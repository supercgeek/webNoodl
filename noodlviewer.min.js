!function(){function a(a,b,c){return a.call.apply(a.bind,arguments)}function b(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function c(d,e,f){return c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:b,c.apply(null,arguments)}function d(a,b){this.D=a,this.m=b||a,this.F=this.m.document}function e(a,b,c){a=a.F.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function f(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function g(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}function h(a){if("string"==typeof a.da)return a.da;var b=a.m.location.protocol;return"about:"==b&&(b=a.D.location.protocol),"https:"==b?"https:":"http:"}function i(a,b){var c=a.createElement("link",{rel:"stylesheet",href:b,media:"all"}),d=!1;c.onload=function(){d||(d=!0)},c.onerror=function(){d||(d=!0)},e(a,"head",c)}function j(a,b,c,d){var e=a.F.getElementsByTagName("head")[0];if(e){var f=a.createElement("script",{src:b}),g=!1;return f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function k(a){this.ca=a||"-"}function l(a,b){this.V=a,this.N=4,this.H="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.H=c[1],this.N=parseInt(c[2],10))}function m(a){return a.H+a.N}function n(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function o(a,b){this.a=a,this.h=a.m.document.documentElement,this.J=b,this.f="wf",this.e=new k("-"),this.Z=!1!==b.events,this.u=!1!==b.classes}function p(a){a.u&&f(a.h,[a.e.d(a.f,"loading")]),r(a,"loading")}function q(a){if(a.u){var b=g(a.h,a.e.d(a.f,"active")),c=[],d=[a.e.d(a.f,"loading")];b||c.push(a.e.d(a.f,"inactive")),f(a.h,c,d)}r(a,"inactive")}function r(a,b,c){a.Z&&a.J[b]&&(c?a.J[b](c.getName(),m(c)):a.J[b]())}function s(){this.t={}}function t(a,b,c){var d,e=[];for(d in b)if(b.hasOwnProperty(d)){var f=a.t[d];f&&e.push(f(b[d],c))}return e}function u(a,b){this.a=a,this.q=b,this.j=this.a.createElement("span",{"aria-hidden":"true"},this.q)}function v(a,b){var c,d=a.j;c=[];for(var e=b.V.split(/,\s*/),f=0;f<e.length;f++){var g=e[f].replace(/['"]/g,"");-1==g.indexOf(" ")?c.push(g):c.push("'"+g+"'")}c=c.join(","),e="normal","o"===b.H?e="oblique":"i"===b.H&&(e="italic"),d.style.cssText="display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+c+";"+("font-style:"+e+";font-weight:"+(b.N+"00")+";")}function w(a){e(a.a,"body",a.j)}function x(a,b,c,d,e,f,g){this.O=a,this.ba=b,this.a=c,this.g=d,this.q=g||"BESbswy",this.s={},this.M=e||3e3,this.T=f||null,this.C=this.B=this.w=this.v=null,this.v=new u(this.a,this.q),this.w=new u(this.a,this.q),this.B=new u(this.a,this.q),this.C=new u(this.a,this.q),v(this.v,new l(this.g.getName()+",serif",m(this.g))),v(this.w,new l(this.g.getName()+",sans-serif",m(this.g))),v(this.B,new l("serif",m(this.g))),v(this.C,new l("sans-serif",m(this.g))),w(this.v),w(this.w),w(this.B),w(this.C)}function y(){if(null===R){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);R=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return R}function z(a,b,c){for(var d in Q)if(Q.hasOwnProperty(d)&&b===a.s[Q[d]]&&c===a.s[Q[d]])return!0;return!1}function A(a){var b,c=a.v.j.offsetWidth,d=a.w.j.offsetWidth;(b=c===a.s.serif&&d===a.s["sans-serif"])||(b=y()&&z(a,c,d)),b?P()-a.ea>=a.M?y()&&z(a,c,d)&&(null===a.T||a.T.hasOwnProperty(a.g.getName()))?C(a,a.O):C(a,a.ba):B(a):C(a,a.O)}function B(a){setTimeout(c(function(){A(this)},a),50)}function C(a,b){setTimeout(c(function(){this.v.remove(),this.w.remove(),this.B.remove(),this.C.remove(),b(this.g)},a),0)}function D(a,b,c){this.a=a,this.o=b,this.K=0,this.X=this.S=!1,this.M=c}function E(a){0==--a.K&&a.S&&(a.X?(a=a.o,a.u&&f(a.h,[a.e.d(a.f,"active")],[a.e.d(a.f,"loading"),a.e.d(a.f,"inactive")]),r(a,"active")):q(a.o))}function F(a){this.D=a,this.p=new s,this.U=0,this.P=this.Q=!0}function G(a,b,d,e,g){var h=0==--a.U;(a.P||a.Q)&&setTimeout(function(){var a=g||null,i=e||null||{};if(0===d.length&&h)q(b.o);else{b.K+=d.length,h&&(b.S=h);var j,k=[];for(j=0;j<d.length;j++){var l=d[j],n=i[l.getName()],o=b.o,p=l;o.u&&f(o.h,[o.e.d(o.f,p.getName(),m(p).toString(),"loading")]),r(o,"fontloading",p),o=null,o=new x(c(b.$,b),c(b.aa,b),b.a,l,b.M,a,n),k.push(o)}for(j=0;j<k.length;j++)k[j].start()}},0)}function H(a,b,c){var d=[],e=c.timeout;p(b);var d=t(a.p,c,a.a),f=new D(a.a,b,e);for(a.U=d.length,b=0,c=d.length;b<c;b++)d[b].load(function(b,c,d){G(a,f,b,c,d)})}function I(a,b,c){this.I=a?a:b+S,this.k=[],this.L=[],this.Y=c||""}function J(a){this.k=a,this.W=[],this.G={}}function K(a,b){this.a=a,this.c=b}function L(a,b){this.a=a,this.c=b,this.R=[]}function M(a,b){this.a=a,this.c=b}function N(a,b){this.a=a,this.c=b}function O(a,b){this.a=a,this.c=b}var P=Date.now||function(){return+new Date};d.prototype.createElement=function(a,b,c){if(a=this.F.createElement(a),b)for(var d in b)b.hasOwnProperty(d)&&("style"==d?a.style.cssText=b[d]:a.setAttribute(d,b[d]));return c&&a.appendChild(this.F.createTextNode(c)),a},k.prototype.d=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.ca)},l.prototype.getName=function(){return this.V},u.prototype.remove=function(){var a=this.j;a.parentNode&&a.parentNode.removeChild(a)};var Q={ga:"serif",fa:"sans-serif"},R=null;x.prototype.start=function(){this.s.serif=this.B.j.offsetWidth,this.s["sans-serif"]=this.C.j.offsetWidth,this.ea=P(),A(this)},D.prototype.$=function(a){var b=this.o;b.u&&f(b.h,[b.e.d(b.f,a.getName(),m(a).toString(),"active")],[b.e.d(b.f,a.getName(),m(a).toString(),"loading"),b.e.d(b.f,a.getName(),m(a).toString(),"inactive")]),r(b,"fontactive",a),this.X=!0,E(this)},D.prototype.aa=function(a){var b=this.o;if(b.u){var c=g(b.h,b.e.d(b.f,a.getName(),m(a).toString(),"active")),d=[],e=[b.e.d(b.f,a.getName(),m(a).toString(),"loading")];c||d.push(b.e.d(b.f,a.getName(),m(a).toString(),"inactive")),f(b.h,d,e)}r(b,"fontinactive",a),E(this)},F.prototype.load=function(a){this.a=new d(this.D,a.context||this.D),this.Q=!1!==a.events,this.P=!1!==a.classes,H(this,new o(this.a,a),a)};var S="//fonts.googleapis.com/css";I.prototype.d=function(){if(0==this.k.length)throw Error("No fonts to load!");if(-1!=this.I.indexOf("kit="))return this.I;for(var a=this.k.length,b=[],c=0;c<a;c++)b.push(this.k[c].replace(/ /g,"+"));return a=this.I+"?family="+b.join("%7C"),0<this.L.length&&(a+="&subset="+this.L.join(",")),0<this.Y.length&&(a+="&text="+encodeURIComponent(this.Y)),a};var T={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},U={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},V={i:"i",italic:"i",n:"n",normal:"n"},W=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;J.prototype.parse=function(){for(var a=this.k.length,b=0;b<a;b++){var c=this.k[b].split(":"),d=c[0].replace(/\+/g," "),e=["n4"];if(2<=c.length){var f,g=c[1];if(f=[],g)for(var g=g.split(","),h=g.length,i=0;i<h;i++){var j;if(j=g[i],j.match(/^[\w-]+$/))if(j=W.exec(j.toLowerCase()),null==j)j="";else{var k;if(k=j[1],null==k||""==k)k="4";else{var m=U[k];k=m?m:isNaN(k)?"4":k.substr(0,1)}j=j[2],j=[null==j||""==j?"n":V[j],k].join("")}else j="";j&&f.push(j)}0<f.length&&(e=f),3==c.length&&(c=c[2],f=[],c=c?c.split(","):f,0<c.length&&(c=T[c[0]])&&(this.G[d]=c))}for(this.G[d]||(c=T[d])&&(this.G[d]=c),c=0;c<e.length;c+=1)this.W.push(new l(d,e[c]))}};var X={Arimo:!0,Cousine:!0,Tinos:!0};K.prototype.load=function(a){for(var b=this.a,c=new I(this.c.api,h(b),this.c.text),d=this.c.families,e=d.length,f=0;f<e;f++){var g=d[f].split(":");3==g.length&&c.L.push(g.pop());var j="";2==g.length&&""!=g[1]&&(j=":"),c.k.push(g.join(j))}d=new J(d),d.parse(),i(b,c.d()),a(d.W,d.G,X)},L.prototype.A=function(a){var b=this.a;return h(this.a)+(this.c.api||"//f.fontdeck.com/s/css/js/")+(b.m.location.hostname||b.D.location.hostname)+"/"+a+".js"},L.prototype.load=function(a){var b=this.c.id,c=this.a.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var e=0,f=c.fonts.length;e<f;++e){var g=c.fonts[e];d.R.push(new l(g.name,n("font-weight:"+g.weight+";font-style:"+g.style)))}a(d.R)},j(this.a,this.A(b),function(b){b&&a([])})):a([])},M.prototype.A=function(a){return(this.c.api||"https://use.typekit.net")+"/"+a+".js"},M.prototype.load=function(a){var b=this.c.id,c=this.a.m;b?j(this.a,this.A(b),function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var d=[],e=0;e<b.length;e+=2)for(var f=b[e],g=b[e+1],h=0;h<g.length;h++)d.push(new l(f,g[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(i){}a(d)}},2e3):a([])},N.prototype.A=function(a,b){var c=h(this.a),d=(this.c.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return c+"//"+d+"/"+a+".js"+(b?"?v="+b:"")},N.prototype.load=function(a){var b=this.c.projectId,c=this.c.version;if(b){var d=this.a.m;j(this.a,this.A(b,c),function(c){if(c)a([]);else if(d["__mti_fntLst"+b]){c=d["__mti_fntLst"+b]();var e=[];if(c)for(var f=0;f<c.length;f++)e.push(new l(c[f].fontfamily));a(e)}else a([])}).id="__MonotypeAPIScript__"+b}else a([])},O.prototype.load=function(a){var b,c,d=this.c.urls||[],e=this.c.families||[],f=this.c.testStrings||{};for(b=0,c=d.length;b<c;b++)i(this.a,d[b]);for(d=[],b=0,c=e.length;b<c;b++){var g=e[b].split(":");if(g[1])for(var h=g[1].split(","),j=0;j<h.length;j+=1)d.push(new l(g[0],h[j]));else d.push(new l(g[0]))}a(d,f)};var Y=new F(window);Y.p.t.custom=function(a,b){return new O(b,a)},Y.p.t.fontdeck=function(a,b){return new L(b,a)},Y.p.t.monotype=function(a,b){return new N(b,a)},Y.p.t.typekit=function(a,b){return new M(b,a)},Y.p.t.google=function(a,b){return new K(b,a)};var Z={load:c(Y.load,Y)};"function"==typeof define&&define.amd?define(function(){return Z}):"undefined"!=typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig))}(),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Application=a()}}(function(){var b;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:b<i?-1:b<i+10?b-i+26+26:b<k+26?b-k:b<j+26?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;d<g;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;e<g;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],2:[function(a,b,c){function d(a,b){return 1-3*b+3*a}function e(a,b){return 3*b-6*a}function f(a){return 3*a}function g(a,b,c){return((d(b,c)*a+e(b,c))*a+f(b))*a}function h(a,b,c){return 3*d(b,c)*a*a+2*e(b,c)*a+f(b)}function i(a,b,c,d,e){var f,h,i=0;do h=b+(c-b)/2,f=g(h,d,e)-a,f>0?c=h:b=h;while(Math.abs(f)>n&&++i<o);return h}function j(a,b,c,d){for(var e=0;e<l;++e){var f=h(b,c,d);if(0===f)return b;var i=g(b,c,d)-a;b-=i/f}return b}function k(a,b,c,d){if(4===arguments.length)return new k([a,b,c,d]);if(!(this instanceof k))return new k(a);if(!a||4!==a.length)throw new Error("BezierEasing: points must contains 4 values");for(var e=0;e<4;++e)if("number"!=typeof a[e]||isNaN(a[e])||!isFinite(a[e]))throw new Error("BezierEasing: points should be integers.");if(a[0]<0||a[0]>1||a[2]<0||a[2]>1)throw new Error("BezierEasing x values must be in [0, 1] range.");this._str="BezierEasing("+a+")",this._css="cubic-bezier("+a+")",this._p=a,this._mSampleValues=r?new Float32Array(p):new Array(p),this._precomputed=!1,this.get=this.get.bind(this)}var l=4,m=.001,n=1e-7,o=10,p=11,q=1/(p-1),r="function"==typeof Float32Array;k.prototype={get:function(a){var b=this._p[0],c=this._p[1],d=this._p[2],e=this._p[3];return this._precomputed||this._precompute(),b===c&&d===e?a:0===a?0:1===a?1:g(this._getTForX(a),c,e)},getPoints:function(){return this._p},toString:function(){return this._str},toCSS:function(){return this._css},_precompute:function(){var a=this._p[0],b=this._p[1],c=this._p[2],d=this._p[3];this._precomputed=!0,a===b&&c===d||this._calcSampleValues()},_calcSampleValues:function(){for(var a=this._p[0],b=this._p[2],c=0;c<p;++c)this._mSampleValues[c]=g(c*q,a,b)},_getTForX:function(a){for(var b=this._p[0],c=this._p[2],d=this._mSampleValues,e=0,f=1,g=p-1;f!==g&&d[f]<=a;++f)e+=q;--f;var k=(a-d[f])/(d[f+1]-d[f]),l=e+k*q,n=h(l,b,c);return n>=m?j(a,l,b,c):0===n?l:i(a,e,e+q,b,c)}},k.css={ease:k.ease=k(.25,.1,.25,1),linear:k.linear=k(0,0,1,1),"ease-in":k.easeIn=k(.42,0,1,1),"ease-out":k.easeOut=k(0,0,.58,1),"ease-in-out":k.easeInOut=k(.42,0,.58,1)},b.exports=k},{}],3:[function(a,b,c){(function(c){function d(a){if(!(this instanceof d))return new d(a);if(this._bufs=[],this.length=0,"function"==typeof a){this._callback=a;var b=function(a){this._callback&&(this._callback(a),this._callback=null)}.bind(this);this.on("pipe",function(a){a.on("error",b)}),this.on("unpipe",function(a){a.removeListener("error",b)})}else c.isBuffer(a)?this.append(a):Array.isArray(a)&&a.forEach(function(a){c.isBuffer(a)&&this.append(a)}.bind(this));e.call(this)}var e=a("readable-stream/duplex"),f=a("util");f.inherits(d,e),d.prototype._offset=function(a){for(var b,c=0,d=0;d<this._bufs.length;d++){if(b=c+this._bufs[d].length,a<b)return[d,a-c];c=b}},d.prototype.append=function(a){var b=c.isBuffer(a)||a instanceof d;return"number"==typeof a&&(a=a.toString()),this._bufs.push(b?a:new c(a)),this.length+=a.length,this},d.prototype._write=function(a,b,c){this.append(a),c&&c()},d.prototype._read=function(a){return this.length?(a=Math.min(a,this.length),this.push(this.slice(0,a)),void this.consume(a)):this.push(null)},d.prototype.end=function(a){e.prototype.end.call(this,a),this._callback&&(this._callback(null,this.slice()),this._callback=null)},d.prototype.get=function(a){return this.slice(a,a+1)[0]},d.prototype.slice=function(a,b){return this.copy(null,0,a,b)},d.prototype.copy=function(a,b,d,e){if(("number"!=typeof d||d<0)&&(d=0),("number"!=typeof e||e>this.length)&&(e=this.length),d>=this.length)return a||new c(0);if(e<=0)return a||new c(0);var f,g,h=!!a,i=this._offset(d),j=e-d,k=j,l=h&&b||0,m=i[1];if(0===d&&e==this.length){if(!h)return c.concat(this._bufs);for(g=0;g<this._bufs.length;g++)this._bufs[g].copy(a,l),l+=this._bufs[g].length;return a}if(k<=this._bufs[i[0]].length-m)return h?this._bufs[i[0]].copy(a,b,m,m+k):this._bufs[i[0]].slice(m,m+k);for(h||(a=new c(j)),g=i[0];g<this._bufs.length;g++){if(f=this._bufs[g].length-m,!(k>f)){this._bufs[g].copy(a,l,m,m+k);break}this._bufs[g].copy(a,l,m),l+=f,k-=f,m&&(m=0)}return a},d.prototype.toString=function(a,b,c){return this.slice(b,c).toString(a)},d.prototype.consume=function(a){for(;this._bufs.length;){if(!(a>this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(a),this.length-=a;break}a-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},d.prototype.duplicate=function(){for(var a=0,b=new d;a<this._bufs.length;a++)b.append(this._bufs[a]);return b},d.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var a={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var b in a)!function(b){d.prototype[b]=function(c){return this.slice(c,c+a[b])[b](0)}}(b)}(),b.exports=d}).call(this,a("buffer").Buffer)},{buffer:6,"readable-stream/duplex":177,util:212}],4:[function(a,b,c){},{}],5:[function(a,b,c){(function(b){"use strict";var d=a("buffer"),e=d.Buffer,f=d.SlowBuffer,g=d.kMaxLength||2147483647;c.alloc=function(a,b,c){if("function"==typeof e.alloc)return e.alloc(a,b,c);if("number"==typeof c)throw new TypeError("encoding must not be number");if("number"!=typeof a)throw new TypeError("size must be a number");if(a>g)throw new RangeError("size is too large");var d=c,f=b;void 0===f&&(d=void 0,f=0);var h=new e(a);if("string"==typeof f)for(var i=new e(f,d),j=i.length,k=-1;++k<a;)h[k]=i[k%j];else h.fill(f);return h},c.allocUnsafe=function(a){if("function"==typeof e.allocUnsafe)return e.allocUnsafe(a);if("number"!=typeof a)throw new TypeError("size must be a number");if(a>g)throw new RangeError("size is too large");return new e(a)},c.from=function(a,c,d){if("function"==typeof e.from&&(!b.Uint8Array||Uint8Array.from!==e.from))return e.from(a,c,d);if("number"==typeof a)throw new TypeError('"value" argument must not be a number');if("string"==typeof a)return new e(a,c);if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer){var f=c;if(1===arguments.length)return new e(a);"undefined"==typeof f&&(f=0);var g=d;if("undefined"==typeof g&&(g=a.byteLength-f),f>=a.byteLength)throw new RangeError("'offset' is out of bounds");if(g>a.byteLength-f)throw new RangeError("'length' is out of bounds");return new e(a.slice(f,f+g))}if(e.isBuffer(a)){var h=new e(a.length);return a.copy(h,0,0,a.length),h}if(a){if(Array.isArray(a)||"undefined"!=typeof ArrayBuffer&&a.buffer instanceof ArrayBuffer||"length"in a)return new e(a);if("Buffer"===a.type&&Array.isArray(a.data))return new e(a.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},c.allocUnsafeSlow=function(a){if("function"==typeof e.allocUnsafeSlow)return e.allocUnsafeSlow(a);if("number"!=typeof a)throw new TypeError("size must be a number");if(a>=g)throw new RangeError("size is too large");return new f(a)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:6}],6:[function(a,b,c){(function(b){"use strict";function d(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}function e(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a){return this instanceof f?(f.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof a?g(this,a):"string"==typeof a?h(this,a,arguments.length>1?arguments[1]:"utf8"):i(this,a)):arguments.length>1?new f(a,arguments[1]):new f(a)}function g(a,b){if(a=p(a,b<0?0:0|q(b)),!f.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;c++)a[c]=0;return a}function h(a,b,c){"string"==typeof c&&""!==c||(c="utf8");var d=0|s(b,c);return a=p(a,d),a.write(b,c),a}function i(a,b){if(f.isBuffer(b))return j(a,b);if(Y(b))return k(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return l(a,b);if(b instanceof ArrayBuffer)return m(a,b)}return b.length?n(a,b):o(a,b)}function j(a,b){var c=0|q(b.length);return a=p(a,c),b.copy(a,0,0,c),a}function k(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function l(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function m(a,b){return f.TYPED_ARRAY_SUPPORT?(b.byteLength,a=f._augment(new Uint8Array(b))):a=l(a,new Uint8Array(b)),a}function n(a,b){var c=0|q(b.length);a=p(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function o(a,b){var c,d=0;"Buffer"===b.type&&Y(b.data)&&(c=b.data,d=0|q(c.length)),a=p(a,d);for(var e=0;e<d;e+=1)a[e]=255&c[e];return a}function p(a,b){f.TYPED_ARRAY_SUPPORT?(a=f._augment(new Uint8Array(b)),a.__proto__=f.prototype):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=f.poolSize>>>1;return c&&(a.parent=Z),a}function q(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function r(a,b){if(!(this instanceof r))return new r(a,b);var c=new f(a,b);return delete c.parent,c}function s(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return R(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return U(a).length;default:if(d)return R(a).length;b=(""+b).toLowerCase(),d=!0}}function t(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),b<0&&(b=0),c>this.length&&(c=this.length),c<=b)return"";for(;;)switch(a){case"hex":return F(this,b,c);case"utf8":case"utf-8":return B(this,b,c);case"ascii":return D(this,b,c);case"binary":return E(this,b,c);case"base64":return A(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function u(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function v(a,b,c,d){return V(R(b,a.length-c),a,c,d)}function w(a,b,c,d){return V(S(b),a,c,d)}function x(a,b,c,d){return w(a,b,c,d)}function y(a,b,c,d){return V(U(b),a,c,d)}function z(a,b,c,d){return V(T(b,a.length-c),a,c,d)}function A(a,b,c){return 0===b&&c===a.length?W.fromByteArray(a):W.fromByteArray(a.slice(b,c))}function B(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return C(d)}function C(a){var b=a.length;if(b<=$)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=$));return c}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(127&a[e]);return d}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;e++)d+=String.fromCharCode(a[e]);return d}function F(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;f++)e+=Q(a[f]);return e}function G(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function H(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function I(a,b,c,d,e,g){if(!f.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>e||b<g)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function J(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function K(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function L(a,b,c,d,e,f){if(b>e||b<f)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(c<0)throw new RangeError("index out of range")}function M(a,b,c,d,e){return e||L(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),X.write(a,b,c,d,23,4),c+4}function N(a,b,c,d,e){return e||L(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),X.write(a,b,c,d,52,8),c+8}function O(a){if(a=P(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function P(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function Q(a){return a<16?"0"+a.toString(16):a.toString(16)}function R(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;g++){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function S(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function T(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function U(a){return W.toByteArray(O(a))}function V(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var W=a("base64-js"),X=a("ieee754"),Y=a("isarray");c.Buffer=f,c.SlowBuffer=r,c.INSPECT_MAX_BYTES=50,f.poolSize=8192;var Z={};f.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),f.TYPED_ARRAY_SUPPORT?(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array):(f.prototype.length=void 0,f.prototype.parent=void 0),f.isBuffer=function(a){return!(null==a||!a._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,g=Math.min(c,d);e<g&&a[e]===b[e];)++e;return e!==g&&(c=a[e],d=b[e]),c<d?-1:d<c?1:0},f.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(a,b){if(!Y(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new f(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new f(b),e=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,e),e+=g.length}return d},f.byteLength=s,f.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?B(this,0,a):t.apply(this,arguments)},f.prototype.equals=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===f.compare(this,a)},f.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},f.prototype.compare=function(a){if(!f.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:f.compare(this,a)},f.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[d===-1?0:e-d]){if(d===-1&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(b<0&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(f.isBuffer(a))return c(this,a,b);if("number"==typeof a)return f.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},f.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},f.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},f.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;f.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c,a<0&&(a=0)):a>c&&(a=c),b<0?(b+=c,b<0&&(b=0)):b>c&&(b=c),b<a&&(b=a);var d;if(f.TYPED_ARRAY_SUPPORT)d=f._augment(this.subarray(a,b));else{var e=b-a;d=new f(e,void 0);for(var g=0;g<e;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},f.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},f.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},f.prototype.readUInt8=function(a,b){return b||H(a,1,this.length),this[a]},f.prototype.readUInt16LE=function(a,b){return b||H(a,2,this.length),
this[a]|this[a+1]<<8},f.prototype.readUInt16BE=function(a,b){return b||H(a,2,this.length),this[a]<<8|this[a+1]},f.prototype.readUInt32LE=function(a,b){return b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},f.prototype.readUInt32BE=function(a,b){return b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},f.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},f.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},f.prototype.readInt8=function(a,b){return b||H(a,1,this.length),128&this[a]?(255-this[a]+1)*-1:this[a]},f.prototype.readInt16LE=function(a,b){b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt16BE=function(a,b){b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},f.prototype.readInt32LE=function(a,b){return b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},f.prototype.readInt32BE=function(a,b){return b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},f.prototype.readFloatLE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!0,23,4)},f.prototype.readFloatBE=function(a,b){return b||H(a,4,this.length),X.read(this,a,!1,23,4)},f.prototype.readDoubleLE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!0,52,8)},f.prototype.readDoubleBE=function(a,b){return b||H(a,8,this.length),X.read(this,a,!1,52,8)},f.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},f.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||I(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},f.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,1,255,0),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},f.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):K(this,a,b,!0),b+4},f.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=a<0?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=a<0?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},f.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,1,127,-128),f.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),a<0&&(a=255+a+1),this[b]=255&a,b+1},f.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):J(this,a,b,!0),b+2},f.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):J(this,a,b,!1),b+2},f.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):K(this,a,b,!0),b+4},f.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||I(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),f.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):K(this,a,b,!1),b+4},f.prototype.writeFloatLE=function(a,b,c){return M(this,a,b,!0,c)},f.prototype.writeFloatBE=function(a,b,c){return M(this,a,b,!1,c)},f.prototype.writeDoubleLE=function(a,b,c){return N(this,a,b,!0,c)},f.prototype.writeDoubleBE=function(a,b,c){return N(this,a,b,!1,c)},f.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("sourceStart out of bounds");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,g=d-c;if(this===a&&c<b&&b<d)for(e=g-1;e>=0;e--)a[e+b]=this[e+c];else if(g<1e3||!f.TYPED_ARRAY_SUPPORT)for(e=0;e<g;e++)a[e+b]=this[e+c];else a._set(this.subarray(c,c+g),b);return g},f.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),c<b)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(b<0||b>=this.length)throw new RangeError("start out of bounds");if(c<0||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;d<c;d++)this[d]=a;else{var e=R(a.toString()),f=e.length;for(d=b;d<c;d++)this[d]=e[d%f]}return this}},f.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(f.TYPED_ARRAY_SUPPORT)return new f(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;b<c;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var _=f.prototype;f._augment=function(a){return a.constructor=f,a._isBuffer=!0,a._set=a.set,a.get=_.get,a.set=_.set,a.write=_.write,a.toString=_.toString,a.toLocaleString=_.toString,a.toJSON=_.toJSON,a.equals=_.equals,a.compare=_.compare,a.indexOf=_.indexOf,a.copy=_.copy,a.slice=_.slice,a.readUIntLE=_.readUIntLE,a.readUIntBE=_.readUIntBE,a.readUInt8=_.readUInt8,a.readUInt16LE=_.readUInt16LE,a.readUInt16BE=_.readUInt16BE,a.readUInt32LE=_.readUInt32LE,a.readUInt32BE=_.readUInt32BE,a.readIntLE=_.readIntLE,a.readIntBE=_.readIntBE,a.readInt8=_.readInt8,a.readInt16LE=_.readInt16LE,a.readInt16BE=_.readInt16BE,a.readInt32LE=_.readInt32LE,a.readInt32BE=_.readInt32BE,a.readFloatLE=_.readFloatLE,a.readFloatBE=_.readFloatBE,a.readDoubleLE=_.readDoubleLE,a.readDoubleBE=_.readDoubleBE,a.writeUInt8=_.writeUInt8,a.writeUIntLE=_.writeUIntLE,a.writeUIntBE=_.writeUIntBE,a.writeUInt16LE=_.writeUInt16LE,a.writeUInt16BE=_.writeUInt16BE,a.writeUInt32LE=_.writeUInt32LE,a.writeUInt32BE=_.writeUInt32BE,a.writeIntLE=_.writeIntLE,a.writeIntBE=_.writeIntBE,a.writeInt8=_.writeInt8,a.writeInt16LE=_.writeInt16LE,a.writeInt16BE=_.writeInt16BE,a.writeInt32LE=_.writeInt32LE,a.writeInt32BE=_.writeInt32BE,a.writeFloatLE=_.writeFloatLE,a.writeFloatBE=_.writeFloatBE,a.writeDoubleLE=_.writeDoubleLE,a.writeDoubleBE=_.writeDoubleBE,a.fill=_.fill,a.inspect=_.inspect,a.toArrayBuffer=_.toArrayBuffer,a};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:22,isarray:25}],7:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":24}],8:[function(a,b,c){c.UINT32=a("./lib/uint32"),c.UINT64=a("./lib/uint64")},{"./lib/uint32":9,"./lib/uint64":10}],9:[function(a,c,d){!function(a){function d(a,b){return this instanceof d?(this._low=0,this._high=0,this.remainder=null,"undefined"==typeof b?f.call(this,a):"string"==typeof a?g.call(this,a,b):void e.call(this,a,b)):new d(a,b)}function e(a,b){return this._low=0|a,this._high=0|b,this}function f(a){return this._low=65535&a,this._high=a>>>16,this}function g(a,b){var c=parseInt(a,b||10);return this._low=65535&c,this._high=c>>>16,this}({36:d(Math.pow(36,5)),16:d(Math.pow(16,7)),10:d(Math.pow(10,9)),2:d(Math.pow(2,30))}),{36:d(36),16:d(16),10:d(10),2:d(2)};d.prototype.fromBits=e,d.prototype.fromNumber=f,d.prototype.fromString=g,d.prototype.toNumber=function(){return 65536*this._high+this._low},d.prototype.toString=function(a){return this.toNumber().toString(a||10)},d.prototype.add=function(a){var b=this._low+a._low,c=b>>>16;return c+=this._high+a._high,this._low=65535&b,this._high=65535&c,this},d.prototype.subtract=function(a){return this.add(a.clone().negate())},d.prototype.multiply=function(a){var b,c,d=this._high,e=this._low,f=a._high,g=a._low;return c=e*g,b=c>>>16,b+=d*g,b&=65535,b+=e*f,this._low=65535&c,this._high=65535&b,this},d.prototype.div=function(a){if(0==a._low&&0==a._high)throw Error("division by zero");if(0==a._high&&1==a._low)return this.remainder=new d(0),this;if(a.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(a))return this.remainder=new d(0),this._low=1,this._high=0,this;for(var b=a.clone(),c=-1;!this.lt(b);)b.shiftLeft(1,!0),c++;for(this.remainder=this.clone(),this._low=0,this._high=0;c>=0;c--)b.shiftRight(1),this.remainder.lt(b)||(this.remainder.subtract(b),c>=16?this._high|=1<<c-16:this._low|=1<<c);return this},d.prototype.negate=function(){var a=(65535&~this._low)+1;return this._low=65535&a,this._high=~this._high+(a>>>16)&65535,this},d.prototype.equals=d.prototype.eq=function(a){return this._low==a._low&&this._high==a._high},d.prototype.greaterThan=d.prototype.gt=function(a){return this._high>a._high||!(this._high<a._high)&&this._low>a._low},d.prototype.lessThan=d.prototype.lt=function(a){return this._high<a._high||!(this._high>a._high)&&this._low<a._low},d.prototype.or=function(a){return this._low|=a._low,this._high|=a._high,this},d.prototype.and=function(a){return this._low&=a._low,this._high&=a._high,this},d.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},d.prototype.xor=function(a){return this._low^=a._low,this._high^=a._high,this},d.prototype.shiftRight=d.prototype.shiftr=function(a){return a>16?(this._low=this._high>>a-16,this._high=0):16==a?(this._low=this._high,this._high=0):(this._low=this._low>>a|this._high<<16-a&65535,this._high>>=a),this},d.prototype.shiftLeft=d.prototype.shiftl=function(a,b){return a>16?(this._high=this._low<<a-16,this._low=0,b||(this._high&=65535)):16==a?(this._high=this._low,this._low=0):(this._high=this._high<<a|this._low>>16-a,this._low=this._low<<a&65535,b||(this._high&=65535)),this},d.prototype.rotateLeft=d.prototype.rotl=function(a){var b=this._high<<16|this._low;return b=b<<a|b>>>32-a,this._low=65535&b,this._high=b>>>16,this},d.prototype.rotateRight=d.prototype.rotr=function(a){var b=this._high<<16|this._low;return b=b>>>a|b<<32-a,this._low=65535&b,this._high=b>>>16,this},d.prototype.clone=function(){return new d(this._low,this._high)},"undefined"!=typeof b&&b.amd?b([],function(){return d}):"undefined"!=typeof c&&c.exports?c.exports=d:a.UINT32=d}(this)},{}],10:[function(a,c,d){!function(a){function d(a,b,c,h){return this instanceof d?(this.remainder=null,"string"==typeof a?g.call(this,a,b):"undefined"==typeof b?f.call(this,a):void e.apply(this,arguments)):new d(a,b,c,h)}function e(a,b,c,d){return"undefined"==typeof c?(this._a00=65535&a,this._a16=a>>>16,this._a32=65535&b,this._a48=b>>>16,this):(this._a00=0|a,this._a16=0|b,this._a32=0|c,this._a48=0|d,this)}function f(a){return this._a00=65535&a,this._a16=a>>>16,this._a32=0,this._a48=0,this}function g(a,b){b=b||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var c=h[b]||new d(Math.pow(b,5)),e=0,f=a.length;e<f;e+=5){var g=Math.min(5,f-e),i=parseInt(a.slice(e,e+g),b);this.multiply(g<5?new d(Math.pow(b,g)):c).add(new d(i))}return this}var h={16:d(Math.pow(16,5)),10:d(Math.pow(10,5)),2:d(Math.pow(2,5))},i={16:d(16),10:d(10),2:d(2)};d.prototype.fromBits=e,d.prototype.fromNumber=f,d.prototype.fromString=g,d.prototype.toNumber=function(){return 65536*this._a16+this._a00},d.prototype.toString=function(a){a=a||10;var b=i[a]||new d(a);if(!this.gt(b))return this.toNumber().toString(a);for(var c=this.clone(),e=new Array(64),f=63;f>=0&&(c.div(b),e[f]=c.remainder.toNumber().toString(a),c.gt(b));f--);return e[f-1]=c.toNumber().toString(a),e.join("")},d.prototype.add=function(a){var b=this._a00+a._a00,c=b>>>16;c+=this._a16+a._a16;var d=c>>>16;d+=this._a32+a._a32;var e=d>>>16;return e+=this._a48+a._a48,this._a00=65535&b,this._a16=65535&c,this._a32=65535&d,this._a48=65535&e,this},d.prototype.subtract=function(a){return this.add(a.clone().negate())},d.prototype.multiply=function(a){var b=this._a00,c=this._a16,d=this._a32,e=this._a48,f=a._a00,g=a._a16,h=a._a32,i=a._a48,j=b*f,k=j>>>16;k+=b*g;var l=k>>>16;k&=65535,k+=c*f,l+=k>>>16,l+=b*h;var m=l>>>16;return l&=65535,l+=c*g,m+=l>>>16,l&=65535,l+=d*f,m+=l>>>16,m+=b*i,m&=65535,m+=c*h,m&=65535,m+=d*g,m&=65535,m+=e*f,this._a00=65535&j,this._a16=65535&k,this._a32=65535&l,this._a48=65535&m,this},d.prototype.div=function(a){if(0==a._a16&&0==a._a32&&0==a._a48){if(0==a._a00)throw Error("division by zero");if(1==a._a00)return this.remainder=new d(0),this}if(a.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(a))return this.remainder=new d(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var b=a.clone(),c=-1;!this.lt(b);)b.shiftLeft(1,!0),c++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;c>=0;c--)b.shiftRight(1),this.remainder.lt(b)||(this.remainder.subtract(b),c>=48?this._a48|=1<<c-48:c>=32?this._a32|=1<<c-32:c>=16?this._a16|=1<<c-16:this._a00|=1<<c);return this},d.prototype.negate=function(){var a=(65535&~this._a00)+1;return this._a00=65535&a,a=(65535&~this._a16)+(a>>>16),this._a16=65535&a,a=(65535&~this._a32)+(a>>>16),this._a32=65535&a,this._a48=~this._a48+(a>>>16)&65535,this},d.prototype.equals=d.prototype.eq=function(a){return this._a48==a._a48&&this._a00==a._a00&&this._a32==a._a32&&this._a16==a._a16},d.prototype.greaterThan=d.prototype.gt=function(a){return this._a48>a._a48||!(this._a48<a._a48)&&(this._a32>a._a32||!(this._a32<a._a32)&&(this._a16>a._a16||!(this._a16<a._a16)&&this._a00>a._a00))},d.prototype.lessThan=d.prototype.lt=function(a){return this._a48<a._a48||!(this._a48>a._a48)&&(this._a32<a._a32||!(this._a32>a._a32)&&(this._a16<a._a16||!(this._a16>a._a16)&&this._a00<a._a00))},d.prototype.or=function(a){return this._a00|=a._a00,this._a16|=a._a16,this._a32|=a._a32,this._a48|=a._a48,this},d.prototype.and=function(a){return this._a00&=a._a00,this._a16&=a._a16,this._a32&=a._a32,this._a48&=a._a48,this},d.prototype.xor=function(a){return this._a00^=a._a00,this._a16^=a._a16,this._a32^=a._a32,this._a48^=a._a48,this},d.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},d.prototype.shiftRight=d.prototype.shiftr=function(a){return a%=64,a>=48?(this._a00=this._a48>>a-48,this._a16=0,this._a32=0,this._a48=0):a>=32?(a-=32,this._a00=65535&(this._a32>>a|this._a48<<16-a),this._a16=this._a48>>a&65535,this._a32=0,this._a48=0):a>=16?(a-=16,this._a00=65535&(this._a16>>a|this._a32<<16-a),this._a16=65535&(this._a32>>a|this._a48<<16-a),this._a32=this._a48>>a&65535,this._a48=0):(this._a00=65535&(this._a00>>a|this._a16<<16-a),this._a16=65535&(this._a16>>a|this._a32<<16-a),this._a32=65535&(this._a32>>a|this._a48<<16-a),this._a48=this._a48>>a&65535),this},d.prototype.shiftLeft=d.prototype.shiftl=function(a,b){return a%=64,a>=48?(this._a48=this._a00<<a-48,this._a32=0,this._a16=0,this._a00=0):a>=32?(a-=32,this._a48=this._a16<<a|this._a00>>16-a,this._a32=this._a00<<a&65535,this._a16=0,this._a00=0):a>=16?(a-=16,this._a48=this._a32<<a|this._a16>>16-a,this._a32=65535&(this._a16<<a|this._a00>>16-a),this._a16=this._a00<<a&65535,this._a00=0):(this._a48=this._a48<<a|this._a32>>16-a,this._a32=65535&(this._a32<<a|this._a16>>16-a),this._a16=65535&(this._a16<<a|this._a00>>16-a),this._a00=this._a00<<a&65535),b||(this._a48&=65535),this},d.prototype.rotateLeft=d.prototype.rotl=function(a){if(a%=64,0==a)return this;if(a>=32){var b=this._a00;if(this._a00=this._a32,this._a32=b,b=this._a48,this._a48=this._a16,this._a16=b,32==a)return this;a-=32}var c=this._a48<<16|this._a32,d=this._a16<<16|this._a00,e=c<<a|d>>>32-a,f=d<<a|c>>>32-a;return this._a00=65535&f,this._a16=f>>>16,this._a32=65535&e,this._a48=e>>>16,this},d.prototype.rotateRight=d.prototype.rotr=function(a){if(a%=64,0==a)return this;if(a>=32){var b=this._a00;if(this._a00=this._a32,this._a32=b,b=this._a48,this._a48=this._a16,this._a16=b,32==a)return this;a-=32}var c=this._a48<<16|this._a32,d=this._a16<<16|this._a00,e=c>>>a|d<<32-a,f=d>>>a|c<<32-a;return this._a00=65535&f,this._a16=f>>>16,this._a32=65535&e,this._a48=e>>>16,this},d.prototype.clone=function(){return new d(this._a00,this._a16,this._a32,this._a48)},"undefined"!=typeof b&&b.amd?b([],function(){return d}):"undefined"!=typeof c&&c.exports?c.exports=d:a.UINT64=d}(this)},{}],11:[function(a,b,c){(function(c,d){var e=a("readable-stream"),f=a("end-of-stream"),g=a("inherits"),h=a("stream-shift"),i=new d([0]),j=function(a,b){a._corked?a.once("uncork",b):b()},k=function(a,b){return function(c){c?a.destroy("premature close"===c.message?null:c):b&&!a._ended&&a.end()}},l=function(a,b){return a?a._writableState&&a._writableState.finished?b():a._writableState?a.end(b):(a.end(),void b()):b()},m=function(a){return new e.Readable({objectMode:!0,highWaterMark:16}).wrap(a)},n=function(a,b,c){return this instanceof n?(e.Duplex.call(this,c),this._writable=null,this._readable=null,this._readable2=null,this._forwardDestroy=!c||c.destroy!==!1,this._forwardEnd=!c||c.end!==!1,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,a&&this.setWritable(a),void(b&&this.setReadable(b))):new n(a,b,c)};g(n,e.Duplex),n.obj=function(a,b,c){return c||(c={}),c.objectMode=!0,c.highWaterMark=16,new n(a,b,c)},n.prototype.cork=function(){1===++this._corked&&this.emit("cork")},n.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},n.prototype.setWritable=function(a){if(this._unwrite&&this._unwrite(),this.destroyed)return void(a&&a.destroy&&a.destroy());if(null===a||a===!1)return void this.end();var b=this,d=f(a,{writable:!0,readable:!1},k(this,this._forwardEnd)),e=function(){var a=b._ondrain;b._ondrain=null,a&&a()},g=function(){b._writable.removeListener("drain",e),d()};this._unwrite&&c.nextTick(e),this._writable=a,this._writable.on("drain",e),this._unwrite=g,this.uncork()},n.prototype.setReadable=function(a){if(this._unread&&this._unread(),this.destroyed)return void(a&&a.destroy&&a.destroy());if(null===a||a===!1)return this.push(null),void this.resume();var b=this,c=f(a,{writable:!1,readable:!0},k(this)),d=function(){b._forward()},e=function(){b.push(null)},g=function(){b._readable2.removeListener("readable",d),b._readable2.removeListener("end",e),c()};this._drained=!0,this._readable=a,this._readable2=a._readableState?a:m(a),this._readable2.on("readable",d),this._readable2.on("end",e),this._unread=g,this._forward()},n.prototype._read=function(){this._drained=!0,this._forward()},n.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){this._forwarding=!0;for(var a;null!==(a=h(this._readable2));)this._drained=this.push(a);this._forwarding=!1}},n.prototype.destroy=function(a){if(!this.destroyed){this.destroyed=!0;var b=this;c.nextTick(function(){b._destroy(a)})}},n.prototype._destroy=function(a){if(a){var b=this._ondrain;this._ondrain=null,b?b(a):this.emit("error",a)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},n.prototype._write=function(a,b,c){return this.destroyed?c():this._corked?j(this,this._write.bind(this,a,b,c)):a===i?this._finish(c):this._writable?void(this._writable.write(a)===!1?this._ondrain=c:c()):c()},n.prototype._finish=function(a){var b=this;this.emit("preend"),j(this,function(){l(b._forwardEnd&&b._writable,function(){b._writableState.prefinished===!1&&(b._writableState.prefinished=!0),b.emit("prefinish"),j(b,a)})})},n.prototype.end=function(a,b,c){return"function"==typeof a?this.end(null,null,a):"function"==typeof b?this.end(a,null,b):(this._ended=!0,a&&this.write(a),this._writableState.ending||this.write(i),e.Writable.prototype.end.call(this,c))},b.exports=n}).call(this,a("_process"),a("buffer").Buffer)},{_process:172,buffer:6,"end-of-stream":12,inherits:23,"readable-stream":19,"stream-shift":199}],12:[function(a,b,c){var d=a("once"),e=function(){},f=function(a){return a.setHeader&&"function"==typeof a.abort},g=function(a,b,c){if("function"==typeof b)return g(a,null,b);b||(b={}),c=d(c||e);var h=a._writableState,i=a._readableState,j=b.readable||b.readable!==!1&&a.readable,k=b.writable||b.writable!==!1&&a.writable,l=function(){a.writable||m()},m=function(){k=!1,j||c()},n=function(){j=!1,k||c()},o=function(){return(!j||i&&i.ended)&&(!k||h&&h.ended)?void 0:c(new Error("premature close"))},p=function(){a.req.on("finish",m)};return f(a)?(a.on("complete",m),a.on("abort",o),a.req?p():a.on("request",p)):k&&!h&&(a.on("end",l),a.on("close",l)),a.on("end",n),a.on("finish",m),b.error!==!1&&a.on("error",c),a.on("close",o),function(){a.removeListener("complete",m),a.removeListener("abort",o),a.removeListener("request",p),a.req&&a.req.removeListener("finish",m),a.removeListener("end",l),a.removeListener("close",l),a.removeListener("finish",m),a.removeListener("end",n),a.removeListener("error",c),a.removeListener("close",o)}};b.exports=g},{once:170}],13:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||h(f,this)}function f(a){a.end()}var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var h=a("process-nextick-args"),i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=g(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}},{"./_stream_readable":15,"./_stream_writable":17,"core-util-is":7,inherits:23,"process-nextick-args":171}],14:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":16,"core-util-is":7,inherits:23}],15:[function(a,b,c){(function(c){"use strict";function d(a,b,c){return"function"==typeof a.prependListener?a.prependListener(b,c):void(a._events&&a._events[b]?E(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c))}function e(b,c){O=O||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof O&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=new N,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(M||(M=a("string_decoder/").StringDecoder),this.decoder=new M(b.encoding),this.encoding=b.encoding)}function f(b){return O=O||a("./_stream_duplex"),this instanceof f?(this._readableState=new e(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void F.call(this)):new f(b)}function g(a,b,c,d,e){var f=k(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,l(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var g=new Error("stream.push() after EOF");a.emit("error",g)}else if(b.endEmitted&&e){var i=new Error("stream.unshift() after end event");a.emit("error",i)}else{var j;!b.decoder||e||d||(c=b.decoder.write(c),j=!b.objectMode&&0===c.length),e||(b.reading=!1),j||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&m(a))),o(a,b)}else e||(b.reading=!1);return h(b)}function h(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function i(a){return a>=P?a=P:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function j(a,b){return a<=0||0===b.length&&b.ended?0:b.objectMode?1:a!==a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=i(a)),a<=b.length?a:b.ended?b.length:(b.needReadable=!0,0))}function k(a,b){var c=null;return H.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function l(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,m(a)}}function m(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(L("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?D(n,a):n(a))}function n(a){L("emit readable"),a.emit("readable"),u(a)}function o(a,b){b.readingMore||(b.readingMore=!0,D(p,a,b))}function p(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(L("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function q(a){return function(){var b=a._readableState;L("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&G(a,"data")&&(b.flowing=!0,u(a))}}function r(a){L("readable nexttick read 0"),a.read(0)}function s(a,b){b.resumeScheduled||(b.resumeScheduled=!0,D(t,a,b))}function t(a,b){b.reading||(L("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),u(a),b.flowing&&!b.reading&&a.read(0)}function u(a){var b=a._readableState;for(L("flow",b.flowing);b.flowing&&null!==a.read(););}function v(a,b){if(0===b.length)return null;var c;return b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.head.data:b.buffer.concat(b.length),b.buffer.clear()):c=w(a,b.buffer,b.decoder),c}function w(a,b,c){var d;return a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):d=a===b.head.data.length?b.shift():c?x(a,b):y(a,b),d}function x(a,b){var c=b.head,d=1,e=c.data;for(a-=e.length;c=c.next;){var f=c.data,g=a>f.length?f.length:a;if(e+=g===f.length?f:f.slice(0,a),a-=g,0===a){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}return b.length-=d,e}function y(a,b){var c=I.allocUnsafe(a),d=b.head,e=1;for(d.data.copy(c),a-=d.data.length;d=d.next;){var f=d.data,g=a>f.length?f.length:a;if(f.copy(c,c.length-a,0,g),a-=g,0===a){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}return b.length-=e,c}function z(a){var b=a._readableState;if(b.length>0)throw new Error('"endReadable()" called on non-empty stream');b.endEmitted||(b.ended=!0,D(A,b,a))}function A(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function B(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function C(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=f;var D=a("process-nextick-args"),E=a("isarray");f.ReadableState=e;var F,G=(a("events").EventEmitter,function(a,b){return a.listeners(b).length});!function(){try{F=a("stream")}catch(b){}finally{F||(F=a("events").EventEmitter)}}();var H=a("buffer").Buffer,I=a("buffer-shims"),J=a("core-util-is");J.inherits=a("inherits");var K=a("util"),L=void 0;L=K&&K.debuglog?K.debuglog("stream"):function(){};var M,N=a("./internal/streams/BufferList");J.inherits(f,F);var O,O;f.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=I.from(a,b),b="")),g(this,c,a,b,!1)},f.prototype.unshift=function(a){var b=this._readableState;return g(this,b,a,"",!0)},f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(b){return M||(M=a("string_decoder/").StringDecoder),this._readableState.decoder=new M(b),this._readableState.encoding=b,this};var P=8388608;f.prototype.read=function(a){L("read",a),a=parseInt(a,10);var b=this._readableState,c=a;if(0!==a&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return L("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?z(this):m(this),null;if(a=j(a,b),0===a&&b.ended)return 0===b.length&&z(this),null;var d=b.needReadable;L("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,L("length less than watermark",d)),b.ended||b.reading?(d=!1,L("reading or ended",d)):d&&(L("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=j(c,b)));var e;return e=a>0?v(a,b):null,null===e?(b.needReadable=!0,a=0):b.length-=a,0===b.length&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&z(this)),null!==e&&this.emit("data",e),e},f.prototype._read=function(a){this.emit("error",new Error("not implemented"))},f.prototype.pipe=function(a,b){function e(a){L("onunpipe"),a===m&&g()}function f(){L("onend"),a.end()}function g(){L("cleanup"),a.removeListener("close",j),a.removeListener("finish",k),a.removeListener("drain",r),a.removeListener("error",i),a.removeListener("unpipe",e),m.removeListener("end",f),m.removeListener("end",g),m.removeListener("data",h),s=!0,!n.awaitDrain||a._writableState&&!a._writableState.needDrain||r()}function h(b){L("ondata"),t=!1;var c=a.write(b);!1!==c||t||((1===n.pipesCount&&n.pipes===a||n.pipesCount>1&&C(n.pipes,a)!==-1)&&!s&&(L("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,t=!0),m.pause())}function i(b){L("onerror",b),l(),a.removeListener("error",i),0===G(a,"error")&&a.emit("error",b)}function j(){a.removeListener("finish",k),l()}function k(){L("onfinish"),a.removeListener("close",j),l()}function l(){L("unpipe"),m.unpipe(a)}var m=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=a;break;case 1:n.pipes=[n.pipes,a];break;default:n.pipes.push(a)}n.pipesCount+=1,L("pipe count=%d opts=%j",n.pipesCount,b);var o=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,p=o?f:g;n.endEmitted?D(p):m.once("end",p),a.on("unpipe",e);var r=q(m);a.on("drain",r);var s=!1,t=!1;return m.on("data",h),d(a,"error",i),a.once("close",j),a.once("finish",k),a.emit("pipe",m),n.flowing||(L("pipe resume"),m.resume()),a},f.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),
b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=C(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},f.prototype.on=function(a,b){var c=F.prototype.on.call(this,a,b);if("data"===a)this._readableState.flowing!==!1&&this.resume();else if("readable"===a){var d=this._readableState;d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&m(this,d):D(r,this))}return c},f.prototype.addListener=f.prototype.on,f.prototype.resume=function(){var a=this._readableState;return a.flowing||(L("resume"),a.flowing=!0,s(this,a)),this},f.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},f.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(L("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(L("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return B(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){L("wrapped _read",b),c&&(c=!1,a.resume())},d},f._fromList=v}).call(this,a("_process"))},{"./_stream_duplex":13,"./internal/streams/BufferList":18,_process:172,buffer:6,"buffer-shims":5,"core-util-is":7,events:21,inherits:23,isarray:25,"process-nextick-args":171,"string_decoder/":200,util:4}],16:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("Calling transform done when ws.length != 0");if(d.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("Not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":13,"core-util-is":7,inherits:23}],17:[function(a,b,c){(function(c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){E=E||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof E&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this)}function g(b){return E=E||a("./_stream_duplex"),this instanceof g||this instanceof E?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void A.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),x(b,c)}function i(a,b,c,d){var e=!0,f=!1;return null===c?f=new TypeError("May not write null values to stream"):C.isBuffer(c)||"string"==typeof c||void 0===c||b.objectMode||(f=new TypeError("Invalid non-string/buffer chunk")),f&&(a.emit("error",f),x(d,f),e=!1),e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=D.from(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),C.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?x(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?y(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;l(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,f.next?(b.corkedRequestsFree=f.next,f.next=null):b.corkedRequestsFree=new w(b)}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(l(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?x(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function w(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=g;var x=a("process-nextick-args"),y=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:x;g.WritableState=f;var z=a("core-util-is");z.inherits=a("inherits");var A,B={deprecate:a("util-deprecate")};!function(){try{A=a("stream")}catch(b){}finally{A||(A=a("events").EventEmitter)}}();var C=a("buffer").Buffer,D=a("buffer-shims");z.inherits(g,A);var E;f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:B.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var E;g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),C.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);return this._writableState.defaultEncoding=a,this},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":13,_process:172,buffer:6,"buffer-shims":5,"core-util-is":7,events:21,inherits:23,"process-nextick-args":171,"util-deprecate":209}],18:[function(a,b,c){"use strict";function d(){this.head=null,this.tail=null,this.length=0}var e=(a("buffer").Buffer,a("buffer-shims"));b.exports=d,d.prototype.push=function(a){var b={data:a,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length},d.prototype.unshift=function(a){var b={data:a,next:this.head};0===this.length&&(this.tail=b),this.head=b,++this.length},d.prototype.shift=function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}},d.prototype.clear=function(){this.head=this.tail=null,this.length=0},d.prototype.join=function(a){if(0===this.length)return"";for(var b=this.head,c=""+b.data;b=b.next;)c+=a+b.data;return c},d.prototype.concat=function(a){if(0===this.length)return e.alloc(0);if(1===this.length)return this.head.data;for(var b=e.allocUnsafe(a>>>0),c=this.head,d=0;c;)c.data.copy(b,d),d+=c.data.length,c=c.next;return b}},{buffer:6,"buffer-shims":5}],19:[function(a,b,c){(function(d){var e=function(){try{return a("stream")}catch(b){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),!d.browser&&"disable"===d.env.READABLE_STREAM&&e&&(b.exports=e)}).call(this,a("_process"))},{"./lib/_stream_duplex.js":13,"./lib/_stream_passthrough.js":14,"./lib/_stream_readable.js":15,"./lib/_stream_transform.js":16,"./lib/_stream_writable.js":17,_process:172}],20:[function(a,b,c){var d=a("once"),e=function(){},f=function(a){return a.setHeader&&"function"==typeof a.abort},g=function(a){return a.stdio&&Array.isArray(a.stdio)&&3===a.stdio.length},h=function(a,b,c){if("function"==typeof b)return h(a,null,b);b||(b={}),c=d(c||e);var i=a._writableState,j=a._readableState,k=b.readable||b.readable!==!1&&a.readable,l=b.writable||b.writable!==!1&&a.writable,m=function(){a.writable||n()},n=function(){l=!1,k||c()},o=function(){k=!1,l||c()},p=function(a){c(a?new Error("exited with error code: "+a):null)},q=function(){return(!k||j&&j.ended)&&(!l||i&&i.ended)?void 0:c(new Error("premature close"))},r=function(){a.req.on("finish",n)};return f(a)?(a.on("complete",n),a.on("abort",q),a.req?r():a.on("request",r)):l&&!i&&(a.on("end",m),a.on("close",m)),g(a)&&a.on("exit",p),a.on("end",o),a.on("finish",n),b.error!==!1&&a.on("error",c),a.on("close",q),function(){a.removeListener("complete",n),a.removeListener("abort",q),a.removeListener("request",r),a.req&&a.req.removeListener("finish",n),a.removeListener("end",m),a.removeListener("close",m),a.removeListener("finish",n),a.removeListener("exit",p),a.removeListener("end",o),a.removeListener("error",c),a.removeListener("close",q)}};b.exports=h},{once:170}],21:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],22:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],23:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],24:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],25:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],26:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"DataView");b.exports=f},{"./_getNative":80,"./_root":113}],27:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_hashClear"),f=a("./_hashDelete"),g=a("./_hashGet"),h=a("./_hashHas"),i=a("./_hashSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_hashClear":84,"./_hashDelete":85,"./_hashGet":86,"./_hashHas":87,"./_hashSet":88}],28:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_listCacheClear"),f=a("./_listCacheDelete"),g=a("./_listCacheGet"),h=a("./_listCacheHas"),i=a("./_listCacheSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_listCacheClear":97,"./_listCacheDelete":98,"./_listCacheGet":99,"./_listCacheHas":100,"./_listCacheSet":101}],29:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Map");b.exports=f},{"./_getNative":80,"./_root":113}],30:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_mapCacheClear"),f=a("./_mapCacheDelete"),g=a("./_mapCacheGet"),h=a("./_mapCacheHas"),i=a("./_mapCacheSet");d.prototype.clear=e,d.prototype.delete=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_mapCacheClear":102,"./_mapCacheDelete":103,"./_mapCacheGet":104,"./_mapCacheHas":105,"./_mapCacheSet":106}],31:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Promise");b.exports=f},{"./_getNative":80,"./_root":113}],32:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Set");b.exports=f},{"./_getNative":80,"./_root":113}],33:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.__data__=new e;++b<c;)this.add(a[b])}var e=a("./_MapCache"),f=a("./_setCacheAdd"),g=a("./_setCacheHas");d.prototype.add=d.prototype.push=f,d.prototype.has=g,b.exports=d},{"./_MapCache":30,"./_setCacheAdd":114,"./_setCacheHas":115}],34:[function(a,b,c){function d(a){this.__data__=new e(a)}var e=a("./_ListCache"),f=a("./_stackClear"),g=a("./_stackDelete"),h=a("./_stackGet"),i=a("./_stackHas"),j=a("./_stackSet");d.prototype.clear=f,d.prototype.delete=g,d.prototype.get=h,d.prototype.has=i,d.prototype.set=j,b.exports=d},{"./_ListCache":28,"./_stackClear":117,"./_stackDelete":118,"./_stackGet":119,"./_stackHas":120,"./_stackSet":121}],35:[function(a,b,c){var d=a("./_root"),e=d.Symbol;b.exports=e},{"./_root":113}],36:[function(a,b,c){var d=a("./_root"),e=d.Uint8Array;b.exports=e},{"./_root":113}],37:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"WeakMap");b.exports=f},{"./_getNative":80,"./_root":113}],38:[function(a,b,c){function d(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}b.exports=d},{}],39:[function(a,b,c){function d(a,b){for(var c=-1,d=a?a.length:0;++c<d;)if(!b(a[c],c,a))return!1;return!0}b.exports=d},{}],40:[function(a,b,c){function d(a,b){var c=g(a)||f(a)?e(a.length,String):[],d=c.length,i=!!d;for(var k in a)!b&&!j.call(a,k)||i&&("length"==k||h(k,d))||c.push(k);return c}var e=a("./_baseTimes"),f=a("./isArguments"),g=a("./isArray"),h=a("./_isIndex"),i=Object.prototype,j=i.hasOwnProperty;b.exports=d},{"./_baseTimes":65,"./_isIndex":90,"./isArguments":132,"./isArray":133}],41:[function(a,b,c){function d(a,b){for(var c=-1,d=a?a.length:0;++c<d;)if(b(a[c],c,a))return!0;return!1}b.exports=d},{}],42:[function(a,b,c){function d(a,b,c){var d=a[b];g.call(a,b)&&e(d,c)&&(void 0!==c||b in a)||(a[b]=c)}var e=a("./eq"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./eq":127}],43:[function(a,b,c){function d(a,b){for(var c=a.length;c--;)if(e(a[c][0],b))return c;return-1}var e=a("./eq");b.exports=d},{"./eq":127}],44:[function(a,b,c){function d(a,b){return a&&e(b,f(b),a)}var e=a("./_copyObject"),f=a("./keys");b.exports=d},{"./_copyObject":69,"./keys":144}],45:[function(a,b,c){function d(a){return e(a)?f(a):{}}var e=a("./isObject"),f=Object.create;b.exports=d},{"./isObject":140}],46:[function(a,b,c){var d=a("./_baseForOwn"),e=a("./_createBaseEach"),f=e(d);b.exports=f},{"./_baseForOwn":49,"./_createBaseEach":72}],47:[function(a,b,c){function d(a,b){var c=!0;return e(a,function(a,d,e){return c=!!b(a,d,e)}),c}var e=a("./_baseEach");b.exports=d},{"./_baseEach":46}],48:[function(a,b,c){var d=a("./_createBaseFor"),e=d();b.exports=e},{"./_createBaseFor":73}],49:[function(a,b,c){function d(a,b){return a&&e(a,b,f)}var e=a("./_baseFor"),f=a("./keys");b.exports=d},{"./_baseFor":48,"./keys":144}],50:[function(a,b,c){function d(a,b){b=f(b,a)?[b]:e(b);for(var c=0,d=b.length;null!=a&&c<d;)a=a[g(b[c++])];return c&&c==d?a:void 0}var e=a("./_castPath"),f=a("./_isKey"),g=a("./_toKey");b.exports=d},{"./_castPath":68,"./_isKey":92,"./_toKey":123}],51:[function(a,b,c){function d(a){return f.call(a)}var e=Object.prototype,f=e.toString;b.exports=d},{}],52:[function(a,b,c){function d(a,b){return null!=a&&b in Object(a)}b.exports=d},{}],53:[function(a,b,c){function d(a,b,c,h,i){return a===b||(null==a||null==b||!f(a)&&!g(b)?a!==a&&b!==b:e(a,b,d,c,h,i))}var e=a("./_baseIsEqualDeep"),f=a("./isObject"),g=a("./isObjectLike");b.exports=d},{"./_baseIsEqualDeep":54,"./isObject":140,"./isObjectLike":141}],54:[function(a,b,c){function d(a,b,c,d,q,s){var t=j(a),u=j(b),v=o,w=o;t||(v=i(a),v=v==n?p:v),u||(w=i(b),w=w==n?p:w);var x=v==p&&!k(a),y=w==p&&!k(b),z=v==w;if(z&&!x)return s||(s=new e),t||l(a)?f(a,b,c,d,q,s):g(a,b,v,c,d,q,s);if(!(q&m)){var A=x&&r.call(a,"__wrapped__"),B=y&&r.call(b,"__wrapped__");if(A||B){var C=A?a.value():a,D=B?b.value():b;return s||(s=new e),c(C,D,d,q,s)}}return!!z&&(s||(s=new e),h(a,b,c,d,q,s))}var e=a("./_Stack"),f=a("./_equalArrays"),g=a("./_equalByTag"),h=a("./_equalObjects"),i=a("./_getTag"),j=a("./isArray"),k=a("./_isHostObject"),l=a("./isTypedArray"),m=2,n="[object Arguments]",o="[object Array]",p="[object Object]",q=Object.prototype,r=q.hasOwnProperty;b.exports=d},{"./_Stack":34,"./_equalArrays":74,"./_equalByTag":75,"./_equalObjects":76,"./_getTag":81,"./_isHostObject":89,"./isArray":133,"./isTypedArray":143}],55:[function(a,b,c){function d(a,b,c,d){var i=c.length,j=i,k=!d;if(null==a)return!j;for(a=Object(a);i--;){var l=c[i];if(k&&l[2]?l[1]!==a[l[0]]:!(l[0]in a))return!1}for(;++i<j;){l=c[i];var m=l[0],n=a[m],o=l[1];if(k&&l[2]){if(void 0===n&&!(m in a))return!1}else{var p=new e;if(d)var q=d(n,o,m,a,b,p);if(!(void 0===q?f(o,n,d,g|h,p):q))return!1}}return!0}var e=a("./_Stack"),f=a("./_baseIsEqual"),g=1,h=2;b.exports=d},{"./_Stack":34,"./_baseIsEqual":53}],56:[function(a,b,c){function d(a){if(!h(a)||g(a))return!1;var b=e(a)||f(a)?p:k;return b.test(i(a))}var e=a("./isFunction"),f=a("./_isHostObject"),g=a("./_isMasked"),h=a("./isObject"),i=a("./_toSource"),j=/[\\^$.*+?()[\]{}|]/g,k=/^\[object .+?Constructor\]$/,l=Function.prototype,m=Object.prototype,n=l.toString,o=m.hasOwnProperty,p=RegExp("^"+n.call(o).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=d},{"./_isHostObject":89,"./_isMasked":94,"./_toSource":124,"./isFunction":138,"./isObject":140}],57:[function(a,b,c){function d(a){return f(a)&&e(a.length)&&!!E[G.call(a)]}var e=a("./isLength"),f=a("./isObjectLike"),g="[object Arguments]",h="[object Array]",i="[object Boolean]",j="[object Date]",k="[object Error]",l="[object Function]",m="[object Map]",n="[object Number]",o="[object Object]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object WeakMap]",t="[object ArrayBuffer]",u="[object DataView]",v="[object Float32Array]",w="[object Float64Array]",x="[object Int8Array]",y="[object Int16Array]",z="[object Int32Array]",A="[object Uint8Array]",B="[object Uint8ClampedArray]",C="[object Uint16Array]",D="[object Uint32Array]",E={};E[v]=E[w]=E[x]=E[y]=E[z]=E[A]=E[B]=E[C]=E[D]=!0,E[g]=E[h]=E[t]=E[i]=E[u]=E[j]=E[k]=E[l]=E[m]=E[n]=E[o]=E[p]=E[q]=E[r]=E[s]=!1;var F=Object.prototype,G=F.toString;b.exports=d},{"./isLength":139,"./isObjectLike":141}],58:[function(a,b,c){function d(a){return"function"==typeof a?a:null==a?g:"object"==typeof a?h(a)?f(a[0],a[1]):e(a):i(a)}var e=a("./_baseMatches"),f=a("./_baseMatchesProperty"),g=a("./identity"),h=a("./isArray"),i=a("./property");b.exports=d},{"./_baseMatches":60,"./_baseMatchesProperty":61,"./identity":131,"./isArray":133,"./property":147}],59:[function(a,b,c){function d(a){if(!e(a))return f(a);var b=[];for(var c in Object(a))h.call(a,c)&&"constructor"!=c&&b.push(c);return b}var e=a("./_isPrototype"),f=a("./_nativeKeys"),g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_isPrototype":95,"./_nativeKeys":110}],60:[function(a,b,c){function d(a){var b=f(a);return 1==b.length&&b[0][2]?g(b[0][0],b[0][1]):function(c){return c===a||e(c,a,b)}}var e=a("./_baseIsMatch"),f=a("./_getMatchData"),g=a("./_matchesStrictComparable");b.exports=d},{"./_baseIsMatch":55,"./_getMatchData":79,"./_matchesStrictComparable":108}],61:[function(a,b,c){function d(a,b){return h(a)&&i(b)?j(k(a),b):function(c){var d=f(c,a);return void 0===d&&d===b?g(c,a):e(b,d,void 0,l|m)}}var e=a("./_baseIsEqual"),f=a("./get"),g=a("./hasIn"),h=a("./_isKey"),i=a("./_isStrictComparable"),j=a("./_matchesStrictComparable"),k=a("./_toKey"),l=1,m=2;b.exports=d},{"./_baseIsEqual":53,"./_isKey":92,"./_isStrictComparable":96,"./_matchesStrictComparable":108,"./_toKey":123,"./get":129,"./hasIn":130}],62:[function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}b.exports=d},{}],63:[function(a,b,c){function d(a){return function(b){return e(b,a)}}var e=a("./_baseGet");b.exports=d},{"./_baseGet":50}],64:[function(a,b,c){function d(a,b){return b=f(void 0===b?a.length-1:b,0),function(){for(var c=arguments,d=-1,g=f(c.length-b,0),h=Array(g);++d<g;)h[d]=c[b+d];d=-1;for(var i=Array(b+1);++d<b;)i[d]=c[d];return i[b]=h,e(a,this,i)}}var e=a("./_apply"),f=Math.max;b.exports=d},{"./_apply":38}],65:[function(a,b,c){function d(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}b.exports=d},{}],66:[function(a,b,c){function d(a){if("string"==typeof a)return a;if(f(a))return i?i.call(a):"";var b=a+"";return"0"==b&&1/a==-g?"-0":b}var e=a("./_Symbol"),f=a("./isSymbol"),g=1/0,h=e?e.prototype:void 0,i=h?h.toString:void 0;b.exports=d},{"./_Symbol":35,"./isSymbol":142}],67:[function(a,b,c){function d(a){return function(b){return a(b)}}b.exports=d},{}],68:[function(a,b,c){function d(a){return e(a)?a:f(a)}var e=a("./isArray"),f=a("./_stringToPath");b.exports=d},{"./_stringToPath":122,"./isArray":133}],69:[function(a,b,c){function d(a,b,c,d){c||(c={});for(var f=-1,g=b.length;++f<g;){var h=b[f],i=d?d(c[h],a[h],h,c,a):void 0;e(c,h,void 0===i?a[h]:i)}return c}var e=a("./_assignValue");b.exports=d},{"./_assignValue":42}],70:[function(a,b,c){var d=a("./_root"),e=d["__core-js_shared__"];b.exports=e},{"./_root":113}],71:[function(a,b,c){function d(a){return e(function(b,c){var d=-1,e=c.length,g=e>1?c[e-1]:void 0,h=e>2?c[2]:void 0;for(g=a.length>3&&"function"==typeof g?(e--,g):void 0,h&&f(c[0],c[1],h)&&(g=e<3?void 0:g,e=1),b=Object(b);++d<e;){var i=c[d];i&&a(b,i,d,g)}return b})}var e=a("./_baseRest"),f=a("./_isIterateeCall");b.exports=d},{"./_baseRest":64,"./_isIterateeCall":91}],72:[function(a,b,c){function d(a,b){return function(c,d){if(null==c)return c;if(!e(c))return a(c,d);for(var f=c.length,g=b?f:-1,h=Object(c);(b?g--:++g<f)&&d(h[g],g,h)!==!1;);return c}}var e=a("./isArrayLike");b.exports=d},{"./isArrayLike":134}],73:[function(a,b,c){function d(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}b.exports=d},{}],74:[function(a,b,c){function d(a,b,c,d,i,j){var k=i&h,l=a.length,m=b.length;if(l!=m&&!(k&&m>l))return!1;var n=j.get(a);if(n&&j.get(b))return n==b;var o=-1,p=!0,q=i&g?new e:void 0;for(j.set(a,b),j.set(b,a);++o<l;){var r=a[o],s=b[o];if(d)var t=k?d(s,r,o,b,a,j):d(r,s,o,a,b,j);if(void 0!==t){if(t)continue;p=!1;break}if(q){if(!f(b,function(a,b){if(!q.has(b)&&(r===a||c(r,a,d,i,j)))return q.add(b)})){p=!1;break}}else if(r!==s&&!c(r,s,d,i,j)){p=!1;break}}return j.delete(a),j.delete(b),p}var e=a("./_SetCache"),f=a("./_arraySome"),g=1,h=2;b.exports=d},{"./_SetCache":33,"./_arraySome":41}],75:[function(a,b,c){function d(a,b,c,d,e,x,z){switch(c){case w:if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)return!1;a=a.buffer,b=b.buffer;case v:return!(a.byteLength!=b.byteLength||!d(new f(a),new f(b)));case m:case n:case q:return g(+a,+b);case o:return a.name==b.name&&a.message==b.message;case r:case t:return a==b+"";case p:var A=i;case s:var B=x&l;if(A||(A=j),a.size!=b.size&&!B)return!1;var C=z.get(a);if(C)return C==b;x|=k,z.set(a,b);var D=h(A(a),A(b),d,e,x,z);return z.delete(a),D;case u:if(y)return y.call(a)==y.call(b)}return!1}var e=a("./_Symbol"),f=a("./_Uint8Array"),g=a("./eq"),h=a("./_equalArrays"),i=a("./_mapToArray"),j=a("./_setToArray"),k=1,l=2,m="[object Boolean]",n="[object Date]",o="[object Error]",p="[object Map]",q="[object Number]",r="[object RegExp]",s="[object Set]",t="[object String]",u="[object Symbol]",v="[object ArrayBuffer]",w="[object DataView]",x=e?e.prototype:void 0,y=x?x.valueOf:void 0;b.exports=d},{"./_Symbol":35,"./_Uint8Array":36,"./_equalArrays":74,"./_mapToArray":107,"./_setToArray":116,"./eq":127}],76:[function(a,b,c){function d(a,b,c,d,g,i){var j=g&f,k=e(a),l=k.length,m=e(b),n=m.length;if(l!=n&&!j)return!1;for(var o=l;o--;){var p=k[o];if(!(j?p in b:h.call(b,p)))return!1}var q=i.get(a);if(q&&i.get(b))return q==b;var r=!0;i.set(a,b),i.set(b,a);for(var s=j;++o<l;){p=k[o];var t=a[p],u=b[p];if(d)var v=j?d(u,t,p,b,a,i):d(t,u,p,a,b,i);if(!(void 0===v?t===u||c(t,u,d,g,i):v)){r=!1;break}s||(s="constructor"==p)}if(r&&!s){var w=a.constructor,x=b.constructor;w!=x&&"constructor"in a&&"constructor"in b&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(r=!1)}return i.delete(a),i.delete(b),r}var e=a("./keys"),f=2,g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./keys":144}],77:[function(a,b,c){(function(a){var c="object"==typeof a&&a&&a.Object===Object&&a;
b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],78:[function(a,b,c){function d(a,b){var c=a.__data__;return e(b)?c["string"==typeof b?"string":"hash"]:c.map}var e=a("./_isKeyable");b.exports=d},{"./_isKeyable":93}],79:[function(a,b,c){function d(a){for(var b=f(a),c=b.length;c--;){var d=b[c],g=a[d];b[c]=[d,g,e(g)]}return b}var e=a("./_isStrictComparable"),f=a("./keys");b.exports=d},{"./_isStrictComparable":96,"./keys":144}],80:[function(a,b,c){function d(a,b){var c=f(a,b);return e(c)?c:void 0}var e=a("./_baseIsNative"),f=a("./_getValue");b.exports=d},{"./_baseIsNative":56,"./_getValue":82}],81:[function(a,b,c){var d=a("./_DataView"),e=a("./_Map"),f=a("./_Promise"),g=a("./_Set"),h=a("./_WeakMap"),i=a("./_baseGetTag"),j=a("./_toSource"),k="[object Map]",l="[object Object]",m="[object Promise]",n="[object Set]",o="[object WeakMap]",p="[object DataView]",q=Object.prototype,r=q.toString,s=j(d),t=j(e),u=j(f),v=j(g),w=j(h),x=i;(d&&x(new d(new ArrayBuffer(1)))!=p||e&&x(new e)!=k||f&&x(f.resolve())!=m||g&&x(new g)!=n||h&&x(new h)!=o)&&(x=function(a){var b=r.call(a),c=b==l?a.constructor:void 0,d=c?j(c):void 0;if(d)switch(d){case s:return p;case t:return k;case u:return m;case v:return n;case w:return o}return b}),b.exports=x},{"./_DataView":26,"./_Map":29,"./_Promise":31,"./_Set":32,"./_WeakMap":37,"./_baseGetTag":51,"./_toSource":124}],82:[function(a,b,c){function d(a,b){return null==a?void 0:a[b]}b.exports=d},{}],83:[function(a,b,c){function d(a,b,c){b=i(b,a)?[b]:e(b);for(var d,l=-1,m=b.length;++l<m;){var n=k(b[l]);if(!(d=null!=a&&c(a,n)))break;a=a[n]}if(d)return d;var m=a?a.length:0;return!!m&&j(m)&&h(n,m)&&(g(a)||f(a))}var e=a("./_castPath"),f=a("./isArguments"),g=a("./isArray"),h=a("./_isIndex"),i=a("./_isKey"),j=a("./isLength"),k=a("./_toKey");b.exports=d},{"./_castPath":68,"./_isIndex":90,"./_isKey":92,"./_toKey":123,"./isArguments":132,"./isArray":133,"./isLength":139}],84:[function(a,b,c){function d(){this.__data__=e?e(null):{}}var e=a("./_nativeCreate");b.exports=d},{"./_nativeCreate":109}],85:[function(a,b,c){function d(a){return this.has(a)&&delete this.__data__[a]}b.exports=d},{}],86:[function(a,b,c){function d(a){var b=this.__data__;if(e){var c=b[a];return c===f?void 0:c}return h.call(b,a)?b[a]:void 0}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__",g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_nativeCreate":109}],87:[function(a,b,c){function d(a){var b=this.__data__;return e?void 0!==b[a]:g.call(b,a)}var e=a("./_nativeCreate"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./_nativeCreate":109}],88:[function(a,b,c){function d(a,b){var c=this.__data__;return c[a]=e&&void 0===b?f:b,this}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__";b.exports=d},{"./_nativeCreate":109}],89:[function(a,b,c){function d(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}b.exports=d},{}],90:[function(a,b,c){function d(a,b){return b=null==b?e:b,!!b&&("number"==typeof a||f.test(a))&&a>-1&&a%1==0&&a<b}var e=9007199254740991,f=/^(?:0|[1-9]\d*)$/;b.exports=d},{}],91:[function(a,b,c){function d(a,b,c){if(!h(c))return!1;var d=typeof b;return!!("number"==d?f(c)&&g(b,c.length):"string"==d&&b in c)&&e(c[b],a)}var e=a("./eq"),f=a("./isArrayLike"),g=a("./_isIndex"),h=a("./isObject");b.exports=d},{"./_isIndex":90,"./eq":127,"./isArrayLike":134,"./isObject":140}],92:[function(a,b,c){function d(a,b){if(e(a))return!1;var c=typeof a;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=a&&!f(a))||(h.test(a)||!g.test(a)||null!=b&&a in Object(b))}var e=a("./isArray"),f=a("./isSymbol"),g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/;b.exports=d},{"./isArray":133,"./isSymbol":142}],93:[function(a,b,c){function d(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}b.exports=d},{}],94:[function(a,b,c){function d(a){return!!f&&f in a}var e=a("./_coreJsData"),f=function(){var a=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();b.exports=d},{"./_coreJsData":70}],95:[function(a,b,c){function d(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||e;return a===c}var e=Object.prototype;b.exports=d},{}],96:[function(a,b,c){function d(a){return a===a&&!e(a)}var e=a("./isObject");b.exports=d},{"./isObject":140}],97:[function(a,b,c){function d(){this.__data__=[]}b.exports=d},{}],98:[function(a,b,c){function d(a){var b=this.__data__,c=e(b,a);if(c<0)return!1;var d=b.length-1;return c==d?b.pop():g.call(b,c,1),!0}var e=a("./_assocIndexOf"),f=Array.prototype,g=f.splice;b.exports=d},{"./_assocIndexOf":43}],99:[function(a,b,c){function d(a){var b=this.__data__,c=e(b,a);return c<0?void 0:b[c][1]}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":43}],100:[function(a,b,c){function d(a){return e(this.__data__,a)>-1}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":43}],101:[function(a,b,c){function d(a,b){var c=this.__data__,d=e(c,a);return d<0?c.push([a,b]):c[d][1]=b,this}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":43}],102:[function(a,b,c){function d(){this.__data__={hash:new e,map:new(g||f),string:new e}}var e=a("./_Hash"),f=a("./_ListCache"),g=a("./_Map");b.exports=d},{"./_Hash":27,"./_ListCache":28,"./_Map":29}],103:[function(a,b,c){function d(a){return e(this,a).delete(a)}var e=a("./_getMapData");b.exports=d},{"./_getMapData":78}],104:[function(a,b,c){function d(a){return e(this,a).get(a)}var e=a("./_getMapData");b.exports=d},{"./_getMapData":78}],105:[function(a,b,c){function d(a){return e(this,a).has(a)}var e=a("./_getMapData");b.exports=d},{"./_getMapData":78}],106:[function(a,b,c){function d(a,b){return e(this,a).set(a,b),this}var e=a("./_getMapData");b.exports=d},{"./_getMapData":78}],107:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}b.exports=d},{}],108:[function(a,b,c){function d(a,b){return function(c){return null!=c&&(c[a]===b&&(void 0!==b||a in Object(c)))}}b.exports=d},{}],109:[function(a,b,c){var d=a("./_getNative"),e=d(Object,"create");b.exports=e},{"./_getNative":80}],110:[function(a,b,c){var d=a("./_overArg"),e=d(Object.keys,Object);b.exports=e},{"./_overArg":112}],111:[function(a,b,c){var d=a("./_freeGlobal"),e="object"==typeof c&&c&&!c.nodeType&&c,f=e&&"object"==typeof b&&b&&!b.nodeType&&b,g=f&&f.exports===e,h=g&&d.process,i=function(){try{return h&&h.binding("util")}catch(a){}}();b.exports=i},{"./_freeGlobal":77}],112:[function(a,b,c){function d(a,b){return function(c){return a(b(c))}}b.exports=d},{}],113:[function(a,b,c){var d=a("./_freeGlobal"),e="object"==typeof self&&self&&self.Object===Object&&self,f=d||e||Function("return this")();b.exports=f},{"./_freeGlobal":77}],114:[function(a,b,c){function d(a){return this.__data__.set(a,e),this}var e="__lodash_hash_undefined__";b.exports=d},{}],115:[function(a,b,c){function d(a){return this.__data__.has(a)}b.exports=d},{}],116:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}b.exports=d},{}],117:[function(a,b,c){function d(){this.__data__=new e}var e=a("./_ListCache");b.exports=d},{"./_ListCache":28}],118:[function(a,b,c){function d(a){return this.__data__.delete(a)}b.exports=d},{}],119:[function(a,b,c){function d(a){return this.__data__.get(a)}b.exports=d},{}],120:[function(a,b,c){function d(a){return this.__data__.has(a)}b.exports=d},{}],121:[function(a,b,c){function d(a,b){var c=this.__data__;if(c instanceof e){var d=c.__data__;if(!f||d.length<h-1)return d.push([a,b]),this;c=this.__data__=new g(d)}return c.set(a,b),this}var e=a("./_ListCache"),f=a("./_Map"),g=a("./_MapCache"),h=200;b.exports=d},{"./_ListCache":28,"./_Map":29,"./_MapCache":30}],122:[function(a,b,c){var d=a("./memoize"),e=a("./toString"),f=/^\./,g=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,i=d(function(a){a=e(a);var b=[];return f.test(a)&&b.push(""),a.replace(g,function(a,c,d,e){b.push(d?e.replace(h,"$1"):c||a)}),b});b.exports=i},{"./memoize":146,"./toString":149}],123:[function(a,b,c){function d(a){if("string"==typeof a||e(a))return a;var b=a+"";return"0"==b&&1/a==-f?"-0":b}var e=a("./isSymbol"),f=1/0;b.exports=d},{"./isSymbol":142}],124:[function(a,b,c){function d(a){if(null!=a){try{return f.call(a)}catch(b){}try{return a+""}catch(b){}}return""}var e=Function.prototype,f=e.toString;b.exports=d},{}],125:[function(a,b,c){var d=a("./_assignValue"),e=a("./_copyObject"),f=a("./_createAssigner"),g=a("./isArrayLike"),h=a("./_isPrototype"),i=a("./keys"),j=Object.prototype,k=j.hasOwnProperty,l=j.propertyIsEnumerable,m=!l.call({valueOf:1},"valueOf"),n=f(function(a,b){if(m||h(b)||g(b))return void e(b,i(b),a);for(var c in b)k.call(b,c)&&d(a,c,b[c])});b.exports=n},{"./_assignValue":42,"./_copyObject":69,"./_createAssigner":71,"./_isPrototype":95,"./isArrayLike":134,"./keys":144}],126:[function(a,b,c){function d(a,b){var c=f(a);return b?e(c,b):c}var e=a("./_baseAssign"),f=a("./_baseCreate");b.exports=d},{"./_baseAssign":44,"./_baseCreate":45}],127:[function(a,b,c){function d(a,b){return a===b||a!==a&&b!==b}b.exports=d},{}],128:[function(a,b,c){function d(a,b,c){var d=h(a)?e:f;return c&&i(a,b,c)&&(b=void 0),d(a,g(b,3))}var e=a("./_arrayEvery"),f=a("./_baseEvery"),g=a("./_baseIteratee"),h=a("./isArray"),i=a("./_isIterateeCall");b.exports=d},{"./_arrayEvery":39,"./_baseEvery":47,"./_baseIteratee":58,"./_isIterateeCall":91,"./isArray":133}],129:[function(a,b,c){function d(a,b,c){var d=null==a?void 0:e(a,b);return void 0===d?c:d}var e=a("./_baseGet");b.exports=d},{"./_baseGet":50}],130:[function(a,b,c){function d(a,b){return null!=a&&f(a,b,e)}var e=a("./_baseHasIn"),f=a("./_hasPath");b.exports=d},{"./_baseHasIn":52,"./_hasPath":83}],131:[function(a,b,c){function d(a){return a}b.exports=d},{}],132:[function(a,b,c){function d(a){return e(a)&&h.call(a,"callee")&&(!j.call(a,"callee")||i.call(a)==f)}var e=a("./isArrayLikeObject"),f="[object Arguments]",g=Object.prototype,h=g.hasOwnProperty,i=g.toString,j=g.propertyIsEnumerable;b.exports=d},{"./isArrayLikeObject":135}],133:[function(a,b,c){var d=Array.isArray;b.exports=d},{}],134:[function(a,b,c){function d(a){return null!=a&&f(a.length)&&!e(a)}var e=a("./isFunction"),f=a("./isLength");b.exports=d},{"./isFunction":138,"./isLength":139}],135:[function(a,b,c){function d(a){return f(a)&&e(a)}var e=a("./isArrayLike"),f=a("./isObjectLike");b.exports=d},{"./isArrayLike":134,"./isObjectLike":141}],136:[function(a,b,c){var d=a("./_root"),e=a("./stubFalse"),f="object"==typeof c&&c&&!c.nodeType&&c,g=f&&"object"==typeof b&&b&&!b.nodeType&&b,h=g&&g.exports===f,i=h?d.Buffer:void 0,j=i?i.isBuffer:void 0,k=j||e;b.exports=k},{"./_root":113,"./stubFalse":148}],137:[function(a,b,c){function d(a){if(h(a)&&(g(a)||"string"==typeof a||"function"==typeof a.splice||i(a)||f(a)))return!a.length;var b=e(a);if(b==l||b==m)return!a.size;if(q||j(a))return!k(a).length;for(var c in a)if(o.call(a,c))return!1;return!0}var e=a("./_getTag"),f=a("./isArguments"),g=a("./isArray"),h=a("./isArrayLike"),i=a("./isBuffer"),j=a("./_isPrototype"),k=a("./_nativeKeys"),l="[object Map]",m="[object Set]",n=Object.prototype,o=n.hasOwnProperty,p=n.propertyIsEnumerable,q=!p.call({valueOf:1},"valueOf");b.exports=d},{"./_getTag":81,"./_isPrototype":95,"./_nativeKeys":110,"./isArguments":132,"./isArray":133,"./isArrayLike":134,"./isBuffer":136}],138:[function(a,b,c){function d(a){var b=e(a)?i.call(a):"";return b==f||b==g}var e=a("./isObject"),f="[object Function]",g="[object GeneratorFunction]",h=Object.prototype,i=h.toString;b.exports=d},{"./isObject":140}],139:[function(a,b,c){function d(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=e}var e=9007199254740991;b.exports=d},{}],140:[function(a,b,c){function d(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}b.exports=d},{}],141:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}b.exports=d},{}],142:[function(a,b,c){function d(a){return"symbol"==typeof a||e(a)&&h.call(a)==f}var e=a("./isObjectLike"),f="[object Symbol]",g=Object.prototype,h=g.toString;b.exports=d},{"./isObjectLike":141}],143:[function(a,b,c){var d=a("./_baseIsTypedArray"),e=a("./_baseUnary"),f=a("./_nodeUtil"),g=f&&f.isTypedArray,h=g?e(g):d;b.exports=h},{"./_baseIsTypedArray":57,"./_baseUnary":67,"./_nodeUtil":111}],144:[function(a,b,c){function d(a){return g(a)?e(a):f(a)}var e=a("./_arrayLikeKeys"),f=a("./_baseKeys"),g=a("./isArrayLike");b.exports=d},{"./_arrayLikeKeys":40,"./_baseKeys":59,"./isArrayLike":134}],145:[function(a,c,d){(function(a){(function(){function e(a,b){return a.set(b[0],b[1]),a}function f(a,b){return a.add(b),a}function g(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function h(a,b,c,d){for(var e=-1,f=a?a.length:0;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function i(a,b){for(var c=-1,d=a?a.length:0;++c<d&&b(a[c],c,a)!==!1;);return a}function j(a,b){for(var c=a?a.length:0;c--&&b(a[c],c,a)!==!1;);return a}function k(a,b){for(var c=-1,d=a?a.length:0;++c<d;)if(!b(a[c],c,a))return!1;return!0}function l(a,b){for(var c=-1,d=a?a.length:0,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}function m(a,b){var c=a?a.length:0;return!!c&&x(a,b,0)>-1}function n(a,b,c){for(var d=-1,e=a?a.length:0;++d<e;)if(c(b,a[d]))return!0;return!1}function o(a,b){for(var c=-1,d=a?a.length:0,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function p(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function q(a,b,c,d){var e=-1,f=a?a.length:0;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function r(a,b,c,d){var e=a?a.length:0;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function s(a,b){for(var c=-1,d=a?a.length:0;++c<d;)if(b(a[c],c,a))return!0;return!1}function t(a){return a.split("")}function u(a){return a.match(Gb)||[]}function v(a,b,c){var d;return c(a,function(a,c,e){if(b(a,c,e))return d=c,!1}),d}function w(a,b,c,d){for(var e=a.length,f=c+(d?1:-1);d?f--:++f<e;)if(b(a[f],f,a))return f;return-1}function x(a,b,c){if(b!==b)return w(a,z,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function y(a,b,c,d){for(var e=c-1,f=a.length;++e<f;)if(d(a[e],b))return e;return-1}function z(a){return a!==a}function A(a,b){var c=a?a.length:0;return c?F(a,b)/c:Fa}function B(a){return function(b){return null==b?da:b[a]}}function C(a){return function(b){return null==a?da:a[b]}}function D(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function E(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function F(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==da&&(c=c===da?f:c+f)}return c}function G(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function H(a,b){return o(b,function(b){return[b,a[b]]})}function I(a){return function(b){return a(b)}}function J(a,b){return o(b,function(b){return a[b]})}function K(a,b){return a.has(b)}function L(a,b){for(var c=-1,d=a.length;++c<d&&x(b,a[c],0)>-1;);return c}function M(a,b){for(var c=a.length;c--&&x(b,a[c],0)>-1;);return c}function N(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&d++;return d}function O(a){return"\\"+Pc[a]}function P(a,b){return null==a?da:a[b]}function Q(a){return Gc.test(a)}function R(a){return Hc.test(a)}function S(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}function T(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function U(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function V(a,b){return function(c){return a(b(c))}}function W(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c];g!==b&&g!==ia||(a[c]=ia,f[e++]=c)}return f}function X(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function Y(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=[a,a]}),c}function Z(a){return Q(a)?_(a):ed(a)}function $(a){return Q(a)?aa(a):t(a)}function _(a){for(var b=Ec.lastIndex=0;Ec.test(a);)b++;return b}function aa(a){return a.match(Ec)||[]}function ba(a){return a.match(Fc)||[]}function ca(a){function b(a){if(Kh(a)&&!Pl(a)&&!(a instanceof t)){if(a instanceof d)return a;if(Wj.call(a,"__wrapped__"))return Gf(a)}return new d(a)}function c(){}function d(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=da}function t(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ga,this.__views__=[]}function C(){var a=new t(this.__wrapped__);return a.__actions__=xe(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=xe(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=xe(this.__views__),a}function _(){if(this.__filtered__){var a=new t(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function aa(){var a=this.__wrapped__.value(),b=this.__dir__,c=Pl(a),d=b<0,e=c?a.length:0,f=gf(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=uk(i,this.__takeCount__);if(!c||e<fa||e==i&&n==i)return ee(a,this.__actions__);var o=[];a:for(;i--&&m<n;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==Aa)q=u;else if(!u){if(t==za)continue a;break a}}o[m++]=q}return o}function Gb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Tb(){this.__data__=Dk?Dk(null):{}}function Ub(a){return this.has(a)&&delete this.__data__[a]}function Vb(a){var b=this.__data__;if(Dk){var c=b[a];return c===ha?da:c}return Wj.call(b,a)?b[a]:da}function Wb(a){var b=this.__data__;return Dk?b[a]!==da:Wj.call(b,a)}function Xb(a,b){var c=this.__data__;return c[a]=Dk&&b===da?ha:b,this}function Yb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Zb(){this.__data__=[]}function $b(a){var b=this.__data__,c=vc(b,a);if(c<0)return!1;var d=b.length-1;return c==d?b.pop():hk.call(b,c,1),!0}function _b(a){var b=this.__data__,c=vc(b,a);return c<0?da:b[c][1]}function ac(a){return vc(this.__data__,a)>-1}function bc(a,b){var c=this.__data__,d=vc(c,a);return d<0?c.push([a,b]):c[d][1]=b,this}function cc(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function dc(){this.__data__={hash:new Gb,map:new(zk||Yb),string:new Gb}}function ec(a){return df(this,a).delete(a)}function fc(a){return df(this,a).get(a)}function gc(a){return df(this,a).has(a)}function hc(a,b){return df(this,a).set(a,b),this}function ic(a){var b=-1,c=a?a.length:0;for(this.__data__=new cc;++b<c;)this.add(a[b])}function jc(a){return this.__data__.set(a,ha),this}function kc(a){return this.__data__.has(a)}function lc(a){this.__data__=new Yb(a)}function mc(){this.__data__=new Yb}function nc(a){return this.__data__.delete(a)}function oc(a){return this.__data__.get(a)}function pc(a){return this.__data__.has(a)}function qc(a,b){var c=this.__data__;if(c instanceof Yb){var d=c.__data__;if(!zk||d.length<fa-1)return d.push([a,b]),this;c=this.__data__=new cc(d)}return c.set(a,b),this}function rc(a,b){var c=Pl(a)||wh(a)?G(a.length,Oj):[],d=c.length,e=!!d;for(var f in a)!b&&!Wj.call(a,f)||e&&("length"==f||pf(f,d))||c.push(f);return c}function sc(a,b,c,d){return a===da||vh(a,Sj[c])&&!Wj.call(d,c)?b:a}function tc(a,b,c){(c===da||vh(a[b],c))&&("number"!=typeof b||c!==da||b in a)||(a[b]=c)}function uc(a,b,c){var d=a[b];Wj.call(a,b)&&vh(d,c)&&(c!==da||b in a)||(a[b]=c)}function vc(a,b){for(var c=a.length;c--;)if(vh(a[c][0],b))return c;return-1}function wc(a,b,c,d){return Qk(a,function(a,e,f){b(d,a,c(a),f)}),d}function xc(a,b){return a&&ye(b,ri(b),a)}function yc(a,b){for(var c=-1,d=null==a,e=b.length,f=Hj(e);++c<e;)f[c]=d?da:oi(a,b[c]);return f}function zc(a,b,c){return a===a&&(c!==da&&(a=a<=c?a:c),b!==da&&(a=a>=b?a:b)),a}function Ac(a,b,c,d,e,f,g){var h;if(d&&(h=f?d(a,e,f,g):d(a)),h!==da)return h;if(!Jh(a))return a;var j=Pl(a);if(j){if(h=kf(a),!b)return xe(a,h)}else{var k=$k(a),l=k==Pa||k==Qa;if(Rl(a))return le(a,b);if(k==Ta||k==Ka||l&&!f){if(S(a))return f?a:{};if(h=lf(l?{}:a),!b)return ze(a,xc(h,a))}else{if(!Lc[k])return f?a:{};h=mf(a,k,Ac,b)}}g||(g=new lc);var m=g.get(a);if(m)return m;if(g.set(a,h),!j)var n=c?$e(a):ri(a);return i(n||a,function(e,f){n&&(f=e,e=a[f]),uc(h,f,Ac(e,b,c,d,f,a,g))}),h}function Bc(a){var b=ri(a);return function(c){return Ec(c,a,b)}}function Ec(a,b,c){var d=c.length;if(null==a)return!d;for(a=Mj(a);d--;){var e=c[d],f=b[e],g=a[e];if(g===da&&!(e in a)||!f(g))return!1}return!0}function Fc(a){return Jh(a)?fk(a):{}}function Gc(a,b,c){if("function"!=typeof a)throw new Pj(ga);return bl(function(){a.apply(da,c)},b)}function Hc(a,b,c,d){var e=-1,f=m,g=!0,h=a.length,i=[],j=b.length;if(!h)return i;c&&(b=o(b,I(c))),d?(f=n,g=!1):b.length>=fa&&(f=K,g=!1,b=new ic(b));a:for(;++e<h;){var k=a[e],l=c?c(k):k;if(k=d||0!==k?k:0,g&&l===l){for(var p=j;p--;)if(b[p]===l)continue a;i.push(k)}else f(b,l,d)||i.push(k)}return i}function Mc(a,b){var c=!0;return Qk(a,function(a,d,e){return c=!!b(a,d,e)}),c}function Nc(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===da?g===g&&!Vh(g):c(g,h)))var h=g,i=f}return i}function Oc(a,b,c,d){var e=a.length;for(c=_h(c),c<0&&(c=-c>e?0:e+c),d=d===da||d>e?e:_h(d),d<0&&(d+=e),d=c>d?0:ai(d);c<d;)a[c++]=b;return a}function Pc(a,b){var c=[];return Qk(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function Sc(a,b,c,d,e){var f=-1,g=a.length;for(c||(c=of),e||(e=[]);++f<g;){var h=a[f];b>0&&c(h)?b>1?Sc(h,b-1,c,d,e):p(e,h):d||(e[e.length]=h)}return e}function Tc(a,b){return a&&Sk(a,b,ri)}function Vc(a,b){return a&&Tk(a,b,ri)}function Wc(a,b){return l(b,function(b){return Gh(a[b])})}function Yc(a,b){b=rf(b,a)?[b]:je(b);for(var c=0,d=b.length;null!=a&&c<d;)a=a[Df(b[c++])];return c&&c==d?a:da}function Zc(a,b,c){var d=b(a);return Pl(a)?d:p(d,c(a))}function ed(a){return Zj.call(a)}function jd(a,b){return a>b}function kd(a,b){return null!=a&&Wj.call(a,b)}function ld(a,b){return null!=a&&b in Mj(a)}function md(a,b,c){return a>=uk(b,c)&&a<tk(b,c)}function nd(a,b,c){for(var d=c?n:m,e=a[0].length,f=a.length,g=f,h=Hj(f),i=1/0,j=[];g--;){var k=a[g];g&&b&&(k=o(k,I(b))),i=uk(k.length,i),h[g]=!c&&(b||e>=120&&k.length>=120)?new ic(g&&k):da}k=a[0];var l=-1,p=h[0];a:for(;++l<e&&j.length<i;){var q=k[l],r=b?b(q):q;if(q=c||0!==q?q:0,!(p?K(p,r):d(j,r,c))){for(g=f;--g;){var s=h[g];if(!(s?K(s,r):d(a[g],r,c)))continue a}p&&p.push(r),j.push(q)}}return j}function od(a,b,c,d){return Tc(a,function(a,e,f){b(d,c(a),e,f)}),d}function pd(a,b,c){rf(b,a)||(b=je(b),a=Bf(a,b),b=Zf(b));var d=null==a?a:a[Df(b)];return null==d?da:g(d,a,c)}function qd(a){return Kh(a)&&Zj.call(a)==_a}function rd(a){return Kh(a)&&Zj.call(a)==Na}function sd(a,b,c,d,e){return a===b||(null==a||null==b||!Jh(a)&&!Kh(b)?a!==a&&b!==b:td(a,b,sd,c,d,e))}function td(a,b,c,d,e,f){var g=Pl(a),h=Pl(b),i=La,j=La;g||(i=$k(a),i=i==Ka?Ta:i),h||(j=$k(b),j=j==Ka?Ta:j);var k=i==Ta&&!S(a),l=j==Ta&&!S(b),m=i==j;if(m&&!k)return f||(f=new lc),g||Wl(a)?Xe(a,b,c,d,e,f):Ye(a,b,i,c,d,e,f);if(!(e&ua)){var n=k&&Wj.call(a,"__wrapped__"),o=l&&Wj.call(b,"__wrapped__");if(n||o){var p=n?a.value():a,q=o?b.value():b;return f||(f=new lc),c(p,q,d,e,f)}}return!!m&&(f||(f=new lc),Ze(a,b,c,d,e,f))}function ud(a){return Kh(a)&&$k(a)==Ra}function vd(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=Mj(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){h=c[e];var i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===da&&!(i in a))return!1}else{var l=new lc;if(d)var m=d(j,k,i,a,b,l);if(!(m===da?sd(k,j,d,ta|ua,l):m))return!1}}return!0}function wd(a){if(!Jh(a)||uf(a))return!1;var b=Gh(a)||S(a)?_j:Nb;return b.test(Ef(a))}function xd(a){return Jh(a)&&Zj.call(a)==Va}function yd(a){return Kh(a)&&$k(a)==Wa}function zd(a){return Kh(a)&&Ih(a.length)&&!!Kc[Zj.call(a)]}function Ad(a){return"function"==typeof a?a:null==a?hj:"object"==typeof a?Pl(a)?Gd(a[0],a[1]):Fd(a):pj(a)}function Bd(a){if(!vf(a))return sk(a);var b=[];for(var c in Mj(a))Wj.call(a,c)&&"constructor"!=c&&b.push(c);return b}function Cd(a){if(!Jh(a))return Af(a);var b=vf(a),c=[];for(var d in a)("constructor"!=d||!b&&Wj.call(a,d))&&c.push(d);return c}function Dd(a,b){return a<b}function Ed(a,b){var c=-1,d=xh(a)?Hj(a.length):[];return Qk(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function Fd(a){var b=ef(a);return 1==b.length&&b[0][2]?xf(b[0][0],b[0][1]):function(c){return c===a||vd(c,a,b)}}function Gd(a,b){return rf(a)&&wf(b)?xf(Df(a),b):function(c){var d=oi(c,a);return d===da&&d===b?qi(c,a):sd(b,d,da,ta|ua)}}function Hd(a,b,c,d,e){if(a!==b){if(!Pl(b)&&!Wl(b))var f=Cd(b);i(f||b,function(g,h){if(f&&(h=g,g=b[h]),Jh(g))e||(e=new lc),Id(a,b,h,c,Hd,d,e);else{var i=d?d(a[h],g,h+"",a,b,e):da;i===da&&(i=g),tc(a,h,i)}})}}function Id(a,b,c,d,e,f,g){var h=a[c],i=b[c],j=g.get(i);if(j)return void tc(a,c,j);var k=f?f(h,i,c+"",a,b,g):da,l=k===da;l&&(k=i,Pl(i)||Wl(i)?Pl(h)?k=h:yh(h)?k=xe(h):(l=!1,k=Ac(i,!0)):Sh(i)||wh(i)?wh(h)?k=ci(h):!Jh(h)||d&&Gh(h)?(l=!1,k=Ac(i,!0)):k=h:l=!1),l&&(g.set(i,k),e(k,i,d,f,g),g.delete(i)),tc(a,c,k)}function Jd(a,b){var c=a.length;if(c)return b+=b<0?c:0,pf(b,c)?a[b]:da}function Kd(a,b,c){var d=-1;b=o(b.length?b:[hj],I(cf()));var e=Ed(a,function(a,c,e){var f=o(b,function(b){return b(a)});return{criteria:f,index:++d,value:a}});return E(e,function(a,b){return ue(a,b,c)})}function Ld(a,b){return a=Mj(a),Md(a,b,function(b,c){return c in a})}function Md(a,b,c){for(var d=-1,e=b.length,f={};++d<e;){var g=b[d],h=a[g];c(h,g)&&(f[g]=h)}return f}function Nd(a){return function(b){return Yc(b,a)}}function Od(a,b,c,d){var e=d?y:x,f=-1,g=b.length,h=a;for(a===b&&(b=xe(b)),c&&(h=o(a,I(c)));++f<g;)for(var i=0,j=b[f],k=c?c(j):j;(i=e(h,k,i,d))>-1;)h!==a&&hk.call(h,i,1),hk.call(a,i,1);return a}function Pd(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(c==d||e!==f){var f=e;if(pf(e))hk.call(a,e,1);else if(rf(e,a))delete a[Df(e)];else{var g=je(e),h=Bf(a,g);null!=h&&delete h[Df(Zf(g))]}}}return a}function Qd(a,b){return a+nk(wk()*(b-a+1))}function Rd(a,b,c,d){for(var e=-1,f=tk(mk((b-a)/(c||1)),0),g=Hj(f);f--;)g[d?f:++e]=a,a+=c;return g}function Sd(a,b){var c="";if(!a||b<1||b>Da)return c;do b%2&&(c+=a),b=nk(b/2),b&&(a+=a);while(b);return c}function Td(a,b){return b=tk(b===da?a.length-1:b,0),function(){for(var c=arguments,d=-1,e=tk(c.length-b,0),f=Hj(e);++d<e;)f[d]=c[b+d];d=-1;for(var h=Hj(b+1);++d<b;)h[d]=c[d];return h[b]=f,g(a,this,h)}}function Ud(a,b,c,d){if(!Jh(a))return a;b=rf(b,a)?[b]:je(b);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=Df(b[e]),j=c;if(e!=g){var k=h[i];j=d?d(k,i,h):da,j===da&&(j=Jh(k)?k:pf(b[e+1])?[]:{})}uc(h,i,j),h=h[i]}return a}function Vd(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),c=c>e?e:c,c<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Hj(e);++d<e;)f[d]=a[d+b];return f}function Wd(a,b){var c;return Qk(a,function(a,d,e){return c=b(a,d,e),!c}),!!c}function Xd(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&e<=Ia){for(;d<e;){var f=d+e>>>1,g=a[f];null!==g&&!Vh(g)&&(c?g<=b:g<b)?d=f+1:e=f}return e}return Yd(a,b,hj,c)}function Yd(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=Vh(b),j=b===da;e<f;){var k=nk((e+f)/2),l=c(a[k]),m=l!==da,n=null===l,o=l===l,p=Vh(l);if(g)var q=d||o;else q=j?o&&(d||m):h?o&&m&&(d||!n):i?o&&m&&!n&&(d||!p):!n&&!p&&(d?l<=b:l<b);q?e=k+1:f=k}return uk(f,Ha)}function Zd(a,b){for(var c=-1,d=a.length,e=0,f=[];++c<d;){var g=a[c],h=b?b(g):g;if(!c||!vh(h,i)){var i=h;f[e++]=0===g?0:g}}return f}function $d(a){return"number"==typeof a?a:Vh(a)?Fa:+a}function _d(a){if("string"==typeof a)return a;if(Vh(a))return Pk?Pk.call(a):"";var b=a+"";return"0"==b&&1/a==-Ca?"-0":b}function ae(a,b,c){var d=-1,e=m,f=a.length,g=!0,h=[],i=h;if(c)g=!1,e=n;else if(f>=fa){var j=b?null:Wk(a);if(j)return X(j);g=!1,e=K,i=new ic}else i=b?[]:h;a:for(;++d<f;){var k=a[d],l=b?b(k):k;if(k=c||0!==k?k:0,g&&l===l){for(var o=i.length;o--;)if(i[o]===l)continue a;b&&i.push(l),h.push(k)}else e(i,l,c)||(i!==h&&i.push(l),h.push(k))}return h}function be(a,b){b=rf(b,a)?[b]:je(b),a=Bf(a,b);var c=Df(Zf(b));return!(null!=a&&Wj.call(a,c))||delete a[c]}function ce(a,b,c,d){return Ud(a,b,c(Yc(a,b)),d)}function de(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?Vd(a,d?0:f,d?f+1:e):Vd(a,d?f+1:0,d?e:f)}function ee(a,b){var c=a;return c instanceof t&&(c=c.value()),q(b,function(a,b){return b.func.apply(b.thisArg,p([a],b.args))},c)}function fe(a,b,c){for(var d=-1,e=a.length;++d<e;)var f=f?p(Hc(f,a[d],b,c),Hc(a[d],f,b,c)):a[d];return f&&f.length?ae(f,b,c):[]}function ge(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;){var h=d<f?b[d]:da;c(g,a[d],h)}return g}function he(a){return yh(a)?a:[]}function ie(a){return"function"==typeof a?a:hj}function je(a){return Pl(a)?a:dl(a)}function ke(a,b,c){var d=a.length;return c=c===da?d:c,!b&&c>=d?a:Vd(a,b,c)}function le(a,b){if(b)return a.slice();var c=new a.constructor(a.length);return a.copy(c),c}function me(a){var b=new a.constructor(a.byteLength);return new ck(b).set(new ck(a)),b}function ne(a,b){var c=b?me(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.byteLength)}function oe(a,b,c){var d=b?c(U(a),!0):U(a);return q(d,e,new a.constructor)}function pe(a){var b=new a.constructor(a.source,Jb.exec(a));return b.lastIndex=a.lastIndex,b}function qe(a,b,c){var d=b?c(X(a),!0):X(a);return q(d,f,new a.constructor)}function re(a){return Ok?Mj(Ok.call(a)):{}}function se(a,b){var c=b?me(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.length)}function te(a,b){if(a!==b){var c=a!==da,d=null===a,e=a===a,f=Vh(a),g=b!==da,h=null===b,i=b===b,j=Vh(b);if(!h&&!j&&!f&&a>b||f&&g&&i&&!h&&!j||d&&g&&i||!c&&i||!e)return 1;if(!d&&!f&&!j&&a<b||j&&c&&e&&!d&&!f||h&&c&&e||!g&&e||!i)return-1}return 0}function ue(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=te(e[d],f[d]);if(i){if(d>=h)return i;var j=c[d];return i*("desc"==j?-1:1)}}return a.index-b.index}function ve(a,b,c,d){for(var e=-1,f=a.length,g=c.length,h=-1,i=b.length,j=tk(f-g,0),k=Hj(i+j),l=!d;++h<i;)k[h]=b[h];for(;++e<g;)(l||e<f)&&(k[c[e]]=a[e]);for(;j--;)k[h++]=a[e++];return k}function we(a,b,c,d){for(var e=-1,f=a.length,g=-1,h=c.length,i=-1,j=b.length,k=tk(f-h,0),l=Hj(k+j),m=!d;++e<k;)l[e]=a[e];for(var n=e;++i<j;)l[n+i]=b[i];for(;++g<h;)(m||e<f)&&(l[n+c[g]]=a[e++]);return l}function xe(a,b){var c=-1,d=a.length;for(b||(b=Hj(d));++c<d;)b[c]=a[c];return b}function ye(a,b,c,d){c||(c={});for(var e=-1,f=b.length;++e<f;){var g=b[e],h=d?d(c[g],a[g],g,c,a):da;uc(c,g,h===da?a[g]:h)}return c}function ze(a,b){return ye(a,Yk(a),b)}function Ae(a,b){return function(c,d){var e=Pl(c)?h:wc,f=b?b():{};return e(c,a,cf(d,2),f)}}function Be(a){return Td(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:da,g=e>2?c[2]:da;for(f=a.length>3&&"function"==typeof f?(e--,f):da,g&&qf(c[0],c[1],g)&&(f=e<3?da:f,e=1),b=Mj(b);++d<e;){var h=c[d];h&&a(b,h,d,f)}return b})}function Ce(a,b){return function(c,d){if(null==c)return c;if(!xh(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Mj(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function De(a){return function(b,c,d){for(var e=-1,f=Mj(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function Ee(a,b,c){function d(){var b=this&&this!==Uc&&this instanceof d?f:a;return b.apply(e?c:this,arguments)}var e=b&ja,f=He(a);return d}function Fe(a){return function(b){b=ei(b);var c=Q(b)?$(b):da,d=c?c[0]:b.charAt(0),e=c?ke(c,1).join(""):b.slice(1);return d[a]()+e}}function Ge(a){return function(b){return q(cj(Ki(b).replace(Cc,"")),a,"")}}function He(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Fc(a.prototype),d=a.apply(c,b);return Jh(d)?d:c;
}}function Ie(a,b,c){function d(){for(var f=arguments.length,h=Hj(f),i=f,j=bf(d);i--;)h[i]=arguments[i];var k=f<3&&h[0]!==j&&h[f-1]!==j?[]:W(h,j);if(f-=k.length,f<c)return Te(a,b,Le,d.placeholder,da,h,k,da,da,c-f);var l=this&&this!==Uc&&this instanceof d?e:a;return g(l,this,h)}var e=He(a);return d}function Je(a){return function(b,c,d){var e=Mj(b);if(!xh(b)){var f=cf(c,3);b=ri(b),c=function(a){return f(e[a],a,e)}}var g=a(b,c,d);return g>-1?e[f?b[g]:g]:da}}function Ke(a){return Td(function(b){b=Sc(b,1);var c=b.length,e=c,f=d.prototype.thru;for(a&&b.reverse();e--;){var g=b[e];if("function"!=typeof g)throw new Pj(ga);if(f&&!h&&"wrapper"==af(g))var h=new d([],!0)}for(e=h?e:c;++e<c;){g=b[e];var i=af(g),j="wrapper"==i?Xk(g):da;h=j&&tf(j[0])&&j[1]==(qa|ma|oa|ra)&&!j[4].length&&1==j[9]?h[af(j[0])].apply(h,j[3]):1==g.length&&tf(g)?h[i]():h.thru(g)}return function(){var a=arguments,d=a[0];if(h&&1==a.length&&Pl(d)&&d.length>=fa)return h.plant(d).value();for(var e=0,f=c?b[e].apply(this,a):d;++e<c;)f=b[e].call(this,f);return f}})}function Le(a,b,c,d,e,f,g,h,i,j){function k(){for(var r=arguments.length,s=Hj(r),t=r;t--;)s[t]=arguments[t];if(o)var u=bf(k),v=N(s,u);if(d&&(s=ve(s,d,e,o)),f&&(s=we(s,f,g,o)),r-=v,o&&r<j){var w=W(s,u);return Te(a,b,Le,k.placeholder,c,s,w,h,i,j-r)}var x=m?c:this,y=n?x[a]:a;return r=s.length,h?s=Cf(s,h):p&&r>1&&s.reverse(),l&&i<r&&(s.length=i),this&&this!==Uc&&this instanceof k&&(y=q||He(y)),y.apply(x,s)}var l=b&qa,m=b&ja,n=b&ka,o=b&(ma|na),p=b&sa,q=n?da:He(a);return k}function Me(a,b){return function(c,d){return od(c,a,b(d),{})}}function Ne(a,b){return function(c,d){var e;if(c===da&&d===da)return b;if(c!==da&&(e=c),d!==da){if(e===da)return d;"string"==typeof c||"string"==typeof d?(c=_d(c),d=_d(d)):(c=$d(c),d=$d(d)),e=a(c,d)}return e}}function Oe(a){return Td(function(b){return b=1==b.length&&Pl(b[0])?o(b[0],I(cf())):o(Sc(b,1),I(cf())),Td(function(c){var d=this;return a(b,function(a){return g(a,d,c)})})})}function Pe(a,b){b=b===da?" ":_d(b);var c=b.length;if(c<2)return c?Sd(b,a):b;var d=Sd(b,mk(a/Z(b)));return Q(b)?ke($(d),0,a).join(""):d.slice(0,a)}function Qe(a,b,c,d){function e(){for(var b=-1,i=arguments.length,j=-1,k=d.length,l=Hj(k+i),m=this&&this!==Uc&&this instanceof e?h:a;++j<k;)l[j]=d[j];for(;i--;)l[j++]=arguments[++b];return g(m,f?c:this,l)}var f=b&ja,h=He(a);return e}function Re(a){return function(b,c,d){return d&&"number"!=typeof d&&qf(b,c,d)&&(c=d=da),b=$h(b),c===da?(c=b,b=0):c=$h(c),d=d===da?b<c?1:-1:$h(d),Rd(b,c,d,a)}}function Se(a){return function(b,c){return"string"==typeof b&&"string"==typeof c||(b=bi(b),c=bi(c)),a(b,c)}}function Te(a,b,c,d,e,f,g,h,i,j){var k=b&ma,l=k?g:da,m=k?da:g,n=k?f:da,o=k?da:f;b|=k?oa:pa,b&=~(k?pa:oa),b&la||(b&=~(ja|ka));var p=[a,b,e,n,l,o,m,h,i,j],q=c.apply(da,p);return tf(a)&&al(q,p),q.placeholder=d,cl(q,a,b)}function Ue(a){var b=Lj[a];return function(a,c){if(a=bi(a),c=uk(_h(c),292)){var d=(ei(a)+"e").split("e"),e=b(d[0]+"e"+(+d[1]+c));return d=(ei(e)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return b(a)}}function Ve(a){return function(b){var c=$k(b);return c==Ra?U(b):c==Wa?Y(b):H(b,a(b))}}function We(a,b,c,d,e,f,g,h){var i=b&ka;if(!i&&"function"!=typeof a)throw new Pj(ga);var j=d?d.length:0;if(j||(b&=~(oa|pa),d=e=da),g=g===da?g:tk(_h(g),0),h=h===da?h:_h(h),j-=e?e.length:0,b&pa){var k=d,l=e;d=e=da}var m=i?da:Xk(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&yf(n,m),a=n[0],b=n[1],c=n[2],d=n[3],e=n[4],h=n[9]=null==n[9]?i?0:a.length:tk(n[9]-j,0),!h&&b&(ma|na)&&(b&=~(ma|na)),b&&b!=ja)o=b==ma||b==na?Ie(a,b,h):b!=oa&&b!=(ja|oa)||e.length?Le.apply(da,n):Qe(a,b,c,d);else var o=Ee(a,b,c);var p=m?Uk:al;return cl(p(o,n),a,b)}function Xe(a,b,c,d,e,f){var g=e&ua,h=a.length,i=b.length;if(h!=i&&!(g&&i>h))return!1;var j=f.get(a);if(j&&f.get(b))return j==b;var k=-1,l=!0,m=e&ta?new ic:da;for(f.set(a,b),f.set(b,a);++k<h;){var n=a[k],o=b[k];if(d)var p=g?d(o,n,k,b,a,f):d(n,o,k,a,b,f);if(p!==da){if(p)continue;l=!1;break}if(m){if(!s(b,function(a,b){if(!m.has(b)&&(n===a||c(n,a,d,e,f)))return m.add(b)})){l=!1;break}}else if(n!==o&&!c(n,o,d,e,f)){l=!1;break}}return f.delete(a),f.delete(b),l}function Ye(a,b,c,d,e,f,g){switch(c){case ab:if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)return!1;a=a.buffer,b=b.buffer;case _a:return!(a.byteLength!=b.byteLength||!d(new ck(a),new ck(b)));case Ma:case Na:case Sa:return vh(+a,+b);case Oa:return a.name==b.name&&a.message==b.message;case Va:case Xa:return a==b+"";case Ra:var h=U;case Wa:var i=f&ua;if(h||(h=X),a.size!=b.size&&!i)return!1;var j=g.get(a);if(j)return j==b;f|=ta,g.set(a,b);var k=Xe(h(a),h(b),d,e,f,g);return g.delete(a),k;case Ya:if(Ok)return Ok.call(a)==Ok.call(b)}return!1}function Ze(a,b,c,d,e,f){var g=e&ua,h=ri(a),i=h.length,j=ri(b),k=j.length;if(i!=k&&!g)return!1;for(var l=i;l--;){var m=h[l];if(!(g?m in b:Wj.call(b,m)))return!1}var n=f.get(a);if(n&&f.get(b))return n==b;var o=!0;f.set(a,b),f.set(b,a);for(var p=g;++l<i;){m=h[l];var q=a[m],r=b[m];if(d)var s=g?d(r,q,m,b,a,f):d(q,r,m,a,b,f);if(!(s===da?q===r||c(q,r,d,e,f):s)){o=!1;break}p||(p="constructor"==m)}if(o&&!p){var t=a.constructor,u=b.constructor;t!=u&&"constructor"in a&&"constructor"in b&&!("function"==typeof t&&t instanceof t&&"function"==typeof u&&u instanceof u)&&(o=!1)}return f.delete(a),f.delete(b),o}function $e(a){return Zc(a,ri,Yk)}function _e(a){return Zc(a,si,Zk)}function af(a){for(var b=a.name+"",c=Hk[b],d=Wj.call(Hk,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function bf(a){var c=Wj.call(b,"placeholder")?b:a;return c.placeholder}function cf(){var a=b.iteratee||ij;return a=a===ij?Ad:a,arguments.length?a(arguments[0],arguments[1]):a}function df(a,b){var c=a.__data__;return sf(b)?c["string"==typeof b?"string":"hash"]:c.map}function ef(a){for(var b=ri(a),c=b.length;c--;){var d=b[c],e=a[d];b[c]=[d,e,wf(e)]}return b}function ff(a,b){var c=P(a,b);return wd(c)?c:da}function gf(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=uk(b,a+g);break;case"takeRight":a=tk(a,b-g)}}return{start:a,end:b}}function hf(a){var b=a.match(Eb);return b?b[1].split(Fb):[]}function jf(a,b,c){b=rf(b,a)?[b]:je(b);for(var d,e=-1,f=b.length;++e<f;){var g=Df(b[e]);if(!(d=null!=a&&c(a,g)))break;a=a[g]}if(d)return d;var f=a?a.length:0;return!!f&&Ih(f)&&pf(g,f)&&(Pl(a)||wh(a))}function kf(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&Wj.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function lf(a){return"function"!=typeof a.constructor||vf(a)?{}:Fc(dk(a))}function mf(a,b,c,d){var e=a.constructor;switch(b){case _a:return me(a);case Ma:case Na:return new e(+a);case ab:return ne(a,d);case bb:case cb:case db:case eb:case fb:case gb:case hb:case ib:case jb:return se(a,d);case Ra:return oe(a,d,c);case Sa:case Xa:return new e(a);case Va:return pe(a);case Wa:return qe(a,d,c);case Ya:return re(a)}}function nf(a,b){var c=b.length,d=c-1;return b[d]=(c>1?"& ":"")+b[d],b=b.join(c>2?", ":" "),a.replace(Db,"{\n/* [wrapped with "+b+"] */\n")}function of(a){return Pl(a)||wh(a)||!!(ik&&a&&a[ik])}function pf(a,b){return b=null==b?Da:b,!!b&&("number"==typeof a||Pb.test(a))&&a>-1&&a%1==0&&a<b}function qf(a,b,c){if(!Jh(c))return!1;var d=typeof b;return!!("number"==d?xh(c)&&pf(b,c.length):"string"==d&&b in c)&&vh(c[b],a)}function rf(a,b){if(Pl(a))return!1;var c=typeof a;return!("number"!=c&&"symbol"!=c&&"boolean"!=c&&null!=a&&!Vh(a))||(vb.test(a)||!ub.test(a)||null!=b&&a in Mj(b))}function sf(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}function tf(a){var c=af(a),d=b[c];if("function"!=typeof d||!(c in t.prototype))return!1;if(a===d)return!0;var e=Xk(d);return!!e&&a===e[0]}function uf(a){return!!Uj&&Uj in a}function vf(a){var b=a&&a.constructor,c="function"==typeof b&&b.prototype||Sj;return a===c}function wf(a){return a===a&&!Jh(a)}function xf(a,b){return function(c){return null!=c&&(c[a]===b&&(b!==da||a in Mj(c)))}}function yf(a,b){var c=a[1],d=b[1],e=c|d,f=e<(ja|ka|qa),g=d==qa&&c==ma||d==qa&&c==ra&&a[7].length<=b[8]||d==(qa|ra)&&b[7].length<=b[8]&&c==ma;if(!f&&!g)return a;d&ja&&(a[2]=b[2],e|=c&ja?0:la);var h=b[3];if(h){var i=a[3];a[3]=i?ve(i,h,b[4]):h,a[4]=i?W(a[3],ia):b[4]}return h=b[5],h&&(i=a[5],a[5]=i?we(i,h,b[6]):h,a[6]=i?W(a[5],ia):b[6]),h=b[7],h&&(a[7]=h),d&qa&&(a[8]=null==a[8]?b[8]:uk(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function zf(a,b,c,d,e,f){return Jh(a)&&Jh(b)&&(f.set(b,a),Hd(a,b,da,zf,f),f.delete(b)),a}function Af(a){var b=[];if(null!=a)for(var c in Mj(a))b.push(c);return b}function Bf(a,b){return 1==b.length?a:Yc(a,Vd(b,0,-1))}function Cf(a,b){for(var c=a.length,d=uk(b.length,c),e=xe(a);d--;){var f=b[d];a[d]=pf(f,c)?e[f]:da}return a}function Df(a){if("string"==typeof a||Vh(a))return a;var b=a+"";return"0"==b&&1/a==-Ca?"-0":b}function Ef(a){if(null!=a){try{return Vj.call(a)}catch(b){}try{return a+""}catch(b){}}return""}function Ff(a,b){return i(Ja,function(c){var d="_."+c[0];b&c[1]&&!m(a,d)&&a.push(d)}),a.sort()}function Gf(a){if(a instanceof t)return a.clone();var b=new d(a.__wrapped__,a.__chain__);return b.__actions__=xe(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function Hf(a,b,c){b=(c?qf(a,b,c):b===da)?1:tk(_h(b),0);var d=a?a.length:0;if(!d||b<1)return[];for(var e=0,f=0,g=Hj(mk(d/b));e<d;)g[f++]=Vd(a,e,e+=b);return g}function If(a){for(var b=-1,c=a?a.length:0,d=0,e=[];++b<c;){var f=a[b];f&&(e[d++]=f)}return e}function Jf(){for(var a=arguments.length,b=Hj(a?a-1:0),c=arguments[0],d=a;d--;)b[d-1]=arguments[d];return a?p(Pl(c)?xe(c):[c],Sc(b,1)):[]}function Kf(a,b,c){var d=a?a.length:0;return d?(b=c||b===da?1:_h(b),Vd(a,b<0?0:b,d)):[]}function Lf(a,b,c){var d=a?a.length:0;return d?(b=c||b===da?1:_h(b),b=d-b,Vd(a,0,b<0?0:b)):[]}function Mf(a,b){return a&&a.length?de(a,cf(b,3),!0,!0):[]}function Nf(a,b){return a&&a.length?de(a,cf(b,3),!0):[]}function Of(a,b,c,d){var e=a?a.length:0;return e?(c&&"number"!=typeof c&&qf(a,b,c)&&(c=0,d=e),Oc(a,b,c,d)):[]}function Pf(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=null==c?0:_h(c);return e<0&&(e=tk(d+e,0)),w(a,cf(b,3),e)}function Qf(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d-1;return c!==da&&(e=_h(c),e=c<0?tk(d+e,0):uk(e,d-1)),w(a,cf(b,3),e,!0)}function Rf(a){var b=a?a.length:0;return b?Sc(a,1):[]}function Sf(a){var b=a?a.length:0;return b?Sc(a,Ca):[]}function Tf(a,b){var c=a?a.length:0;return c?(b=b===da?1:_h(b),Sc(a,b)):[]}function Uf(a){for(var b=-1,c=a?a.length:0,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d}function Vf(a){return a&&a.length?a[0]:da}function Wf(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=null==c?0:_h(c);return e<0&&(e=tk(d+e,0)),x(a,b,e)}function Xf(a){var b=a?a.length:0;return b?Vd(a,0,-1):[]}function Yf(a,b){return a?rk.call(a,b):""}function Zf(a){var b=a?a.length:0;return b?a[b-1]:da}function $f(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d;if(c!==da&&(e=_h(c),e=(e<0?tk(d+e,0):uk(e,d-1))+1),b!==b)return w(a,z,e-1,!0);for(;e--;)if(a[e]===b)return e;return-1}function _f(a,b){return a&&a.length?Jd(a,_h(b)):da}function ag(a,b){return a&&a.length&&b&&b.length?Od(a,b):a}function bg(a,b,c){return a&&a.length&&b&&b.length?Od(a,b,cf(c,2)):a}function cg(a,b,c){return a&&a.length&&b&&b.length?Od(a,b,da,c):a}function dg(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=cf(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return Pd(a,e),c}function eg(a){return a?xk.call(a):a}function fg(a,b,c){var d=a?a.length:0;return d?(c&&"number"!=typeof c&&qf(a,b,c)?(b=0,c=d):(b=null==b?0:_h(b),c=c===da?d:_h(c)),Vd(a,b,c)):[]}function gg(a,b){return Xd(a,b)}function hg(a,b,c){return Yd(a,b,cf(c,2))}function ig(a,b){var c=a?a.length:0;if(c){var d=Xd(a,b);if(d<c&&vh(a[d],b))return d}return-1}function jg(a,b){return Xd(a,b,!0)}function kg(a,b,c){return Yd(a,b,cf(c,2),!0)}function lg(a,b){var c=a?a.length:0;if(c){var d=Xd(a,b,!0)-1;if(vh(a[d],b))return d}return-1}function mg(a){return a&&a.length?Zd(a):[]}function ng(a,b){return a&&a.length?Zd(a,cf(b,2)):[]}function og(a){var b=a?a.length:0;return b?Vd(a,1,b):[]}function pg(a,b,c){return a&&a.length?(b=c||b===da?1:_h(b),Vd(a,0,b<0?0:b)):[]}function qg(a,b,c){var d=a?a.length:0;return d?(b=c||b===da?1:_h(b),b=d-b,Vd(a,b<0?0:b,d)):[]}function rg(a,b){return a&&a.length?de(a,cf(b,3),!1,!0):[]}function sg(a,b){return a&&a.length?de(a,cf(b,3)):[]}function tg(a){return a&&a.length?ae(a):[]}function ug(a,b){return a&&a.length?ae(a,cf(b,2)):[]}function vg(a,b){return a&&a.length?ae(a,da,b):[]}function wg(a){if(!a||!a.length)return[];var b=0;return a=l(a,function(a){if(yh(a))return b=tk(a.length,b),!0}),G(b,function(b){return o(a,B(b))})}function xg(a,b){if(!a||!a.length)return[];var c=wg(a);return null==b?c:o(c,function(a){return g(b,da,a)})}function yg(a,b){return ge(a||[],b||[],uc)}function zg(a,b){return ge(a||[],b||[],Ud)}function Ag(a){var c=b(a);return c.__chain__=!0,c}function Bg(a,b){return b(a),a}function Cg(a,b){return b(a)}function Dg(){return Ag(this)}function Eg(){return new d(this.value(),this.__chain__)}function Fg(){this.__values__===da&&(this.__values__=Zh(this.value()));var a=this.__index__>=this.__values__.length,b=a?da:this.__values__[this.__index__++];return{done:a,value:b}}function Gg(){return this}function Hg(a){for(var b,d=this;d instanceof c;){var e=Gf(d);e.__index__=0,e.__values__=da,b?f.__wrapped__=e:b=e;var f=e;d=d.__wrapped__}return f.__wrapped__=a,b}function Ig(){var a=this.__wrapped__;if(a instanceof t){var b=a;return this.__actions__.length&&(b=new t(this)),b=b.reverse(),b.__actions__.push({func:Cg,args:[eg],thisArg:da}),new d(b,this.__chain__)}return this.thru(eg)}function Jg(){return ee(this.__wrapped__,this.__actions__)}function Kg(a,b,c){var d=Pl(a)?k:Mc;return c&&qf(a,b,c)&&(b=da),d(a,cf(b,3))}function Lg(a,b){var c=Pl(a)?l:Pc;return c(a,cf(b,3))}function Mg(a,b){return Sc(Sg(a,b),1)}function Ng(a,b){return Sc(Sg(a,b),Ca)}function Og(a,b,c){return c=c===da?1:_h(c),Sc(Sg(a,b),c)}function Pg(a,b){var c=Pl(a)?i:Qk;return c(a,cf(b,3))}function Qg(a,b){var c=Pl(a)?j:Rk;return c(a,cf(b,3))}function Rg(a,b,c,d){a=xh(a)?a:Ei(a),c=c&&!d?_h(c):0;var e=a.length;return c<0&&(c=tk(e+c,0)),Uh(a)?c<=e&&a.indexOf(b,c)>-1:!!e&&x(a,b,c)>-1}function Sg(a,b){var c=Pl(a)?o:Ed;return c(a,cf(b,3))}function Tg(a,b,c,d){return null==a?[]:(Pl(b)||(b=null==b?[]:[b]),c=d?da:c,Pl(c)||(c=null==c?[]:[c]),Kd(a,b,c))}function Ug(a,b,c){var d=Pl(a)?q:D,e=arguments.length<3;return d(a,cf(b,4),c,e,Qk)}function Vg(a,b,c){var d=Pl(a)?r:D,e=arguments.length<3;return d(a,cf(b,4),c,e,Rk)}function Wg(a,b){var c=Pl(a)?l:Pc;return c(a,ih(cf(b,3)))}function Xg(a){var b=xh(a)?a:Ei(a),c=b.length;return c>0?b[Qd(0,c-1)]:da}function Yg(a,b,c){var d=-1,e=Zh(a),f=e.length,g=f-1;for(b=(c?qf(a,b,c):b===da)?1:zc(_h(b),0,f);++d<b;){var h=Qd(d,g),i=e[h];e[h]=e[d],e[d]=i}return e.length=b,e}function Zg(a){return Yg(a,Ga)}function $g(a){if(null==a)return 0;if(xh(a))return Uh(a)?Z(a):a.length;var b=$k(a);return b==Ra||b==Wa?a.size:Bd(a).length}function _g(a,b,c){var d=Pl(a)?s:Wd;return c&&qf(a,b,c)&&(b=da),d(a,cf(b,3))}function ah(a,b){if("function"!=typeof b)throw new Pj(ga);return a=_h(a),function(){if(--a<1)return b.apply(this,arguments)}}function bh(a,b,c){return b=c?da:b,b=a&&null==b?a.length:b,We(a,qa,da,da,da,da,b)}function ch(a,b){var c;if("function"!=typeof b)throw new Pj(ga);return a=_h(a),function(){return--a>0&&(c=b.apply(this,arguments)),a<=1&&(b=da),c}}function dh(a,b,c){b=c?da:b;var d=We(a,ma,da,da,da,da,da,b);return d.placeholder=dh.placeholder,d}function eh(a,b,c){b=c?da:b;var d=We(a,na,da,da,da,da,da,b);return d.placeholder=eh.placeholder,d}function fh(a,b,c){function d(b){var c=m,d=n;return m=n=da,s=b,p=a.apply(d,c)}function e(a){return s=a,q=bl(h,b),t?d(a):p}function f(a){var c=a-r,d=a-s,e=b-c;return u?uk(e,o-d):e}function g(a){var c=a-r,d=a-s;return r===da||c>=b||c<0||u&&d>=o}function h(){var a=El();return g(a)?i(a):void(q=bl(h,f(a)))}function i(a){return q=da,v&&m?d(a):(m=n=da,p)}function j(){q!==da&&Vk(q),s=0,m=r=n=q=da}function k(){return q===da?p:i(El())}function l(){var a=El(),c=g(a);if(m=arguments,n=this,r=a,c){if(q===da)return e(r);if(u)return q=bl(h,b),d(r)}return q===da&&(q=bl(h,b)),p}var m,n,o,p,q,r,s=0,t=!1,u=!1,v=!0;if("function"!=typeof a)throw new Pj(ga);return b=bi(b)||0,Jh(c)&&(t=!!c.leading,u="maxWait"in c,o=u?tk(bi(c.maxWait)||0,b):o,v="trailing"in c?!!c.trailing:v),l.cancel=j,l.flush=k,l}function gh(a){return We(a,sa)}function hh(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new Pj(ga);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g),g};return c.cache=new(hh.Cache||cc),c}function ih(a){if("function"!=typeof a)throw new Pj(ga);return function(){var b=arguments;switch(b.length){case 0:return!a.call(this);case 1:return!a.call(this,b[0]);case 2:return!a.call(this,b[0],b[1]);case 3:return!a.call(this,b[0],b[1],b[2])}return!a.apply(this,b)}}function jh(a){return ch(2,a)}function kh(a,b){if("function"!=typeof a)throw new Pj(ga);return b=b===da?b:_h(b),Td(a,b)}function lh(a,b){if("function"!=typeof a)throw new Pj(ga);return b=b===da?0:tk(_h(b),0),Td(function(c){var d=c[b],e=ke(c,0,b);return d&&p(e,d),g(a,this,e)})}function mh(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new Pj(ga);return Jh(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),fh(a,b,{leading:d,maxWait:b,trailing:e})}function nh(a){return bh(a,1)}function oh(a,b){return b=null==b?hj:b,Kl(b,a)}function ph(){if(!arguments.length)return[];var a=arguments[0];return Pl(a)?a:[a]}function qh(a){return Ac(a,!1,!0)}function rh(a,b){return Ac(a,!1,!0,b)}function sh(a){return Ac(a,!0,!0)}function th(a,b){return Ac(a,!0,!0,b)}function uh(a,b){return null==b||Ec(a,b,ri(b))}function vh(a,b){return a===b||a!==a&&b!==b}function wh(a){return yh(a)&&Wj.call(a,"callee")&&(!gk.call(a,"callee")||Zj.call(a)==Ka)}function xh(a){return null!=a&&Ih(a.length)&&!Gh(a)}function yh(a){return Kh(a)&&xh(a)}function zh(a){return a===!0||a===!1||Kh(a)&&Zj.call(a)==Ma}function Ah(a){return!!a&&1===a.nodeType&&Kh(a)&&!Sh(a)}function Bh(a){if(xh(a)&&(Pl(a)||"string"==typeof a||"function"==typeof a.splice||Rl(a)||wh(a)))return!a.length;var b=$k(a);if(b==Ra||b==Wa)return!a.size;if(Gk||vf(a))return!sk(a).length;for(var c in a)if(Wj.call(a,c))return!1;return!0}function Ch(a,b){return sd(a,b)}function Dh(a,b,c){c="function"==typeof c?c:da;var d=c?c(a,b):da;return d===da?sd(a,b,c):!!d}function Eh(a){return!!Kh(a)&&(Zj.call(a)==Oa||"string"==typeof a.message&&"string"==typeof a.name)}function Fh(a){return"number"==typeof a&&qk(a)}function Gh(a){var b=Jh(a)?Zj.call(a):"";return b==Pa||b==Qa}function Hh(a){return"number"==typeof a&&a==_h(a)}function Ih(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=Da}function Jh(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Kh(a){return!!a&&"object"==typeof a}function Lh(a,b){return a===b||vd(a,b,ef(b))}function Mh(a,b,c){return c="function"==typeof c?c:da,vd(a,b,ef(b),c)}function Nh(a){return Rh(a)&&a!=+a}function Oh(a){if(_k(a))throw new Jj("This method is not supported with core-js. Try https://github.com/es-shims.");return wd(a)}function Ph(a){return null===a}function Qh(a){return null==a}function Rh(a){return"number"==typeof a||Kh(a)&&Zj.call(a)==Sa}function Sh(a){if(!Kh(a)||Zj.call(a)!=Ta||S(a))return!1;var b=dk(a);if(null===b)return!0;var c=Wj.call(b,"constructor")&&b.constructor;return"function"==typeof c&&c instanceof c&&Vj.call(c)==Yj}function Th(a){return Hh(a)&&a>=-Da&&a<=Da}function Uh(a){return"string"==typeof a||!Pl(a)&&Kh(a)&&Zj.call(a)==Xa}function Vh(a){return"symbol"==typeof a||Kh(a)&&Zj.call(a)==Ya}function Wh(a){return a===da}function Xh(a){return Kh(a)&&$k(a)==Za}function Yh(a){return Kh(a)&&Zj.call(a)==$a}function Zh(a){if(!a)return[];if(xh(a))return Uh(a)?$(a):xe(a);if(ek&&a[ek])return T(a[ek]());var b=$k(a),c=b==Ra?U:b==Wa?X:Ei;return c(a)}function $h(a){if(!a)return 0===a?a:0;if(a=bi(a),a===Ca||a===-Ca){var b=a<0?-1:1;return b*Ea}return a===a?a:0}function _h(a){var b=$h(a),c=b%1;return b===b?c?b-c:b:0}function ai(a){return a?zc(_h(a),0,Ga):0}function bi(a){if("number"==typeof a)return a;if(Vh(a))return Fa;if(Jh(a)){var b="function"==typeof a.valueOf?a.valueOf():a;a=Jh(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Ab,"");var c=Mb.test(a);return c||Ob.test(a)?Rc(a.slice(2),c?2:8):Lb.test(a)?Fa:+a}function ci(a){return ye(a,si(a))}function di(a){return zc(_h(a),-Da,Da)}function ei(a){return null==a?"":_d(a)}function fi(a,b){var c=Fc(a);return b?xc(c,b):c}function gi(a,b){return v(a,cf(b,3),Tc)}function hi(a,b){return v(a,cf(b,3),Vc)}function ii(a,b){return null==a?a:Sk(a,cf(b,3),si)}function ji(a,b){return null==a?a:Tk(a,cf(b,3),si)}function ki(a,b){return a&&Tc(a,cf(b,3))}function li(a,b){return a&&Vc(a,cf(b,3))}function mi(a){return null==a?[]:Wc(a,ri(a))}function ni(a){return null==a?[]:Wc(a,si(a))}function oi(a,b,c){var d=null==a?da:Yc(a,b);return d===da?c:d}function pi(a,b){return null!=a&&jf(a,b,kd)}function qi(a,b){return null!=a&&jf(a,b,ld)}function ri(a){return xh(a)?rc(a):Bd(a)}function si(a){return xh(a)?rc(a,!0):Cd(a)}function ti(a,b){var c={};return b=cf(b,3),Tc(a,function(a,d,e){c[b(a,d,e)]=a}),c}function ui(a,b){var c={};return b=cf(b,3),Tc(a,function(a,d,e){c[d]=b(a,d,e)}),c}function vi(a,b){return wi(a,ih(cf(b)))}function wi(a,b){return null==a?{}:Md(a,_e(a),cf(b))}function xi(a,b,c){b=rf(b,a)?[b]:je(b);var d=-1,e=b.length;for(e||(a=da,e=1);++d<e;){var f=null==a?da:a[Df(b[d])];f===da&&(d=e,f=c),a=Gh(f)?f.call(a):f}return a}function yi(a,b,c){return null==a?a:Ud(a,b,c)}function zi(a,b,c,d){return d="function"==typeof d?d:da,null==a?a:Ud(a,b,c,d)}function Ai(a,b,c){var d=Pl(a)||Wl(a);if(b=cf(b,4),null==c)if(d||Jh(a)){var e=a.constructor;c=d?Pl(a)?new e:[]:Gh(e)?Fc(dk(a)):{}}else c={};return(d?i:Tc)(a,function(a,d,e){return b(c,a,d,e)}),c}function Bi(a,b){return null==a||be(a,b)}function Ci(a,b,c){return null==a?a:ce(a,b,ie(c))}function Di(a,b,c,d){return d="function"==typeof d?d:da,null==a?a:ce(a,b,ie(c),d)}function Ei(a){return a?J(a,ri(a)):[]}function Fi(a){return null==a?[]:J(a,si(a))}function Gi(a,b,c){return c===da&&(c=b,b=da),c!==da&&(c=bi(c),c=c===c?c:0),b!==da&&(b=bi(b),b=b===b?b:0),zc(bi(a),b,c)}function Hi(a,b,c){return b=$h(b),c===da?(c=b,b=0):c=$h(c),a=bi(a),md(a,b,c)}function Ii(a,b,c){if(c&&"boolean"!=typeof c&&qf(a,b,c)&&(b=c=da),c===da&&("boolean"==typeof b?(c=b,b=da):"boolean"==typeof a&&(c=a,a=da)),a===da&&b===da?(a=0,b=1):(a=$h(a),b===da?(b=a,a=0):b=$h(b)),a>b){var d=a;a=b,b=d}if(c||a%1||b%1){var e=wk();return uk(a+e*(b-a+Qc("1e-"+((e+"").length-1))),b)}return Qd(a,b)}function Ji(a){return um(ei(a).toLowerCase())}function Ki(a){return a=ei(a),a&&a.replace(Qb,fd).replace(Dc,"")}function Li(a,b,c){a=ei(a),b=_d(b);var d=a.length;c=c===da?d:zc(_h(c),0,d);var e=c;return c-=b.length,c>=0&&a.slice(c,e)==b}function Mi(a){return a=ei(a),a&&qb.test(a)?a.replace(ob,gd):a}function Ni(a){return a=ei(a),a&&zb.test(a)?a.replace(yb,"\\$&"):a}function Oi(a,b,c){a=ei(a),b=_h(b);var d=b?Z(a):0;if(!b||d>=b)return a;var e=(b-d)/2;return Pe(nk(e),c)+a+Pe(mk(e),c)}function Pi(a,b,c){a=ei(a),b=_h(b);var d=b?Z(a):0;return b&&d<b?a+Pe(b-d,c):a}function Qi(a,b,c){a=ei(a),b=_h(b);var d=b?Z(a):0;return b&&d<b?Pe(b-d,c)+a:a}function Ri(a,b,c){return c||null==b?b=0:b&&(b=+b),a=ei(a).replace(Ab,""),vk(a,b||(Kb.test(a)?16:10))}function Si(a,b,c){return b=(c?qf(a,b,c):b===da)?1:_h(b),Sd(ei(a),b)}function Ti(){var a=arguments,b=ei(a[0]);return a.length<3?b:b.replace(a[1],a[2])}function Ui(a,b,c){return c&&"number"!=typeof c&&qf(a,b,c)&&(b=c=da),(c=c===da?Ga:c>>>0)?(a=ei(a),a&&("string"==typeof b||null!=b&&!Ul(b))&&(b=_d(b),!b&&Q(a))?ke($(a),0,c):a.split(b,c)):[]}function Vi(a,b,c){return a=ei(a),c=zc(_h(c),0,a.length),b=_d(b),a.slice(c,c+b.length)==b}function Wi(a,c,d){var e=b.templateSettings;d&&qf(a,c,d)&&(c=da),a=ei(a),c=_l({},c,e,sc);var f,g,h=_l({},c.imports,e.imports,sc),i=ri(h),j=J(h,i),k=0,l=c.interpolate||Rb,m="__p += '",n=Nj((c.escape||Rb).source+"|"+l.source+"|"+(l===tb?Ib:Rb).source+"|"+(c.evaluate||Rb).source+"|$","g"),o="//# sourceURL="+("sourceURL"in c?c.sourceURL:"lodash.templateSources["+ ++Jc+"]")+"\n";a.replace(n,function(b,c,d,e,h,i){return d||(d=e),m+=a.slice(k,i).replace(Sb,O),c&&(f=!0,m+="' +\n__e("+c+") +\n'"),h&&(g=!0,m+="';\n"+h+";\n__p += '"),d&&(m+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),k=i+b.length,b}),m+="';\n";var p=c.variable;p||(m="with (obj) {\n"+m+"\n}\n"),m=(g?m.replace(kb,""):m).replace(lb,"$1").replace(mb,"$1;"),m="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(f?", __e = _.escape":"")+(g?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var q=vm(function(){return Kj(i,o+"return "+m).apply(da,j)});if(q.source=m,Eh(q))throw q;return q}function Xi(a){return ei(a).toLowerCase()}function Yi(a){return ei(a).toUpperCase()}function Zi(a,b,c){if(a=ei(a),a&&(c||b===da))return a.replace(Ab,"");if(!a||!(b=_d(b)))return a;var d=$(a),e=$(b),f=L(d,e),g=M(d,e)+1;return ke(d,f,g).join("")}function $i(a,b,c){if(a=ei(a),a&&(c||b===da))return a.replace(Cb,"");if(!a||!(b=_d(b)))return a;var d=$(a),e=M(d,$(b))+1;return ke(d,0,e).join("")}function _i(a,b,c){if(a=ei(a),a&&(c||b===da))return a.replace(Bb,"");if(!a||!(b=_d(b)))return a;var d=$(a),e=L(d,$(b));return ke(d,e).join("")}function aj(a,b){var c=va,d=wa;if(Jh(b)){var e="separator"in b?b.separator:e;c="length"in b?_h(b.length):c,d="omission"in b?_d(b.omission):d}a=ei(a);var f=a.length;if(Q(a)){var g=$(a);f=g.length}if(c>=f)return a;var h=c-Z(d);if(h<1)return d;var i=g?ke(g,0,h).join(""):a.slice(0,h);if(e===da)return i+d;if(g&&(h+=i.length-h),Ul(e)){if(a.slice(h).search(e)){var j,k=i;for(e.global||(e=Nj(e.source,ei(Jb.exec(e))+"g")),e.lastIndex=0;j=e.exec(k);)var l=j.index;i=i.slice(0,l===da?h:l)}}else if(a.indexOf(_d(e),h)!=h){var m=i.lastIndexOf(e);m>-1&&(i=i.slice(0,m))}return i+d}function bj(a){return a=ei(a),a&&pb.test(a)?a.replace(nb,hd):a}function cj(a,b,c){return a=ei(a),b=c?da:b,b===da?R(a)?ba(a):u(a):a.match(b)||[]}function dj(a){var b=a?a.length:0,c=cf();return a=b?o(a,function(a){if("function"!=typeof a[1])throw new Pj(ga);return[c(a[0]),a[1]]}):[],Td(function(c){for(var d=-1;++d<b;){var e=a[d];if(g(e[0],this,c))return g(e[1],this,c)}})}function ej(a){return Bc(Ac(a,!0))}function fj(a){return function(){return a}}function gj(a,b){return null==a||a!==a?b:a}function hj(a){return a}function ij(a){return Ad("function"==typeof a?a:Ac(a,!0))}function jj(a){return Fd(Ac(a,!0))}function kj(a,b){return Gd(a,Ac(b,!0))}function lj(a,b,c){var d=ri(b),e=Wc(b,d);null!=c||Jh(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Wc(b,ri(b)));var f=!(Jh(c)&&"chain"in c&&!c.chain),g=Gh(a);return i(e,function(c){var d=b[c];a[c]=d,g&&(a.prototype[c]=function(){var b=this.__chain__;if(f||b){var c=a(this.__wrapped__),e=c.__actions__=xe(this.__actions__);return e.push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,p([this.value()],arguments))})}),a}function mj(){return Uc._===this&&(Uc._=$j),this}function nj(){}function oj(a){return a=_h(a),Td(function(b){return Jd(b,a)})}function pj(a){return rf(a)?B(Df(a)):Nd(a)}function qj(a){return function(b){return null==a?da:Yc(a,b)}}function rj(){return[]}function sj(){return!1}function tj(){return{}}function uj(){return""}function vj(){return!0}function wj(a,b){if(a=_h(a),a<1||a>Da)return[];var c=Ga,d=uk(a,Ga);b=cf(b),a-=Ga;for(var e=G(d,b);++c<a;)b(c);return e}function xj(a){return Pl(a)?o(a,Df):Vh(a)?[a]:xe(dl(a))}function yj(a){var b=++Xj;return ei(a)+b}function zj(a){return a&&a.length?Nc(a,hj,jd):da}function Aj(a,b){return a&&a.length?Nc(a,cf(b,2),jd):da}function Bj(a){return A(a,hj)}function Cj(a,b){return A(a,cf(b,2))}function Dj(a){return a&&a.length?Nc(a,hj,Dd):da}function Ej(a,b){return a&&a.length?Nc(a,cf(b,2),Dd):da}function Fj(a){return a&&a.length?F(a,hj):0}function Gj(a,b){return a&&a.length?F(a,cf(b,2)):0}a=a?id.defaults(Uc.Object(),a,id.pick(Uc,Ic)):Uc;var Hj=a.Array,Ij=a.Date,Jj=a.Error,Kj=a.Function,Lj=a.Math,Mj=a.Object,Nj=a.RegExp,Oj=a.String,Pj=a.TypeError,Qj=Hj.prototype,Rj=Kj.prototype,Sj=Mj.prototype,Tj=a["__core-js_shared__"],Uj=function(){var a=/[^.]+$/.exec(Tj&&Tj.keys&&Tj.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Vj=Rj.toString,Wj=Sj.hasOwnProperty,Xj=0,Yj=Vj.call(Mj),Zj=Sj.toString,$j=Uc._,_j=Nj("^"+Vj.call(Wj).replace(yb,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ak=Xc?a.Buffer:da,bk=a.Symbol,ck=a.Uint8Array,dk=V(Mj.getPrototypeOf,Mj),ek=bk?bk.iterator:da,fk=Mj.create,gk=Sj.propertyIsEnumerable,hk=Qj.splice,ik=bk?bk.isConcatSpreadable:da,jk=a.clearTimeout!==Uc.clearTimeout&&a.clearTimeout,kk=Ij&&Ij.now!==Uc.Date.now&&Ij.now,lk=a.setTimeout!==Uc.setTimeout&&a.setTimeout,mk=Lj.ceil,nk=Lj.floor,ok=Mj.getOwnPropertySymbols,pk=ak?ak.isBuffer:da,qk=a.isFinite,rk=Qj.join,sk=V(Mj.keys,Mj),tk=Lj.max,uk=Lj.min,vk=a.parseInt,wk=Lj.random,xk=Qj.reverse,yk=ff(a,"DataView"),zk=ff(a,"Map"),Ak=ff(a,"Promise"),Bk=ff(a,"Set"),Ck=ff(a,"WeakMap"),Dk=ff(Mj,"create"),Ek=function(){var a=ff(Mj,"defineProperty"),b=ff.name;return b&&b.length>2?a:da}(),Fk=Ck&&new Ck,Gk=!gk.call({valueOf:1},"valueOf"),Hk={},Ik=Ef(yk),Jk=Ef(zk),Kk=Ef(Ak),Lk=Ef(Bk),Mk=Ef(Ck),Nk=bk?bk.prototype:da,Ok=Nk?Nk.valueOf:da,Pk=Nk?Nk.toString:da;b.templateSettings={escape:rb,evaluate:sb,interpolate:tb,variable:"",imports:{_:b}},b.prototype=c.prototype,b.prototype.constructor=b,d.prototype=Fc(c.prototype),d.prototype.constructor=d,t.prototype=Fc(c.prototype),t.prototype.constructor=t,Gb.prototype.clear=Tb,Gb.prototype.delete=Ub,Gb.prototype.get=Vb,Gb.prototype.has=Wb,Gb.prototype.set=Xb,Yb.prototype.clear=Zb,Yb.prototype.delete=$b,Yb.prototype.get=_b,Yb.prototype.has=ac,Yb.prototype.set=bc,cc.prototype.clear=dc,cc.prototype.delete=ec,cc.prototype.get=fc,cc.prototype.has=gc,cc.prototype.set=hc,ic.prototype.add=ic.prototype.push=jc,ic.prototype.has=kc,lc.prototype.clear=mc,lc.prototype.delete=nc,lc.prototype.get=oc,lc.prototype.has=pc,lc.prototype.set=qc;var Qk=Ce(Tc),Rk=Ce(Vc,!0),Sk=De(),Tk=De(!0),Uk=Fk?function(a,b){return Fk.set(a,b),a}:hj,Vk=jk||function(a){return Uc.clearTimeout(a)},Wk=Bk&&1/X(new Bk([,-0]))[1]==Ca?function(a){return new Bk(a)}:nj,Xk=Fk?function(a){return Fk.get(a)}:nj,Yk=ok?V(ok,Mj):rj,Zk=ok?function(a){for(var b=[];a;)p(b,Yk(a)),a=dk(a);return b}:rj,$k=ed;(yk&&$k(new yk(new ArrayBuffer(1)))!=ab||zk&&$k(new zk)!=Ra||Ak&&$k(Ak.resolve())!=Ua||Bk&&$k(new Bk)!=Wa||Ck&&$k(new Ck)!=Za)&&($k=function(a){var b=Zj.call(a),c=b==Ta?a.constructor:da,d=c?Ef(c):da;if(d)switch(d){case Ik:return ab;case Jk:return Ra;case Kk:return Ua;case Lk:return Wa;case Mk:return Za}return b});var _k=Tj?Gh:sj,al=function(){var a=0,b=0;return function(c,d){var e=El(),f=ya-(e-b);if(b=e,f>0){if(++a>=xa)return c}else a=0;return Uk(c,d)}}(),bl=lk||function(a,b){return Uc.setTimeout(a,b)},cl=Ek?function(a,b,c){var d=b+"";return Ek(a,"toString",{configurable:!0,enumerable:!1,value:fj(nf(d,Ff(hf(d),c)))})}:hj,dl=hh(function(a){a=ei(a);var b=[];return wb.test(a)&&b.push(""),a.replace(xb,function(a,c,d,e){b.push(d?e.replace(Hb,"$1"):c||a)}),b}),el=Td(function(a,b){return yh(a)?Hc(a,Sc(b,1,yh,!0)):[]}),fl=Td(function(a,b){var c=Zf(b);return yh(c)&&(c=da),yh(a)?Hc(a,Sc(b,1,yh,!0),cf(c,2)):[]}),gl=Td(function(a,b){var c=Zf(b);return yh(c)&&(c=da),yh(a)?Hc(a,Sc(b,1,yh,!0),da,c):[]}),hl=Td(function(a){var b=o(a,he);return b.length&&b[0]===a[0]?nd(b):[]}),il=Td(function(a){var b=Zf(a),c=o(a,he);return b===Zf(c)?b=da:c.pop(),c.length&&c[0]===a[0]?nd(c,cf(b,2)):[]}),jl=Td(function(a){var b=Zf(a),c=o(a,he);return b===Zf(c)?b=da:c.pop(),c.length&&c[0]===a[0]?nd(c,da,b):[]}),kl=Td(ag),ll=Td(function(a,b){b=Sc(b,1);var c=a?a.length:0,d=yc(a,b);return Pd(a,o(b,function(a){return pf(a,c)?+a:a}).sort(te)),d}),ml=Td(function(a){return ae(Sc(a,1,yh,!0))}),nl=Td(function(a){var b=Zf(a);return yh(b)&&(b=da),ae(Sc(a,1,yh,!0),cf(b,2))}),ol=Td(function(a){var b=Zf(a);return yh(b)&&(b=da),
ae(Sc(a,1,yh,!0),da,b)}),pl=Td(function(a,b){return yh(a)?Hc(a,b):[]}),ql=Td(function(a){return fe(l(a,yh))}),rl=Td(function(a){var b=Zf(a);return yh(b)&&(b=da),fe(l(a,yh),cf(b,2))}),sl=Td(function(a){var b=Zf(a);return yh(b)&&(b=da),fe(l(a,yh),da,b)}),tl=Td(wg),ul=Td(function(a){var b=a.length,c=b>1?a[b-1]:da;return c="function"==typeof c?(a.pop(),c):da,xg(a,c)}),vl=Td(function(a){a=Sc(a,1);var b=a.length,c=b?a[0]:0,e=this.__wrapped__,f=function(b){return yc(b,a)};return!(b>1||this.__actions__.length)&&e instanceof t&&pf(c)?(e=e.slice(c,+c+(b?1:0)),e.__actions__.push({func:Cg,args:[f],thisArg:da}),new d(e,this.__chain__).thru(function(a){return b&&!a.length&&a.push(da),a})):this.thru(f)}),wl=Ae(function(a,b,c){Wj.call(a,c)?++a[c]:a[c]=1}),xl=Je(Pf),yl=Je(Qf),zl=Ae(function(a,b,c){Wj.call(a,c)?a[c].push(b):a[c]=[b]}),Al=Td(function(a,b,c){var d=-1,e="function"==typeof b,f=rf(b),h=xh(a)?Hj(a.length):[];return Qk(a,function(a){var i=e?b:f&&null!=a?a[b]:da;h[++d]=i?g(i,a,c):pd(a,b,c)}),h}),Bl=Ae(function(a,b,c){a[c]=b}),Cl=Ae(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),Dl=Td(function(a,b){if(null==a)return[];var c=b.length;return c>1&&qf(a,b[0],b[1])?b=[]:c>2&&qf(b[0],b[1],b[2])&&(b=[b[0]]),Kd(a,Sc(b,1),[])}),El=kk||function(){return Uc.Date.now()},Fl=Td(function(a,b,c){var d=ja;if(c.length){var e=W(c,bf(Fl));d|=oa}return We(a,d,b,c,e)}),Gl=Td(function(a,b,c){var d=ja|ka;if(c.length){var e=W(c,bf(Gl));d|=oa}return We(b,d,a,c,e)}),Hl=Td(function(a,b){return Gc(a,1,b)}),Il=Td(function(a,b,c){return Gc(a,bi(b)||0,c)});hh.Cache=cc;var Jl=Td(function(a,b){b=1==b.length&&Pl(b[0])?o(b[0],I(cf())):o(Sc(b,1),I(cf()));var c=b.length;return Td(function(d){for(var e=-1,f=uk(d.length,c);++e<f;)d[e]=b[e].call(this,d[e]);return g(a,this,d)})}),Kl=Td(function(a,b){var c=W(b,bf(Kl));return We(a,oa,da,b,c)}),Ll=Td(function(a,b){var c=W(b,bf(Ll));return We(a,pa,da,b,c)}),Ml=Td(function(a,b){return We(a,ra,da,da,da,Sc(b,1))}),Nl=Se(jd),Ol=Se(function(a,b){return a>=b}),Pl=Hj.isArray,Ql=$c?I($c):qd,Rl=pk||sj,Sl=_c?I(_c):rd,Tl=ad?I(ad):ud,Ul=bd?I(bd):xd,Vl=cd?I(cd):yd,Wl=dd?I(dd):zd,Xl=Se(Dd),Yl=Se(function(a,b){return a<=b}),Zl=Be(function(a,b){if(Gk||vf(b)||xh(b))return void ye(b,ri(b),a);for(var c in b)Wj.call(b,c)&&uc(a,c,b[c])}),$l=Be(function(a,b){ye(b,si(b),a)}),_l=Be(function(a,b,c,d){ye(b,si(b),a,d)}),am=Be(function(a,b,c,d){ye(b,ri(b),a,d)}),bm=Td(function(a,b){return yc(a,Sc(b,1))}),cm=Td(function(a){return a.push(da,sc),g(_l,da,a)}),dm=Td(function(a){return a.push(da,zf),g(im,da,a)}),em=Me(function(a,b,c){a[b]=c},fj(hj)),fm=Me(function(a,b,c){Wj.call(a,b)?a[b].push(c):a[b]=[c]},cf),gm=Td(pd),hm=Be(function(a,b,c){Hd(a,b,c)}),im=Be(function(a,b,c,d){Hd(a,b,c,d)}),jm=Td(function(a,b){return null==a?{}:(b=o(Sc(b,1),Df),Ld(a,Hc(_e(a),b)))}),km=Td(function(a,b){return null==a?{}:Ld(a,o(Sc(b,1),Df))}),lm=Ve(ri),mm=Ve(si),nm=Ge(function(a,b,c){return b=b.toLowerCase(),a+(c?Ji(b):b)}),om=Ge(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),pm=Ge(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),qm=Fe("toLowerCase"),rm=Ge(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),sm=Ge(function(a,b,c){return a+(c?" ":"")+um(b)}),tm=Ge(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),um=Fe("toUpperCase"),vm=Td(function(a,b){try{return g(a,da,b)}catch(c){return Eh(c)?c:new Jj(c)}}),wm=Td(function(a,b){return i(Sc(b,1),function(b){b=Df(b),a[b]=Fl(a[b],a)}),a}),xm=Ke(),ym=Ke(!0),zm=Td(function(a,b){return function(c){return pd(c,a,b)}}),Am=Td(function(a,b){return function(c){return pd(a,c,b)}}),Bm=Oe(o),Cm=Oe(k),Dm=Oe(s),Em=Re(),Fm=Re(!0),Gm=Ne(function(a,b){return a+b},0),Hm=Ue("ceil"),Im=Ne(function(a,b){return a/b},1),Jm=Ue("floor"),Km=Ne(function(a,b){return a*b},1),Lm=Ue("round"),Mm=Ne(function(a,b){return a-b},0);return b.after=ah,b.ary=bh,b.assign=Zl,b.assignIn=$l,b.assignInWith=_l,b.assignWith=am,b.at=bm,b.before=ch,b.bind=Fl,b.bindAll=wm,b.bindKey=Gl,b.castArray=ph,b.chain=Ag,b.chunk=Hf,b.compact=If,b.concat=Jf,b.cond=dj,b.conforms=ej,b.constant=fj,b.countBy=wl,b.create=fi,b.curry=dh,b.curryRight=eh,b.debounce=fh,b.defaults=cm,b.defaultsDeep=dm,b.defer=Hl,b.delay=Il,b.difference=el,b.differenceBy=fl,b.differenceWith=gl,b.drop=Kf,b.dropRight=Lf,b.dropRightWhile=Mf,b.dropWhile=Nf,b.fill=Of,b.filter=Lg,b.flatMap=Mg,b.flatMapDeep=Ng,b.flatMapDepth=Og,b.flatten=Rf,b.flattenDeep=Sf,b.flattenDepth=Tf,b.flip=gh,b.flow=xm,b.flowRight=ym,b.fromPairs=Uf,b.functions=mi,b.functionsIn=ni,b.groupBy=zl,b.initial=Xf,b.intersection=hl,b.intersectionBy=il,b.intersectionWith=jl,b.invert=em,b.invertBy=fm,b.invokeMap=Al,b.iteratee=ij,b.keyBy=Bl,b.keys=ri,b.keysIn=si,b.map=Sg,b.mapKeys=ti,b.mapValues=ui,b.matches=jj,b.matchesProperty=kj,b.memoize=hh,b.merge=hm,b.mergeWith=im,b.method=zm,b.methodOf=Am,b.mixin=lj,b.negate=ih,b.nthArg=oj,b.omit=jm,b.omitBy=vi,b.once=jh,b.orderBy=Tg,b.over=Bm,b.overArgs=Jl,b.overEvery=Cm,b.overSome=Dm,b.partial=Kl,b.partialRight=Ll,b.partition=Cl,b.pick=km,b.pickBy=wi,b.property=pj,b.propertyOf=qj,b.pull=kl,b.pullAll=ag,b.pullAllBy=bg,b.pullAllWith=cg,b.pullAt=ll,b.range=Em,b.rangeRight=Fm,b.rearg=Ml,b.reject=Wg,b.remove=dg,b.rest=kh,b.reverse=eg,b.sampleSize=Yg,b.set=yi,b.setWith=zi,b.shuffle=Zg,b.slice=fg,b.sortBy=Dl,b.sortedUniq=mg,b.sortedUniqBy=ng,b.split=Ui,b.spread=lh,b.tail=og,b.take=pg,b.takeRight=qg,b.takeRightWhile=rg,b.takeWhile=sg,b.tap=Bg,b.throttle=mh,b.thru=Cg,b.toArray=Zh,b.toPairs=lm,b.toPairsIn=mm,b.toPath=xj,b.toPlainObject=ci,b.transform=Ai,b.unary=nh,b.union=ml,b.unionBy=nl,b.unionWith=ol,b.uniq=tg,b.uniqBy=ug,b.uniqWith=vg,b.unset=Bi,b.unzip=wg,b.unzipWith=xg,b.update=Ci,b.updateWith=Di,b.values=Ei,b.valuesIn=Fi,b.without=pl,b.words=cj,b.wrap=oh,b.xor=ql,b.xorBy=rl,b.xorWith=sl,b.zip=tl,b.zipObject=yg,b.zipObjectDeep=zg,b.zipWith=ul,b.entries=lm,b.entriesIn=mm,b.extend=$l,b.extendWith=_l,lj(b,b),b.add=Gm,b.attempt=vm,b.camelCase=nm,b.capitalize=Ji,b.ceil=Hm,b.clamp=Gi,b.clone=qh,b.cloneDeep=sh,b.cloneDeepWith=th,b.cloneWith=rh,b.conformsTo=uh,b.deburr=Ki,b.defaultTo=gj,b.divide=Im,b.endsWith=Li,b.eq=vh,b.escape=Mi,b.escapeRegExp=Ni,b.every=Kg,b.find=xl,b.findIndex=Pf,b.findKey=gi,b.findLast=yl,b.findLastIndex=Qf,b.findLastKey=hi,b.floor=Jm,b.forEach=Pg,b.forEachRight=Qg,b.forIn=ii,b.forInRight=ji,b.forOwn=ki,b.forOwnRight=li,b.get=oi,b.gt=Nl,b.gte=Ol,b.has=pi,b.hasIn=qi,b.head=Vf,b.identity=hj,b.includes=Rg,b.indexOf=Wf,b.inRange=Hi,b.invoke=gm,b.isArguments=wh,b.isArray=Pl,b.isArrayBuffer=Ql,b.isArrayLike=xh,b.isArrayLikeObject=yh,b.isBoolean=zh,b.isBuffer=Rl,b.isDate=Sl,b.isElement=Ah,b.isEmpty=Bh,b.isEqual=Ch,b.isEqualWith=Dh,b.isError=Eh,b.isFinite=Fh,b.isFunction=Gh,b.isInteger=Hh,b.isLength=Ih,b.isMap=Tl,b.isMatch=Lh,b.isMatchWith=Mh,b.isNaN=Nh,b.isNative=Oh,b.isNil=Qh,b.isNull=Ph,b.isNumber=Rh,b.isObject=Jh,b.isObjectLike=Kh,b.isPlainObject=Sh,b.isRegExp=Ul,b.isSafeInteger=Th,b.isSet=Vl,b.isString=Uh,b.isSymbol=Vh,b.isTypedArray=Wl,b.isUndefined=Wh,b.isWeakMap=Xh,b.isWeakSet=Yh,b.join=Yf,b.kebabCase=om,b.last=Zf,b.lastIndexOf=$f,b.lowerCase=pm,b.lowerFirst=qm,b.lt=Xl,b.lte=Yl,b.max=zj,b.maxBy=Aj,b.mean=Bj,b.meanBy=Cj,b.min=Dj,b.minBy=Ej,b.stubArray=rj,b.stubFalse=sj,b.stubObject=tj,b.stubString=uj,b.stubTrue=vj,b.multiply=Km,b.nth=_f,b.noConflict=mj,b.noop=nj,b.now=El,b.pad=Oi,b.padEnd=Pi,b.padStart=Qi,b.parseInt=Ri,b.random=Ii,b.reduce=Ug,b.reduceRight=Vg,b.repeat=Si,b.replace=Ti,b.result=xi,b.round=Lm,b.runInContext=ca,b.sample=Xg,b.size=$g,b.snakeCase=rm,b.some=_g,b.sortedIndex=gg,b.sortedIndexBy=hg,b.sortedIndexOf=ig,b.sortedLastIndex=jg,b.sortedLastIndexBy=kg,b.sortedLastIndexOf=lg,b.startCase=sm,b.startsWith=Vi,b.subtract=Mm,b.sum=Fj,b.sumBy=Gj,b.template=Wi,b.times=wj,b.toFinite=$h,b.toInteger=_h,b.toLength=ai,b.toLower=Xi,b.toNumber=bi,b.toSafeInteger=di,b.toString=ei,b.toUpper=Yi,b.trim=Zi,b.trimEnd=$i,b.trimStart=_i,b.truncate=aj,b.unescape=bj,b.uniqueId=yj,b.upperCase=tm,b.upperFirst=um,b.each=Pg,b.eachRight=Qg,b.first=Vf,lj(b,function(){var a={};return Tc(b,function(c,d){Wj.call(b.prototype,d)||(a[d]=c)}),a}(),{chain:!1}),b.VERSION=ea,i(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){b[a].placeholder=b}),i(["drop","take"],function(a,b){t.prototype[a]=function(c){var d=this.__filtered__;if(d&&!b)return new t(this);c=c===da?1:tk(_h(c),0);var e=this.clone();return d?e.__takeCount__=uk(c,e.__takeCount__):e.__views__.push({size:uk(c,Ga),type:a+(e.__dir__<0?"Right":"")}),e},t.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),i(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==za||c==Ba;t.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:cf(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),i(["head","last"],function(a,b){var c="take"+(b?"Right":"");t.prototype[a]=function(){return this[c](1).value()[0]}}),i(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");t.prototype[a]=function(){return this.__filtered__?new t(this):this[c](1)}}),t.prototype.compact=function(){return this.filter(hj)},t.prototype.find=function(a){return this.filter(a).head()},t.prototype.findLast=function(a){return this.reverse().find(a)},t.prototype.invokeMap=Td(function(a,b){return"function"==typeof a?new t(this):this.map(function(c){return pd(c,a,b)})}),t.prototype.reject=function(a){return this.filter(ih(cf(a)))},t.prototype.slice=function(a,b){a=_h(a);var c=this;return c.__filtered__&&(a>0||b<0)?new t(c):(a<0?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==da&&(b=_h(b),c=b<0?c.dropRight(-b):c.take(b-a)),c)},t.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},t.prototype.toArray=function(){return this.take(Ga)},Tc(t.prototype,function(a,c){var e=/^(?:filter|find|map|reject)|While$/.test(c),f=/^(?:head|last)$/.test(c),g=b[f?"take"+("last"==c?"Right":""):c],h=f||/^find/.test(c);g&&(b.prototype[c]=function(){var c=this.__wrapped__,i=f?[1]:arguments,j=c instanceof t,k=i[0],l=j||Pl(c),m=function(a){var c=g.apply(b,p([a],i));return f&&n?c[0]:c};l&&e&&"function"==typeof k&&1!=k.length&&(j=l=!1);var n=this.__chain__,o=!!this.__actions__.length,q=h&&!n,r=j&&!o;if(!h&&l){c=r?c:new t(this);var s=a.apply(c,i);return s.__actions__.push({func:Cg,args:[m],thisArg:da}),new d(s,n)}return q&&r?a.apply(this,i):(s=this.thru(m),q?f?s.value()[0]:s.value():s)})}),i(["pop","push","shift","sort","splice","unshift"],function(a){var c=Qj[a],d=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",e=/^(?:pop|shift)$/.test(a);b.prototype[a]=function(){var a=arguments;if(e&&!this.__chain__){var b=this.value();return c.apply(Pl(b)?b:[],a)}return this[d](function(b){return c.apply(Pl(b)?b:[],a)})}}),Tc(t.prototype,function(a,c){var d=b[c];if(d){var e=d.name+"",f=Hk[e]||(Hk[e]=[]);f.push({name:c,func:d})}}),Hk[Le(da,ka).name]=[{name:"wrapper",func:da}],t.prototype.clone=C,t.prototype.reverse=_,t.prototype.value=aa,b.prototype.at=vl,b.prototype.chain=Dg,b.prototype.commit=Eg,b.prototype.next=Fg,b.prototype.plant=Hg,b.prototype.reverse=Ig,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=Jg,b.prototype.first=b.prototype.head,ek&&(b.prototype[ek]=Gg),b}var da,ea="4.15.0",fa=200,ga="Expected a function",ha="__lodash_hash_undefined__",ia="__lodash_placeholder__",ja=1,ka=2,la=4,ma=8,na=16,oa=32,pa=64,qa=128,ra=256,sa=512,ta=1,ua=2,va=30,wa="...",xa=150,ya=16,za=1,Aa=2,Ba=3,Ca=1/0,Da=9007199254740991,Ea=1.7976931348623157e308,Fa=NaN,Ga=4294967295,Ha=Ga-1,Ia=Ga>>>1,Ja=[["ary",qa],["bind",ja],["bindKey",ka],["curry",ma],["curryRight",na],["flip",sa],["partial",oa],["partialRight",pa],["rearg",ra]],Ka="[object Arguments]",La="[object Array]",Ma="[object Boolean]",Na="[object Date]",Oa="[object Error]",Pa="[object Function]",Qa="[object GeneratorFunction]",Ra="[object Map]",Sa="[object Number]",Ta="[object Object]",Ua="[object Promise]",Va="[object RegExp]",Wa="[object Set]",Xa="[object String]",Ya="[object Symbol]",Za="[object WeakMap]",$a="[object WeakSet]",_a="[object ArrayBuffer]",ab="[object DataView]",bb="[object Float32Array]",cb="[object Float64Array]",db="[object Int8Array]",eb="[object Int16Array]",fb="[object Int32Array]",gb="[object Uint8Array]",hb="[object Uint8ClampedArray]",ib="[object Uint16Array]",jb="[object Uint32Array]",kb=/\b__p \+= '';/g,lb=/\b(__p \+=) '' \+/g,mb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,nb=/&(?:amp|lt|gt|quot|#39|#96);/g,ob=/[&<>"'`]/g,pb=RegExp(nb.source),qb=RegExp(ob.source),rb=/<%-([\s\S]+?)%>/g,sb=/<%([\s\S]+?)%>/g,tb=/<%=([\s\S]+?)%>/g,ub=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vb=/^\w*$/,wb=/^\./,xb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yb=/[\\^$.*+?()[\]{}|]/g,zb=RegExp(yb.source),Ab=/^\s+|\s+$/g,Bb=/^\s+/,Cb=/\s+$/,Db=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Eb=/\{\n\/\* \[wrapped with (.+)\] \*/,Fb=/,? & /,Gb=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hb=/\\(\\)?/g,Ib=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Jb=/\w*$/,Kb=/^0x/i,Lb=/^[-+]0x[0-9a-f]+$/i,Mb=/^0b[01]+$/i,Nb=/^\[object .+?Constructor\]$/,Ob=/^0o[0-7]+$/i,Pb=/^(?:0|[1-9]\d*)$/,Qb=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Rb=/($^)/,Sb=/['\n\r\u2028\u2029\\]/g,Tb="\\ud800-\\udfff",Ub="\\u0300-\\u036f\\ufe20-\\ufe23",Vb="\\u20d0-\\u20f0",Wb="\\u2700-\\u27bf",Xb="a-z\\xdf-\\xf6\\xf8-\\xff",Yb="\\xac\\xb1\\xd7\\xf7",Zb="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$b="\\u2000-\\u206f",_b=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ac="A-Z\\xc0-\\xd6\\xd8-\\xde",bc="\\ufe0e\\ufe0f",cc=Yb+Zb+$b+_b,dc="[']",ec="["+Tb+"]",fc="["+cc+"]",gc="["+Ub+Vb+"]",hc="\\d+",ic="["+Wb+"]",jc="["+Xb+"]",kc="[^"+Tb+cc+hc+Wb+Xb+ac+"]",lc="\\ud83c[\\udffb-\\udfff]",mc="(?:"+gc+"|"+lc+")",nc="[^"+Tb+"]",oc="(?:\\ud83c[\\udde6-\\uddff]){2}",pc="[\\ud800-\\udbff][\\udc00-\\udfff]",qc="["+ac+"]",rc="\\u200d",sc="(?:"+jc+"|"+kc+")",tc="(?:"+qc+"|"+kc+")",uc="(?:"+dc+"(?:d|ll|m|re|s|t|ve))?",vc="(?:"+dc+"(?:D|LL|M|RE|S|T|VE))?",wc=mc+"?",xc="["+bc+"]?",yc="(?:"+rc+"(?:"+[nc,oc,pc].join("|")+")"+xc+wc+")*",zc=xc+wc+yc,Ac="(?:"+[ic,oc,pc].join("|")+")"+zc,Bc="(?:"+[nc+gc+"?",gc,oc,pc,ec].join("|")+")",Cc=RegExp(dc,"g"),Dc=RegExp(gc,"g"),Ec=RegExp(lc+"(?="+lc+")|"+Bc+zc,"g"),Fc=RegExp([qc+"?"+jc+"+"+uc+"(?="+[fc,qc,"$"].join("|")+")",tc+"+"+vc+"(?="+[fc,qc+sc,"$"].join("|")+")",qc+"?"+sc+"+"+uc,qc+"+"+vc,hc,Ac].join("|"),"g"),Gc=RegExp("["+rc+Tb+Ub+Vb+bc+"]"),Hc=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ic=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jc=-1,Kc={};Kc[bb]=Kc[cb]=Kc[db]=Kc[eb]=Kc[fb]=Kc[gb]=Kc[hb]=Kc[ib]=Kc[jb]=!0,Kc[Ka]=Kc[La]=Kc[_a]=Kc[Ma]=Kc[ab]=Kc[Na]=Kc[Oa]=Kc[Pa]=Kc[Ra]=Kc[Sa]=Kc[Ta]=Kc[Va]=Kc[Wa]=Kc[Xa]=Kc[Za]=!1;var Lc={};Lc[Ka]=Lc[La]=Lc[_a]=Lc[ab]=Lc[Ma]=Lc[Na]=Lc[bb]=Lc[cb]=Lc[db]=Lc[eb]=Lc[fb]=Lc[Ra]=Lc[Sa]=Lc[Ta]=Lc[Va]=Lc[Wa]=Lc[Xa]=Lc[Ya]=Lc[gb]=Lc[hb]=Lc[ib]=Lc[jb]=!0,Lc[Oa]=Lc[Pa]=Lc[Za]=!1;var Mc={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"ss"},Nc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Oc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Pc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Qc=parseFloat,Rc=parseInt,Sc="object"==typeof a&&a&&a.Object===Object&&a,Tc="object"==typeof self&&self&&self.Object===Object&&self,Uc=Sc||Tc||Function("return this")(),Vc="object"==typeof d&&d&&!d.nodeType&&d,Wc=Vc&&"object"==typeof c&&c&&!c.nodeType&&c,Xc=Wc&&Wc.exports===Vc,Yc=Xc&&Sc.process,Zc=function(){try{return Yc&&Yc.binding("util")}catch(a){}}(),$c=Zc&&Zc.isArrayBuffer,_c=Zc&&Zc.isDate,ad=Zc&&Zc.isMap,bd=Zc&&Zc.isRegExp,cd=Zc&&Zc.isSet,dd=Zc&&Zc.isTypedArray,ed=B("length"),fd=C(Mc),gd=C(Nc),hd=C(Oc),id=ca();"function"==typeof b&&"object"==typeof b.amd&&b.amd?(Uc._=id,b(function(){return id})):Wc?((Wc.exports=id)._=id,Vc._=id):Uc._=id}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],146:[function(a,b,c){function d(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new TypeError(f);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g),g};return c.cache=new(d.Cache||e),c}var e=a("./_MapCache"),f="Expected a function";d.Cache=e,b.exports=d},{"./_MapCache":30}],147:[function(a,b,c){function d(a){return g(a)?e(h(a)):f(a)}var e=a("./_baseProperty"),f=a("./_basePropertyDeep"),g=a("./_isKey"),h=a("./_toKey");b.exports=d},{"./_baseProperty":62,"./_basePropertyDeep":63,"./_isKey":92,"./_toKey":123}],148:[function(a,b,c){function d(){return!1}b.exports=d},{}],149:[function(a,b,c){function d(a){return null==a?"":e(a)}var e=a("./_baseToString");b.exports=d},{"./_baseToString":66}],150:[function(a,b,c){function d(a,b,d,g,i,j){var o=i,r=j-i,s=0;if(a.length>=e)throw new Error("input too large");if(a.length>k){var t=c.compressBound(a.length);if(r<t)throw Error("output too small: "+r+" < "+t);for(var u=1,v=(1<<l)+3,w=a.length-k;d+f<w;){var x=a[d+1]<<8|a[d],y=a[d+3]<<8|a[d+2],z=Math.imul(x|y<<16,q)>>>h,A=g[z]-1;if(g[z]=d+1,A<0||d-A>>>16>0||(a[A+3]<<8|a[A+2])!=y||(a[A+1]<<8|a[A])!=x)u=v++>>l,d+=u;else{v=(1<<l)+3;var B=d-s,C=d-A;d+=f,A+=f;for(var D=d;d<w&&a[d]==a[A];)d++,A++;D=d-D;var E=D<n?D:n;if(B>=p){b[o++]=(p<<m)+E;for(var F=B-p;F>254;F-=255)b[o++]=255;b[o++]=F}else b[o++]=(B<<m)+E;for(var G=0;G<B;G++)b[o++]=a[s+G];if(b[o++]=C,b[o++]=C>>8,D>=n){for(D-=n;D>=255;)D-=255,b[o++]=255;b[o++]=D}s=d}}}if(0==s)return 0;if(B=a.length-s,B>=p){b[o++]=p<<m;for(var H=B-p;H>254;H-=255)b[o++]=255;b[o++]=H}else b[o++]=B<<m;for(d=s;d<a.length;)b[o++]=a[d++];return o}a("cuint").UINT32;Math.imul||(Math.imul=function(a,b){var c=a>>>16,d=65535&a,e=b>>>16,f=65535&b;return d*f+(c*f+d*e<<16)|0}),c.uncompress=function(a,b,c,d){c=c||0,d=d||a.length-c;for(var e=c,f=d,g=0;e<f;){var h=a[e++],i=h>>4;if(i>0){for(var j=i+240;255===j;)j=a[e++],i+=j;for(var k=e+i;e<k;)b[g++]=a[e++];if(e===f)return g}var l=a[e++]|a[e++]<<8;if(0===l||l>g)return-(e-2);for(var m=15&h,j=m+240;255===j;)j=a[e++],m+=j;for(var n=g-l,k=g+m+4;g<k;)b[g++]=b[n++]}return g};var e=2113929216,f=4,g=16,h=8*f-g,i=1<<g,j=8,k=j+f,l=6,m=4,n=(1<<m)-1,o=8-m,p=(1<<o)-1,q=2654435761;c.compressBound=function(a){return a>e?0:a+a/255+16|0},c.compress=function(a,b,c,e){for(var f=new Array(i),g=0;g<i;g++)f[g]=0;return d(a,b,0,f,c||0,e||b.length)},c.compressHC=c.compress,c.compressDependent=d},{cuint:8}],151:[function(a,b,c){(function(b){function d(a,c){var d=[],f=new e(c);return f.on("data",function(a){d.push(a)}),f.end(a),b.concat(d)}var e=a("./decoder_stream");c.LZ4_uncompress=d}).call(this,a("buffer").Buffer)},{"./decoder_stream":152,buffer:6}],152:[function(a,b,c){(function(c){function d(a){return this instanceof d?(e.call(this,a),this.options=a||{},this.binding=this.options.useJS?j:i,this.buffer=null,this.pos=0,this.descriptor=null,this.state=k.MAGIC,this.notEnoughData=!1,this.descriptorStart=0,this.streamSize=null,this.dictId=null,this.currentStreamChecksum=null,this.dataBlockSize=0,void(this.skippableSize=0)):new d(a)}var e=a("stream").Transform,f=a("util").inherits,g=a("./static"),h=g.utils,i=h.bindings,j=a("./binding"),k=g.STATES,l=g.SIZES;f(d,e),d.prototype._transform=function(a,b,d){if(this.skippableSize>0){if(this.skippableSize-=a.length,this.skippableSize>0)return void d();a=a.slice(-this.skippableSize),this.skippableSize=0,this.state=k.MAGIC}this.buffer=this.buffer?c.concat([this.buffer,a],this.buffer.length+a.length):a,this._main(d)},d.prototype.emit_Error=function(a){this.emit("error",new Error(a+" @"+this.pos))},d.prototype.check_Size=function(a){var b=this.buffer.length-this.pos;return b<=0||b<a?(this.notEnoughData&&this.emit_Error("Unexpected end of LZ4 stream"),!0):(this.pos+=a,!1)},d.prototype.read_MagicNumber=function(){var a=this.pos;if(this.check_Size(l.MAGIC))return!0;var b=h.readInt32LE(this.buffer,a);return(4294967280&b)===g.MAGICNUMBER_SKIPPABLE?void(this.state=k.SKIP_SIZE):b!==g.MAGICNUMBER?(this.pos=a,this.emit_Error("Invalid magic number: "+b.toString(16).toUpperCase()),!0):void(this.state=k.DESCRIPTOR)},d.prototype.read_SkippableSize=function(){var a=this.pos;return!!this.check_Size(l.SKIP_SIZE)||(this.state=k.SKIP_DATA,void(this.skippableSize=h.readInt32LE(this.buffer,a)))},d.prototype.read_Descriptor=function(){var a=this.pos;if(this.check_Size(l.DESCRIPTOR))return!0;this.descriptorStart=a;var b=this.buffer[a],c=b>>6;if(c!==g.VERSION)return this.pos=a,this.emit_Error("Invalid version: "+c+" != "+g.VERSION),!0;if(b>>1&1)return this.pos=a,this.emit_Error("Reserved bit set"),!0;var d=this.buffer[a+1]>>4&7,e=g.blockMaxSizes[d];return null===e?(this.pos=a,this.emit_Error("Invalid block max size: "+d),!0):(this.descriptor={blockIndependence:Boolean(b>>5&1),blockChecksum:Boolean(b>>4&1),blockMaxSize:e,streamSize:Boolean(b>>3&1),streamChecksum:Boolean(b>>2&1),dict:Boolean(1&b),dictId:0},void(this.state=k.SIZE))},d.prototype.read_Size=function(){if(this.descriptor.streamSize){var a=this.pos;if(this.check_Size(l.SIZE))return!0;this.streamSize=this.buffer.slice(a,a+8)}this.state=k.DICTID},d.prototype.read_DictId=function(){if(this.descriptor.dictId){var a=this.pos;if(this.check_Size(l.DICTID))return!0;this.dictId=h.readInt32LE(this.buffer,a)}this.state=k.DESCRIPTOR_CHECKSUM},d.prototype.read_DescriptorChecksum=function(){var a=this.pos;if(this.check_Size(l.DESCRIPTOR_CHECKSUM))return!0;var b=this.buffer[a],c=h.descriptorChecksum(this.buffer.slice(this.descriptorStart,a));return c!==b?(this.pos=a,this.emit_Error("Invalid stream descriptor checksum"),!0):void(this.state=k.DATABLOCK_SIZE)},d.prototype.read_DataBlockSize=function(){var a=this.pos;if(this.check_Size(l.DATABLOCK_SIZE))return!0;var b=h.readInt32LE(this.buffer,a);return b===g.EOS?void(this.state=k.EOS):(this.dataBlockSize=b,void(this.state=k.DATABLOCK_DATA))},d.prototype.read_DataBlockData=function(){var a=this.pos,b=this.dataBlockSize;return 2147483648&b&&(b=2147483647&b),!!this.check_Size(b)||(this.dataBlock=this.buffer.slice(a,a+b),void(this.state=k.DATABLOCK_CHECKSUM))},d.prototype.read_DataBlockChecksum=function(){var a=this.pos;if(this.descriptor.blockChecksum){if(this.check_Size(l.DATABLOCK_CHECKSUM))return!0;var b=h.readInt32LE(this.buffer,this.pos-4),c=h.blockChecksum(this.dataBlock);if(c!==b)return this.pos=a,this.emit_Error("Invalid block checksum"),!0}this.state=k.DATABLOCK_UNCOMPRESS},d.prototype.uncompress_DataBlock=function(){var a;if(2147483648&this.dataBlockSize)a=this.dataBlock;else{a=new c(this.descriptor.blockMaxSize);var b=this.binding.uncompress(this.dataBlock,a);if(b<0)return this.emit_Error("Invalid data block: "+-b),!0;b<this.descriptor.blockMaxSize&&(a=a.slice(0,b))}this.dataBlock=null,this.push(a),this.descriptor.streamChecksum&&(this.currentStreamChecksum=h.streamChecksum(a,this.currentStreamChecksum)),this.state=k.DATABLOCK_SIZE},d.prototype.read_EOS=function(){if(this.descriptor.streamChecksum){var a=this.pos;if(this.check_Size(l.EOS))return!0;var b=h.readInt32LE(this.buffer,a);if(b!==h.streamChecksum(null,this.currentStreamChecksum))return this.pos=a,this.emit_Error("Invalid stream checksum: "+b.toString(16).toUpperCase()),!0}this.state=k.MAGIC},d.prototype._flush=function(a){this.notEnoughData=!0,this._main(a)},d.prototype._main=function(a){for(var b,c=this.pos;!b&&this.pos<this.buffer.length;)this.state===k.MAGIC&&(b=this.read_MagicNumber()),this.state===k.SKIP_SIZE&&(b=this.read_SkippableSize()),this.state===k.DESCRIPTOR&&(b=this.read_Descriptor()),this.state===k.SIZE&&(b=this.read_Size()),this.state===k.DICTID&&(b=this.read_DictId()),this.state===k.DESCRIPTOR_CHECKSUM&&(b=this.read_DescriptorChecksum()),this.state===k.DATABLOCK_SIZE&&(b=this.read_DataBlockSize()),this.state===k.DATABLOCK_DATA&&(b=this.read_DataBlockData()),this.state===k.DATABLOCK_CHECKSUM&&(b=this.read_DataBlockChecksum()),this.state===k.DATABLOCK_UNCOMPRESS&&(b=this.uncompress_DataBlock()),this.state===k.EOS&&(b=this.read_EOS());this.pos>c&&(this.buffer=this.buffer.slice(this.pos),this.pos=0),a()},b.exports=d}).call(this,a("buffer").Buffer)},{"./binding":150,"./static":156,buffer:6,stream:187,util:212}],153:[function(a,b,c){(function(b){function d(a,c){var d=[],f=new e(c);return f.on("data",function(a){d.push(a)}),f.end(a),b.concat(d)}var e=a("./encoder_stream");c.LZ4_compress=d}).call(this,a("buffer").Buffer)},{"./encoder_stream":154,buffer:6}],154:[function(a,b,c){(function(c){function d(a){if(!(this instanceof d))return new d(a);e.call(this,a);var b=a||m;b!==m&&Object.keys(m).forEach(function(a){b.hasOwnProperty(a)||(b[a]=m[a])}),this.options=b,this.binding=this.options.useJS?j:i,this.compress=b.highCompression?this.binding.compressHC:this.binding.compress;var c=0;c|=g.VERSION<<6,c|=(1&b.blockIndependence)<<5,c|=(1&b.blockChecksum)<<4,c|=(1&b.streamSize)<<3,c|=(1&b.streamChecksum)<<2,c|=1&b.dict;var f=g.blockMaxSizes.indexOf(b.blockMaxSize);if(f<0)throw new Error("Invalid blockMaxSize: "+b.blockMaxSize);this.descriptor={flg:c,bd:(7&f)<<4},this.buffer=[],this.length=0,this.first=!0,this.checksum=null}var e=a("stream").Transform,f=a("util").inherits,g=a("./static"),h=g.utils,i=h.bindings,j=a("./binding"),k=g.STATES,l=g.SIZES,m={blockIndependence:!0,blockChecksum:!1,blockMaxSize:4<<20,streamSize:!1,streamChecksum:!0,dict:!1,dictId:0,highCompression:!1};f(d,e),d.prototype.headerSize=function(){var a=this.options.streamSize?l.DESCRIPTOR:0,b=this.options.dict?l.DICTID:0;return l.MAGIC+1+1+a+b+1},d.prototype.header=function(){var a=this.headerSize(),b=new c(a);this.state=k.MAGIC,b.writeInt32LE(g.MAGICNUMBER,0,!0),this.state=k.DESCRIPTOR;var d=b.slice(l.MAGIC,b.length-1);d.writeUInt8(this.descriptor.flg,0,!0),d.writeUInt8(this.descriptor.bd,1,!0);var e=2;return this.state=k.SIZE,this.options.streamSize&&(d.writeInt32LE(0,e,!0),d.writeInt32LE(this.size,e+4,!0),e+=l.SIZE),this.state=k.DICTID,this.options.dict&&(d.writeInt32LE(this.dictId,e,!0),e+=l.DICTID),this.state=k.DESCRIPTOR_CHECKSUM,b.writeUInt8(h.descriptorChecksum(d),l.MAGIC+e,!1),b},d.prototype.update_Checksum=function(a){this.state=k.CHECKSUM_UPDATE,this.options.streamChecksum&&(this.checksum=h.streamChecksum(a,this.checksum))},d.prototype.compress_DataBlock=function(a){this.state=k.DATABLOCK_COMPRESS;var b=this.options.blockChecksum?l.DATABLOCK_CHECKSUM:0,d=this.binding.compressBound(a.length),e=new c(l.DATABLOCK_SIZE+d+b),f=e.slice(l.DATABLOCK_SIZE,l.DATABLOCK_SIZE+d),g=this.compress(a,f);if(this.state=k.DATABLOCK_SIZE,g>0&&g<=this.options.blockMaxSize?(e.writeUInt32LE(g,0,!0),e=e.slice(0,l.DATABLOCK_SIZE+g+b)):(e.writeInt32LE(2147483648|a.length,0,!0),e=e.slice(0,l.DATABLOCK_SIZE+a.length+b),a.copy(e,l.DATABLOCK_SIZE)),this.state=k.DATABLOCK_CHECKSUM,this.options.blockChecksum){var i=e.slice(-b);i.writeInt32LE(h.blockChecksum(f),0,!0)}return this.update_Checksum(a),this.size+=a.length,e},d.prototype._transform=function(a,b,d){a&&(this.buffer.push(a),this.length+=a.length),this.first&&(this.push(this.header()),this.first=!1);var e=this.options.blockMaxSize;if(this.length<e)return d();for(var f=c.concat(this.buffer,this.length),g=0,h=f.length;h>=e;h-=e,g+=e)this.push(this.compress_DataBlock(f.slice(g,g+e)));h>0?(this.buffer=[f.slice(g)],this.length=this.buffer[0].length):(this.buffer=[],this.length=0),d()},d.prototype._flush=function(a){if(this.first&&(this.push(this.header()),this.first=!1),this.length>0){var b=c.concat(this.buffer,this.length);this.buffer=[],this.length=0;var d=this.compress_DataBlock(b);this.push(d)}if(this.options.streamChecksum){this.state=k.CHECKSUM;var e=new c(l.EOS+l.CHECKSUM);e.writeInt32LE(h.streamChecksum(null,this.checksum),l.EOS,!0)}else var e=new c(l.EOS);this.state=k.EOS,e.writeInt32LE(g.EOS,0,!0),this.push(e),a()},b.exports=d}).call(this,a("buffer").Buffer)},{"./binding":150,"./static":156,buffer:6,stream:187,util:212}],155:[function(a,b,c){b.exports=a("./static"),b.exports.version="0.5.1",b.exports.createDecoderStream=a("./decoder_stream"),b.exports.decode=a("./decoder").LZ4_uncompress,b.exports.createEncoderStream=a("./encoder_stream"),b.exports.encode=a("./encoder").LZ4_compress;var d=b.exports.utils.bindings;b.exports.decodeBlock=d.uncompress,b.exports.encodeBound=d.compressBound,b.exports.encodeBlock=d.compress,b.exports.encodeBlockHC=d.compressHC},{"./decoder":151,"./decoder_stream":152,"./encoder":153,"./encoder_stream":154,"./static":156}],156:[function(a,b,c){(function(b){c.MAGICNUMBER=407708164,c.MAGICNUMBER_BUFFER=new b(4),c.MAGICNUMBER_BUFFER.writeUInt32LE(c.MAGICNUMBER,0,!1),c.EOS=0,c.EOS_BUFFER=new b(4),c.EOS_BUFFER.writeUInt32LE(c.EOS,0,!1),c.VERSION=1,c.MAGICNUMBER_SKIPPABLE=407710288,c.blockMaxSizes=[null,null,null,null,65536,262144,1<<20,4<<20],c.extension=".lz4",c.STATES={MAGIC:0,DESCRIPTOR:1,SIZE:2,DICTID:3,DESCRIPTOR_CHECKSUM:4,DATABLOCK_SIZE:5,DATABLOCK_DATA:6,DATABLOCK_CHECKSUM:7,DATABLOCK_UNCOMPRESS:8,DATABLOCK_COMPRESS:9,CHECKSUM:10,CHECKSUM_UPDATE:11,EOS:90,SKIP_SIZE:101,SKIP_DATA:102},c.SIZES={MAGIC:4,DESCRIPTOR:2,SIZE:8,DICTID:4,DESCRIPTOR_CHECKSUM:1,DATABLOCK_SIZE:4,DATABLOCK_CHECKSUM:4,CHECKSUM:4,EOS:4,SKIP_SIZE:4},c.utils=a("./utils")}).call(this,a("buffer").Buffer)},{"./utils":157,buffer:6}],157:[function(a,b,c){var d=a("xxhashjs"),e=0;c.descriptorChecksum=function(a){return d(a,e).toNumber()>>8&255},c.blockChecksum=function(a){return d(a,e).toNumber()},c.streamChecksum=function(a,b){return null===a?b.digest().toNumber():(null===b&&(b=d(e)),b.update(a))},c.readInt32LE=function(a,b){return a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24},c.bindings=a("./binding")},{"./binding":150,xxhashjs:241}],158:[function(a,b,c){b.exports.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"reserved"},b.exports.codes={};for(var d in b.exports.types){var e=b.exports.types[d];b.exports.codes[e]=d}b.exports.CMD_SHIFT=4,b.exports.CMD_MASK=240,b.exports.DUP_MASK=8,b.exports.QOS_MASK=3,b.exports.QOS_SHIFT=1,b.exports.RETAIN_MASK=1,b.exports.LENGTH_MASK=127,b.exports.LENGTH_FIN_MASK=128,b.exports.SESSIONPRESENT_MASK=1,b.exports.USERNAME_MASK=128,b.exports.PASSWORD_MASK=64,b.exports.WILL_RETAIN_MASK=32,b.exports.WILL_QOS_MASK=24,b.exports.WILL_QOS_SHIFT=3,b.exports.WILL_FLAG_MASK=4,
b.exports.CLEAN_SESSION_MASK=2},{}],159:[function(a,b,c){(function(c){"use strict";function d(a){switch(a.cmd){case"connect":return e(a);case"connack":return f(a);case"publish":return g(a);case"puback":case"pubrec":case"pubrel":case"pubcomp":case"unsuback":return h(a);case"subscribe":return i(a);case"suback":return j(a);case"unsubscribe":return k(a);case"pingreq":case"pingresp":case"disconnect":return l(a);default:throw new Error("unknown command")}}function e(a){var a=a||{},b=a.protocolId||"MQTT",d=a.protocolVersion||4,e=a.will,f=a.clean,g=a.keepalive||0,h=a.clientId||"",i=a.username,j=a.password;void 0===f&&(f=!0);var k=0;if(!b||"string"!=typeof b&&!c.isBuffer(b))throw new Error("Invalid protocol id");if(k+=b.length+2,!d||"number"!=typeof d||d>255||d<0)throw new Error("Invalid protocol version");if(k+=1,"string"!=typeof h&&!c.isBuffer(h)||!h&&4!=d||!h&&!f){if(d<4)throw new Error("clientId must be supplied before 3.1.1");if(0==f)throw new Error("clientId must be given if cleanSession set to 0")}else k+=h.length+2;if("number"!=typeof g||g<0||g>65535)throw new Error("Invalid keepalive");if(k+=2,k+=1,e){if("object"!=typeof e)throw new Error("Invalid will");if(!e.topic||"string"!=typeof e.topic)throw new Error("Invalid will topic");if(k+=c.byteLength(e.topic)+2,e.payload&&e.payload){if(!(e.payload.length>=0))throw new Error("Invalid will payload");k+="string"==typeof e.payload?c.byteLength(e.payload)+2:e.payload.length+2}else k+=2}if(i){if(!i.length)throw new Error("Invalid username");k+=c.byteLength(i)+2}if(j){if(!j.length)throw new Error("Invalid password");k+=t(j)+2}var l=new c(1+m(k)+k),p=0;l.writeUInt8(u.codes.connect<<u.CMD_SHIFT,p++,!0),p+=n(l,p,k),p+=s(l,p,b),l.writeUInt8(d,p++,!0);var q=0;return q|=i?u.USERNAME_MASK:0,q|=j?u.PASSWORD_MASK:0,q|=e&&e.retain?u.WILL_RETAIN_MASK:0,q|=e&&e.qos?e.qos<<u.WILL_QOS_SHIFT:0,q|=e?u.WILL_FLAG_MASK:0,q|=f?u.CLEAN_SESSION_MASK:0,l.writeUInt8(q,p++,!0),p+=r(l,p,g),p+=s(l,p,h),e&&(p+=o(l,p,e.topic),p+=s(l,p,e.payload)),i&&(p+=s(l,p,i)),j&&(p+=s(l,p,j)),l}function f(a){var a=a||{},b=a.returnCode;if("number"!=typeof b)throw new Error("Invalid return code");var d=new c(4),e=0;return d.writeUInt8(u.codes.connack<<u.CMD_SHIFT,e++,!0),e+=n(d,e,2),d.writeUInt8(a.sessionPresent&&u.SESSIONPRESENT_MASK||0,e++,!0),d.writeUInt8(b,e++,!0),d}function g(a){var a=a||{},b=a.dup?u.DUP_MASK:0,d=a.qos,e=a.retain?u.RETAIN_MASK:0,f=a.topic,g=a.payload||v,h=a.messageId,i=0;if("string"==typeof f)i+=c.byteLength(f)+2;else{if(!c.isBuffer(f))throw new Error("Invalid topic");i+=f.length+2}if(i+=c.isBuffer(g)?g.length:c.byteLength(g),d&&"number"!=typeof h)throw new Error("Invalid message id");d&&(i+=2);var j=new c(1+m(i)+i),k=0;return j.writeUInt8(u.codes.publish<<u.CMD_SHIFT|b|d<<u.QOS_SHIFT|e,k++,!0),k+=n(j,k,i),k+=s(j,k,f),d>0&&(k+=r(j,k,h)),c.isBuffer(g)?q(j,k,g):p(j,k,g),j}function h(a){var a=a||{},b=a.cmd||"puback",d=a.messageId,e=a.dup&&"pubrel"===b?u.DUP_MASK:0,f=0;if("pubrel"===b&&(f=1),"number"!=typeof d)throw new Error("Invalid message id");var g=new c(4),h=0;return g[h++]=u.codes[b]<<u.CMD_SHIFT|e|f<<u.QOS_SHIFT,h+=n(g,h,2),h+=r(g,h,d),g}function i(a){var a=a||{},b=a.dup?u.DUP_MASK:0,d=a.qos||0,e=a.messageId,f=a.subscriptions,g=0;if("number"!=typeof e)throw new Error("Invalid message id");if(g+=2,"object"!=typeof f||!f.length)throw new Error("Invalid subscriptions");for(var h=0;h<f.length;h+=1){var i=f[h].topic,d=f[h].qos;if("string"!=typeof i)throw new Error("Invalid subscriptions - invalid topic");if("number"!=typeof d)throw new Error("Invalid subscriptions - invalid qos");g+=c.byteLength(i)+2+1}var j=new c(1+m(g)+g),k=0;j.writeUInt8(u.codes.subscribe<<u.CMD_SHIFT|b|1<<u.QOS_SHIFT,k++,!0),k+=n(j,k,g),k+=r(j,k,e);for(var h=0;h<f.length;h++){var l=f[h],i=l.topic,d=l.qos;k+=o(j,k,i),j.writeUInt8(d,k++,!0)}return j}function j(a){var a=a||{},b=a.messageId,d=a.granted,e=0;if("number"!=typeof b)throw new Error("Invalid message id");if(e+=2,"object"!=typeof d||!d.length)throw new Error("Invalid qos vector");for(var f=0;f<d.length;f+=1){if("number"!=typeof d[f])throw new Error("Invalid qos vector");e+=1}var g=new c(1+m(e)+e),h=0;g.writeUInt8(u.codes.suback<<u.CMD_SHIFT,h++,!0),h+=n(g,h,e),h+=r(g,h,b);for(var f=0;f<d.length;f++)g.writeUInt8(d[f],h++,!0);return g}function k(a){var a=a||{},b=a.messageId,d=a.dup?u.DUP_MASK:0,e=a.unsubscriptions,f=0;if("number"!=typeof b)throw new Error("Invalid message id");if(f+=2,"object"!=typeof e||!e.length)throw new Error("Invalid unsubscriptions");for(var g=0;g<e.length;g+=1){if("string"!=typeof e[g])throw new Error("Invalid unsubscriptions");f+=c.byteLength(e[g])+2}var h=new c(1+m(f)+f),i=0;h[i++]=u.codes.unsubscribe<<u.CMD_SHIFT|d|1<<u.QOS_SHIFT,i+=n(h,i,f),i+=r(h,i,b);for(var g=0;g<e.length;g++)i+=o(h,i,e[g]);return h}function l(a){var b=new c(2);return b[0]=u.codes[a.cmd]<<4,b[1]=0,b}function m(a){return a>=0&&a<128?1:a>=128&&a<16384?2:a>=16384&&a<2097152?3:a>=2097152&&a<268435456?4:0}function n(a,b,c){var d=0,e=b;do d=c%128|0,c=c/128|0,c>0&&(d=128|d),a.writeUInt8(d,b++,!0);while(c>0);return b-e}function o(a,b,d){var e=c.byteLength(d);return r(a,b,e),p(a,b+2,d),e+2}function p(a,b,c){a.write(c,b)}function q(a,b,c){return c.copy(a,b),c.length}function r(a,b,c){return a.writeUInt8(c>>8,b,!0),a.writeUInt8(255&c,b+1,!0),2}function s(a,b,c){var d=0;return c&&"string"==typeof c?d+=o(a,b+d,c):c?(d+=r(a,b+d,c.length),d+=q(a,b+d,c)):d+=r(a,b+d,0),d}function t(a){return c.isBuffer(a)?a.length:c.byteLength(a)}var u=a("./constants"),v=new c(0);b.exports=d}).call(this,a("buffer").Buffer)},{"./constants":158,buffer:6}],160:[function(a,b,c){"use strict";c.parser=a("./parser"),c.generate=a("./generate")},{"./generate":159,"./parser":162}],161:[function(a,b,c){function d(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}b.exports=d},{}],162:[function(a,b,c){function d(){return this instanceof d?(this._list=e(),this._newPacket(),this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],void(this._stateCounter=0)):new d}var e=a("bl"),f=a("inherits"),g=a("events").EventEmitter,h=a("./packet"),i=a("./constants");f(d,g),d.prototype._newPacket=function(){return this.packet&&(this._list.consume(this.packet.length),this.emit("packet",this.packet)),this.packet=new h,!0},d.prototype.parse=function(a){for(this._list.append(a);(this.packet.length!=-1||this._list.length>0)&&this[this._states[this._stateCounter]]();)this._stateCounter++,this._stateCounter>=this._states.length&&(this._stateCounter=0);return this._list.length},d.prototype._parseHeader=function(){var a=this._list.readUInt8(0);return this.packet.cmd=i.types[a>>i.CMD_SHIFT],this.packet.retain=0!==(a&i.RETAIN_MASK),this.packet.qos=a>>i.QOS_SHIFT&i.QOS_MASK,this.packet.dup=0!==(a&i.DUP_MASK),this._list.consume(1),!0},d.prototype._parseLength=function(){for(var a,b=0,c=1,d=0,e=!0;b<5&&(a=this._list.readUInt8(b++),d+=c*(a&i.LENGTH_MASK),c*=128,0!==(a&i.LENGTH_FIN_MASK));)if(this._list.length<=b){e=!1;break}return e&&(this.packet.length=d,this._list.consume(b)),e},d.prototype._parsePayload=function(){var a=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseMessageId();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":case"disconnect":break;default:this.emit("error",new Error("not supported"))}a=!0}return a},d.prototype._parseConnect=function(){var a,b,c,d,e,f,g={},h=this.packet;if(a=this._parseString(),null===a)return this.emit("error",new Error("cannot parse protocol id"));if("MQTT"!=a&&"MQIsdp"!=a)return this.emit("error",new Error("invalid protocol id"));if(h.protocolId=a,this._pos>=this._list.length)return this.emit("error",new Error("packet too short"));if(h.protocolVersion=this._list.readUInt8(this._pos),3!=h.protocolVersion&&4!=h.protocolVersion)return this.emit("error",new Error("invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this.emit("error",new Error("packet too short"));if(g.username=this._list.readUInt8(this._pos)&i.USERNAME_MASK,g.password=this._list.readUInt8(this._pos)&i.PASSWORD_MASK,g.will=this._list.readUInt8(this._pos)&i.WILL_FLAG_MASK,g.will&&(h.will={},h.will.retain=0!==(this._list.readUInt8(this._pos)&i.WILL_RETAIN_MASK),h.will.qos=(this._list.readUInt8(this._pos)&i.WILL_QOS_MASK)>>i.WILL_QOS_SHIFT),h.clean=0!==(this._list.readUInt8(this._pos)&i.CLEAN_SESSION_MASK),this._pos++,h.keepalive=this._parseNum(),h.keepalive===-1)return this.emit("error",new Error("packet too short"));if(b=this._parseString(),null===b)return this.emit("error",new Error("packet too short"));if(h.clientId=b,g.will){if(c=this._parseString(),null===c)return this.emit("error",new Error("cannot parse will topic"));if(h.will.topic=c,d=this._parseBuffer(),null===d)return this.emit("error",new Error("cannot parse will payload"));h.will.payload=d}if(g.username){if(f=this._parseString(),null===f)return this.emit("error",new Error("cannot parse username"));h.username=f}if(g.password){if(e=this._parseBuffer(),null===e)return this.emit("error",new Error("cannot parse username"));h.password=e}return h},d.prototype._parseConnack=function(){var a=this.packet;return this._list.length<2?null:(a.sessionPresent=!!(this._list.readUInt8(this._pos++)&i.SESSIONPRESENT_MASK),a.returnCode=this._list.readUInt8(this._pos),a.returnCode===-1?this.emit("error",new Error("cannot parse return code")):void 0)},d.prototype._parsePublish=function(){var a=this.packet;return a.topic=this._parseString(),null===a.topic?this.emit("error",new Error("cannot parse topic")):void(a.qos>0&&!this._parseMessageId()||(a.payload=this._list.slice(this._pos,a.length)))},d.prototype._parseSubscribe=function(){var a,b,c=this.packet;if(1!=c.qos)return this.emit("error",new Error("wrong subscribe header"));if(c.subscriptions=[],this._parseMessageId())for(;this._pos<c.length;){if(a=this._parseString(),null===a)return this.emit("error",new Error("Parse error - cannot parse topic"));b=this._list.readUInt8(this._pos++),c.subscriptions.push({topic:a,qos:b})}},d.prototype._parseSuback=function(){if(this.packet.granted=[],this._parseMessageId())for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))},d.prototype._parseUnsubscribe=function(){var a=this.packet;if(a.unsubscriptions=[],this._parseMessageId())for(;this._pos<a.length;){var b;if(b=this._parseString(),null===b)return this.emit("error",new Error("cannot parse topic"));a.unsubscriptions.push(b)}},d.prototype._parseUnsuback=function(){if(!this._parseMessageId())return this.emit("error",new Error("cannot parse message id"))},d.prototype._parseMessageId=function(){var a=this.packet;return a.messageId=this._parseNum(),null!==a.messageId||(this.emit("error",new Error("cannot parse message id")),!1)},d.prototype._parseString=function(a){var b,c=this._parseNum(),d=c+this._pos;return c===-1||d>this._list.length||d>this.packet.length?null:(b=this._list.toString("utf8",this._pos,d),this._pos+=c,b)},d.prototype._parseBuffer=function(){var a,b=this._parseNum(),c=b+this._pos;return b===-1||c>this._list.length||c>this.packet.length?null:(a=this._list.slice(this._pos,c),this._pos+=b,a)},d.prototype._parseNum=function(){if(this._list.length-this._pos<2)return-1;var a=this._list.readUInt16BE(this._pos);return this._pos+=2,a},b.exports=d},{"./constants":158,"./packet":161,bl:3,events:21,inherits:23}],163:[function(a,b,c){(function(c,d){"use strict";function e(){return"mqttjs_"+Math.random().toString(16).substr(2,8)}function f(a,b,c){try{var d=m.generate(b);a.emit("packetsend",b),a.stream.write(d)&&c?c():c&&a.stream.once("drain",c)}catch(e){c?c(e):a.emit("error",e)}}function g(a,b,c){a.outgoingStore.put(b,function(d){return d?c&&c(d):void f(a,b,c)})}function h(){}function i(a,b){var c,d=this;if(!(this instanceof i))return new i(a,b);this.options=b||{};for(c in s)"undefined"==typeof this.options[c]?this.options[c]=s[c]:this.options[c]=b[c];this.options.clientId=this.options.clientId||e(),this.streamBuilder=a,this.outgoingStore=this.options.outgoingStore||new k,this.incomingStore=this.options.incomingStore||new k,this.queueQoSZero=null==this.options.queueQoSZero||this.options.queueQoSZero,this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this.nextId=Math.floor(65535*Math.random()),this.outgoing={},this.on("connect",function(){if(!this.disconnected){this.connected=!0;var a=null;a=this.outgoingStore.createStream(),a.once("readable",function(){function b(){var c,e=a.read(1);e&&(!d.disconnecting&&!d.reconnectTimer&&0<d.options.reconnectPeriod?(a.read(0),c=d.outgoing[e.messageId],d.outgoing[e.messageId]=function(){c&&c(),b()},d._sendPacket(e)):a.destroy&&a.destroy())}b()}).on("error",this.emit.bind(this,"error"))}}),this.on("close",function(){this.connected=!1,clearTimeout(this.connackTimer)}),this.on("connect",this._setupPingTimer),this.on("connect",function(){function a(){var c=b.shift(),e=null;c&&(e=c.packet,d._sendPacket(e,function(b){c.cb&&c.cb(b),a()}))}var b=this.queue;a()}),this.on("close",function(){null!==d.pingTimer&&(d.pingTimer.clear(),d.pingTimer=null)}),this.on("close",this._setupReconnect),j.EventEmitter.call(this),this._setupStream()}var j=a("events"),k=a("./store"),l=a("end-of-stream"),m=a("mqtt-packet"),n=a("readable-stream").Writable,o=a("inherits"),p=a("reinterval"),q=a("./validations"),r=d.setImmediate||function(a){c.nextTick(a)},s={keepalive:10,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0};o(i,j.EventEmitter),i.prototype._setupStream=function(){function a(){var b=i.shift(),d=g;b?c._handlePacket(b,a):(g=null,d())}var b,c=this,d=new n,e=m.parser(this.options),g=null,i=[];this._clearReconnect(),this.stream=this.streamBuilder(this),e.on("packet",function(a){i.push(a)}),d._write=function(b,c,d){g=d,e.parse(b),a()},this.stream.pipe(d),this.stream.on("error",h),l(this.stream,this.emit.bind(this,"close")),b=Object.create(this.options),b.cmd="connect",f(this,b),e.on("error",this.emit.bind(this,"error")),this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){c._cleanUp(!0)},this.options.connectTimeout)},i.prototype._handlePacket=function(a,b){switch(this.emit("packetreceive",a),a.cmd){case"publish":this._handlePublish(a,b);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(a),b();break;case"pubrel":this._handlePubrel(a,b);break;case"connack":this._handleConnack(a),b();break;case"pingresp":this._handlePingresp(a),b()}},i.prototype._checkDisconnecting=function(a){return this.disconnecting&&(a?a(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},i.prototype.publish=function(a,b,c,d){var e;if("function"==typeof c&&(d=c,c=null),c||(c={qos:0,retain:!1}),this._checkDisconnecting(d))return this;switch(e={cmd:"publish",topic:a,payload:b,qos:c.qos,retain:c.retain,messageId:this._nextId()},c.qos){case 1:case 2:this.outgoing[e.messageId]=d||h,this._sendPacket(e);break;default:this._sendPacket(e,d)}return this},i.prototype.subscribe=function(){var a,b,c=Array.prototype.slice.call(arguments),d=[],e=c.shift(),f=c.pop()||h,g=c.pop();return"string"==typeof e&&(e=[e]),"function"!=typeof f&&(g=f,f=h),b=q.validateTopics(e),null!==b?(f(new Error("Invalid topic "+b)),this):this._checkDisconnecting(f)?this:(g||(g={qos:0}),Array.isArray(e)?e.forEach(function(a){d.push({topic:a,qos:g.qos})}):Object.keys(e).forEach(function(a){d.push({topic:a,qos:e[a]})}),a={cmd:"subscribe",subscriptions:d,qos:1,retain:!1,dup:!1,messageId:this._nextId()},this.outgoing[a.messageId]=f,this._sendPacket(a),this)},i.prototype.unsubscribe=function(a,b){var c={cmd:"unsubscribe",qos:1,messageId:this._nextId()};return b=b||h,this._checkDisconnecting(b)?this:("string"==typeof a?c.unsubscriptions=[a]:"object"==typeof a&&a.length&&(c.unsubscriptions=a),this.outgoing[c.messageId]=b,this._sendPacket(c),this)},i.prototype.end=function(a,b){function c(){e.disconnected=!0,e.incomingStore.close(function(){e.outgoingStore.close(b)})}function d(){e._cleanUp(a,r.bind(null,c))}var e=this;return"function"==typeof a&&(b=a,a=!1),this.disconnecting?this:(this._clearReconnect(),this.disconnecting=!0,!a&&0<Object.keys(this.outgoing).length?this.once("outgoingEmpty",setTimeout.bind(null,d,10)):d(),this)},i.prototype._reconnect=function(){this.emit("reconnect"),this._setupStream()},i.prototype._setupReconnect=function(){var a=this;!a.disconnecting&&!a.reconnectTimer&&0<a.options.reconnectPeriod&&(this.reconnecting||(this.emit("offline"),this.reconnecting=!0),a.reconnectTimer=setInterval(function(){a._reconnect()},a.options.reconnectPeriod))},i.prototype._clearReconnect=function(){this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},i.prototype._cleanUp=function(a,b){b&&this.stream.on("close",b),a?this.stream.destroy():this._sendPacket({cmd:"disconnect"},r.bind(null,this.stream.end.bind(this.stream))),this.disconnecting||(this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(this.pingTimer.clear(),this.pingTimer=null)},i.prototype._sendPacket=function(a,b){if(!this.connected)return void(0<a.qos||"publish"!==a.cmd||this.queueQoSZero?this.queue.push({packet:a,cb:b}):b&&b(new Error("No connection to broker")));switch(this._shiftPingInterval(),a.qos){case 2:case 1:g(this,a,b);break;case 0:default:f(this,a,b)}},i.prototype._setupPingTimer=function(){var a=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=p(function(){a._checkPing()},1e3*this.options.keepalive))},i.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},i.prototype._checkPing=function(){this.pingResp?(this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):this._cleanUp(!0)},i.prototype._handlePingresp=function(){this.pingResp=!0},i.prototype._handleConnack=function(a){var b=a.returnCode,c=["","Unacceptable protocol version","Identifier rejected","Server unavailable","Bad username or password","Not authorized"];clearTimeout(this.connackTimer),0===b?(this.reconnecting=!1,this.emit("connect",a)):0<b&&this.emit("error",new Error("Connection refused: "+c[b]))},i.prototype._handlePublish=function(a,b){var c=a.topic.toString(),d=a.payload,e=a.qos,f=a.messageId,g=this;switch(e){case 2:this.incomingStore.put(a,function(){g._sendPacket({cmd:"pubrec",messageId:f},b)});break;case 1:this._sendPacket({cmd:"puback",messageId:f});case 0:this.emit("message",c,d,a),this.handleMessage(a,b)}},i.prototype.handleMessage=function(a,b){b()},i.prototype._handleAck=function(a){var b=a.messageId,c=a.cmd,d=null,e=this.outgoing[b],f=this;if(e){switch(c){case"pubcomp":case"puback":delete this.outgoing[b],this.outgoingStore.del(a,e);break;case"pubrec":d={cmd:"pubrel",qos:2,messageId:b},this._sendPacket(d);break;case"suback":delete this.outgoing[b],this.outgoingStore.del(a,function(b,c){if(b)return f.emit("error",b);var d,g=c.subscriptions,h=a.granted;for(d=0;d<h.length;d+=1)g[d].qos=h[d];e(null,g)});break;case"unsuback":delete this.outgoing[b],this.outgoingStore.del(a,e);break;default:f.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}},i.prototype._handlePubrel=function(a,b){var c=a.messageId,d=this;d.incomingStore.get(a,function(e,f){return e?d.emit("error",e):("pubrel"!==f.cmd&&(d.emit("message",f.topic,f.payload,f),d.incomingStore.put(a)),void d._sendPacket({cmd:"pubcomp",messageId:c},b))})},i.prototype._nextId=function(){var a=this.nextId++;return 65535===a&&(this.nextId=1),a},b.exports=i}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./store":168,"./validations":169,_process:172,"end-of-stream":20,events:21,inherits:23,"mqtt-packet":160,"readable-stream":184,reinterval:185}],164:[function(a,b,c){(function(c){"use strict";function d(a){var b;a.auth&&(b=a.auth.match(/^(.+):(.+)$/),b?(a.username=b[1],a.password=b[2]):a.username=a.auth)}function e(a,b){function c(a){return b.servers&&(a._reconnectCount&&a._reconnectCount!==b.servers.length||(a._reconnectCount=0),b.host=b.servers[a._reconnectCount].host,b.port=b.servers[a._reconnectCount].port,b.hostname=b.host,a._reconnectCount++),i[b.protocol](a,b)}if("object"!=typeof a||b||(b=a,a=null),b=b||{},a&&(b=h(g.parse(a,!0),b),b.protocol=b.protocol.replace(/\:$/,"")),d(b),b.query&&"string"==typeof b.query.clientId&&(b.clientId=b.query.clientId),b.cert&&b.key){if(!b.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss"].indexOf(b.protocol))switch(b.protocol){case"mqtt":b.protocol="mqtts";break;case"ws":b.protocol="wss";break;default:throw new Error('Unknown protocol for secure connection: "'+b.protocol+'"!')}}if(i[b.protocol]||(b.protocol=j.filter(function(a){return"function"==typeof i[a]})[0]),!1===b.clean&&!b.clientId)throw new Error("Missing clientId for unclean clients");return new f(c,b)}var f=a("../client"),g=a("url"),h=a("xtend"),i={},j=[];"browser"!==c.title&&(i.mqtt=a("./tcp"),i.tcp=a("./tcp"),i.ssl=a("./tls"),i.tls=a("./tls"),i.mqtts=a("./tls")),i.ws=a("./ws"),i.wss=a("./ws"),j=["mqtt","mqtts","ws","wss"],b.exports=e,b.exports.connect=e,b.exports.MqttClient=f}).call(this,a("_process"))},{"../client":163,"./tcp":165,"./tls":166,"./ws":167,_process:172,url:208,xtend:237}],165:[function(a,b,c){"use strict";function d(a,b){var c,d;return b.port=b.port||1883,b.hostname=b.hostname||b.host||"localhost",c=b.port,d=b.hostname,e.createConnection(c,d)}var e=a("net");b.exports=d},{net:4}],166:[function(a,b,c){"use strict";function d(a,b){function c(c){b.rejectUnauthorized&&a.emit("error",c),d.end()}var d;return b.port=b.port||8883,b.host=b.hostname||b.host||"localhost",b.rejectUnauthorized=!1!==b.rejectUnauthorized,d=e.connect(b),d.on("secureConnect",function(){b.rejectUnauthorized&&!d.authorized?d.emit("error",new Error("TLS not authorized")):d.removeListener("error",c)}),d.on("error",c),d}var e=a("tls");b.exports=d},{tls:4}],167:[function(a,b,c){(function(c){"use strict";function d(a,b){var c={protocol:"mqtt"},d=b.hostname||"localhost",e=String(b.port||80),g=b.path||"/",i=b.protocol+"://"+d+":"+e+g;return"MQIsdp"===b.protocolId&&3===b.protocolVersion&&(c.protocol="mqttv3.1"),"wss"===b.protocol&&h.forEach(function(a){b.hasOwnProperty(a)&&(c[a]=b[a])}),f(i,c)}function e(a,b){var c,d;if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");return d=g.parse(document.URL),b.protocol||("https:"===d.protocol?b.protocol="wss":b.protocol="ws"),b.hostname||(b.hostname=b.host),b.hostname||(b.hostname=d.hostname,b.port||(b.port=d.port)),b.port||("wss"===b.protocol?b.port=443:b.port=80),b.path||(b.path="/"),c=b.protocol+"://"+b.hostname+":"+b.port+b.path,f(c,"mqttv3.1")}var f=a("websocket-stream"),g=a("url"),h=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];"browser"!==c.title?b.exports=d:b.exports=e}).call(this,a("_process"))},{_process:172,url:208,"websocket-stream":213}],168:[function(a,b,c){(function(c){"use strict";function d(){return this instanceof d?void(this._inflights={}):new d}var e=a("readable-stream").Readable,f={objectMode:!0};d.prototype.put=function(a,b){return this._inflights[a.messageId]=a,b&&b(),this},d.prototype.createStream=function(){var a=new e(f),b=this._inflights,d=Object.keys(this._inflights),g=!1,h=0;return a._read=function(){!g&&h<d.length?this.push(b[d[h++]]):this.push(null)},a.destroy=function(){if(!g){var a=this;g=!0,c.nextTick(function(){a.emit("close")})}},a},d.prototype.del=function(a,b){return a=this._inflights[a.messageId],a?(delete this._inflights[a.messageId],b(null,a)):b&&b(new Error("missing packet")),this},d.prototype.get=function(a,b){return a=this._inflights[a.messageId],a?b(null,a):b&&b(new Error("missing packet")),this},d.prototype.close=function(a){this._inflights=null,a&&a()},b.exports=d}).call(this,a("_process"))},{_process:172,"readable-stream":184}],169:[function(a,b,c){"use strict";function d(a){var b=a.split("/"),c=0;for(c=0;c<b.length;c++)if("+"!==b[c]){if("#"===b[c])return c===b.length-1;if(-1!==b[c].indexOf("+")||-1!==b[c].indexOf("#"))return!1}return!0}function e(a){for(var b=0;b<a.length;b++)if(!d(a[b]))return a[b];return null}b.exports={validateTopics:e}},{}],170:[function(a,b,c){function d(a){var b=function(){return b.called?b.value:(b.called=!0,b.value=a.apply(this,arguments))};return b.called=!1,b}var e=a("wrappy");b.exports=e(d),d.proto=d(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return d(this)},configurable:!0})})},{wrappy:216}],171:[function(a,b,c){(function(a){"use strict";function c(b,c,d,e){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var f,g,h=arguments.length;switch(h){case 0:case 1:return a.nextTick(b);case 2:return a.nextTick(function(){b.call(null,c)});case 3:return a.nextTick(function(){b.call(null,c,d)});case 4:return a.nextTick(function(){b.call(null,c,d,e)});default:for(f=new Array(h-1),g=0;g<f.length;)f[g++]=arguments[g];return a.nextTick(function(){b.apply(null,f)})}}!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?b.exports=c:b.exports=a.nextTick}).call(this,a("_process"))},{_process:172}],172:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],173:[function(a,c,d){(function(a){!function(e){function f(a){throw new RangeError(I[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(H,".");var e=a.split("."),f=g(e,b).join(".");return d+f}function i(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:x}function l(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;e<q;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=i<=t?y:i>=t+z?z:i-t,!(l<n);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;h<q;++h)p=a[h],p<128&&u.push(L(p));for(d=e=u.length,e&&u.push(E);d<q;){for(j=w,h=0;h<q;++h)p=a[h],p>=b&&p<j&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;h<q;++h)if(p=a[h],p<b&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=n<=g?y:n>=g+z?z:n-g,!(k<o);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d&&!d.nodeType&&d,s="object"==typeof c&&c&&!c.nodeType&&c,t="object"==typeof a&&a;t.global!==t&&t.window!==t&&t.self!==t||(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^\x20-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.4.1",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof b&&"object"==typeof b.amd&&b.amd)b("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],174:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;k<j;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],175:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],176:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":174,"./encode":175}],177:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":178}],178:[function(a,b,c){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),
a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("_process"))},{"./_stream_readable":180,"./_stream_writable":182,_process:172,"core-util-is":7,inherits:23}],179:[function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":181,"core-util-is":7,inherits:23}],180:[function(a,b,c){(function(c){function d(b,c){b=b||{};var d=b.highWaterMark;this.highWaterMark=d||0===d?d:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;b<32;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:a<=0?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return y.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a,b,e){var f=a.write(c);!1===f&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(z.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var d=a._readableState;if(d.flowing)throw new Error("Cannot switch to old mode now.");var e=b||!1,f=!1;a.readable=!0,a.pipe=A.prototype.pipe,a.on=a.addListener=A.prototype.on,a.on("readable",function(){f=!0;for(var b;!e&&null!==(b=a.read());)a.emit("data",b);null===b&&(f=!1,a._readableState.needReadable=!0)}),a.pause=function(){e=!0,this.emit("pause")},a.resume=function(){e=!1,f?c.nextTick(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;j<k&&i<a;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C;B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c,d=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return c=null,b.length>0&&b.decoder&&(c=t(a,b),b.length-=c.length),0===b.length&&u(this),c;var e=b.needReadable;return b.length-a<=b.highWaterMark&&(e=!0),(b.ended||b.reading)&&(e=!1),e&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),e&&!b.reading&&(a=i(d,b)),c=a>0?t(a,b):null,null===c&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),c},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),a._writableState&&!a._writableState.needDrain||o()}function g(b){j(),a.removeListener("error",g),0===z.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?c.nextTick(n):k.once("end",n),a.on("unpipe",d);var o=p(k);return a.on("drain",o),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(g):a._events.error=[g,a._events.error]:a.on("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,c.nextTick(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return e===-1?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=A.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("_process"))},{_process:172,buffer:6,"core-util-is":7,events:21,inherits:23,isarray:183,stream:187,"string_decoder/":200}],181:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a);var b=(this._transformState=new d(a,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=(a._readableState,a._transformState);if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":178,"core-util-is":7,inherits:23}],182:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void w.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!u.isBuffer(d)&&"string"!=typeof d&&null!==d&&void 0!==d&&!b.objectMode){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new u(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),u.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){f(e)}):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,d){b.ending=!0,s(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var u=a("buffer").Buffer;f.WritableState=e;var v=a("core-util-is");v.inherits=a("inherits");var w=a("stream");v.inherits(f,w),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),u.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":178,_process:172,buffer:6,"core-util-is":7,inherits:23,stream:187}],183:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],184:[function(a,b,c){(function(d){var e=a("stream");c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),d.browser||"disable"!==d.env.READABLE_STREAM||(b.exports=a("stream"))}).call(this,a("_process"))},{"./lib/_stream_duplex.js":178,"./lib/_stream_passthrough.js":179,"./lib/_stream_readable.js":180,"./lib/_stream_transform.js":181,"./lib/_stream_writable.js":182,_process:172,stream:187}],185:[function(a,b,c){"use strict";function d(a,b,c){var d=this;this._callback=a,this._args=c,this._interval=setInterval(a,b,this._args),this.reschedule=function(a){a||(a=d._interval),d._interval&&clearInterval(d._interval),d._interval=setInterval(d._callback,a,d._args)},this.clear=function(){d._interval&&(clearInterval(d._interval),d._interval=void 0)},this.destroy=function(){d._interval&&clearInterval(d._interval),d._callback=void 0,d._interval=void 0,d._args=void 0}}function e(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var a;if(arguments.length>0){a=new Array(arguments.length-2);for(var b=0;b<a.length;b++)a[b]=arguments[b+2]}return new d(arguments[0],arguments[1],a)}b.exports=e},{}],186:[function(a,b,c){(function(b){!function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);var e=this;f(e),e.q=e.c="",e.bufferCheckPosition=c.MAX_BUFFER_LENGTH,e.opt=b||{},e.opt.lowercase=e.opt.lowercase||e.opt.lowercasetags,e.looseCase=e.opt.lowercase?"toLowerCase":"toUpperCase",e.tags=[],e.closed=e.closedRoot=e.sawRoot=!1,e.tag=e.error=null,e.strict=!!a,e.noscript=!(!a&&!e.opt.noscript),e.state=V.BEGIN,e.strictEntities=e.opt.strictEntities,e.ENTITIES=e.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),e.attribList=[],e.opt.xmlns&&(e.ns=Object.create(Q)),e.trackPosition=e.opt.position!==!1,e.trackPosition&&(e.position=e.line=e.column=0),n(e,"onready")}function e(a){for(var b=Math.max(c.MAX_BUFFER_LENGTH,10),d=0,e=0,f=D.length;e<f;e++){var g=a[D[e]].length;if(g>b)switch(D[e]){case"textNode":p(a);break;case"cdata":o(a,"oncdata",a.cdata),a.cdata="";break;case"script":o(a,"onscript",a.script),a.script="";break;default:r(a,"Max buffer length exceeded: "+D[e])}d=Math.max(d,g)}var h=c.MAX_BUFFER_LENGTH-d;a.bufferCheckPosition=h+a.position}function f(a){for(var b=0,c=D.length;b<c;b++)a[D[b]]=""}function g(a){p(a),""!==a.cdata&&(o(a,"oncdata",a.cdata),a.cdata=""),""!==a.script&&(o(a,"onscript",a.script),a.script="")}function h(a,b){return new i(a,b)}function i(a,b){if(!(this instanceof i))return new i(a,b);E.apply(this),this._parser=new d(a,b),this.writable=!0,this.readable=!0;var c=this;this._parser.onend=function(){c.emit("end")},this._parser.onerror=function(a){c.emit("error",a),c._parser.error=null},this._decoder=null,G.forEach(function(a){Object.defineProperty(c,"on"+a,{get:function(){return c._parser["on"+a]},set:function(b){return b?void c.on(a,b):(c.removeAllListeners(a),c._parser["on"+a]=b,b)},enumerable:!0,configurable:!1})})}function j(a){return a.split("").reduce(function(a,b){return a[b]=!0,a},{})}function k(a){return"[object RegExp]"===Object.prototype.toString.call(a)}function l(a,b){return k(a)?!!b.match(a):a[b]}function m(a,b){return!l(a,b)}function n(a,b,c){a[b]&&a[b](c)}function o(a,b,c){a.textNode&&p(a),n(a,b,c)}function p(a){a.textNode=q(a.opt,a.textNode),a.textNode&&n(a,"ontext",a.textNode),a.textNode=""}function q(a,b){return a.trim&&(b=b.trim()),a.normalize&&(b=b.replace(/\s+/g," ")),b}function r(a,b){return p(a),a.trackPosition&&(b+="\nLine: "+a.line+"\nColumn: "+a.column+"\nChar: "+a.c),b=new Error(b),a.error=b,n(a,"onerror",b),a}function s(a){return a.sawRoot&&!a.closedRoot&&t(a,"Unclosed root tag"),a.state!==V.BEGIN&&a.state!==V.BEGIN_WHITESPACE&&a.state!==V.TEXT&&r(a,"Unexpected end"),p(a),a.c="",a.closed=!0,n(a,"onend"),d.call(a,a.strict,a.opt),a}function t(a,b){if("object"!=typeof a||!(a instanceof d))throw new Error("bad call to strictFail");a.strict&&r(a,b)}function u(a){a.strict||(a.tagName=a.tagName[a.looseCase]());var b=a.tags[a.tags.length-1]||a,c=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(c.ns=b.ns),a.attribList.length=0,o(a,"onopentagstart",c)}function v(a,b){var c=a.indexOf(":"),d=c<0?["",a]:a.split(":"),e=d[0],f=d[1];return b&&"xmlns"===a&&(e="xmlns",f=""),{prefix:e,local:f}}function w(a){if(a.strict||(a.attribName=a.attribName[a.looseCase]()),a.attribList.indexOf(a.attribName)!==-1||a.tag.attributes.hasOwnProperty(a.attribName))return void(a.attribName=a.attribValue="");if(a.opt.xmlns){var b=v(a.attribName,!0),c=b.prefix,d=b.local;if("xmlns"===c)if("xml"===d&&a.attribValue!==O)t(a,"xml: prefix must be bound to "+O+"\nActual: "+a.attribValue);else if("xmlns"===d&&a.attribValue!==P)t(a,"xmlns: prefix must be bound to "+P+"\nActual: "+a.attribValue);else{var e=a.tag,f=a.tags[a.tags.length-1]||a;e.ns===f.ns&&(e.ns=Object.create(f.ns)),e.ns[d]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,o(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function x(a,b){if(a.opt.xmlns){var c=a.tag,d=v(a.tagName);c.prefix=d.prefix,c.local=d.local,c.uri=c.ns[d.prefix]||"",c.prefix&&!c.uri&&(t(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName)),c.uri=d.prefix);var e=a.tags[a.tags.length-1]||a;c.ns&&e.ns!==c.ns&&Object.keys(c.ns).forEach(function(b){o(a,"onopennamespace",{prefix:b,uri:c.ns[b]})});for(var f=0,g=a.attribList.length;f<g;f++){var h=a.attribList[f],i=h[0],j=h[1],k=v(i,!0),l=k.prefix,m=k.local,n=""===l?"":c.ns[l]||"",p={name:i,value:j,prefix:l,local:m,uri:n};l&&"xmlns"!==l&&!n&&(t(a,"Unbound namespace prefix: "+JSON.stringify(l)),p.uri=l),a.tag.attributes[i]=p,o(a,"onattribute",p)}a.attribList.length=0}a.tag.isSelfClosing=!!b,a.sawRoot=!0,a.tags.push(a.tag),o(a,"onopentag",a.tag),b||(a.noscript||"script"!==a.tagName.toLowerCase()?a.state=V.TEXT:a.state=V.SCRIPT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function y(a){if(!a.tagName)return t(a,"Weird empty close tag."),a.textNode+="</>",void(a.state=V.TEXT);if(a.script){if("script"!==a.tagName)return a.script+="</"+a.tagName+">",a.tagName="",void(a.state=V.SCRIPT);o(a,"onscript",a.script),a.script=""}var b=a.tags.length,c=a.tagName;a.strict||(c=c[a.looseCase]());for(var d=c;b--;){var e=a.tags[b];if(e.name===d)break;t(a,"Unexpected close tag")}if(b<0)return t(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",void(a.state=V.TEXT);a.tagName=c;for(var f=a.tags.length;f-- >b;){var g=a.tag=a.tags.pop();a.tagName=a.tag.name,o(a,"onclosetag",a.tagName);var h={};for(var i in g.ns)h[i]=g.ns[i];var j=a.tags[a.tags.length-1]||a;a.opt.xmlns&&g.ns!==j.ns&&Object.keys(g.ns).forEach(function(b){var c=g.ns[b];o(a,"onclosenamespace",{prefix:b,uri:c})})}0===b&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=V.TEXT}function z(a){var b,c=a.entity,d=c.toLowerCase(),e="";return a.ENTITIES[c]?a.ENTITIES[c]:a.ENTITIES[d]?a.ENTITIES[d]:(c=d,"#"===c.charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),b=parseInt(c,16),e=b.toString(16)):(c=c.slice(1),b=parseInt(c,10),e=b.toString(10))),c=c.replace(/^0+/,""),e.toLowerCase()!==c?(t(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCodePoint(b))}function A(a,b){"<"===b?(a.state=V.OPEN_WAKA,a.startTagPosition=a.position):m(H,b)&&(t(a,"Non-whitespace before first tag."),a.textNode=b,a.state=V.TEXT)}function B(a,b){var c="";return b<a.length&&(c=a.charAt(b)),c}function C(a){var b=this;if(this.error)throw this.error;if(b.closed)return r(b,"Cannot write after close. Assign an onready handler.");if(null===a)return s(b);"object"==typeof a&&(a=a.toString());for(var c=0,d="";;){if(d=B(a,c++),b.c=d,!d)break;switch(b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++),b.state){case V.BEGIN:if(b.state=V.BEGIN_WHITESPACE,"\ufeff"===d)continue;A(b,d);continue;case V.BEGIN_WHITESPACE:A(b,d);continue;case V.TEXT:if(b.sawRoot&&!b.closedRoot){for(var f=c-1;d&&"<"!==d&&"&"!==d;)d=B(a,c++),d&&b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++);b.textNode+=a.substring(f,c-1)}"<"!==d||b.sawRoot&&b.closedRoot&&!b.strict?(!m(H,d)||b.sawRoot&&!b.closedRoot||t(b,"Text data outside of root node."),"&"===d?b.state=V.TEXT_ENTITY:b.textNode+=d):(b.state=V.OPEN_WAKA,b.startTagPosition=b.position);continue;case V.SCRIPT:"<"===d?b.state=V.SCRIPT_ENDING:b.script+=d;continue;case V.SCRIPT_ENDING:"/"===d?b.state=V.CLOSE_TAG:(b.script+="<"+d,b.state=V.SCRIPT);continue;case V.OPEN_WAKA:if("!"===d)b.state=V.SGML_DECL,b.sgmlDecl="";else if(l(H,d));else if(l(R,d))b.state=V.OPEN_TAG,b.tagName=d;else if("/"===d)b.state=V.CLOSE_TAG,b.tagName="";else if("?"===d)b.state=V.PROC_INST,b.procInstName=b.procInstBody="";else{if(t(b,"Unencoded <"),b.startTagPosition+1<b.position){var g=b.position-b.startTagPosition;d=new Array(g).join(" ")+d}b.textNode+="<"+d,b.state=V.TEXT}continue;case V.SGML_DECL:(b.sgmlDecl+d).toUpperCase()===M?(o(b,"onopencdata"),b.state=V.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+d==="--"?(b.state=V.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+d).toUpperCase()===N?(b.state=V.DOCTYPE,(b.doctype||b.sawRoot)&&t(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):">"===d?(o(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=V.TEXT):l(K,d)?(b.state=V.SGML_DECL_QUOTED,b.sgmlDecl+=d):b.sgmlDecl+=d;continue;case V.SGML_DECL_QUOTED:d===b.q&&(b.state=V.SGML_DECL,b.q=""),b.sgmlDecl+=d;continue;case V.DOCTYPE:">"===d?(b.state=V.TEXT,o(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=d,"["===d?b.state=V.DOCTYPE_DTD:l(K,d)&&(b.state=V.DOCTYPE_QUOTED,b.q=d));continue;case V.DOCTYPE_QUOTED:b.doctype+=d,d===b.q&&(b.q="",b.state=V.DOCTYPE);continue;case V.DOCTYPE_DTD:b.doctype+=d,"]"===d?b.state=V.DOCTYPE:l(K,d)&&(b.state=V.DOCTYPE_DTD_QUOTED,b.q=d);continue;case V.DOCTYPE_DTD_QUOTED:b.doctype+=d,d===b.q&&(b.state=V.DOCTYPE_DTD,b.q="");continue;case V.COMMENT:"-"===d?b.state=V.COMMENT_ENDING:b.comment+=d;continue;case V.COMMENT_ENDING:"-"===d?(b.state=V.COMMENT_ENDED,b.comment=q(b.opt,b.comment),b.comment&&o(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+d,b.state=V.COMMENT);continue;case V.COMMENT_ENDED:">"!==d?(t(b,"Malformed comment"),b.comment+="--"+d,b.state=V.COMMENT):b.state=V.TEXT;continue;case V.CDATA:"]"===d?b.state=V.CDATA_ENDING:b.cdata+=d;continue;case V.CDATA_ENDING:"]"===d?b.state=V.CDATA_ENDING_2:(b.cdata+="]"+d,b.state=V.CDATA);continue;case V.CDATA_ENDING_2:">"===d?(b.cdata&&o(b,"oncdata",b.cdata),o(b,"onclosecdata"),b.cdata="",b.state=V.TEXT):"]"===d?b.cdata+="]":(b.cdata+="]]"+d,b.state=V.CDATA);continue;case V.PROC_INST:"?"===d?b.state=V.PROC_INST_ENDING:l(H,d)?b.state=V.PROC_INST_BODY:b.procInstName+=d;continue;case V.PROC_INST_BODY:if(!b.procInstBody&&l(H,d))continue;"?"===d?b.state=V.PROC_INST_ENDING:b.procInstBody+=d;continue;case V.PROC_INST_ENDING:">"===d?(o(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=V.TEXT):(b.procInstBody+="?"+d,b.state=V.PROC_INST_BODY);continue;case V.OPEN_TAG:l(S,d)?b.tagName+=d:(u(b),">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:(m(H,d)&&t(b,"Invalid character in tag name"),b.state=V.ATTRIB));continue;case V.OPEN_TAG_SLASH:">"===d?(x(b,!0),y(b)):(t(b,"Forward-slash in opening tag not followed by >"),b.state=V.ATTRIB);continue;case V.ATTRIB:if(l(H,d))continue;">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME:"="===d?b.state=V.ATTRIB_VALUE:">"===d?(t(b,"Attribute without value"),b.attribValue=b.attribName,w(b),x(b)):l(H,d)?b.state=V.ATTRIB_NAME_SAW_WHITE:l(S,d)?b.attribName+=d:t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME_SAW_WHITE:if("="===d)b.state=V.ATTRIB_VALUE;else{if(l(H,d))continue;t(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",o(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",">"===d?x(b):l(R,d)?(b.attribName=d,b.state=V.ATTRIB_NAME):(t(b,"Invalid attribute name"),b.state=V.ATTRIB)}continue;case V.ATTRIB_VALUE:if(l(H,d))continue;l(K,d)?(b.q=d,b.state=V.ATTRIB_VALUE_QUOTED):(t(b,"Unquoted attribute value"),b.state=V.ATTRIB_VALUE_UNQUOTED,b.attribValue=d);continue;case V.ATTRIB_VALUE_QUOTED:if(d!==b.q){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=d;continue}w(b),b.q="",b.state=V.ATTRIB_VALUE_CLOSED;continue;case V.ATTRIB_VALUE_CLOSED:l(H,d)?b.state=V.ATTRIB:">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(t(b,"No whitespace between attributes"),b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_VALUE_UNQUOTED:if(m(L,d)){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_U:b.attribValue+=d;continue}w(b),">"===d?x(b):b.state=V.ATTRIB;continue;case V.CLOSE_TAG:if(b.tagName)">"===d?y(b):l(S,d)?b.tagName+=d:b.script?(b.script+="</"+b.tagName,b.tagName="",b.state=V.SCRIPT):(m(H,d)&&t(b,"Invalid tagname in closing tag"),b.state=V.CLOSE_TAG_SAW_WHITE);else{if(l(H,d))continue;m(R,d)?b.script?(b.script+="</"+d,b.state=V.SCRIPT):t(b,"Invalid tagname in closing tag."):b.tagName=d}continue;case V.CLOSE_TAG_SAW_WHITE:if(l(H,d))continue;">"===d?y(b):t(b,"Invalid characters in closing tag");continue;case V.TEXT_ENTITY:case V.ATTRIB_VALUE_ENTITY_Q:case V.ATTRIB_VALUE_ENTITY_U:var h,i;switch(b.state){case V.TEXT_ENTITY:h=V.TEXT,i="textNode";break;case V.ATTRIB_VALUE_ENTITY_Q:h=V.ATTRIB_VALUE_QUOTED,i="attribValue";break;case V.ATTRIB_VALUE_ENTITY_U:h=V.ATTRIB_VALUE_UNQUOTED,i="attribValue"}";"===d?(b[i]+=z(b),b.entity="",b.state=h):l(b.entity.length?U:T,d)?b.entity+=d:(t(b,"Invalid character in entity name"),b[i]+="&"+b.entity+d,b.entity="",b.state=h);continue;default:throw new Error(b,"Unknown state: "+b.state)}}return b.position>=b.bufferCheckPosition&&e(b),b}c.parser=function(a,b){return new d(a,b)},c.SAXParser=d,c.SAXStream=i,c.createStream=h,c.MAX_BUFFER_LENGTH=65536;var D=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(a){function b(){}b.prototype=a;var c=new b;return c}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),d.prototype={end:function(){s(this)},write:C,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){g(this)}};var E;try{E=a("stream").Stream}catch(F){E=function(){}}var G=c.EVENTS.filter(function(a){return"error"!==a&&"end"!==a});i.prototype=Object.create(E.prototype,{constructor:{value:i}}),i.prototype.write=function(c){if("function"==typeof b&&"function"==typeof b.isBuffer&&b.isBuffer(c)){if(!this._decoder){var d=a("string_decoder").StringDecoder;this._decoder=new d("utf8")}c=this._decoder.write(c)}return this._parser.write(c.toString()),this.emit("data",c),!0},i.prototype.end=function(a){return a&&a.length&&this.write(a),this._parser.end(),!0},i.prototype.on=function(a,b){var c=this;return c._parser["on"+a]||G.indexOf(a)===-1||(c._parser["on"+a]=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,a),c.emit.apply(c,b)}),E.prototype.on.call(c,a,b)};var H="\r\n\t ",I="0124356789",J="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",K="'\"",L=H+">",M="[CDATA[",N="DOCTYPE",O="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",Q={xml:O,xmlns:P};H=j(H),I=j(I),J=j(J);var R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,U=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;K=j(K),L=j(L);var V=0;c.STATE={BEGIN:V++,BEGIN_WHITESPACE:V++,TEXT:V++,TEXT_ENTITY:V++,OPEN_WAKA:V++,SGML_DECL:V++,SGML_DECL_QUOTED:V++,DOCTYPE:V++,DOCTYPE_QUOTED:V++,DOCTYPE_DTD:V++,DOCTYPE_DTD_QUOTED:V++,
COMMENT_STARTING:V++,COMMENT:V++,COMMENT_ENDING:V++,COMMENT_ENDED:V++,CDATA:V++,CDATA_ENDING:V++,CDATA_ENDING_2:V++,PROC_INST:V++,PROC_INST_BODY:V++,PROC_INST_ENDING:V++,OPEN_TAG:V++,OPEN_TAG_SLASH:V++,ATTRIB:V++,ATTRIB_NAME:V++,ATTRIB_NAME_SAW_WHITE:V++,ATTRIB_VALUE:V++,ATTRIB_VALUE_QUOTED:V++,ATTRIB_VALUE_CLOSED:V++,ATTRIB_VALUE_UNQUOTED:V++,ATTRIB_VALUE_ENTITY_Q:V++,ATTRIB_VALUE_ENTITY_U:V++,CLOSE_TAG:V++,CLOSE_TAG_SAW_WHITE:V++,SCRIPT:V++,SCRIPT_ENDING:V++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(a){var b=c.ENTITIES[a],d="number"==typeof b?String.fromCharCode(b):b;c.ENTITIES[a]=d});for(var W in c.STATE)c.STATE[c.STATE[W]]=W;V=c.STATE,String.fromCodePoint||!function(){var a=String.fromCharCode,b=Math.floor,c=function(){var c,d,e=16384,f=[],g=-1,h=arguments.length;if(!h)return"";for(var i="";++g<h;){var j=Number(arguments[g]);if(!isFinite(j)||j<0||j>1114111||b(j)!==j)throw RangeError("Invalid code point: "+j);j<=65535?f.push(j):(j-=65536,c=(j>>10)+55296,d=j%1024+56320,f.push(c,d)),(g+1===h||f.length>e)&&(i+=a.apply(null,f),f.length=0)}return i};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:c,configurable:!0,writable:!0}):String.fromCodePoint=c}()}("undefined"==typeof c?this.sax={}:c)}).call(this,a("buffer").Buffer)},{buffer:6,stream:187,string_decoder:200}],187:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:21,inherits:23,"readable-stream/duplex.js":188,"readable-stream/passthrough.js":195,"readable-stream/readable.js":196,"readable-stream/transform.js":197,"readable-stream/writable.js":198}],188:[function(a,b,c){arguments[4][177][0].apply(c,arguments)},{"./lib/_stream_duplex.js":189,dup:177}],189:[function(a,b,c){arguments[4][13][0].apply(c,arguments)},{"./_stream_readable":191,"./_stream_writable":193,"core-util-is":7,dup:13,inherits:23,"process-nextick-args":171}],190:[function(a,b,c){arguments[4][14][0].apply(c,arguments)},{"./_stream_transform":192,"core-util-is":7,dup:14,inherits:23}],191:[function(a,b,c){(function(c){"use strict";function d(a,b,c){return"function"==typeof a.prependListener?a.prependListener(b,c):void(a._events&&a._events[b]?E(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c))}function e(b,c){O=O||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof O&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=new N,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(M||(M=a("string_decoder/").StringDecoder),this.decoder=new M(b.encoding),this.encoding=b.encoding)}function f(b){return O=O||a("./_stream_duplex"),this instanceof f?(this._readableState=new e(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void F.call(this)):new f(b)}function g(a,b,c,d,e){var f=k(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,l(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var g=new Error("stream.push() after EOF");a.emit("error",g)}else if(b.endEmitted&&e){var i=new Error("stream.unshift() after end event");a.emit("error",i)}else{var j;!b.decoder||e||d||(c=b.decoder.write(c),j=!b.objectMode&&0===c.length),e||(b.reading=!1),j||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&m(a))),o(a,b)}else e||(b.reading=!1);return h(b)}function h(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function i(a){return a>=P?a=P:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function j(a,b){return a<=0||0===b.length&&b.ended?0:b.objectMode?1:a!==a?b.flowing&&b.length?b.buffer.head.data.length:b.length:(a>b.highWaterMark&&(b.highWaterMark=i(a)),a<=b.length?a:b.ended?b.length:(b.needReadable=!0,0))}function k(a,b){var c=null;return H.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function l(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,m(a)}}function m(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(L("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?D(n,a):n(a))}function n(a){L("emit readable"),a.emit("readable"),u(a)}function o(a,b){b.readingMore||(b.readingMore=!0,D(p,a,b))}function p(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(L("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function q(a){return function(){var b=a._readableState;L("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&G(a,"data")&&(b.flowing=!0,u(a))}}function r(a){L("readable nexttick read 0"),a.read(0)}function s(a,b){b.resumeScheduled||(b.resumeScheduled=!0,D(t,a,b))}function t(a,b){b.reading||(L("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),u(a),b.flowing&&!b.reading&&a.read(0)}function u(a){var b=a._readableState;for(L("flow",b.flowing);b.flowing&&null!==a.read(););}function v(a,b){if(0===b.length)return null;var c;return b.objectMode?c=b.buffer.shift():!a||a>=b.length?(c=b.decoder?b.buffer.join(""):1===b.buffer.length?b.buffer.head.data:b.buffer.concat(b.length),b.buffer.clear()):c=w(a,b.buffer,b.decoder),c}function w(a,b,c){var d;return a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):d=a===b.head.data.length?b.shift():c?x(a,b):y(a,b),d}function x(a,b){var c=b.head,d=1,e=c.data;for(a-=e.length;c=c.next;){var f=c.data,g=a>f.length?f.length:a;if(e+=g===f.length?f:f.slice(0,a),a-=g,0===a){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}return b.length-=d,e}function y(a,b){var c=I.allocUnsafe(a),d=b.head,e=1;for(d.data.copy(c),a-=d.data.length;d=d.next;){var f=d.data,g=a>f.length?f.length:a;if(f.copy(c,c.length-a,0,g),a-=g,0===a){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}return b.length-=e,c}function z(a){var b=a._readableState;if(b.length>0)throw new Error('"endReadable()" called on non-empty stream');b.endEmitted||(b.ended=!0,D(A,b,a))}function A(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function B(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function C(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=f;var D=a("process-nextick-args"),E=a("isarray");f.ReadableState=e;var F,G=(a("events").EventEmitter,function(a,b){return a.listeners(b).length});!function(){try{F=a("stream")}catch(b){}finally{F||(F=a("events").EventEmitter)}}();var H=a("buffer").Buffer,I=a("buffer-shims"),J=a("core-util-is");J.inherits=a("inherits");var K=a("util"),L=void 0;L=K&&K.debuglog?K.debuglog("stream"):function(){};var M,N=a("./internal/streams/BufferList");J.inherits(f,F);var O,O;f.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=I.from(a,b),b="")),g(this,c,a,b,!1)},f.prototype.unshift=function(a){var b=this._readableState;return g(this,b,a,"",!0)},f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(b){return M||(M=a("string_decoder/").StringDecoder),this._readableState.decoder=new M(b),this._readableState.encoding=b,this};var P=8388608;f.prototype.read=function(a){L("read",a),a=parseInt(a,10);var b=this._readableState,c=a;if(0!==a&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return L("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?z(this):m(this),null;if(a=j(a,b),0===a&&b.ended)return 0===b.length&&z(this),null;var d=b.needReadable;L("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,L("length less than watermark",d)),b.ended||b.reading?(d=!1,L("reading or ended",d)):d&&(L("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=j(c,b)));var e;return e=a>0?v(a,b):null,null===e?(b.needReadable=!0,a=0):b.length-=a,0===b.length&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&z(this)),null!==e&&this.emit("data",e),e},f.prototype._read=function(a){this.emit("error",new Error("not implemented"))},f.prototype.pipe=function(a,b){function e(a){L("onunpipe"),a===m&&g()}function f(){L("onend"),a.end()}function g(){L("cleanup"),a.removeListener("close",j),a.removeListener("finish",k),a.removeListener("drain",r),a.removeListener("error",i),a.removeListener("unpipe",e),m.removeListener("end",f),m.removeListener("end",g),m.removeListener("data",h),s=!0,!n.awaitDrain||a._writableState&&!a._writableState.needDrain||r()}function h(b){L("ondata"),t=!1;var c=a.write(b);!1!==c||t||((1===n.pipesCount&&n.pipes===a||n.pipesCount>1&&C(n.pipes,a)!==-1)&&!s&&(L("false write response, pause",m._readableState.awaitDrain),m._readableState.awaitDrain++,t=!0),m.pause())}function i(b){L("onerror",b),l(),a.removeListener("error",i),0===G(a,"error")&&a.emit("error",b)}function j(){a.removeListener("finish",k),l()}function k(){L("onfinish"),a.removeListener("close",j),l()}function l(){L("unpipe"),m.unpipe(a)}var m=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=a;break;case 1:n.pipes=[n.pipes,a];break;default:n.pipes.push(a)}n.pipesCount+=1,L("pipe count=%d opts=%j",n.pipesCount,b);var o=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,p=o?f:g;n.endEmitted?D(p):m.once("end",p),a.on("unpipe",e);var r=q(m);a.on("drain",r);var s=!1,t=!1;return m.on("data",h),d(a,"error",i),a.once("close",j),a.once("finish",k),a.emit("pipe",m),n.flowing||(L("pipe resume"),m.resume()),a},f.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=C(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},f.prototype.on=function(a,b){var c=F.prototype.on.call(this,a,b);if("data"===a)this._readableState.flowing!==!1&&this.resume();else if("readable"===a){var d=this._readableState;d.endEmitted||d.readableListening||(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&m(this,d):D(r,this))}return c},f.prototype.addListener=f.prototype.on,f.prototype.resume=function(){var a=this._readableState;return a.flowing||(L("resume"),a.flowing=!0,s(this,a)),this},f.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},f.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(L("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(L("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return B(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){L("wrapped _read",b),c&&(c=!1,a.resume())},d},f._fromList=v}).call(this,a("_process"))},{"./_stream_duplex":189,"./internal/streams/BufferList":194,_process:172,buffer:6,"buffer-shims":5,"core-util-is":7,events:21,inherits:23,isarray:25,"process-nextick-args":171,"string_decoder/":200,util:4}],192:[function(a,b,c){arguments[4][16][0].apply(c,arguments)},{"./_stream_duplex":189,"core-util-is":7,dup:16,inherits:23}],193:[function(a,b,c){(function(c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){E=E||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof E&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this)}function g(b){return E=E||a("./_stream_duplex"),this instanceof g||this instanceof E?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void A.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),x(b,c)}function i(a,b,c,d){var e=!0,f=!1;return null===c?f=new TypeError("May not write null values to stream"):C.isBuffer(c)||"string"==typeof c||void 0===c||b.objectMode||(f=new TypeError("Invalid non-string/buffer chunk")),f&&(a.emit("error",f),x(d,f),e=!1),e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=D.from(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),C.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?x(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?y(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;l(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,f.next?(b.corkedRequestsFree=f.next,f.next=null):b.corkedRequestsFree=new w(b)}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(l(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?x(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function w(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=g;var x=a("process-nextick-args"),y=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:x;g.WritableState=f;var z=a("core-util-is");z.inherits=a("inherits");var A,B={deprecate:a("util-deprecate")};!function(){try{A=a("stream")}catch(b){}finally{A||(A=a("events").EventEmitter)}}();var C=a("buffer").Buffer,D=a("buffer-shims");z.inherits(g,A);var E;f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:B.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var E;g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),C.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);return this._writableState.defaultEncoding=a,this},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":189,_process:172,buffer:6,"buffer-shims":5,"core-util-is":7,events:21,inherits:23,"process-nextick-args":171,"util-deprecate":209}],194:[function(a,b,c){arguments[4][18][0].apply(c,arguments)},{buffer:6,"buffer-shims":5,dup:18}],195:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":190}],196:[function(a,b,c){(function(d){var e=function(){try{return a("stream")}catch(b){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=e||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js"),!d.browser&&"disable"===d.env.READABLE_STREAM&&e&&(b.exports=e)}).call(this,a("_process"))},{"./lib/_stream_duplex.js":189,"./lib/_stream_passthrough.js":190,"./lib/_stream_readable.js":191,"./lib/_stream_transform.js":192,"./lib/_stream_writable.js":193,_process:172}],197:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":192}],198:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":193}],199:[function(a,b,c){function d(a){var b=a._readableState;return b?b.objectMode?a.read():a.read(e(b)):null}function e(a){return a.buffer.length?a.buffer.head?a.buffer.head.data.length:a.buffer[0].length:a.length}b.exports=d},{}],200:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&d<=56319)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&d<=56319){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(b<=2&&c>>4==14){this.charLength=3;break}if(b<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:6}],201:[function(a,b,c){arguments[4][13][0].apply(c,arguments)},{"./_stream_readable":202,"./_stream_writable":204,"core-util-is":7,dup:13,inherits:23,"process-nextick-args":171}],202:[function(a,b,c){(function(c){"use strict";function d(b,c){I=I||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof I&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(H||(H=a("string_decoder/").StringDecoder),this.decoder=new H(b.encoding),this.encoding=b.encoding)}function e(b){return I=I||a("./_stream_duplex"),this instanceof e?(this._readableState=new d(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void C.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else{var i;!b.decoder||e||d||(c=b.decoder.write(c),i=!b.objectMode&&0===c.length),e||(b.reading=!1),i||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a))),n(a,b)}else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){return a>=J?a=J:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:a<=0?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(G("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?z(m,a):m(a))}function m(a){G("emit readable"),a.emit("readable"),t(a)}function n(a,b){b.readingMore||(b.readingMore=!0,z(o,a,b))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(G("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;G("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&D(a,"data")&&(b.flowing=!0,t(a))}}function q(a){G("readable nexttick read 0"),a.read(0)}function r(a,b){b.resumeScheduled||(b.resumeScheduled=!0,z(s,a,b))}function s(a,b){b.reading||(G("resume read 0"),a.read(0)),b.resumeScheduled=!1,a.emit("resume"),t(a),b.flowing&&!b.reading&&a.read(0)}function t(a){var b=a._readableState;if(G("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function u(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):1===d.length?d[0]:B.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new B(a);for(var i=0,j=0,k=d.length;j<k&&i<a;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function v(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,z(w,b,a))}function w(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function x(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function y(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=e;var z=a("process-nextick-args"),A=a("isarray"),B=a("buffer").Buffer;e.ReadableState=d;var C,D=(a("events"),function(a,b){return a.listeners(b).length});!function(){try{C=a("stream")}catch(b){}finally{C||(C=a("events").EventEmitter)}}();var B=a("buffer").Buffer,E=a("core-util-is");E.inherits=a("inherits");var F=a("util"),G=void 0;G=F&&F.debuglog?F.debuglog("stream"):function(){};var H;E.inherits(e,C);var I,I;e.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new B(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.isPaused=function(){return this._readableState.flowing===!1},e.prototype.setEncoding=function(b){return H||(H=a("string_decoder/").StringDecoder),this._readableState.decoder=new H(b),this._readableState.encoding=b,this};var J=8388608;e.prototype.read=function(a){G("read",a);var b=this._readableState,c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return G("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?v(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&v(this),null;var d=b.needReadable;G("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,G("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,G("reading or ended",d)),d&&(G("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?u(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&v(this),null!==e&&this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){G("onunpipe"),a===l&&f()}function e(){G("onend"),a.end()}function f(){G("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),r=!0,!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q();
}function g(b){G("ondata");var c=a.write(b);!1===c&&(1!==m.pipesCount||m.pipes[0]!==a||1!==l.listenerCount("data")||r||(G("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++),l.pause())}function h(b){G("onerror",b),k(),a.removeListener("error",h),0===D(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){G("onfinish"),a.removeListener("close",i),k()}function k(){G("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,G("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?z(o):l.once("end",o),a.on("unpipe",d);var q=p(l);a.on("drain",q);var r=!1;return l.on("data",g),a._events&&a._events.error?A(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(G("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=y(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=C.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&!this._readableState.endEmitted){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):z(q,this))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(G("resume"),a.flowing=!0,r(this,a)),this},e.prototype.pause=function(){return G("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(G("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(G("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(G("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return x(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){G("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=u}).call(this,a("_process"))},{"./_stream_duplex":201,_process:172,buffer:6,"core-util-is":7,events:21,inherits:23,isarray:25,"process-nextick-args":171,"string_decoder/":200,util:4}],203:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":201,"core-util-is":7,inherits:23}],204:[function(a,b,c){(function(c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){D=D||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof D&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this),this.corkedRequestsFree.next=new w(this)}function g(b){return D=D||a("./_stream_duplex"),this instanceof g||this instanceof D?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void B.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),x(b,c)}function i(a,b,c,d){var e=!0;if(!z.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");a.emit("error",f),x(d,f),e=!1}return e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new z(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),z.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?x(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?y(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;l(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,b.corkedRequestsFree=f.next,f.next=null}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(l(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?x(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function w(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=g;var x=a("process-nextick-args"),y=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:x,z=a("buffer").Buffer;g.WritableState=f;var A=a("core-util-is");A.inherits=a("inherits");var B,C={deprecate:a("util-deprecate")};!function(){try{B=a("stream")}catch(b){}finally{B||(B=a("events").EventEmitter)}}();var z=a("buffer").Buffer;A.inherits(g,B);var D;f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:C.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var D;g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),z.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":201,_process:172,buffer:6,"core-util-is":7,events:21,inherits:23,"process-nextick-args":171,"util-deprecate":209}],205:[function(a,b,c){arguments[4][197][0].apply(c,arguments)},{"./lib/_stream_transform.js":203,dup:197}],206:[function(a,b,c){(function(c){function d(a){g.call(this,a),this._destroyed=!1}function e(a,b,c){c(null,a)}function f(a){return function(b,c,d){return"function"==typeof b&&(d=c,c=b,b={}),"function"!=typeof c&&(c=e),"function"!=typeof d&&(d=null),a(b,c,d)}}var g=a("readable-stream/transform"),h=a("util").inherits,i=a("xtend");h(d,g),d.prototype.destroy=function(a){if(!this._destroyed){this._destroyed=!0;var b=this;c.nextTick(function(){a&&b.emit("error",a),b.emit("close")})}},b.exports=f(function(a,b,c){var e=new d(a);return e._transform=b,c&&(e._flush=c),e}),b.exports.ctor=f(function(a,b,c){function e(b){return this instanceof e?(this.options=i(a,b),void d.call(this,this.options)):new e(b)}return h(e,d),e.prototype._transform=b,c&&(e.prototype._flush=c),e}),b.exports.obj=f(function(a,b,c){var e=new d(i({objectMode:!0,highWaterMark:16},a));return e._transform=b,c&&(e._flush=c),e})}).call(this,a("_process"))},{_process:172,"readable-stream/transform":205,util:212,xtend:237}],207:[function(a,b,c){function d(a,b){this._id=a,this._clearFn=b}var e=a("process/browser.js").nextTick,f=Function.prototype.apply,g=Array.prototype.slice,h={},i=0;c.setTimeout=function(){return new d(f.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new d(f.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof setImmediate?setImmediate:function(a){var b=i++,d=!(arguments.length<2)&&g.call(arguments,1);return h[b]=!0,e(function(){h[b]&&(d?a.apply(null,d):a.call(null),c.clearImmediate(b))}),b},c.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(a){delete h[a]}},{"process/browser.js":172}],208:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","\t"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);k!==-1&&(h===-1||k<h)&&(h=k)}var l,o;o=h===-1?d.lastIndexOf("@"):d.lastIndexOf("@",h),o!==-1&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);k!==-1&&(h===-1||k<h)&&(h=k)}h===-1&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;j<B;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;E<F;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;j<B;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");Q!==-1&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(R!==-1?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:173,querystring:176}],209:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){try{if(!a.localStorage)return!1}catch(c){return!1}var d=a.localStorage[b];return null!=d&&"true"===String(d).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],210:[function(a,b,c){arguments[4][23][0].apply(c,arguments)},{dup:23}],211:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],212:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(d<0)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":211,_process:172,inherits:210}],213:[function(a,b,c){(function(c,d,e){function f(a,b,f){function j(a,b,c){!z||a instanceof e||(a=new e(a,"utf8")),s.send(a,c)}function k(a,b,c){if(s.bufferedAmount>x)return void setTimeout(k,y,a,b,c);try{s.send(a)}catch(d){return c(d)}c()}function l(a){s.close(),a()}function m(){r.setReadable(w),r.setWritable(w),r.emit("connect")}function n(){r.end(),r.destroy()}function o(a){r.destroy(a)}function p(a){var b=a.data;b=new e(b instanceof ArrayBuffer?new Uint8Array(b):b),w.push(b)}function q(){s.close()}var r,s,t="browser"===c.title,u=!!d.WebSocket,v=t?k:j,w=g.obj(v,l);b&&!Array.isArray(b)&&"object"==typeof b&&(f=b,b=null),f||(f={});var x=f.browserBufferSize||524288,y=f.browserBufferTimeout||1e3;"object"==typeof a?s=a:(s=u&&t?new i(a,b):new i(a,b,f),s.binaryType="arraybuffer"),s.readyState===i.OPEN?r=w:(r=h.obj(),s.onopen=m),r.socket=s,s.onclose=n,s.onerror=o,s.onmessage=p,w.on("close",q);var z=f.binary||void 0===f.binary;return r}var g=a("through2"),h=a("duplexify"),i=a("ws");b.exports=f}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a("buffer").Buffer)},{_process:172,buffer:6,duplexify:11,through2:206,ws:214}],214:[function(a,b,c){var d=null;d="undefined"!=typeof WebSocket?WebSocket:"undefined"!=typeof MozWebSocket?MozWebSocket:window.WebSocket||window.MozWebSocket,b.exports=d},{}],215:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a,b){function c(a){q[a]=!0;for(var b in e[a][1]){var d=e[a][1][b];q[d]||c(d)}}for(var h,i=Object.keys(f),j=0,k=i.length;j<k;j++){var l=i[j],m=f[l].exports;if(m===a||m&&m.default===a){h=l;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var n={},j=0,k=i.length;j<k;j++){var l=i[j];n[l]=l}e[h]=[Function(["require","module","exports"],"("+a+")(self)"),n]}var o=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[h]=h,e[o]=[Function(["require"],"var f = require("+g(h)+");(f.default ? f.default : f)(self);"),p];var q={};c(o);var r="("+d+")({"+Object.keys(q).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(o)+"])",s=window.URL||window.webkitURL||window.mozURL||window.msURL,t=new Blob([r],{type:"text/javascript"});if(b&&b.bare)return t;var u=s.createObjectURL(t),v=new Worker(u);return v.objectURL=u,v}},{}],216:[function(a,b,c){function d(a,b){function c(){for(var b=new Array(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];var d=a.apply(this,b),e=b[b.length-1];return"function"==typeof d&&d!==e&&Object.keys(e).forEach(function(a){d[a]=e[a]}),d}if(a&&b)return d(a)(b);if("function"!=typeof a)throw new TypeError("need wrapper function");return Object.keys(a).forEach(function(b){c[b]=a[b]}),c}b.exports=d},{}],217:[function(a,b,c){(function(){"use strict";c.stripBOM=function(a){return"\ufeff"===a[0]?a.substring(1):a}}).call(this)},{}],218:[function(a,b,c){(function(){"use strict";var a;a=new RegExp(/(?!xmlns)^.*:/),c.normalize=function(a){return a.toLowerCase()},c.firstCharLowerCase=function(a){return a.charAt(0).toLowerCase()+a.slice(1)},c.stripPrefix=function(b){return b.replace(a,"")},c.parseNumbers=function(a){return isNaN(a)||(a=a%1===0?parseInt(a,10):parseFloat(a)),a},c.parseBooleans=function(a){return/^(?:true|false)$/i.test(a)&&(a="true"===a.toLowerCase()),a}}).call(this)},{}],219:[function(a,b,c){(function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o={}.hasOwnProperty,p=function(a,b){return function(){return a.apply(b,arguments)}};k=a("sax"),f=a("events"),d=a("xmlbuilder"),b=a("./bom"),i=a("./processors"),l=a("timers").setImmediate,g=function(a){return"object"==typeof a&&null!=a&&0===Object.keys(a).length},h=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)e=a[c],b=e(b);return b},j=function(a){return a.indexOf("&")>=0||a.indexOf(">")>=0||a.indexOf("<")>=0},m=function(a){return"<![CDATA["+e(a)+"]]>"},e=function(a){return a.replace("]]>","]]]]><![CDATA[>")},c.processors=i,c.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,
attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}},c.ValidationError=function(a){function b(a){this.message=a}return n(b,a),b}(Error),c.Builder=function(){function a(a){var b,d,e;this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e)}return a.prototype.buildObject=function(a){var b,e,f,g,h;return b=this.options.attrkey,e=this.options.charkey,1===Object.keys(a).length&&this.options.rootName===c.defaults[.2].rootName?(h=Object.keys(a)[0],a=a[h]):h=this.options.rootName,f=function(a){return function(c,d){var g,h,i,k,l,n;if("object"!=typeof d)a.options.cdata&&j(d)?c.raw(m(d)):c.txt(d);else for(l in d)if(o.call(d,l))if(h=d[l],l===b){if("object"==typeof h)for(g in h)n=h[g],c=c.att(g,n)}else if(l===e)c=a.options.cdata&&j(h)?c.raw(m(h)):c.txt(h);else if(Array.isArray(h))for(k in h)o.call(h,k)&&(i=h[k],c="string"==typeof i?a.options.cdata&&j(i)?c.ele(l).raw(m(i)).up():c.ele(l,i).up():f(c.ele(l),i).up());else"object"==typeof h?c=f(c.ele(l),h).up():"string"==typeof h&&a.options.cdata&&j(h)?c=c.ele(l).raw(m(h)).up():(null==h&&(h=""),c=c.ele(l,h.toString()).up());return c}}(this),g=d.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),f(g,a).end(this.options.renderOpts)},a}(),c.Parser=function(a){function d(a){this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this);var b,d,e;if(!(this instanceof c.Parser))return new c.Parser(a);this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return n(d,a),d.prototype.processAsync=function(){var a,b,c;try{return this.remaining.length<=this.options.chunkSize?(a=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(a),this.saxParser.close()):(a=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(a),l(this.processAsync))}catch(c){if(b=c,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},d.prototype.assignOrPush=function(a,b,c){return b in a?(a[b]instanceof Array||(a[b]=[a[b]]),a[b].push(c)):this.options.explicitArray?a[b]=[c]:a[b]=c},d.prototype.reset=function(){var a,b,c,d;return this.removeAllListeners(),this.saxParser=k.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(a){return function(b){if(a.saxParser.resume(),!a.saxParser.errThrown)return a.saxParser.errThrown=!0,a.emit("error",b)}}(this),this.saxParser.onend=function(a){return function(){if(!a.saxParser.ended)return a.saxParser.ended=!0,a.emit("end",a.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,d=[],a=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(c){return function(e){var f,g,i,j,k;if(i={},i[b]="",!c.options.ignoreAttrs){k=e.attributes;for(f in k)o.call(k,f)&&(a in i||c.options.mergeAttrs||(i[a]={}),g=c.options.attrValueProcessors?h(c.options.attrValueProcessors,e.attributes[f]):e.attributes[f],j=c.options.attrNameProcessors?h(c.options.attrNameProcessors,f):f,c.options.mergeAttrs?c.assignOrPush(i,j,g):i[a][j]=g)}return i["#name"]=c.options.tagNameProcessors?h(c.options.tagNameProcessors,e.name):e.name,c.options.xmlns&&(i[c.options.xmlnskey]={uri:e.uri,local:e.local}),d.push(i)}}(this),this.saxParser.onclosetag=function(a){return function(){var c,e,f,i,j,k,l,m,n,p,q,r;if(m=d.pop(),l=m["#name"],a.options.explicitChildren&&a.options.preserveChildrenOrder||delete m["#name"],m.cdata===!0&&(c=m.cdata,delete m.cdata),q=d[d.length-1],m[b].match(/^\s*$/)&&!c?(e=m[b],delete m[b]):(a.options.trim&&(m[b]=m[b].trim()),a.options.normalize&&(m[b]=m[b].replace(/\s{2,}/g," ").trim()),m[b]=a.options.valueProcessors?h(a.options.valueProcessors,m[b]):m[b],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])),g(m)&&(m=""!==a.options.emptyTag?a.options.emptyTag:e),null!=a.options.validator){r="/"+function(){var a,b,c;for(c=[],a=0,b=d.length;a<b;a++)k=d[a],c.push(k["#name"]);return c}().concat(l).join("/");try{m=a.options.validator(r,q&&q[l],m)}catch(i){f=i,a.emit("error",f)}}if(a.options.explicitChildren&&!a.options.mergeAttrs&&"object"==typeof m)if(a.options.preserveChildrenOrder){if(q){q[a.options.childkey]=q[a.options.childkey]||[],n={};for(j in m)o.call(m,j)&&(n[j]=m[j]);q[a.options.childkey].push(n),delete m["#name"],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])}}else k={},a.options.attrkey in m&&(k[a.options.attrkey]=m[a.options.attrkey],delete m[a.options.attrkey]),!a.options.charsAsChildren&&a.options.charkey in m&&(k[a.options.charkey]=m[a.options.charkey],delete m[a.options.charkey]),Object.getOwnPropertyNames(m).length>0&&(k[a.options.childkey]=m),m=k;return d.length>0?a.assignOrPush(q,l,m):(a.options.explicitRoot&&(p=m,m={},m[l]=p),a.resultObject=m,a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),c=function(a){return function(c){var e,f;if(f=d[d.length-1])return f[b]+=c,a.options.explicitChildren&&a.options.preserveChildrenOrder&&a.options.charsAsChildren&&(a.options.includeWhiteChars||""!==c.replace(/\\n/g,"").trim())&&(f[a.options.childkey]=f[a.options.childkey]||[],e={"#name":"__text__"},e[b]=c,a.options.normalize&&(e[b]=e[b].replace(/\s{2,}/g," ").trim()),f[a.options.childkey].push(e)),f}}(this),this.saxParser.ontext=c,this.saxParser.oncdata=function(a){return function(a){var b;if(b=c(a))return b.cdata=!0}}(this)},d.prototype.parseString=function(a,c){var d,e;null!=c&&"function"==typeof c&&(this.on("end",function(a){return this.reset(),c(null,a)}),this.on("error",function(a){return this.reset(),c(a)}));try{return a=a.toString(),""===a.trim()?(this.emit("end",null),!0):(a=b.stripBOM(a),this.options.async?(this.remaining=a,l(this.processAsync),this.saxParser):this.saxParser.write(a).close())}catch(e){if(d=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",d),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw d}},d}(f.EventEmitter),c.parseString=function(a,b,d){var e,f,g;return null!=d?("function"==typeof d&&(e=d),"object"==typeof b&&(f=b)):("function"==typeof b&&(e=b),f={}),g=new c.Parser(f),g.parseString(a,e)}}).call(this)},{"./bom":217,"./processors":218,events:21,sax:186,timers:207,xmlbuilder:236}],220:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing attribute name of element "+a.name);if(null==c)throw new Error("Missing attribute value for attribute "+b+" of element "+a.name);this.name=this.stringify.attName(b),this.value=this.stringify.attValue(c)}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){return" "+this.name+'="'+this.value+'"'},a}()}).call(this)},{"lodash/create":126}],221:[function(a,b,c){(function(){var c,d,e,f,g;g=a("./XMLStringifier"),d=a("./XMLDeclaration"),e=a("./XMLDocType"),f=a("./XMLElement"),b.exports=c=function(){function a(a,b){var c,d;if(null==a)throw new Error("Root element needs a name");null==b&&(b={}),this.options=b,this.stringify=new g(b),d=new f(this,"doc"),c=d.element(a),c.isRoot=!0,c.documentObject=this,this.rootObject=c,b.headless||(c.declaration(b),null==b.pubID&&null==b.sysID||c.doctype(b))}return a.prototype.root=function(){return this.rootObject},a.prototype.end=function(a){return this.toString(a)},a.prototype.toString=function(a){var b,c,d,e,f,g,h,i;return e=(null!=a?a.pretty:void 0)||!1,b=null!=(g=null!=a?a.indent:void 0)?g:"  ",d=null!=(h=null!=a?a.offset:void 0)?h:0,c=null!=(i=null!=a?a.newline:void 0)?i:"\n",f="",null!=this.xmldec&&(f+=this.xmldec.toString(a)),null!=this.doctype&&(f+=this.doctype.toString(a)),f+=this.rootObject.toString(a),e&&f.slice(-c.length)===c&&(f=f.slice(0,-c.length)),f},a}()}).call(this)},{"./XMLDeclaration":228,"./XMLDocType":229,"./XMLElement":230,"./XMLStringifier":234}],222:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<![CDATA["+this.text+"]]>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":231,"lodash/create":126}],223:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing comment text");this.text=this.stringify.comment(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!-- "+this.text+" -->",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":231,"lodash/create":126}],224:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c,d,e,f){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");if(null==c)throw new Error("Missing DTD attribute name");if(!d)throw new Error("Missing DTD attribute type");if(!e)throw new Error("Missing DTD attribute default");if(0!==e.indexOf("#")&&(e="#"+e),!e.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(f&&!e.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(b),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(d),this.defaultValue=this.stringify.dtdAttDefault(f),this.defaultValueType=e}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ATTLIST "+this.elementName+" "+this.attributeName+" "+this.attributeType,"#DEFAULT"!==this.defaultValueType&&(g+=" "+this.defaultValueType),this.defaultValue&&(g+=' "'+this.defaultValue+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":126}],225:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(b),this.value=this.stringify.dtdElementValue(c)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ELEMENT "+this.name+" "+this.value+">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":126}],226:[function(a,b,c){(function(){var c,d,e;d=a("lodash/create"),e=a("lodash/isObject"),b.exports=c=function(){function a(a,b,c,d){if(this.stringify=a.stringify,null==c)throw new Error("Missing entity name");if(null==d)throw new Error("Missing entity value");if(this.pe=!!b,this.name=this.stringify.eleName(c),e(d)){if(!d.pubID&&!d.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(d.pubID&&!d.sysID)throw new Error("System identifier is required for a public external entity");if(null!=d.pubID&&(this.pubID=this.stringify.dtdPubID(d.pubID)),null!=d.sysID&&(this.sysID=this.stringify.dtdSysID(d.sysID)),null!=d.nData&&(this.nData=this.stringify.dtdNData(d.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(d)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ENTITY",this.pe&&(g+=" %"),g+=" "+this.name,this.value?g+=' "'+this.value+'"':(this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),this.nData&&(g+=" NDATA "+this.nData)),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":126,"lodash/isObject":140}],227:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(b),null!=c.pubID&&(this.pubID=this.stringify.dtdPubID(c.pubID)),null!=c.sysID&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!NOTATION "+this.name,this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.pubID?g+=' PUBLIC "'+this.pubID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":126}],228:[function(a,b,c){(function(){var c,d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;e=a("lodash/create"),f=a("lodash/isObject"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c,d,e){var g;b.__super__.constructor.call(this,a),f(c)&&(g=c,c=g.version,d=g.encoding,e=g.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),null!=d&&(this.encoding=this.stringify.xmlEncoding(d)),null!=e&&(this.standalone=this.stringify.xmlStandalone(e))}return g(b,a),b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?xml",g+=' version="'+this.version+'"',null!=this.encoding&&(g+=' encoding="'+this.encoding+'"'),null!=this.standalone&&(g+=' standalone="'+this.standalone+'"'),g+="?>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":231,"lodash/create":126,"lodash/isObject":140}],229:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l;k=a("lodash/create"),l=a("lodash/isObject"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDTDAttList"),g=a("./XMLDTDEntity"),f=a("./XMLDTDElement"),h=a("./XMLDTDNotation"),j=a("./XMLProcessingInstruction"),b.exports=i=function(){function a(a,b,c){var d,e;this.documentObject=a,this.stringify=this.documentObject.stringify,this.children=[],l(b)&&(d=b,b=d.pubID,c=d.sysID),null==c&&(e=[b,c],c=e[0],b=e[1]),null!=b&&(this.pubID=this.stringify.dtdPubID(b)),null!=c&&(this.sysID=this.stringify.dtdSysID(c))}return a.prototype.element=function(a,b){var c;return c=new f(this,a,b),this.children.push(c),this},a.prototype.attList=function(a,b,c,d,f){var g;return g=new e(this,a,b,c,d,f),this.children.push(g),this},a.prototype.entity=function(a,b){var c;return c=new g(this,!1,a,b),this.children.push(c),this},a.prototype.pEntity=function(a,b){var c;return c=new g(this,!0,a,b),this.children.push(c),this},a.prototype.notation=function(a,b){var c;return c=new h(this,a,b),this.children.push(c),this},a.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},a.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},a.prototype.instruction=function(a,b){var c;return c=new j(this,a,b),this.children.push(c),this},a.prototype.root=function(){return this.documentObject.root()},a.prototype.document=function(){return this.documentObject},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(i=(null!=a?a.pretty:void 0)||!1,e=null!=(k=null!=a?a.indent:void 0)?k:"  ",h=null!=(l=null!=a?a.offset:void 0)?l:0,g=null!=(m=null!=a?a.newline:void 0)?m:"\n",b||(b=0),o=new Array(b+h+1).join(e),j="",i&&(j+=o),j+="<!DOCTYPE "+this.root().name,this.pubID&&this.sysID?j+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(j+=' SYSTEM "'+this.sysID+'"'),this.children.length>0){for(j+=" [",i&&(j+=g),n=this.children,d=0,f=n.length;d<f;d++)c=n[d],j+=c.toString(a,b+1);j+="]"}return j+=">",i&&(j+=g),j},a.prototype.ele=function(a,b){return this.element(a,b)},a.prototype.att=function(a,b,c,d,e){return this.attList(a,b,c,d,e)},a.prototype.ent=function(a,b){return this.entity(a,b)},a.prototype.pent=function(a,b){return this.pEntity(a,b)},a.prototype.not=function(a,b){return this.notation(a,b)},a.prototype.dat=function(a){return this.cdata(a)},a.prototype.com=function(a){return this.comment(a)},a.prototype.ins=function(a,b){return this.instruction(a,b)},a.prototype.up=function(){return this.root()},a.prototype.doc=function(){return this.document()},a}()}).call(this)},{"./XMLCData":222,"./XMLComment":223,"./XMLDTDAttList":224,"./XMLDTDElement":225,"./XMLDTDEntity":226,"./XMLDTDNotation":227,"./XMLProcessingInstruction":232,"lodash/create":126,"lodash/isObject":140}],230:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;g=a("lodash/create"),j=a("lodash/isObject"),i=a("lodash/isFunction"),h=a("lodash/every"),e=a("./XMLNode"),c=a("./XMLAttribute"),f=a("./XMLProcessingInstruction"),b.exports=d=function(a){function b(a,c,d){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element name");this.name=this.stringify.eleName(c),this.children=[],this.instructions=[],this.attributes={},null!=d&&this.attribute(d)}return k(b,a),b.prototype.clone=function(){var a,c,d,e,f,h,i,j;d=g(b.prototype,this),d.isRoot&&(d.documentObject=null),d.attributes={},i=this.attributes;for(c in i)l.call(i,c)&&(a=i[c],d.attributes[c]=a.clone());for(d.instructions=[],j=this.instructions,e=0,f=j.length;e<f;e++)h=j[e],d.instructions.push(h.clone());return d.children=[],this.children.forEach(function(a){var b;return b=a.clone(),b.parent=d,d.children.push(b)}),d},b.prototype.attribute=function(a,b){var d,e;if(null!=a&&(a=a.valueOf()),j(a))for(d in a)l.call(a,d)&&(e=a[d],this.attribute(d,e));else i(b)&&(b=b.apply()),this.options.skipNullAttributes&&null==b||(this.attributes[a]=new c(this,a,b));return this},b.prototype.removeAttribute=function(a){var b,c,d;if(null==a)throw new Error("Missing attribute name");if(a=a.valueOf(),Array.isArray(a))for(c=0,d=a.length;c<d;c++)b=a[c],delete this.attributes[b];else delete this.attributes[a];return this},b.prototype.instruction=function(a,b){var c,d,e,g,h;if(null!=a&&(a=a.valueOf()),null!=b&&(b=b.valueOf()),Array.isArray(a))for(c=0,h=a.length;c<h;c++)d=a[c],this.instruction(d);else if(j(a))for(d in a)l.call(a,d)&&(e=a[d],this.instruction(d,e));else i(b)&&(b=b.apply()),g=new f(this,a,b),this.instructions.push(g);return this},b.prototype.toString=function(a,b){var c,d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x;for(p=(null!=a?a.pretty:void 0)||!1,f=null!=(r=null!=a?a.indent:void 0)?r:"  ",o=null!=(s=null!=a?a.offset:void 0)?s:0,n=null!=(t=null!=a?a.newline:void 0)?t:"\n",b||(b=0),x=new Array(b+o+1).join(f),q="",u=this.instructions,e=0,j=u.length;e<j;e++)g=u[e],q+=g.toString(a,b);p&&(q+=x),q+="<"+this.name,v=this.attributes;for(m in v)l.call(v,m)&&(c=v[m],q+=c.toString(a));if(0===this.children.length||h(this.children,function(a){return""===a.value}))q+="/>",p&&(q+=n);else if(p&&1===this.children.length&&null!=this.children[0].value)q+=">",q+=this.children[0].value,q+="</"+this.name+">",q+=n;else{for(q+=">",p&&(q+=n),w=this.children,i=0,k=w.length;i<k;i++)d=w[i],q+=d.toString(a,b+1);p&&(q+=x),q+="</"+this.name+">",p&&(q+=n)}return q},b.prototype.att=function(a,b){return this.attribute(a,b)},b.prototype.ins=function(a,b){return this.instruction(a,b)},b.prototype.a=function(a,b){return this.attribute(a,b)},b.prototype.i=function(a,b){return this.instruction(a,b)},b}(e)}).call(this)},{"./XMLAttribute":220,"./XMLNode":231,"./XMLProcessingInstruction":232,"lodash/create":126,"lodash/every":128,"lodash/isFunction":138,"lodash/isObject":140}],231:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty;m=a("lodash/isObject"),l=a("lodash/isFunction"),k=a("lodash/isEmpty"),g=null,c=null,d=null,e=null,f=null,i=null,j=null,b.exports=h=function(){function b(b){this.parent=b,this.options=this.parent.options,this.stringify=this.parent.stringify,null===g&&(g=a("./XMLElement"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDeclaration"),f=a("./XMLDocType"),i=a("./XMLRaw"),j=a("./XMLText"))}return b.prototype.element=function(a,b,c){var d,e,f,g,h,i,j,o,p,q;if(i=null,null==b&&(b={}),b=b.valueOf(),m(b)||(p=[b,c],c=p[0],b=p[1]),null!=a&&(a=a.valueOf()),Array.isArray(a))for(f=0,j=a.length;f<j;f++)e=a[f],i=this.element(e);else if(l(a))i=this.element(a.apply());else if(m(a)){for(h in a)if(n.call(a,h))if(q=a[h],l(q)&&(q=q.apply()),m(q)&&k(q)&&(q=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===h.indexOf(this.stringify.convertAttKey))i=this.attribute(h.substr(this.stringify.convertAttKey.length),q);else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===h.indexOf(this.stringify.convertPIKey))i=this.instruction(h.substr(this.stringify.convertPIKey.length),q);else if(!this.options.separateArrayItems&&Array.isArray(q))for(g=0,o=q.length;g<o;g++)e=q[g],d={},d[h]=e,i=this.element(d);else m(q)?(i=this.element(h),i.element(q)):i=this.element(h,q)}else i=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?this.text(c):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===a.indexOf(this.stringify.convertCDataKey)?this.cdata(c):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===a.indexOf(this.stringify.convertCommentKey)?this.comment(c):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===a.indexOf(this.stringify.convertRawKey)?this.raw(c):this.node(a,b,c);if(null==i)throw new Error("Could not create any elements with: "+a);return i},b.prototype.insertBefore=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.insertAfter=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e+1),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.remove=function(){var a,b;if(this.isRoot)throw new Error("Cannot remove the root element");return a=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[a,a-a+1].concat(b=[])),b,this.parent},b.prototype.node=function(a,b,c){var d,e;return null!=a&&(a=a.valueOf()),null==b&&(b={}),b=b.valueOf(),m(b)||(e=[b,c],c=e[0],b=e[1]),d=new g(this,a,b),null!=c&&d.text(c),this.children.push(d),d},b.prototype.text=function(a){var b;return b=new j(this,a),this.children.push(b),this},b.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},b.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},b.prototype.raw=function(a){var b;return b=new i(this,a),this.children.push(b),this},b.prototype.declaration=function(a,b,c){var d,f;return d=this.document(),f=new e(d,a,b,c),d.xmldec=f,d.root()},b.prototype.doctype=function(a,b){var c,d;return c=this.document(),d=new f(c,a,b),c.doctype=d,d},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var a;if(this.isRoot)return this;for(a=this.parent;!a.isRoot;)a=a.parent;return a},b.prototype.document=function(){return this.root().documentObject},b.prototype.end=function(a){return this.document().toString(a)},b.prototype.prev=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),a<1)throw new Error("Already at the first node");return this.parent.children[a-1]},b.prototype.next=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),a===-1||a===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[a+1]},b.prototype.importXMLBuilder=function(a){var b;return b=a.root().clone(),b.parent=this,b.isRoot=!1,this.children.push(b),this},b.prototype.ele=function(a,b,c){return this.element(a,b,c)},b.prototype.nod=function(a,b,c){return this.node(a,b,c)},b.prototype.txt=function(a){return this.text(a)},b.prototype.dat=function(a){return this.cdata(a)},b.prototype.com=function(a){return this.comment(a)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(a,b,c){return this.declaration(a,b,c)},b.prototype.dtd=function(a,b){return this.doctype(a,b)},b.prototype.e=function(a,b,c){return this.element(a,b,c)},b.prototype.n=function(a,b,c){return this.node(a,b,c)},b.prototype.t=function(a){return this.text(a)},b.prototype.d=function(a){return this.cdata(a)},b.prototype.c=function(a){return this.comment(a)},b.prototype.r=function(a){return this.raw(a)},b.prototype.u=function(){return this.up()},b}()}).call(this)},{"./XMLCData":222,"./XMLComment":223,"./XMLDeclaration":228,"./XMLDocType":229,"./XMLElement":230,"./XMLRaw":233,"./XMLText":235,"lodash/isEmpty":137,"lodash/isFunction":138,"lodash/isObject":140}],232:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(b),c&&(this.value=this.stringify.insValue(c))}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?",g+=this.target,this.value&&(g+=" "+this.value),g+="?>",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":126}],233:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing raw text");this.value=this.stringify.raw(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":231,"lodash/create":126}],234:[function(a,b,c){(function(){var a,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty;b.exports=a=function(){function a(a){this.assertLegalChar=c(this.assertLegalChar,this);var b,e,f;this.allowSurrogateChars=null!=a?a.allowSurrogateChars:void 0,this.noDoubleEncoding=null!=a?a.noDoubleEncoding:void 0,e=(null!=a?a.stringify:void 0)||{};for(b in e)d.call(e,b)&&(f=e[b],this[b]=f)}return a.prototype.eleName=function(a){return a=""+a||"",this.assertLegalChar(a)},a.prototype.eleText=function(a){return a=""+a||"",this.assertLegalChar(this.elEscape(a))},a.prototype.cdata=function(a){if(a=""+a||"",a.match(/]]>/))throw new Error("Invalid CDATA text: "+a);return this.assertLegalChar(a)},a.prototype.comment=function(a){if(a=""+a||"",a.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+a);return this.assertLegalChar(a)},a.prototype.raw=function(a){return""+a||""},a.prototype.attName=function(a){return""+a||""},a.prototype.attValue=function(a){return a=""+a||"",this.attEscape(a)},a.prototype.insTarget=function(a){return""+a||""},a.prototype.insValue=function(a){if(a=""+a||"",a.match(/\?>/))throw new Error("Invalid processing instruction value: "+a);return a},a.prototype.xmlVersion=function(a){if(a=""+a||"",!a.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+a);return a},a.prototype.xmlEncoding=function(a){if(a=""+a||"",!a.match(/^[A-Za-z](?:[A-Za-z0-9._-]|-)*$/))throw new Error("Invalid encoding: "+a);return a},a.prototype.xmlStandalone=function(a){return a?"yes":"no"},a.prototype.dtdPubID=function(a){return""+a||""},a.prototype.dtdSysID=function(a){return""+a||""},a.prototype.dtdElementValue=function(a){return""+a||""},a.prototype.dtdAttType=function(a){return""+a||""},a.prototype.dtdAttDefault=function(a){return null!=a?""+a||"":a},a.prototype.dtdEntityValue=function(a){return""+a||""},a.prototype.dtdNData=function(a){return""+a||""},a.prototype.convertAttKey="@",a.prototype.convertPIKey="?",a.prototype.convertTextKey="#text",a.prototype.convertCDataKey="#cdata",a.prototype.convertCommentKey="#comment",a.prototype.convertRawKey="#raw",a.prototype.assertLegalChar=function(a){var b,c;if(b=this.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,c=a.match(b))throw new Error("Invalid character ("+c+") in string: "+a+" at index "+c.index);return a},a.prototype.elEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},a.prototype.attEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");
},a}()}).call(this)},{}],235:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element text");this.value=this.stringify.eleText(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":231,"lodash/create":126}],236:[function(a,b,c){(function(){var c,d;d=a("lodash/assign"),c=a("./XMLBuilder"),b.exports.create=function(a,b,e,f){return f=d({},b,e,f),new c(a,f).root()}}).call(this)},{"./XMLBuilder":221,"lodash/assign":125}],237:[function(a,b,c){function d(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)e.call(c,d)&&(a[d]=c[d])}return a}b.exports=d;var e=Object.prototype.hasOwnProperty},{}],238:[function(a,b,c){arguments[4][8][0].apply(c,arguments)},{"./lib/uint32":239,"./lib/uint64":240,dup:8}],239:[function(a,b,c){arguments[4][9][0].apply(c,arguments)},{dup:9}],240:[function(a,b,c){arguments[4][10][0].apply(c,arguments)},{dup:10}],241:[function(a,c,d){(function(d){!function(e){function f(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a.charCodeAt(c);e<128?b.push(e):e<2048?b.push(192|e>>6,128|63&e):e<55296||e>=57344?b.push(224|e>>12,128|e>>6&63,128|63&e):(c++,e=65536+((1023&e)<<10|1023&a.charCodeAt(c)),b.push(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e))}return new Uint8Array(b)}function g(){return 2==arguments.length?new g(arguments[1]).update(arguments[0]).digest():this instanceof g?void h.call(this,arguments[0]):new g(arguments[0])}function h(a){return this.seed=a instanceof i?a.clone():i(a),this.v1=this.seed.clone().add(o),this.v2=this.seed.clone().add(k),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(j),this.total_len=0,this.memsize=0,this.memory=null,this}var i=a("cuint").UINT32;i.prototype.xxh_update=function(a,b){var c,d,e=k._low,f=k._high;d=a*e,c=d>>>16,c+=b*e,c&=65535,c+=a*f;var g=this._low+(65535&d),h=g>>>16;h+=this._high+(65535&c);var i=h<<16|65535&g;i=i<<13|i>>>19,g=65535&i,h=i>>>16,e=j._low,f=j._high,d=g*e,c=d>>>16,c+=h*e,c&=65535,c+=g*f,this._low=65535&d,this._high=65535&c};var j=i("2654435761"),k=i("2246822519"),l=i("3266489917"),m=i("668265263"),n=i("374761393"),o=j.clone().add(k);g.prototype.init=h,g.prototype.update=function(a){var b,c="string"==typeof a;c&&(a=f(a),c=!1,b=!0),"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer&&(b=!0,a=new Uint8Array(a));var e=0,g=a.length,h=e+g;if(0==g)return this;if(this.total_len+=g,0==this.memsize&&(c?this.memory="":b?this.memory=new Uint8Array(16):this.memory=new d(16)),this.memsize+g<16)return c?this.memory+=a:b?this.memory.set(a.subarray(0,g),this.memsize):a.copy(this.memory,this.memsize,0,g),this.memsize+=g,this;if(this.memsize>0){c?this.memory+=a.slice(0,16-this.memsize):b?this.memory.set(a.subarray(0,16-this.memsize),this.memsize):a.copy(this.memory,this.memsize,0,16-this.memsize);var i=0;c?(this.v1.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v2.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v3.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2)),i+=4,this.v4.xxh_update(this.memory.charCodeAt(i+1)<<8|this.memory.charCodeAt(i),this.memory.charCodeAt(i+3)<<8|this.memory.charCodeAt(i+2))):(this.v1.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v2.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v3.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2]),i+=4,this.v4.xxh_update(this.memory[i+1]<<8|this.memory[i],this.memory[i+3]<<8|this.memory[i+2])),e+=16-this.memsize,this.memsize=0,c&&(this.memory="")}if(e<=h-16){var j=h-16;do c?(this.v1.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v2.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v3.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2)),e+=4,this.v4.xxh_update(a.charCodeAt(e+1)<<8|a.charCodeAt(e),a.charCodeAt(e+3)<<8|a.charCodeAt(e+2))):(this.v1.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v2.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v3.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2]),e+=4,this.v4.xxh_update(a[e+1]<<8|a[e],a[e+3]<<8|a[e+2])),e+=4;while(e<=j)}return e<h&&(c?this.memory+=a.slice(e):b?this.memory.set(a.subarray(e,h),this.memsize):a.copy(this.memory,this.memsize,e,h),this.memsize=h-e),this},g.prototype.digest=function(){var a,b,c=this.memory,d="string"==typeof c,e=0,f=this.memsize,g=new i;for(a=this.total_len>=16?this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):this.seed.add(n),a.add(g.fromNumber(this.total_len));e<=f-4;)d?g.fromBits(c.charCodeAt(e+1)<<8|c.charCodeAt(e),c.charCodeAt(e+3)<<8|c.charCodeAt(e+2)):g.fromBits(c[e+1]<<8|c[e],c[e+3]<<8|c[e+2]),a.add(g.multiply(l)).rotl(17).multiply(m),e+=4;for(;e<f;)g.fromBits(d?c.charCodeAt(e++):c[e++],0),a.add(g.multiply(n)).rotl(11).multiply(j);return b=a.clone().shiftRight(15),a.xor(b).multiply(k),b=a.clone().shiftRight(13),a.xor(b).multiply(l),b=a.clone().shiftRight(16),a.xor(b),this.init(this.seed),a},"undefined"!=typeof b&&b.amd?b([],function(){return g}):"undefined"!=typeof c&&c.exports?c.exports=g:e.XXH=g}(this)}).call(this,a("buffer").Buffer)},{buffer:6,cuint:238}],242:[function(a,b,c){"use strict";function d(b){[a("./nodes/visual/group"),a("./nodes/visual/image"),a("./nodes/visual/rectangle"),a("./nodes/visual/circle"),a("./nodes/visual/text"),a("./nodes/visual/stacklayout"),a("./nodes/visual/flowlayout"),a("./nodes/visual/scrollview"),a("./nodes/counter"),a("./nodes/expression"),a("./nodes/and"),a("./nodes/or"),a("./nodes/switch"),a("./nodes/numberblend"),a("./nodes/stringselector"),a("./nodes/stringmapper"),a("./nodes/drag"),a("./nodes/inverter"),a("./nodes/timer"),a("./nodes/velocity"),a("./nodes/variables/number"),a("./nodes/variables/string"),a("./nodes/variables/boolean"),a("./nodes/variables/color"),a("./nodes/touchposition"),a("./nodes/signaltoindex"),a("./nodes/substring"),a("./nodes/gyroscope"),a("./nodes/reload"),a("./nodes/colorblend"),a("./nodes/globals"),a("./nodes/eventsender"),a("./nodes/eventreceiver"),a("./nodes/screenresolution"),a("./nodes/javascript"),a("./nodes/javascript2"),a("./nodes/animation"),a("./nodes/transition"),a("./nodes/numberremapper"),a("./nodes/websocket"),a("./nodes/componentinputs"),a("./nodes/componentoutputs"),a("./nodes/valuechanged"),a("./nodes/visual/textinput"),a("./nodes/visual/page"),a("./nodes/visual/pages"),a("./nodes/pagenavigation"),a("./nodes/pagenavigationback"),a("./nodes/states"),a("./nodes/stringformat"),a("./nodes/data/foreach"),a("./nodes/data/foreachactions"),a("./nodes/data/modelnode"),a("./nodes/data/collectionnode"),a("./nodes/data/staticdata"),a("./nodes/data/restnode"),a("./nodes/sendmessage"),a("./nodes/receivemessage")].forEach(function(a){b.registerNode(a)})}function e(a){if(!a)return{};for(var b={},c=a.substr(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return b}function f(a){function b(a,b){if(c.rootComponent){var d=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);d.forEach(function(a){a.setHighlightEnabled&&a.setHighlightEnabled(b)})}}var c=this;a=a||{},f.instance=this,this.frameScheduled=!1,this.rootComponent=null,this._currentLoadedData=null,this.isWaitingForExport=!0,this.graphModel=new l,this.runningInEditor=!a.runStandalone,n.instance.setIsRunningInEditor(this.runningInEditor),this.editorConnection=new h,this.editorConnection.on("exportDataFull",function(a){c.patchExportData(a)===!1?(c.isWaitingForExport=!1,c.setData(a)):c.editorConnection.requestFullExport()}),this.editorConnection.on("hoverStart",function(a){b(a,!0)}),this.editorConnection.on("hoverEnd",function(a){b(a,!1)}),this.editorConnection.on("reload",this.reload.bind(this)),this.editorConnection.on("inspectStart",function(){c.enableInspector(function(a){c.editorConnection.sendInspectId(a)})}),this.editorConnection.on("inspectEnd",this.disableInspector.bind(this)),this.editorConnection.on("modelUpdate",this.onModelUpdateReceived.bind(this)),this.context=new g({runningInEditor:this.runningInEditor,editorConnection:this.editorConnection}),this.editorConnection.isRunningLocally()&&(this.context.setOutputCollectionEnabled(!0),this.editorConnection.on("connected",function(){c.sendNodeLibrary()})),this.editorConnection.on("debuggingEnabledChanged",this.context.setOutputCollectionEnabled.bind(this.context)),this.editorConnection.on("captureScreenShot",function(a){a.callback(c.context.uiEngine.captureScreenShot(a.width,a.height))}),this.context.eventEmitter.on("scheduleFrame",this.scheduleFrame.bind(this)),this.context.eventEmitter.on("reloadApplication",this.reload.bind(this)),this.registerGraphModelListeners(),this._resetData(),d(this),this.inspector=new v,this.textInputRenderer=new t,this.textInputRenderer.setRenderInputFieldsOnly(!0),p.pubsub=new q,p.pubsub.setConnection(this.editorConnection)}var g=a("./nodecontext"),h=a("./editorconnection"),i=a("./nodelibraryexport"),j=a("./projectsettings"),k=a("./projectpatchers"),l=a("./models/graphmodel"),m=a("./nodedefinition"),n=a("./fontloader"),o=a("./editormodeleventshandler"),p=a("./services/services"),q=a("./services/pubsub"),r=a("./services/mqtt-connection"),s=a("./uiengine/renderers/renderer-canvas2d"),t=a("./uiengine/renderers/renderer-dom"),u=a("./uiengine/renderers/renderer-webgl"),v=a("./inspector"),w=a("./useragent-utils"),x=a("./session-recorder"),y=a("./guid");f.prototype.registerGraphModelListeners=function(){var a=this;this.graphModel.on("componentAdded",function(b){a.context.registerComponentModel(b)},this),this.graphModel.on("componentRemoved",function(b){a.context.deregisterComponentModel(b)},this),this.graphModel.on("settingsUpdated",function(){a.setViewportSettings(a.graphModel.getDeviceSettings(a.deviceName)),a.sendNodeLibrary()})},f.prototype.reload=function(){this._currentLoadedData&&this.setData(this._currentLoadedData)},f.prototype._resetData=function(){this.frameNumber=0,this.rootComponent=null,this._currentLoadedData=null,this.graphModel.reset(),this.context.reset()},f.prototype.registerNode=function(a){a.node?(this.context.nodeRegister.register(m.defineNode(a.node)),a.setup&&a.setup(this.context,this.graphModel)):this.context.nodeRegister.register(a)},f.prototype.patchExportData=function(a){var b=k.collectPatches(a),c=Object.keys(b),d=j.collectPatch(a.settings),e=this;return!!(c.length>0||d)&&(this.editorConnection.isRunningLocally()&&(c.forEach(function(a){e.editorConnection.sendPatches(b[a])}),d&&e.editorConnection.sendPatches(d)),!0)},f.prototype.setRenderer=function(a){var b=this.context.uiEngine;b.removeAllRenderers();var c=w.isMobile.any();"canvas2d"===a?(b.addRenderer(new s({alpha:!1,useScreenResolution:c})),b.addRenderer(this.textInputRenderer)):"webgl"===a?(b.addRenderer(new u({alpha:!1})),b.addRenderer(this.textInputRenderer)):b.addRenderer(new t),this.sessionRecorder&&b.addRenderer(this.sessionRecorder.getRenderer())},f.prototype.setViewportSettings=function(a){this.currentRenderer!==a.renderer&&(this.setRenderer(a.renderer),this.currentRenderer=a.renderer),this.context.uiEngine.setFillMode(a.fillMode),"aspectFit"===a.fillMode&&this.context.uiEngine.setAspectFitViewport(a.canvasWidth,a.canvasHeight)},f.prototype.setData=function(a){this.graphModel.isEmpty()===!1&&this._resetData();var b=a.settings.devices&&a.settings.devices.split(",").length>1,c=e(window.location.search),d=this.editorConnection.isRunningLocally()===!1&&b>0&&!c.device;if(d){var f=JSON.stringify({settings:{devices:"Default Device","Default Device.fillMode":"fill","Default Device.renderer":"canvas2d","Default Device.rootComponent":"/Main"},components:[{name:"/Main",nodes:[{id:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b",type:"Group",parameters:{fill:"parent"},ports:[],children:[{id:"fa90ea16-1232-0437-deea-5dd6263d8247",type:"Rectangle",parameters:{color:"#ebebf2"},ports:[],children:[]},{id:"84ce46fb-1240-c8b1-6cf8-d49b466af961",type:"Scroll View",parameters:{sizeMode:"explicit",alignX:"left",alignY:"top",clip:!0,paddingTop:50,paddingBottom:50,itemSpacing:20},ports:[],children:[{id:"919460fe-c10e-9656-1924-3b39afe0a908",type:"Text",version:2,parameters:{text:"NOODL DEVICE LIST",color:"#666666",fontSize:26,x:30,fontFamily:"fonts/Roboto-Regular.ttf"},ports:[],children:[]},{id:"88e5bc50-f85b-7cfc-61a9-8a8e947a91e0",type:"Stack Layout",parameters:{sizeMode:"childHeight"},ports:[],children:[{id:"6fff1cb1-b58c-aafd-8790-951dd51e2230",type:"For Each",parameters:{template:"/Device Item"},ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance",index:3}],children:[]}]},{id:"01d3bb07-74e9-f7c5-442b-dda6601882b7",type:"Text",version:2,parameters:{text:"Choose a device from the list",color:"#666666",fontSize:16,x:30,fontFamily:"fonts/Roboto-Light.ttf"},ports:[],children:[]}]}]},{id:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",type:"Collection",parameters:{collectionId:"Devices"},ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General",index:9}],children:[]},{id:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",type:"Static Data",parameters:{csv:"DeviceName\nDevice 1\nMy Other Device\nSome third device"},ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General",index:2}],children:[]}],connections:[{sourceId:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",sourcePort:"items",targetId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",targetPort:"items"},{sourceId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",sourcePort:"items",targetId:"6fff1cb1-b58c-aafd-8790-951dd51e2230",targetPort:"items"}],ports:[],roots:["2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"]},{name:"/Device Item",nodes:[{id:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",type:"Group",version:2,parameters:{sizeMode:"explicit",height:{value:55,unit:"px"}},ports:[],children:[{id:"73bb365b-38c7-efde-1516-d06c61315551",type:"Rectangle",parameters:{color:"#ffffff"},ports:[],children:[]},{id:"1e991ed3-43de-e5ac-f939-1162d2bb010f",type:"Rectangle",parameters:{alignY:"top",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"a857ab77-b302-ec9d-b820-52be3faf623d",type:"Rectangle",parameters:{alignY:"bottom",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"0e012b10-9938-cedd-cb1d-8f643353367d",type:"Group",version:2,parameters:{sizeMode:"explicit",paddingLeft:30,paddingRight:30},ports:[],children:[{id:"8ecd1a84-167a-67c3-ea68-eca597baf606",type:"Rectangle",parameters:{alignY:"bottom",color:"#c8c7cc",height:{value:1,unit:"px"}},ports:[],children:[]},{id:"84669e81-f629-9b95-e309-a409ef64ff2e",type:"Text",version:2,parameters:{color:"#000000",fontFamily:"fonts/Roboto-Light.ttf",alignX:"left",alignY:"center",sizeMode:"childHeight",fontSize:20},ports:[],children:[]},{id:"7e35cfcb-81a5-14d4-6e30-cf04ff69ec6f",type:"Group",version:2,parameters:{alignY:"center",sizeMode:"childSize",alignX:"right"},ports:[],children:[{id:"7210c16d-d9cf-604f-cd4e-c3014d6487ee",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#666666",rotationZ:45,y:-3},ports:[],children:[]},{id:"5faf645f-3c87-219c-3371-3eeda03986bc",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#666666",rotationZ:-45,y:4},ports:[],children:[]}]}]}]},{id:"26f178df-a067-6a5f-1d93-d146462b9c0b",type:"Model",parameters:{idType:"instance",properties:"DeviceName"},ports:[{type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:"DeviceName",index:6}],children:[]},{id:"ce5249b7-7681-8532-080b-47206583620c",type:"Collection",parameters:{collectionId:"Devices"},ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General",index:9}],children:[]},{id:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",type:"Expression",parameters:{expression:"childIndex < count - 1"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2},{name:"count",type:{name:"number"},plug:"input",index:3}],children:[]},{id:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",type:"Event Sender",parameters:{channelName:"Device Chosen"},ports:[{name:"DeviceName",plug:"input",type:{name:"*",allowConnectionOnly:!0},index:1}],children:[]},{id:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",type:"Expression",parameters:{expression:"childIndex === 0"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2}],children:[]},{id:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",type:"Expression",parameters:{expression:"childIndex === count - 1"},ports:[{name:"childIndex",type:{name:"number"},plug:"input",index:2},{name:"count",type:{name:"number"},plug:"input",index:3}],children:[]}],connections:[{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"84669e81-f629-9b95-e309-a409ef64ff2e",targetPort:"text"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",targetPort:"childIndex"},{sourceId:"ce5249b7-7681-8532-080b-47206583620c",sourcePort:"count",targetId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",targetPort:"count"},{sourceId:"90b0f462-064f-4a96-98f5-e0b99d2c2f42",sourcePort:"result",targetId:"8ecd1a84-167a-67c3-ea68-eca597baf606",targetPort:"visible"},{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"DeviceName"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"touch.tap",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"sendEvent"},{sourceId:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",sourcePort:"result",targetId:"1e991ed3-43de-e5ac-f939-1162d2bb010f",targetPort:"visible"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"bf2def97-8cbf-a904-91ea-42f4fb14ccf8",targetPort:"childIndex"},{sourceId:"ce5249b7-7681-8532-080b-47206583620c",sourcePort:"count",targetId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",targetPort:"count"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"childIndex",targetId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",targetPort:"childIndex"},{sourceId:"55ae463a-5ceb-2a1b-827f-19a30dc7895e",sourcePort:"result",targetId:"a857ab77-b302-ec9d-b820-52be3faf623d",targetPort:"visible"}],ports:[],roots:["ccd8d324-7db3-d669-1099-dd84a0da6cf1"]}],rootComponent:"/Main",rootNode:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"});f=f.replace(/fonts\//g,"external/viewer/fonts/"),f=JSON.parse(f),this._currentLoadedData=f,this.graphModel.importEditorData(f),this.graphModel.getComponentWithName("/Main").removeNodeWithId(this.graphModel.getNodesWithType("Static Data")[0].id),this.deviceName="Default Device",this.context.eventSenderEmitter.once("Device Chosen",function(a){window.location=window.location.href+"?device="+a.DeviceName}),this.editorConnection.close()}else{this._currentLoadedData=a,this.graphModel.importEditorData(a);var g=this.graphModel.getSettings();this.runningInEditor===!1&&g.analyticsEnabled&&this.recordSession(this.graphModel.getSettings().analyticsServerUrl),g.mqttUseExternalBroker?(this.mqttConnection||(this.mqttConnection=new r),this.mqttConnection.connect({url:g.mqttBrokerUrl,clientId:(this.deviceName||"Noodl Editor")+"-"+y()}),p.pubsub.setConnection(this.mqttConnection)):p.pubsub.setConnection(this.editorConnection)}var h=this.graphModel.getDeviceSettings(c.device);this.deviceName=h.name;var i,j;if(this.editorConnection.isRunningLocally()&&!c.device?(i=this.graphModel.rootComponent,j=this.graphModel.rootNode):(i=h.rootComponent||this.graphModel.rootComponent,j=h.rootId),j||(j=this.graphModel.getComponentWithName(i).getFirstRootId()),this.rootComponent=this.context.createComponentInstanceNode(i),this.rootComponent.setRoot(j),this.context.setRootComponent(this.rootComponent),this.setViewportSettings(h),window.Noodl=this.rootComponent.nodeScope.noodlJavascriptAPI,d){var k=a.settings.devices.split(",").map(function(a){return{DeviceName:a}});this.rootComponent.nodeScope.noodlJavascriptAPI.Collection.get("Devices").set(k)}this.scheduleFrame()},f.prototype.scheduleFrame=function(){this.frameScheduled||(window.requestAnimationFrame(f.prototype._doFrame.bind(this)),this.frameScheduled=!0)},f.prototype._doFrame=function(){this.frameScheduled=!1,this.context.currentFrameTime=window.performance.now(),this.context.eventEmitter.emit("frameStart"),this.context.update(),this.context.layout(),this.context.update(),this.context.uiEngine.renderFrame(),this.context.eventEmitter.emit("frameEnd"),this.frameNumber++},f.prototype.getNodeLibrary=function(){var a=j.generateProjectSettings(this.graphModel.getRawProjectSettings()),b=i(this.context.nodeRegister);return b.projectsettings=a,JSON.stringify(b,null,3)},f.prototype.sendNodeLibrary=function(){var a=this.getNodeLibrary();this.lastSentNodeLibrary!==a&&(this.lastSentNodeLibrary=a,this.editorConnection.send({cmd:"nodelibrary",type:"viewer",content:this.getNodeLibrary()}))},f.prototype.enableInspector=function(a){this.inspector.enable(this.context.uiEngine,a)},f.prototype.disableInspector=function(){this.inspector.disable()},f.prototype.connectToEditor=function(a){this.editorConnection.connect(a)},f.prototype.onModelUpdateReceived=function(a){this.isWaitingForExport||("projectInstanceChanged"===a.type?(this.context.uiEngine.clearImageCache(),this._resetData(),this.scheduleFrame(),this.isWaitingForExport=!0):o.handleEvent(this.context,this.graphModel,a))},f.prototype.recordSession=function(a){this.sessionRecorder=new x(y(),a),this.context.setSessionRecorder(this.sessionRecorder),this.context.uiEngine.on("touchEvent",this.sessionRecorder.appendTouchEvent.bind(this.sessionRecorder)),this.context.uiEngine.addRenderer(this.sessionRecorder.getRenderer())},b.exports=f},{"./editorconnection":245,"./editormodeleventshandler":246,"./fontloader":248,"./guid":249,"./inspector":250,"./models/graphmodel":253,"./nodecontext":256,"./nodedefinition":257,"./nodelibraryexport":258,"./nodes/and":260,"./nodes/animation":261,"./nodes/colorblend":262,"./nodes/componentinputs":263,"./nodes/componentoutputs":265,"./nodes/counter":266,"./nodes/data/collectionnode":268,"./nodes/data/foreach":269,"./nodes/data/foreachactions":270,"./nodes/data/modelnode":272,"./nodes/data/restnode":273,"./nodes/data/staticdata":274,"./nodes/drag":275,"./nodes/eventreceiver":276,"./nodes/eventsender":277,"./nodes/expression":278,"./nodes/globals":279,"./nodes/gyroscope":280,"./nodes/inverter":281,"./nodes/javascript":282,"./nodes/javascript2":283,"./nodes/numberblend":284,"./nodes/numberremapper":285,"./nodes/or":286,"./nodes/pagenavigation":287,"./nodes/pagenavigationback":288,"./nodes/receivemessage":289,"./nodes/reload":290,"./nodes/screenresolution":291,"./nodes/sendmessage":292,"./nodes/signaltoindex":293,"./nodes/states":294,"./nodes/stringformat":295,"./nodes/stringmapper":296,"./nodes/stringselector":297,"./nodes/substring":298,"./nodes/switch":299,"./nodes/timer":300,"./nodes/touchposition":301,"./nodes/transition":302,"./nodes/valuechanged":303,"./nodes/variables/boolean":304,"./nodes/variables/color":305,"./nodes/variables/number":306,"./nodes/variables/string":307,"./nodes/velocity":309,"./nodes/visual/circle":310,"./nodes/visual/flowlayout":311,"./nodes/visual/group":312,"./nodes/visual/image":313,"./nodes/visual/page":315,"./nodes/visual/pages":316,"./nodes/visual/rectangle":317,"./nodes/visual/scrollview":319,"./nodes/visual/stacklayout":320,"./nodes/visual/text":321,"./nodes/visual/textinput":322,"./nodes/websocket":324,"./projectpatchers":328,"./projectsettings":329,"./services/mqtt-connection":330,"./services/pubsub":331,"./services/services":332,"./session-recorder":334,"./uiengine/renderers/renderer-canvas2d":365,"./uiengine/renderers/renderer-dom":366,"./uiengine/renderers/renderer-webgl":367,"./useragent-utils":384}],243:[function(a,b,c){"use strict";var d={easeOutQuartic:function(a,b,c){return c--,-(b-a)*(c*c*c*c-1)+a},easeInQuartic:function(a,b,c){return(b-a)*(c*c*c*c)+a},easeInOutQuartic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c*c*c+a:(c-=2,-(b-a)/2*(c*c*c*c-2)+a)},easeOutCubic:function(a,b,c){return c--,(b-a)*(c*c*c+1)+a},easeInCubic:function(a,b,c){return(b-a)*(c*c*c)+a},easeInOutCubic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c*c+a:(c-=2,(b-a)/2*(c*c*c+2)+a)},easeOutQuadratic:function(a,b,c){return-(b-a)*c*(c-2)+a},easeInQuadratic:function(a,b,c){return(b-a)*(c*c)+a},easeInOutQuadratic:function(a,b,c){return c*=2,c<1?(b-a)/2*c*c+a:(c-=1,-(b-a)/2*(c*(c-2)-1)+a)},linear:function(a,b,c){return a+(b-a)*c}};d.easeIn=d.easeInCubic,d.easeOut=d.easeOutCubic,d.easeInOut=d.easeInOutCubic,b.exports=d},{}],244:[function(a,b,c){"use strict";function d(a){var b=!1;return function(c){c=!!c,c&&b===!1&&a.valueChangedToTrue.call(this),b=c}}b.exports={createSetter:d}},{}],245:[function(a,b,c){"use strict";function d(){e.call(this),this.reconnectOnClose=!0}var e=a("./eventsender"),f=a("./services/services"),g=a("./guid");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isRunningLocally=function(){return"localhost"===document.location.hostname||"127.0.0.1"===document.location.hostname},d.prototype.connect=function(a){this.socket=new WebSocket(a);var b=this;this.socket.addEventListener("open",function(){b.clientId=g(),b.socket.send(JSON.stringify({cmd:"register",type:"viewer",clientId:b.clientId})),b.emit("connected")}),this.socket.addEventListener("close",function(){b.reconnectOnClose&&b.reconnect(a),b.emit("connectionClosed")}),this.socket.addEventListener("error",function(c){console.log("Editor connection error, trying to reconnect"),b.reconnect(a)}),this.socket.addEventListener("message",function(a){var c,d=JSON.parse(a.data);"registered"===d.cmd||("export"===d.cmd?(c=JSON.parse(d.content),"full"===d.type&&b.emit("exportDataFull",c)):"hoverStart"===d.cmd?b.emit("hoverStart",d.content.id):"hoverEnd"===d.cmd?b.emit("hoverEnd",d.content.id):"refresh"===d.cmd?b.emit("reload"):"inspectStart"===d.cmd?b.emit("inspectStart"):"inspectEnd"===d.cmd?b.emit("inspectEnd"):"capture"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.sendThumbnailCapture(c.width,c.height)):"connectionInspectors"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.emit("connectionInspectorsUpdated",c.connectionsToInspect)):"debuggingEnabled"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.emit("debuggingEnabledChanged",c.enabled)):"modelUpdate"===d.cmd?b.emit("modelUpdate",d.content):"publish"===d.cmd?f.pubsub.routeMessage(d):console.log("Command not implemented",d))})},d.prototype.reconnect=function(a){var b=this;window.setTimeout(function(){b.connect(a)},2e3)},d.prototype.isConnected=function(){return void 0!==this.socket&&this.socket.readyState===WebSocket.OPEN},d.prototype.send=function(a){this.isConnected()!==!1&&this.socket.send(JSON.stringify(a))},d.prototype.sendInspectId=function(a){this.send({cmd:"select",type:"viewer",content:JSON.stringify({id:a})})},d.prototype.sendPulsingConnections=function(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c];b=b.concat(d.connections)}),this.send({cmd:"connectiondebugpulse",type:"viewer",content:JSON.stringify({connectionsToPulse:b})})},d.prototype.sendConnectionValues=function(a){this.send({cmd:"connectionvalue",type:"viewer",content:JSON.stringify({connections:a})})},d.prototype.sendDynamicPorts=function(a,b){this.send({cmd:"instanceports",type:"viewer",content:JSON.stringify({nodeid:a,ports:b})})},d.prototype.sendThumbnailCapture=function(a,b){var c=this;this.emit("captureScreenShot",{width:a,height:b,callback:function(a){c.send({cmd:"captured",type:"viewer",content:JSON.stringify({data:a})})}})},d.prototype.sendWarning=function(a,b,c,d){this.send({cmd:"showwarning",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b,key:c,warning:d})})},d.prototype.clearWarnings=function(a,b){this.send({cmd:"clearwarnings",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b})})},d.prototype.sendPatches=function(a){this.send({cmd:"patchproject",type:"viewer",content:JSON.stringify(a)})},d.prototype.requestFullExport=function(){this.send({cmd:"register",type:"viewer"})};var h={};d.prototype.sendServiceRequest=function(a,b){a.token=g(),a.clientId=this.clientId,h[a.token]=b,this.send(a)},d.prototype.close=function(){this.reconnectOnClose=!1,this.isConnected()!==!1&&this.socket.close()},b.exports=d},{"./eventsender":247,"./guid":249,"./services/services":332}],246:[function(a,b,c){"use strict";function d(a,b,c){function d(b,c){var d={},f={};c.forEach(function(a){"input"!==a.plug&&"input/output"!==a.plug||(d[a.name]=a),"output"!==a.plug&&"input/output"!==a.plug||(f[a.name]=a)});var h=Object.keys(b.getInputPorts()),i=e.difference(h,Object.keys(d)),j=e.difference(Object.keys(d),h);i.forEach(b.removeInputPortWithName.bind(b)),j.forEach(function(c){b.addInputPort(d[c]),b.parameters&&b.parameters.hasOwnProperty(c)&&g(a.rootComponent.nodeScope,b,c,b.parameters[c])});var k=Object.keys(b.getOutputPorts()),l=e.difference(k,Object.keys(f)),m=e.difference(Object.keys(f),k);l.forEach(b.removeOutputPortWithName.bind(b)),m.forEach(function(a){b.addOutputPort(f[a])})}function f(a,b,c){if(a.hasNode(b)!==!1){var d=a.getNodeMetadata(b),e=d.inputs[c];if(e)return e.type.defaultUnit?{value:e.default,unit:e.type.defaultUnit}:e.default}}function g(a,b,c,d){var e=a.getNodesWithIdRecursive(b.id);e.forEach(function(a){a.queueInput(c,d)})}var h;c.componentName&&(h=b.getComponentWithName(c.componentName));var i={nodeAdded:function(a){h.importEditorNodeData(a.model,a.parentId,a.childIndex)},nodeRemoved:function(a){h.removeNodeWithId(a.model.id)},connectionAdded:function(a){h.addConnection(a.model)},connectionRemoved:function(b){h.removeConnection(b.model);var c=h.getNodeWithId(b.model.targetId);if(0===h.getConnectionsToPort(c.id,b.model.targetId).length){var d=c.parameters[b.model.targetPort];void 0===d&&(d=f(a.nodeRegister,c.type,b.model.targetPort)),g(a.rootComponent.nodeScope,c,b.model.targetPort,d)}},parameterChanged:function(b){var c=h.getNodeWithId(b.nodeId);if(void 0===c)return void console.log("parameterChanged: Unkown node id",b);var d=b.parameterValue;void 0===d&&(d=f(a.nodeRegister,c.type,b.parameterName)),c.setParameter(b.parameterName,d)},nodeAttached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),h.getNodeWithId(a.parentId),a.childIndex)},nodeDetached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),null)},componentAdded:function(a){b.importComponentFromEditorData(a.model)},componentRemoved:function(a){b.removeComponentWithName(a.componentName)},rootAdded:function(a){h.addRootId(a.nodeId)},projectRootNodeChanged:function(b){a.editorConnection.requestFullExport()},portAdded:function(b){var c=h.getNodeWithId(b.nodeId);"input"!==b.port.plug&&"input/output"!==b.port.plug||(c.addInputPort(b.port),c.parameters.hasOwnProperty(b.port)&&g(a.rootComponent.nodeScope,c,b.port,c.parameters[b.port])),"output"!==b.port.plug&&"input/output"!==b.port.plug||c.addOutputPort(b.port)},portRemoved:function(a){var b=h.getNodeWithId(a.nodeId);"input"!==a.port.plug&&"input/output"!==a.port.plug||b.removeInputPortWithName(a.port.name),"output"!==a.port.plug&&"input/output"!==a.port.plug||b.removeOutputPortWithName(a.port.name);
},nodePortRenamed:function(a){"input"!==a.port.plug&&"input/output"!==a.port.plug||h.renameInputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name),"output"!==a.port.plug&&"input/output"!==a.port.plug||h.renameOutputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name);var c=h.getNodeWithId(a.nodeId);"Component Inputs"===c.type?(h.addInputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameInputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeInputPortWithName(a.oldName)):"Component Outputs"===c.type&&(h.addOutputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameOutputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeOutputPortWithName(a.oldName))},componentPortsUpdated:function(a){d(h,a.ports)},instancePortsChanged:function(a){var b=h.getNodeWithId(a.nodeId);d(b,a.ports)},componentRenamed:function(a){b.renameComponent(a.oldName,a.newName)},settingsChanged:function(a){b.setSettings(a.settings)}};i.hasOwnProperty(c.type)?(i[c.type](c),a.scheduleFrame()):console.log("Unknown event",c)}var e=a("lodash");b.exports={handleEvent:d}},{lodash:145}],247:[function(a,b,c){"use strict";function d(){this.listeners={},this.numListeners={}}var e=a("lodash");d.prototype.on=function(a,b,c){this.listeners.hasOwnProperty(a)||(this.listeners[a]=[],this.numListeners[a]=0),this.listeners[a].push({callback:b,ref:c}),this.numListeners[a]++,this.numListeners[a]>1e3&&console.trace("too many events",a,this.numListeners[a])},d.prototype.removeListenersWithRef=function(a){var b=this.numListeners;e.forIn(this.listeners,function(c,d){var f=e.remove(c,function(b){return b.ref===a});b[d]-=f.length})},d.prototype.removeAllListeners=function(a){a?(delete this.listeners[a],delete this.numListeners[a]):(this.listeners={},this.numListeners={})},d.prototype.emit=function(a,b){var c=this.listeners[a];c&&c.forEach(function(a){a.callback.call(a.ref,b)})},b.exports=d},{lodash:145}],248:[function(a,b,c){"use strict";function d(){this.loadedFontFamilies={},this.fontCssFamiliesAdded={},this.fontCallbacks={};var a=this;["Arial","Arial Black","Courier New","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman"].forEach(function(b){a.loadedFontFamilies[b]=!0})}function e(a){return a.replace(/\.[^\/.]+$/,"")}d.prototype.setIsRunningInEditor=function(a){this.isRunningInEditor=a},d.prototype.loadFont=function(a){var b=e(a).split("/").pop();if(this.loadedFontFamilies[b])return void(this.fontCallbacks[b]&&this.fontCallbacks[b].forEach(function(a){a()}));if(!this.fontCssFamiliesAdded[b]){this.fontCssFamiliesAdded[b]=!0;var c=document.createElement("style");c.type="text/css",this.isRunningInEditor&&"/"!==a[0]&&(a="/"+a),c.appendChild(document.createTextNode("                    @font-face {                        font-family: '"+b+"';                        src: url('"+a+"');                    }                ")),document.head.appendChild(c);var d=this;WebFont.load({timeout:6e5,custom:{families:[b]},fontactive:function(a){d.loadedFontFamilies[a]=!0,d.fontCallbacks[a]&&d.fontCallbacks[a].forEach(function(a){a()})}})}},d.prototype.callWhenFontIsActive=function(a,b){return this.loadedFontFamilies[a]?void b():(this.fontCallbacks[a]||(this.fontCallbacks[a]=[]),void this.fontCallbacks[a].push(b))},d.instance=new d,b.exports=d},{}],249:[function(a,b,c){function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}b.exports=d},{}],250:[function(a,b,c){"use strict";function d(){this.mouseMoveListener=this._onMouseMove.bind(this),this.mouseDownListener=this._onMouseDown.bind(this),this.highlightedControl=void 0}function e(a){return f.some(function(b){return a instanceof b})}var f=[a("./uiengine/controls/circlecontrol"),a("./uiengine/controls/imagecontrol"),a("./uiengine/controls/rectanglecontrol"),a("./uiengine/controls/textcontrol"),a("./uiengine/controls/textinputcontrol")];d.prototype._onMouseMove=function(a){var b=this.uiEngine.hitTest(this._getTouchX(a)*this.uiEngine.renderer.viewportWidth,this._getTouchY(a)*this.uiEngine.renderer.viewportHeight);this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0);for(var c=Math.max.apply(Math,Object.keys(b)),d=b[c],f=d.length-1;f>=0;f--)if(e(d[f])){this.highlightedControl=d[f],this.highlightedControl.setHighlightEnabled(!0);break}},d.prototype._onMouseDown=function(a){0===a.button&&this.highlightedControl&&this.callback(this.highlightedControl.noodlNode.id)},d.prototype._getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype._getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},d.prototype.enable=function(a,b){this.uiEngine=a,this.uiEngine.touchListener.setTouchEnabled(!1),this.domElement=a.renderer.renderers[0].rootElement,this.callback=b,this.domElement.addEventListener("mousemove",this.mouseMoveListener),this.domElement.addEventListener("mousedown",this.mouseDownListener)},d.prototype.disable=function(){this.domElement&&(this.uiEngine.touchListener.setTouchEnabled(!0),this.domElement.removeEventListener("mousemove",this.mouseMoveListener),this.domElement.removeEventListener("mousedown",this.mouseDownListener),this.domElement=void 0,this.callback=void 0,this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0))},b.exports=d},{"./uiengine/controls/circlecontrol":336,"./uiengine/controls/imagecontrol":340,"./uiengine/controls/rectanglecontrol":343,"./uiengine/controls/textcontrol":348,"./uiengine/controls/textinputcontrol":349}],251:[function(a,b,c){"use strict";function d(a,b){this.inputs={},this.outputs={},this.error=void 0;var c=e[a];if(!c)try{c=new Function("define","Noodl",a),e[a]=c}catch(d){this.error=d.message}c&&c(this.define.bind(this),b)}var e={};d.prototype.define=function(a){this.inputs=a.inputs||{},this.outputs=a.outputs||{},this.setup=a.setup,this.run=a.run,this.definedObject=a},d.createFromCode=function(a,b){return new d(a,b)},d.createFromURL=function(a,b,c){var e=new window.XMLHttpRequest;e.open("GET",a,!0),e.onreadystatechange=function(){4!==this.readyState&&this.readyState!==XMLHttpRequest.DONE||c(new d(this.response,b))},e.onerror=function(){console.log("Failed to request",a)},e.send()},d.prototype.getPorts=function(){var a=[],b=this;return Object.keys(this.inputs).forEach(function(c){var d=b.inputs[c],e={name:c,plug:"input"};if("string"==typeof d)e.type={name:d},e.group="Inputs";else for(var f in d)e[f]=d[f];a.push(e)}),Object.keys(this.outputs).forEach(function(c){a.push({name:c,type:{name:b.outputs[c]},plug:"output",group:"Outputs"})}),a},b.exports=d},{}],252:[function(a,b,c){"use strict";function d(a){f.call(this),this.name=a,this.nodes={},this.connections=[],this.roots=[],this.inputPorts={},this.outputPorts={}}var e=a("./nodemodel"),f=a("./../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.addNode=function(a){a.component=this,this.nodes[a.id]=a,this.emit("nodeAdded",a)},d.prototype.getNodeWithId=function(a){return this.nodes[a]},d.prototype.getAllNodes=function(){return g.values(this.nodes)},d.prototype.getNodesWithType=function(a){var b=[],c=this;return Object.keys(this.nodes).forEach(function(d){var e=c.nodes[d];e.type===a&&b.push(e)}),b},d.prototype.addConnection=function(a){this.connections.push(a),this.emit("connectionAdded",a)},d.prototype.removeConnection=function(a){var b=g.findIndex(this.connections,function(b){return g.isEqual(b,a)});this.connections.splice(b,1),this.emit("connectionRemoved",a)},d.prototype.getConnectionsFromPort=function(a,b){return this.connections.filter(function(c){return c.sourceId===a&&c.sourcePort===b})},d.prototype.getConnectionsToPort=function(a,b){return this.connections.filter(function(c){return c.targetId===a&&c.targetPort===b})},d.prototype.getConnectionsFrom=function(a){return this.connections.filter(function(b){return b.sourceId===a})},d.prototype.getConnectionsTo=function(a){return this.connections.filter(function(b){return b.targetId===a})},d.prototype.addRootId=function(a){this.roots.indexOf(a)===-1&&(this.roots.push(a),this.emit("rootAdded",a))},d.prototype.getFirstRootId=function(){return this.roots[0]},d.prototype.removeNodeWithId=function(a){for(var b=this.getNodeWithId(a);b.children.length>0;){var c=b.children[0];this.removeNodeWithId(c.id)}for(var d=this.getConnectionsTo(a).concat(this.getConnectionsFrom(a)),e=0;e<d.length;e++)this.removeConnection(d[e]);this.setNodeParent(b,null);var f=this.roots.indexOf(b.id);f!==-1&&(this.roots.splice(f,1),this.emit("rootRemoved",b.id)),this.emit("nodeRemoved",b),b.removeAllListeners(),delete this.nodes[a]},d.prototype.getAllConnections=function(){return this.connections},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.renameInputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsToPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getInputPort(b));f&&(e.removeInputPortWithName(b),f.name=c,e.addInputPort(f)),d.forEach(function(a){a.targetPort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.renameOutputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsFromPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getOutputPort(b));e.removeOutputPortWithName(b),f.name=c,e.addOutputPort(f),d.forEach(function(a){a.sourcePort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.setNodeParent=function(a,b,c){a.parent&&(this.emit("nodeParentWillBeRemoved",a),a.parent.removeChild(a)),a.emit("parentUpdated",b),b&&(b.addChild(a,c),this.emit("nodeParentUpdated",a))},d.prototype.importEditorNodeData=function(a,b,c){var d=e.createFromExportData(a);this.addNode(d),b&&this.setNodeParent(d,this.getNodeWithId(b),c);var f=this;a.children&&a.children.forEach(function(a,b){f.importEditorNodeData(a,d.id,b)})},d.prototype.reset=function(){for(;this.roots.length;)this.removeNodeWithId(this.roots[0]);if(Object.keys(this.nodes).forEach(this.removeNodeWithId.bind(this)),this.nodes.length>0)throw new Error("Not all nodes were removed during a reset");if(this.connections.length>0)throw new Error("Not all connections were removed during a reset")},d.prototype.rename=function(a){var b=this.name;this.name=a,this.emit("renamed",{oldName:b,newName:a})},d.createFromExportData=function(a){var b=new d(a.name);return a.ports&&a.ports.forEach(function(a){"input"!==a.plug&&"input/output"!==a.plug||b.addInputPort(a),"output"!==a.plug&&"input/output"!==a.plug||b.addOutputPort(a)}),a.nodes&&a.nodes.forEach(b.importEditorNodeData.bind(b)),a.connections&&a.connections.forEach(b.addConnection.bind(b)),a.roots&&a.roots.forEach(b.addRootId.bind(b)),b},b.exports=d},{"./../eventsender":247,"./nodemodel":254,lodash:145}],253:[function(a,b,c){"use strict";function d(){f.call(this),this.components={},this.defaultDevice={canvasWidth:1080,canvasHeight:1920,fillMode:"aspectFit",renderer:"webgl",name:"Default Device"},this.settings=g.clone(h)}var e=a("./componentmodel"),f=a("./../eventsender"),g=a("lodash"),h={analyticsEnabled:!1,analyticsServerUrl:"http://localhost:8080"};d.prototype=Object.create(f.prototype),d.prototype.importComponentFromEditorData=function(a){var b=e.createFromExportData(a);this.addComponent(b)},d.prototype.importEditorData=function(a){a.settings&&this.setSettings(a.settings),a.components.forEach(this.importComponentFromEditorData.bind(this)),this.setRootComponentName(a.rootComponent),this.setRootNodeId(a.rootNode)},d.prototype.setRootComponentName=function(a){this.rootComponent=a,this.emit("rootComponentNameUpdated",a)},d.prototype.setRootNodeId=function(a){this.rootNode=a,this.emit("rootNodeIdChanged",a)},d.prototype.getNodesWithType=function(a){for(var b=[],c=Object.keys(this.components),d=0;d<c.length;d++){var e=this.components[c[d]];b=b.concat(e.getNodesWithType(a))}return b},d.prototype.getComponentWithName=function(a){return this.components[a]},d.prototype.getAllNodes=function(){for(var a=[],b=Object.keys(this.components),c=0;c<b.length;c++){var d=this.components[b[c]];a=a.concat(d.getAllNodes())}return a},d.prototype.addComponent=function(a){this.components[a.name]=a,this.getNodesWithType(a.name).forEach(this._addComponentPorts.bind(this)),a.getAllNodes().forEach(this._onNodeAdded.bind(this)),a.on("nodeAdded",this._onNodeAdded.bind(this),this),this.emit("componentAdded",a)},d.prototype.removeComponentWithName=function(a){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");var b=this.components[a];b.reset(),b.removeAllListeners(),delete this.components[b.name],this.emit("componentRemoved",b)},d.prototype.renameComponent=function(a,b){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");this.getNodesWithType(a).forEach(function(a){a.type=b});var c=this.components[a];c.rename(b),delete this.components[a],this.components[b]=c},d.prototype._addComponentPorts=function(a){if(this.components.hasOwnProperty(a.type)){var b=this.components[a.type];g.forIn(b.getInputPorts(),a.addInputPort.bind(a)),g.forIn(b.getOutputPorts(),a.addOutputPort.bind(a))}},d.prototype._onNodeAdded=function(a){this._addComponentPorts(a),this.emit("nodeAdded",a),this.emit("nodeAdded."+a.type,a)},d.prototype.reset=function(){var a=this;Object.keys(this.components).forEach(function(b){a.removeComponentWithName(b)}),this.settings=g.clone(h),this.devices={}},d.prototype.isEmpty=function(){return 0===Object.keys(this.components).length},d.prototype.setSettings=function(a){if(a.hasOwnProperty("analyticsEnabed")&&(this.settings.analyticsEnabled=a.analyticsEnabled),a.hasOwnProperty("analyticsServerUrl")&&(this.settings.analyticsServerUrl=a.analyticsServerUrl),this.settings.mqttUseExternalBroker=a.mqttUseExternalBroker,this.settings.mqttBrokerUrl=a.mqttBrokerUrl,a.devices){this.devices={};var b=this,c=a.devices.split(",");c.forEach(function(c){b.devices[c]={fillMode:a[c+".fillMode"]||b.defaultDevice.fillMode,canvasWidth:a[c+".canvasWidth"]||b.defaultDevice.canvasWidth,canvasHeight:a[c+".canvasHeight"]||b.defaultDevice.canvasHeight,renderer:a[c+".renderer"]||b.defaultDevice.renderer,rootComponent:a[c+".rootComponent"],name:c}}),this.defaultDeviceName=c[0]}this.projectSettings=a,this.emit("settingsUpdated")},d.prototype.getSettings=function(){return this.settings},d.prototype.getDeviceSettings=function(a){return a&&this.devices.hasOwnProperty(a)!==!1||(a=this.defaultDeviceName),a?this.devices[a]:this.defaultDevice},d.prototype.getRawProjectSettings=function(){return this.projectSettings||{}},b.exports=d},{"./../eventsender":247,"./componentmodel":252,lodash:145}],254:[function(a,b,c){"use strict";function d(a,b){e.call(this),this.id=a,this.type=b,this.inputs=[],this.outputs=[],this.children=[],this.parameters={},this.inputPorts={},this.outputPorts={}}var e=a("./../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setParameter=function(a,b){this.parameters[a]=b,this.emit("parameterUpdated",{name:a,value:b})},d.prototype.setParameters=function(a){var b=this;Object.keys(a).forEach(function(c){b.setParameter(c,a[c])})},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.getInputPort=function(a){return this.inputPorts[a]},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.getOutputPort=function(a){return this.outputPorts[a]},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.addChild=function(a,b){a.parent=this,void 0===b?this.children.push(a):this.children.splice(b,0,a)},d.prototype.removeChild=function(a){a.parent=void 0;var b=this.children.indexOf(a);this.children.splice(b,1)},d.prototype.reset=function(){this.removeAllListeners()},d.createFromExportData=function(a){var b=new d(a.id,a.type);return a.parameters&&b.setParameters(a.parameters),a.ports&&a.ports.forEach(function(a){"input"!==a.plug&&"input/output"!==a.plug||b.addInputPort(a),"output"!==a.plug&&"input/output"!==a.plug||b.addOutputPort(a)}),b},b.exports=d},{"./../eventsender":247}],255:[function(a,b,c){"use strict";function d(a){this.context=a,this._dirty=!1,this._cachedInputValues={},this._inputs={},this.numberedInputs={},this._outputs={},this._inputConnections={},this._outputList=[],this._isUpdating=!1,this._inputValuesQueue={},this._afterInputsHaveUpdatedCallbacks=[],this._internal={},this._signalsSentThisUpdate={}}function e(a){var b=a.split(" ");return b.splice(-1,1),b.join(" ")}var f=a("./outputproperty");Object.defineProperties(d.prototype,{registerInput:{value:function(a,b){if(this.hasInput(a))throw new Error("Input property "+a+" already registered");this._inputs[a]=b,b.hasOwnProperty("default")&&(this._cachedInputValues[a]=b.default)}},deregisterInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Input property "+a+" doesn't exist");delete this._inputs[a],delete this._cachedInputValues[a]}},registerInputs:{value:function(a){for(var b in a)this.registerInput(b,a[b])}},_registerSelectors:{value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c],e={set:function(a){var c=a.split(" "),e=Number(c[c.length-1]);d.set.call(b,e)}};b.registerInput(c,e)})}},registerNumberedInput:{value:function(a,b){if(this.hasNumberedInput(a))throw new Error("Numbered input property "+a+" already registered");this.numberedInputs[a]=b,b.selectors&&this._registerSelectors(b.selectors)}},getInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Node "+this.name+": Invalid input property "+a);return this._inputs[a]}},hasInput:{value:function(a){return a in this._inputs}},hasNumberedInput:{value:function(a){return this.numberedInputs.hasOwnProperty(a)}},registerInputIfNeeded:{value:function(a){this.hasInput(a)===!1&&this._isUnregisteredNumberedInput(a)&&this._registerNumberedInputInstance(a)}},_isUnregisteredNumberedInput:{value:function(a){var b=e(a);return this.numberedInputs.hasOwnProperty(b)}},_registerNumberedInputInstance:{value:function(a){var b=a.split(" "),c=b[b.length-1];if(isNaN(c))throw new Error("Numbered input with name "+a+" doesn't end with a number");c=Number(c);var d=this.numberedInputs[e(a)],f={name:d.name,set:d.createSetter.call(this,c)};this.registerInput(a,f)}},setInputValue:{value:function(a,b,c){this._cachedInputValues[a]=b;var d=this.getInput(a);c?d.set.call(this,b,c):d.set.call(this,b)}},hasOutput:{value:function(a){return a in this._outputs}},registerOutput:{value:function(a,b){if(this.hasOutput(a))throw new Error("Output property "+a+" already registered");var c=new f({owner:this,getter:b.getter,name:a});this._outputs[a]=c,this._outputList.push(c)}},deregisterOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Output property "+a+" isn't registered");var b=this._outputs[a];if(b.hasConnections())throw new Error("Output property "+a+" has connections and can't be removed");delete this._outputs[a];var c=this._outputList.indexOf(b);this._outputList.splice(c,1)}},registerOutputs:{value:function(a){for(var b in a)this.registerOutput(b,a[b])}},registerOutputIfNeeded:{value:function(){}},getOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Node "+this.name+" doesn't have a port named "+a);return this._outputs[a]}},connectInput:{value:function(a,b,c){if(this.hasInput(a)===!1)throw new Error("Invalid connection, input doesn't exist. Trying to connect from "+b.name+" output "+c+" to "+this.name+" input "+a);var d=b.getOutput(c);if(d.registerConnection(this,a),this._inputConnections[a]||(this._inputConnections[a]=[],this._inputValuesQueue[a]=[]),this._inputConnections[a].push(d),b._signalsSentThisUpdate[c])this.queueInput(a,!0),this.queueInput(a,!1);else{var e=d.value;void 0!==e&&this.queueInput(a,e)}this.flagDirty()}},removeInputConnection:{value:function(a,b,c){if(!this._inputConnections[a])throw new Error("Node removeInputConnection: Input doesn't exist");for(var d=this._inputConnections[a],e=0;e<d.length;e++){var f=d[e];if(f.owner.id===b&&f.name===c){d.splice(e,1);var g=f.owner.getOutput(c);g.deregisterConnection(this,a);break}}}},isInputConnected:{value:function(a){return this._inputConnections.hasOwnProperty(a)}},update:{value:function(){if(!this._isUpdating&&this._dirty!==!1){this._isUpdating=!0;for(var a,b=0;this._dirty&&b<100;){this._updateDependencies(),this._dirty=!1;for(var c=!0,d=Object.keys(this._inputValuesQueue);c;){for(c=!1,a=0;a<d.length;a++){var e=d[a],f=this._inputValuesQueue[e];if(f.length>0){var g=f.shift();null!==g&&"object"==typeof g&&g.hasOwnProperty("value")&&g.hasOwnProperty("unit")?this.setInputValue(e,g.value,g.unit):this.setInputValue(e,g),f.length>0&&(c=!0)}}var h=this._afterInputsHaveUpdatedCallbacks;for(this._afterInputsHaveUpdatedCallbacks=[],a=0;a<h.length;a++)h[a].call(this)}b++}this._isUpdating=!1}}},_updateDependencies:{value:function(){for(var a in this._inputConnections)for(var b=this._inputConnections[a],c=0;c<b.length;++c)"reference"!==b[c].type&&b[c].owner.update()}},flagDirty:{value:function(){if(!this._dirty){this._dirty=!0,this.context&&this.context.nodeIsDirty(this);for(var a=0;a<this._outputList.length;++a)this._outputList[a].flagDependeesDirty()}}},sendValue:{value:function(a,b){if(this.hasOutput(a)===!1)return void console.log("Error: Node",this.name,"doesn't have a output named",a);var c=this.getOutput(a);c.hasConnections()!==!1&&void 0!==b&&(c.sendValue(b),this.context&&this.context.connectionSentValue(c,b))}},flagOutputDirty:{value:function(a){var b=this.getOutput(a);b.hasConnections()!==!1&&this.sendValue(a,b.value)}},flagAllOutputsDirty:{value:function(a){for(var b=0;b<this._outputList.length;++b){var c=this._outputList[b];this.sendValue(c.name,c.value)}}},sendSignalOnOutput:{value:function(a){this.sendValue(a,!0),this.sendValue(a,!1),this._signalsSentThisUpdate[a]=!0,this.scheduleAfterInputsHaveUpdated(function(){this._signalsSentThisUpdate[a]=!1})}},queueInput:{value:function(a,b,c){this._inputValuesQueue[a]||(this._inputValuesQueue[a]=[]),c?this._inputValuesQueue[a].push({value:b,unit:c}):this._inputValuesQueue[a].push(b),this.flagDirty()}},scheduleAfterInputsHaveUpdated:{value:function(a){this._afterInputsHaveUpdatedCallbacks.push(a),this.flagDirty()}},setNodeModel:{value:function(a){this.model=a,a.on("parameterUpdated",this._onNodeModelParameterUpdated,this);var b=this;a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){b.hasOutput(a.name)&&b.deregisterOutput(a.name)},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0)}},_onNodeModelParameterUpdated:{value:function(a){this.registerInputIfNeeded(a.name),"object"==typeof a.value&&a.value.hasOwnProperty("unit")?this.queueInput(a.name,a.value.value,a.value.unit):this.queueInput(a.name,a.value)}}}),b.exports=d},{"./outputproperty":327}],256:[function(a,b,c){"use strict";function d(a){a=a||{},a.runningInEditor=!!a.hasOwnProperty("runningInEditor")&&a.runningInEditor,this._dirtyNodes=[],this.callbacksAfterUpdate=[],this.eventEmitter=new e,this.eventEmitter.setMaxListeners(1e3),this.eventSenderEmitter=new e,this.eventSenderEmitter.setMaxListeners(1e4),this.globalValues={},this.globalsEventEmitter=new e,this.globalsEventEmitter.setMaxListeners(1e3),this.runningInEditor=a.runningInEditor,this.currentFrameTime=0,this.nodeRegister=new f(this),this.timerScheduler=new g(this.scheduleFrame.bind(this)),this.componentModels={},this.outputCollectionEnabled=!1,this.connectionsToPulse={},this.connectionsToPulseChanged=!1,this.connectionsToInspect={},this.inspectedConnectionValuesToSendQueue=[],this.connectionPulsingCallbackScheduled=!1,this.editorConnection=a.editorConnection,this.rootComponent=void 0,this.editorConnection&&this.editorConnection.on("connectionInspectorsUpdated",this.onConnectionInspectorsUpdated.bind(this)),this.uiEngine=new h(this.timerScheduler,document.body),this.uiEngine.eventSender.on("requestFrame",this.scheduleFrame.bind(this))}var e=a("events").EventEmitter,f=a("./noderegister"),g=a("./timerscheduler"),h=a("./uiengine/uiengine");d.prototype.setRootComponent=function(a){this.rootComponent=a,a.getVisualRoot()&&this.uiEngine.root.addChild(a.getVisualRoot()._internal.uiControl)},d.prototype.onConnectionInspectorsUpdated=function(a){var b={};a.forEach(function(a){var c=a.fromId+a.fromProperty;b[c]=a}),this.connectionsToInspect=b,this.sendConnectionsToInspectValues()},d.prototype.layout=function(){this.uiEngine.layout()},d.prototype.update=function(){for(var a,b,c=!0,d=0;c&&d<10;){this.layout();var e=this._dirtyNodes;for(this._dirtyNodes=[],a=0,b=e.length;a<b;++a)e[a].update();var f=this.callbacksAfterUpdate;for(this.callbacksAfterUpdate=[],a=0,b=f.length;a<b;a++)f[a]();this.layout(),c=this.callbacksAfterUpdate.length>0||this._dirtyNodes.length>0,d++}this.timerScheduler.hasPendingTimers()&&(this.scheduleFrame(),this.timerScheduler.runTimers(this.currentFrameTime)),this.flushConnectionsToInspect()},d.prototype.flushConnectionsToInspect=function(){this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),this.inspectedConnectionValuesToSendQueue.length>0&&(this.editorConnection.sendConnectionValues(this.inspectedConnectionValuesToSendQueue),this.inspectedConnectionValuesToSendQueue=[])},d.prototype.reset=function(){this.eventEmitter.emit("applicationDataReloaded");var a=this.eventEmitter;["frameStart","frameEnd"].forEach(function(b){a.removeAllListeners(b)}),this.globalValues={},this._dirtyNodes.length=0,this.callbacksAfterUpdate.length=0,this.timerScheduler.runningTimers=[],this.timerScheduler.newTimers=[],this.rootComponent=void 0,this.clearAllConnectionInspections()},d.prototype.nodeIsDirty=function(a){this._dirtyNodes.push(a),this.scheduleFrame()},d.prototype.scheduleFrame=function(){this.eventEmitter.emit("scheduleFrame")},d.prototype.scheduleAfterUpdate=function(a){this.callbacksAfterUpdate.push(a),this.scheduleFrame()},d.prototype.scheduleNextFrame=function(a){this.eventEmitter.once("frameStart",a),this.scheduleFrame()},d.prototype.setGlobalValue=function(a,b){this.globalValues[a]=b,this.globalsEventEmitter.emit(a)},d.prototype.reloadApplication=function(){this.eventEmitter.emit("reloadApplication")},d.prototype.registerComponentModel=function(a){if(this.componentModels.hasOwnProperty(a.name))throw new Error("Duplicate component name "+a.name);this.componentModels[a.name]=a;var b=this;a.on("renamed",function(c){delete b.componentModels[c.oldName],b.componentModels[c.newName]=a},this)},d.prototype.deregisterComponentModel=function(a){this.componentModels.hasOwnProperty(a.name)&&(this.componentModels[a.name].removeListenersWithRef(this),delete this.componentModels[a.name])},d.prototype.getComponentModel=function(a){if(!a)throw new Error("Component instance must have a name");if(this.componentModels.hasOwnProperty(a)===!1)throw new Error("Unknown component "+a);return this.componentModels[a]},d.prototype.hasComponentModelWithName=function(a){return this.componentModels.hasOwnProperty(a)},d.prototype.createComponentInstanceNode=function(b){var c=this.getComponentModel(b),d=a("./nodes/componentinstance"),e=new d(this);return e.name=b,e.setComponentModel(c),e},d.prototype._sendConnectionValue=function(a,b){if(this.connectionsToInspect.hasOwnProperty(a.id)&&this.inspectedConnectionValuesToSendQueue.push({id:a.id,value:b}),this.connectionsToPulse.hasOwnProperty(a.id))return void(this.connectionsToPulse[a.id].timestamp=window.performance.now());var c=[];a.connections.forEach(function(b){c.push(a.owner.id+a.name+b.node.id+b.inputPortName)}),this.connectionsToPulse[a.id]={timestamp:window.performance.now(),connections:c},this.connectionsToPulseChanged=!0,this.connectionPulsingCallbackScheduled===!1&&(this.connectionPulsingCallbackScheduled=!0,window.setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.connectionSentValue=function(a,b){this.editorConnection&&this.editorConnection.isConnected()&&this.outputCollectionEnabled&&this._sendConnectionValue(a,b)},d.prototype.clearAllConnectionInspections=function(){this.connectionsToInspect={},this.connectionsToPulse={},this.editorConnection.sendPulsingConnections(this.connectionsToPulse)},d.prototype.clearOldConnectionPulsing=function(){this.connectionPulsingCallbackScheduled=!1;var a=window.performance.now(),b=this,c=Object.keys(this.connectionsToPulse);c.forEach(function(c){var d=b.connectionsToPulse[c];a-d.timestamp>100&&(b.connectionsToPulseChanged=!0,delete b.connectionsToPulse[c])}),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),Object.keys(this.connectionsToPulse).length>0&&(this.connectionPulsingCallbackScheduled=!0,window.setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.sendConnectionsToInspectValues=function(){var a=this,b=[];Object.keys(this.connectionsToInspect).forEach(function(c){var d=a.connectionsToInspect[c],e=a.rootComponent.nodeScope.getNodesWithIdRecursive(d.toId);if(e.length>0){var f=e[e.length-1];b.push({id:c,value:f._cachedInputValues[d.toProperty]})}}),b.length>0&&this.editorConnection.sendConnectionValues(b)},d.prototype.setOutputCollectionEnabled=function(a){this.outputCollectionEnabled=a,a&&this.sendConnectionsToInspectValues()},d.prototype.sendGlobalEventFromEventSender=function(a,b){this.eventSenderEmitter.emit(a,b),this.sessionRecorder&&this.sessionRecorder.appendEvent(a)},d.prototype.setSessionRecorder=function(a){this.sessionRecorder=a},b.exports=d},{"./noderegister":259,"./nodes/componentinstance":264,"./timerscheduler":335,"./uiengine/uiengine":383,events:21}],257:[function(a,b,c){"use strict";function d(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");d.set&&(a[c]={set:d.set}),d.setUnitType&&(a[c].setUnitType=d.setUnitType),b.inputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,default:d.default,index:d.index,exportToEditor:!d.hasOwnProperty("exportToEditor")||d.exportToEditor},d.valueChangedToTrue&&(b.inputs[c].type={name:"boolean",allowConnectionsOnly:!0})}function e(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");a[c]={createSetter:d.createSetter},b.numberedInputs[c]={displayPrefix:d.displayPrefix,group:d.group,name:d.name},d.selectors&&(b.numberedInputs[c].selectors={},a[c].selectors={},Object.keys(d.selectors).forEach(function(e){var f=d.selectors[e];b.numberedInputs[c].selectors[e]={displayName:f.displayName,editorName:f.editorName,group:f.group},a[c].selectors[e]={set:f.set}}))}function f(a,b,c){Object.keys(c).forEach(function(e){d(a,b,e,c[e])})}function g(a,b){
Object.keys(b).forEach(function(c){var d=b[c],e=d.type;"signal"===d.type&&(e="boolean"),a.outputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:e,index:d.index,exportToEditor:!d.hasOwnProperty("exportToEditor")||d.exportToEditor}})}function h(a,b){Object.keys(b).forEach(function(c){a[c]=b[c].default})}function i(a){function b(a){k.call(this,a)}if(!a.category)throw new Error("Node must have a category");if(!a.name)throw new Error("Node must have a name");var c={inputs:{},outputs:{},numberedInputs:{},category:a.category,dynamicports:a.dynamicports,allowChildren:a.allowChildren,allowChildrenWithCategory:a.allowChildrenWithCategory,allowAsChild:a.allowAsChild,panels:a.panels,color:a.color,usePortAsLabel:a.usePortAsLabel,portLabelTruncationMode:a.portLabelTruncationMode,name:a.name,displayNodeName:a.displayNodeName,deprecated:a.deprecated,haveComponentPorts:a.haveComponentPorts,version:a.version};a._internal=a._internal||{},a.prototypeExtensions=a.prototypeExtensions||{},a.inputs=a.inputs||{},a.outputs=a.outputs||{},a.numberedInputs=a.numberedInputs||{},a.initialize=a.initialize||function(){};var d={},i={};f(d,c,a.inputs),g(c,a.outputs),Object.keys(a.numberedInputs).forEach(function(b){e(i,c,b,a.numberedInputs[b])}),Object.keys(a.prototypeExtensions).forEach(function(b){a.prototypeExtensions[b].value||(a.prototypeExtensions[b]={value:a.prototypeExtensions[b]})}),b.prototype=Object.create(k.prototype,a.prototypeExtensions),Object.defineProperty(b.prototype,"name",{value:a.name});var j=function(e){var f=new b(e);return f._inputs=Object.create(d),Object.keys(a.inputs).forEach(function(b){var c=a.inputs[b];c.valueChangedToTrue&&(f._inputs[b]={set:l.createSetter({valueChangedToTrue:c.valueChangedToTrue})})}),Object.keys(a.outputs).forEach(function(b){var c=a.outputs[b];"signal"===c.type?f.registerOutput(b,{getter:function(){return!1}}):f.registerOutput(b,c)}),Object.keys(i).forEach(function(a){f.registerNumberedInput(a,i[a])}),h(f._cachedInputValues,c.inputs),a.initialize.call(f),f};return j.metadata=c,j}function j(a,b){for(var c in b)if("initialize"===c&&a.initialize){var d=a.initialize;a.initialize=function(){d.call(this),b.initialize.call(this)}}else b[c]&&b[c].constructor===Object?a[c]=j(a[c]||{},b[c]):a[c]=b[c];return a}var k=a("./node"),l=a("./edgetriggeredinput");b.exports={defineNode:i,extend:j}},{"./edgetriggeredinput":244,"./node":255}],258:[function(a,b,c){"use strict";function d(a){var b={typecasts:[{from:"boolean",to:["number","string"]},{from:"number",to:["boolean","string"]},{from:"string",to:["number","boolean","image","color"]},{from:"image",to:[]},{from:"color",to:[]},{from:"enum",to:[]},{from:"object",to:[]},{from:"reference",to:[]},{from:"font",to:[]}],dynamicports:[{type:"conditionalports",name:"basic"},{type:"expand",name:"basic"},{type:"portchannel",name:"event-sender-channel",channelPortname:"channelName",typename:"Event Sender",ignorePorts:["channelName","sendEvent","propagation"]},{type:"numbered",name:"simple-number",port:{type:"number"}},{type:"numbered",name:"simple-boolean",port:{type:"boolean"}},{type:"numbered",name:"simple-string",port:{type:"string"}},{type:"numbered",name:"simple-color",port:{type:"color"}},{type:"regexp",name:"expression-mathjs",filters:[{type:"replace",regexp:"\\s",args:"g",with:""},{type:"ignore",regexp:"([a-z]|[A-Z])([a-z]|\\.|[A-Z]|[0-9])*(?=\\()",args:"g"},{type:"ignore",regexp:"pi|false|true",args:"g"},{type:"ports",regexp:"([a-z]|[A-Z])([a-z]|\\.|[A-Z]|[0-9])*",args:"g",port:{type:{name:"number"},plug:"input"}}]},{type:"regexp",name:"expression-multiline-mathjs",filters:[{type:"replace",regexp:"[ \\t]+",args:"g",with:""},{type:"ignore",regexp:"([a-z]|[A-Z])([a-z]|\\.|[A-Z]|[0-9])*(?=\\()",args:"g"},{type:"ports",regexp:"(([A-Za-z_]|[A-Za-z0-9_])+)(?==)",args:"g",port:{type:{name:"number"},plug:"output"}},{type:"ignore",regexp:"(([A-Za-z_]|[A-Za-z0-9_])+)(?==)",args:"g"},{type:"ports",regexp:"([a-z]|[A-Z])([a-z]|\\.|[A-Z]|[0-9])*",args:"g",port:{type:{name:"number"},plug:"input"}}]}],colors:{component:{base:"#6e3599",baseHighlighted:"#8440b8",header:"#6e3599",headerHighlighted:"#8440b8",outline:"#6e3599",outlineHighlighted:"#b58900",text:"#ffffff"},visual:{base:"#2a4e6e",baseHighlighted:"#376690",header:"#2a4e6e",headerHighlighted:"#376690",outline:"#2a4e6e",outlineHighlighted:"#b58900",text:"#ffffff"},data:{base:"#6d8241",baseHighlighted:"#2f8d22",header:"#6d8241",headerHighlighted:"#2f8d22",outline:"#6d8241",outlineHighlighted:"#b58900",text:"#ffffff"},javascript:{base:"#a24176",baseHighlighted:"#ab5484",header:"#a24176",headerHighlighted:"#ab5484",outline:"#ab5484",outlineHighlighted:"#d57bab",text:"#ffffff"},default:{base:"#3e434e",baseHighlighted:"#505768",header:"#3e434e",headerHighlighted:"#505768",outline:"#3e434e",outlineHighlighted:"#b58900",text:"#ffffff"}},nodetypes:[{name:"Component Children",color:"component",panels:"none",allowAsChild:!0,category:"Visual",haveComponentChildren:["Visual"]}]},c=Object.keys(a._constructors);return c.forEach(function(c){function d(a,b){var c={name:a,type:b.type,plug:"output"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),f.ports.push(c)}var e=a._constructors[c].metadata,f={name:c};b.nodetypes.push(f),e.version&&(f.version=e.version),e.displayNodeName&&(f.displayNodeName=e.displayNodeName),e.deprecated&&(f.deprecated=!0),e.haveComponentPorts&&(f.haveComponentPorts=!0),"Visual"===e.category&&(f.allowAsChild=!0,f.allowAsExportRoot=!0,f.color="visual"),e.allowChildren&&(f.allowChildrenWithCategory=["Visual"],f.color="visual"),e.allowChildrenWithCategory&&(f.allowChildrenWithCategory=e.allowChildrenWithCategory),e.allowAsChild&&(f.allowAsChild=!0),f.category=e.category,e.panels&&(f.panels=e.panels),e.usePortAsLabel&&(f.usePortAsLabel=e.usePortAsLabel,f.portLabelTruncationMode=e.portLabelTruncationMode),e.color&&(f.color=e.color),e.dynamicports&&(f.dynamicports=e.dynamicports),f.ports=[];var g=[],h={},i={};e.dynamicports&&(e.dynamicports.filter(function(a){return"conditionalports/basic"===a.name}).forEach(function(a){a.ports.forEach(function(a){i[a.name]=!0})}),e.dynamicports.filter(function(a){return void 0!==a.channelPort}).forEach(function(a){i[a.channelPort.name]=!0})),e.numberedInputs&&Object.keys(e.numberedInputs).forEach(function(a){var b=e.numberedInputs[a],c={name:b.name,prefix:a};b.displayPrefix&&(c.displayPrefix=b.displayPrefix);var d={plug:"input"};if(b.group&&(d.group=b.group),c.port=d,b.selectors){var f=[];Object.keys(b.selectors).forEach(function(a){var c=b.selectors[a];h[a]=!0;var d={name:a,plug:"input"};c.displayName&&(d.displayName=c.displayName),c.editorName&&(d.editorName=c.editorName),c.group&&(d.group=c.group),d.allowEditOnly=!0,f.push(d)}),c.selectors=f}g.push(c)}),g.length&&(f.dynamicports=g),Object.keys(e.inputs).forEach(function(a){if(!h.hasOwnProperty(a)&&!i.hasOwnProperty(a)){var b=e.inputs[a];if(b.exportToEditor!==!1){var c={name:a,type:b.type,plug:"input"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),void 0!==b.default&&(c.default=b.default),b.hasOwnProperty("index")&&(c.index=b.index),f.ports.push(c)}}}),Object.keys(e.outputs).forEach(function(a){var b=e.outputs[a];d(a,b)})}),b}b.exports=d},{}],259:[function(a,b,c){"use strict";function d(a){this._constructors={},this.context=a}d.prototype.register=function(a){var b=a.metadata.name;if(this._constructors.hasOwnProperty(b))throw new Error("Node with name "+b+" already registered");this._constructors[b]=a},d.prototype.createNode=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a](this.context)},d.prototype.getNodeMetadata=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a].metadata},d.prototype.hasNode=function(a){return this._constructors.hasOwnProperty(a)},b.exports=d},{}],260:[function(a,b,c){"use strict";function d(a){return!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"And",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){var a=this._internal.inputs;return a.length>0&&a.some(d)===!1}}}})},{"../nodedefinition":257}],261:[function(a,b,c){"use strict";function d(a){this.name=a.name,this.startValue=0,this.endValue=0,this.currentValue=void 0,this.startMode="implicit",this.ease=a.ease,this.node=a.node,this.hasSampledStartValue=!1;var b=this;this.animation=a.node.context.timerScheduler.createTimer({startValue:0,endValue:0,onRunning:function(a){var c=b.ease(this.startValue,this.endValue,a);b.setCurrentValue(c)}}),this.animation.startValue=0,this.animation.endValue=0}var e=(a("../node"),a("../nodedefinition")),f=a("../easecurves"),g=a("bezier-easing");Object.defineProperties(d.prototype,{setCurrentValue:{value:function(a){this.currentValue=a,this.node.flagOutputDirty(this.name)}},play:{value:function(a,b){if(void 0===a&&(console.log("Animation warning, start value is undefined"),a=0),void 0===b)return void console.error("Animation error, start:",a,"end:",b);var c=this.animation;c.startValue=a,this.setCurrentValue(a),c.endValue=b,c.duration=this.node._internal.duration,c.start()}},playToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.endValue))}},playToStart:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.startValue))}},replayToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.startValue,this.endValue))}},replayToStart:{value:function(){this.hasConnections()!==!1&&this.play(this.endValue,this.startValue)}},hasConnections:{value:function(){return this.node.getOutput(this.name).hasConnections()}},getTargetsCurrentValue:{value:function(){var a=this.node.getOutput(this.name).connections;return a[0].node._cachedInputValues[a[0].inputPortName]}},updateStartValue:{value:function(){"implicit"!==this.startMode||this.hasSampledStartValue||(this.hasSampledStartValue=!0,this.startValue=this.getTargetsCurrentValue())}},stop:{value:function(){this.animation.stop(),this.setCurrentValue(void 0)}},jumpToStart:{value:function(){this.animation.stop(),this.setCurrentValue(this.startValue)}},jumpToEnd:{value:function(){this.animation.stop(),this.setCurrentValue(this.endValue)}}});var h=[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}],i=300,j={name:"Animation",category:"Animation",initialize:function(){var a=this._internal;a.duration=i,a.ease=f.easeOut,a._isPlayingToEnd=!1,a.animations=[],a.cubicBezierPoints=[0,0,0,0],a.cubicBezierFunction=void 0;var b=this;a.animation=this.context.timerScheduler.createTimer({onFinish:function(){a._isPlayingToEnd===!1?b.sendSignalOnOutput("hasReachedStart"):b.sendSignalOnOutput("hasReachedEnd")}})},inputs:{duration:{index:0,type:"number",displayName:"Duration (ms)",group:"Animation Properties",default:i,set:function(a){this._internal.duration=a}},easingCurve:{index:10,type:{name:"enum",enums:h},group:"Animation Properties",displayName:"Easing Curve",default:"easeOut",set:function(a){var b;"cubicBezier"===a?(this.updateCubicBezierFunction(),b=this._internal.cubicBezierFunction):b=f[a],this._internal.ease=b}},playToEnd:{index:20,group:"Play",displayName:"To End",editorName:"Play To End",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!0;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToEnd()})}},playToStart:{index:21,group:"Play",displayName:"To Start",editorName:"Play To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToStart()})}},replayToEnd:{index:22,group:"Play",displayName:"From Start To End",editorName:"Play From Start To End",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations,c=this;this._internal._isPlayingToEnd=!0,this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToEnd()})}},replayToStart:{index:23,group:"Play",displayName:"From End To Start",editorName:"Play From End To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToStart()})}},stop:{index:60,group:"Instant Actions",displayName:"Stop",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations;a.stop();for(var c=0;c<b.length;c++)b[c].stop()}},jumpToStart:{index:61,group:"Instant Actions",displayName:"Jump To Start",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToStart();this.sendSignalOnOutput("hasReachedStart")}},jumpToEnd:{index:62,group:"Instant Actions",displayName:"Jump To End",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToEnd();this.sendSignalOnOutput("hasReachedEnd")}},cubicBezierP1X:{set:function(a){this._internal.cubicBezierPoints[0]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP1Y:{set:function(a){this._internal.cubicBezierPoints[1]=a,this.updateCubicBezierFunction()}},cubicBezierP2X:{set:function(a){this._internal.cubicBezierPoints[2]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP2Y:{set:function(a){this._internal.cubicBezierPoints[3]=a,this.updateCubicBezierFunction()}}},outputs:{hasReachedStart:{type:"signal",group:"Signals",displayName:"Has Reached Start"},hasReachedEnd:{type:"signal",group:"Signals",displayName:"Has Reached End"}},dynamicports:[{name:"conditionalports/basic",condition:"easingCurve = cubicBezier",ports:[{name:"cubicBezierP1X",displayName:"P1 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:11},{name:"cubicBezierP1Y",displayName:"P1 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:12},{name:"cubicBezierP2X",displayName:"P2 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:13},{name:"cubicBezierP2Y",displayName:"P2 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:14}]},{name:"expand/basic",indexStep:100,template:[{name:"{{portname}}.startMode",type:{name:"enum",enums:[{value:"explicit",label:"Explicit"},{value:"implicit",label:"Implicit"}],allowEditOnly:!0},plug:"input",group:"{{portname}} Animation",displayName:"Start Mode",default:"implicit",index:1e3},{name:"{{portname}}.endValue",type:"number",plug:"input",group:"{{portname}} Animation",displayName:"End Value",editorName:"End Value | {{portname}} ",default:0,index:1002}]},{name:"expand/basic",condition:"'{{portname}}.startMode' = explicit",indexStep:100,template:[{name:"{{portname}}.startValue",plug:"input",type:"number",displayName:"Start Value",editorName:"Start Value | {{portname}}",group:"{{portname}} Animation",default:0,index:1001}]}],panels:[{name:"PortEditor",title:"Animations",plug:"output",type:{name:"number"},group:"Animation Values"}],prototypeExtensions:{updateCubicBezierFunction:{value:function(){var a=this._internal.cubicBezierPoints,b=g(a);this._internal.cubicBezierFunction=function(a,c,d){return f.linear(a,c,b.get(d))},this._internal.ease=this._internal.cubicBezierFunction}},_registerAnimationGroup:{value:function(a){var b=new d({node:this,ease:this._internal.ease,name:a});this._internal.animations.push(b);var c={};c[a+".startMode"]={set:function(a){b.startMode=a}},c[a+".startValue"]={default:0,set:function(a){b.startValue=a}},c[a+".endValue"]={default:0,set:function(a){b.endValue=a}},this.registerInputs(c),this.registerOutput(a,{getter:function(){return b.currentValue}})}},registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=a.indexOf("."),c=a.substr(0,b);this.hasOutput(c)||this._registerAnimationGroup(c)}}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this._registerAnimationGroup(a)}}}};b.exports=e.defineNode(j)},{"../easecurves":243,"../node":255,"../nodedefinition":257,"bezier-easing":2}],262:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function g(a){return"#"+f(a[0])+f(a[1])+f(a[2])}var h=a("../easecurves"),i=[0,0,0],j=[0,0,0],k=[0,0,0],l={name:"Color Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.resultColor="#000000",a.blendValue=0,a.colors=[]},numberedInputs:{color:{name:"numbered/simple-color",displayPrefix:"Color",createSetter:function(a){return function(b){this._internal.colors[a]=b,this.updateColor()}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value",default:0,set:function(a){this._internal.blendValue=a,this.updateColor()}}},outputs:{result:{type:"color",displayName:"Result",getter:function(){return this._internal.resultColor}}},prototypeExtensions:{updateColor:function(){function a(a){return b[a]?b[a]:"#000000"}var b=this._internal.colors;if(0!==b.length){var c=d(0,b.length-1,this._internal.blendValue),f=Math.floor(c),l=c-f;0===l?this._internal.resultColor=a(f):(e(i,a(f)),e(j,a(f+1)),k[0]=Math.floor(h.linear(i[0],j[0],l)),k[1]=Math.floor(h.linear(i[1],j[1],l)),k[2]=Math.floor(h.linear(i[2],j[2],l)),this._internal.resultColor=g(k)),this.flagOutputDirty("result")}}}};b.exports={node:l}},{"../easecurves":243}],263:[function(a,b,c){"use strict";b.exports={node:{name:"Component Inputs",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"output",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,category:"Component Utilities",initialize:function(){this._internal.outputs={}},prototypeExtensions:{registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:function(){return this.nodeScope.componentOwner._internal.inputValues[a]}})}}}}},{}],264:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.nodeScope=new f(a,this),this._internal.childRoot=null,this._internal.componentOutputValues={},this._internal.componentOutputs=[],this._internal.componentInputs=[],this._internal.inputValues={}}var e=a("../node"),f=a("../nodescope"),g=a("lodash");d.prototype=Object.create(e.prototype,{setComponentModel:{value:function(a){this.model=a;var b=this;this.nodeScope.setComponentModel(a),this._internal.componentInputs=this.nodeScope.getNodesWithType("Component Inputs"),this._internal.componentOutputs=this.nodeScope.getNodesWithType("Component Outputs"),g.values(a.getInputPorts()).forEach(this.registerComponentInputPort.bind(this)),g.values(a.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this)),a.roots&&a.roots.length>0&&this.setRoot(a.roots[0]),a.on("rootAdded",function(a){b._internal.root||b.setRoot(a)},this),a.on("rootRemoved",function(c){if(b._internal.root&&b._internal.root.id===c){var d=b._internal.visualParent;b.resetRoot();var e=a.getFirstRootId();e&&this.nodeScope.hasNodeWithId(e)&&(b.setRoot(a.getFirstRootId()),d&&d.addChild(b))}},this),a.on("inputPortAdded",this.registerComponentInputPort.bind(this),this),a.on("outputPortAdded",this.registerComponentOutputPort.bind(this),this),a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){this.hasOutput(a.name)&&b.deregisterOutput(a.name)},this),a.on("nodeAdded",function(a){"Component Inputs"===a.type?b._internal.componentInputs.push(b.nodeScope.getNodeWithId(a.id)):"Component Outputs"===a.type&&b._internal.componentOutputs.push(b.nodeScope.getNodeWithId(a.id))},this),a.on("nodeRemoved",function(a){"Component Inputs"===a.type?g.remove(b._internal.componentInputs,{id:a.id}):"Component Outputs"===a.type&&g.remove(b._internal.componentOutputs,{id:a.id})},this),a.on("renamed",function(a){b.name=a.newName},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0),this.nodeScope.reset()}},registerComponentInputPort:{value:function(a){this.registerInput(a.name,{set:function(b,c){c?this._internal.inputValues[a.name]={value:b,unit:c}:this._internal.inputValues[a.name]=b,this._internal.componentInputs.forEach(function(b){b.registerOutputIfNeeded(a.name),b.flagOutputDirty(a.name)})}})}},registerComponentOutputPort:{value:function(a){this.registerOutput(a.name,{getter:function(){return this._internal.componentOutputValues[a.name]}})}},setOutputFromComponentOutput:{value:function(a,b){this.hasOutput(a)!==!1&&(this._internal.componentOutputValues[a]=b,this.flagOutputDirty(a))}},setRoot:{value:function(a){if(!a)throw Error("id must be set");var b=this.nodeScope.getNodeWithId(a);if(b.getVisualRoot){this._internal.root&&this.resetRoot(),this._internal.root=b;var c=b.getVisualRoot();c&&(c._internal.visualParent&&c._internal.visualParent.removeChild(this._internal.root),void 0===c.componentIds&&(c.componentIds=[]),c.componentIds.indexOf(this.id)===-1&&c.componentIds.push(this.id))}}},resetRoot:{value:function(){this._internal.visualParent&&this._internal.visualParent.removeChild(this);var a=this._internal.root.getVisualRoot();if(this._internal.root=void 0,a&&a.componentIds){var b=a.componentIds.indexOf(this.id);b!==-1&&a.componentIds.splice(b,1)}}},setChildRoot:{value:function(a){var b=this._internal.childRoot,c=a;if(this._internal.childRoot=c,this.model.children){var d=this.parentNodeScope,e=this.model.children.map(function(a){return d.getNodeWithId(a.id)});if(b)for(var f=0;f<e.length;f++)b.removeChild(e[f]);if(c)for(var f=0;f<e.length;f++){var g=e[f],h=g.model.parent.children.indexOf(g.model);this.addChild(g,h)}}}},getChildRootIndex:{value:function(){if(!this._internal.childRoot||!this._internal.childRoot.model||!this._internal.childRoot.model.children)return 0;for(var a=this._internal.childRoot.model.children,b=0;b<a.length;b++)if("Component Children"===a[b].type)return b;return 0}},getChildRoot:{value:function(){return this._internal.childRoot?this._internal.childRoot:this._internal.root.getChildRoot()}},getVisualRoot:{value:function(){if(this._internal.root)return this._internal.root.getVisualRoot()}},addChild:{value:function(a,b){this.getChildRoot().addChild(a,b+this.getChildRootIndex())}},flagDirty:{value:function(){if(!this._dirty){e.prototype.flagDirty.call(this);for(var a=this._internal.componentInputs,b=0,c=a.length;b<c;b++)a[b].flagDirty();this._internal.componentOutputs.forEach(function(a){a.flagDirty()})}}},setHighlightEnabled:{value:function(a){var b=this.getVisualRoot();b&&b.setHighlightEnabled&&b.setHighlightEnabled(a)}},update:{value:function(){e.prototype.update.call(this),this._internal.componentOutputs.forEach(function(a){a.update()})}}}),d.prototype.constructor=d,b.exports=d},{"../node":255,"../nodescope":325,lodash:145}],265:[function(a,b,c){"use strict";b.exports={node:{category:"Component Utilities",name:"Component Outputs",panels:[{name:"PortEditor",context:["select","connectTo"],title:"Outputs",plug:"input",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.nodeScope.componentOwner.setOutputFromComponentOutput(a,b)}})}}}}},{}],266:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Counter",category:"Math",initialize:function(){this._internal.currentValue=0,this._internal.startValue=0,this._internal.startValueSet=!1,this._internal.limitsEnabled=!1,this._internal.limitsMin=0,this._internal.limitsMax=0},inputs:{increase:{displayName:"Increase Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue>=this._internal.limitsMax||(this._internal.currentValue++,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},decrease:{displayName:"Decrease Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue<=this._internal.limitsMin||(this._internal.currentValue--,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},reset:{displayName:"Reset To Start",valueChangedToTrue:function(){0!==this.currentValue&&(this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},startValue:{type:"number",displayName:"Start Value",default:0,set:function(a){this._internal.startValue=Number(a),this._internal.startValueSet===!1&&(this._internal.startValueSet=!0,this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},limitsMin:{type:{name:"number"},displayName:"Min Value",group:"Limits",default:0,set:function(a){this._internal.limitsMin=Number(a)}},limitsMax:{type:{name:"number"},displayName:"Max Value",group:"Limits",default:0,set:function(a){this._internal.limitsMax=Number(a)}},limitsEnabled:{type:{name:"boolean"},displayName:"Limits Enabled",group:"Limits",default:!1,set:function(a){this._internal.limitsEnabled=!!a}}},outputs:{currentCount:{displayName:"Current Count",type:"number",getter:function(){return this._internal.currentValue}},countChanged:{displayName:"Count Changed",type:"signal"}}})},{"../nodedefinition":257}],267:[function(a,b,c){"use strict";function d(){this.items=[]}var e=a("./model"),f=a("lodash"),g={};d.get=function(a){return void 0===a&&(a=e.guid()),g[a]||(g[a]=new d),g[a]},d.exists=function(a){return void 0!==g[a]},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);c!==-1&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=f.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.set=function(a){function b(a){for(var b={},c=a.length,d=0;d<c;d++){var e=a[d];b[e.getId()]=e}return b}var c,f;if(a!==this){var a=a instanceof d?a.items:a,g=[];for(c=a.length,f=0;f<c;f++){var h=a[f];h instanceof e?g.push(h):g.push(e.create(h))}var i=this.items,j=b(i),k=b(g);for(c=i.length,f=0;f<c;f++)k.hasOwnProperty(i[f].getId())||(this.removeAtIndex(f),f--,c--);for(f=0;f<Math.min(i.length,g.length);f++)i[f]!==g[f]&&(j.hasOwnProperty(g[f].getId())&&this.remove(g[f]),this.addAtIndex(g[f],f));for(f=i.length;f<g.length;f++)this.add(g[f])}},d.prototype.contains=function(a){return this.items.indexOf(a)!==-1},d.prototype.add=function(a){this.contains(a)||(this.items.push(a),this.notify("add",{item:a}),this.notify("change"),a.notify("add",{collection:this}))},d.prototype.addAtIndex=function(a,b){this.contains(a)||(this.items.splice(b,0,a),this.notify("add",{item:a,index:b}),this.notify("change"),a.notify("add",{collection:this,index:b}))},d.prototype.removeAtIndex=function(a){var b=this.items[a];this.items.splice(a,1),this.notify("remove",{item:b,index:a}),this.notify("change"),b.notify("remove",{collection:this})},d.prototype.remove=function(a){var b=this.items.indexOf(a);b!==-1&&this.removeAtIndex(b)},d.prototype.size=function(){return this.items.length},d.prototype.get=function(a){return this.items[a]},d.prototype.each=function(a){for(var b=0;b<this.items.length;b++)a(this.items[b],b)},b.exports=d},{"./model":271,lodash:145}],268:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("./model"),g=a("./collection"),h=a("../../edgetriggeredinput"),i={name:"Collection",category:"Data",usePortAsLabel:"collectionId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"idType = explicit OR idType NOT SET",ports:[{name:"collectionId",plug:"input",type:"string",displayName:"Id",group:"General"}]},{name:"conditionalports/basic",condition:"idType = unique",ports:[{name:"newId",plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"New",group:"General"}]}],initialize:function(){var a=this;this._internal.flagCountDirtyCallback=function(){a.flagOutputDirty("count")},this._internal.copySourceItemsCallback=function(){a.copySourceItems()}},inputs:{idType:{type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Generated",value:"unique"}],allowEditOnly:!0},default:"explicit",displayName:"Id Mode",group:"General",set:function(a){this._internal.idType=a}},items:{type:"collection",group:"Modify",displayName:"Items",set:function(a){a&&a!==this._internal.sourceItems&&(this.bindSourceCollection(a),this.scheduleCopySourceItems())}},modifyId:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Item Id",group:"Modify",set:function(a){this._internal.modifyId=a}},add:{displayName:"Add",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.modifyId){var b=f.get(a.modifyId);a.collection.add(b)}})}},remove:{displayName:"Remove",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.modifyId){var b=f.get(a.modifyId);a.collection.remove(b)}})}},clear:{displayName:"Clear",group:"Modify",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){a.collection.set([])})}}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.name}},items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}},count:{type:"number",displayName:"Count",group:"General",getter:function(){return this._internal.collection?this._internal.collection.size():0}}},prototypeExtensions:{registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||("collectionId"===a?this.registerInput(a,{set:function(a){b.setCollectionID(a)}}):"newId"===a&&this.registerInput(a,{set:h.createSetter({valueChangedToTrue:function(){b.newCollectionID()}})}))},newCollectionID:function(){this.setCollectionID(f.guid())},setCollectionID:function(a){this._internal.name=a,this.setCollection(g.get(a)),this.flagOutputDirty("id")},setCollection:function(a){this.bindCollection(a),this.flagOutputDirty("items"),this.flagOutputDirty("count")},unbindSourceCollection:function(){var a=this._internal;a.sourceItems&&a.sourceItems instanceof g&&(a.sourceItems.off("change",this._internal.copySourceItemsCallback),a.sourceItems=void 0)},bindSourceCollection:function(a){var b=this._internal;this.unbindSourceCollection(),b.sourceItems=a,a instanceof g&&a.on("change",this._internal.copySourceItemsCallback)},unbindCurrentCollection:function(){var a=this._internal.collection;a&&(a.off("change",this._internal.flagCountDirtyCallback),this._internal.collection=void 0)},bindCollection:function(a){this.unbindCurrentCollection(),this._internal.collection=a,a.on("change",this._internal.flagCountDirtyCallback)},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()},scheduleCopySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems||(a.hasScheduledCopySourceItems=!0,
this.scheduleAfterInputsHaveUpdated(this.copySourceItems.bind(this)))},copySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems=!1,(a.collection||void 0!==a.idType&&"explicit"!==a.idType)&&(a.collection||"unique"!==a.idType||this.newCollectionID(),a.collection.set(a.sourceItems))}}},j=d.defineNode(i);b.exports=j},{"../../edgetriggeredinput":244,"../../node":255,"../../nodedefinition":257,"./collection":267,"./model":271}],269:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("../../guid"),g="// model item is available in item variable\n// set the component variable to the name of the desired component for this\n// item. Component name must start with a '/'.\ncomponent = '/MyComponent';",h={name:"For Each",color:"data",category:"Visual",dynamicports:[{name:"conditionalports/basic",condition:"templateType = explicit OR templateType NOT SET",ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance"}]},{name:"conditionalports/basic",condition:"templateType = dynamic",ports:[{name:"templateScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script",default:g,group:"Appearance"}]}],initialize:function(){this._internal.itemNodes=[];var a=this;this._internal.onAddItem=function(b){a.addItem(b.item,b.index)},this._internal.onRemoveItem=function(b){a.removeItem(b.item)}},inputs:{items:{group:"Data",displayName:"Items",type:{name:"collection",allowConnectionsOnly:!0},set:function(a){a&&a!==this._internal.items&&(this.bindCollection(a),this.scheduleRefresh())}},templateType:{group:"Appearance",displayName:"Template Type",type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Dynamic",value:"dynamic"}]},default:"explicit",set:function(a){this._internal.templateType=a,this.scheduleRefresh()}},template:{set:function(a){this._internal.template=a,this.scheduleRefresh()}},templateScript:{set:function(a){try{this._internal.templateFunction=new Function("item","var component;"+a+";return component;")}catch(b){console.log(b),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-syntax-warning",{message:"<strong>Syntax</strong>: "+b.message})}this.scheduleRefresh()}},refresh:{group:"Appearance",displayName:"Refresh",type:"signal",valueChangedToTrue:function(){this.scheduleRefresh()}}},prototypeExtensions:{updateTarget:function(a){this._internal.target=a?this.nodeScope.getNodeWithId(a):void 0,this.scheduleRefresh()},setNodeModel:function(a){e.prototype.setNodeModel.call(this,a),a.parent&&this.updateTarget(a.parent.id);var b=this;a.on("parentUpdated",function(a){b.updateTarget(a?a.id:void 0)},this)},scheduleRefresh:function(){var a=this,b=this._internal;b.hasScheduledRefresh||(b.hasScheduledRefresh=!0,this.scheduleAfterInputsHaveUpdated(function(){a.refresh()}))},unbindCurrentCollection:function(){var a=this._internal.items;a&&(a.off("add",this._internal.onAddItem),a.off("remove",this._internal.onRemoveItem),this._internal.collection=void 0)},bindCollection:function(a){var b=this._internal;this.unbindCurrentCollection(),a.on("add",this._internal.onAddItem),a.on("remove",this._internal.onRemoveItem),b.items=a},getTemplateForModel:function(a){var b=this._internal;if(void 0===b.templateType||"explicit"===b.templateType)return b.template;if(b.templateFunction){try{var c=b.templateFunction(a)}catch(d){console.log(d),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-dynamic-warning",{message:"<strong>Dynamic template</strong>: "+d.message})}return c}},addItem:function(a,b){var c=this._internal,d=this.getTemplateForModel(a);if(d){var e=this.nodeScope.createNode(d,f());e._forEachModel=a;var g=e.nodeScope.getNodesWithType("Model");if(g&&g.length>0)for(var h=0;h<g.length;h++)g[h].hasInstanceIDType()&&g[h].setModel(a);var i=e.nodeScope.getNodesWithType("For Each Actions");if(i&&i.length>0)for(var h=0;h<i.length;h++)i[h].setItemId(a.getId()),i[h].signalAdded();c.itemNodes.push(e),c.target.addChild(e,b)}},removeItem:function(a){function b(){var b=c.target._internal.children;for(var d in b){var e=b[d];if(e._forEachModel===a&&!e._forEachRemoveInProgress)return e}}var c=this._internal,d=b();if(d){var e=d.nodeScope.getNodesWithType("For Each Actions");e&&e.length>0?(d._forEachRemoveInProgress=!0,e[0].tryRemove(function(){c.target.removeChild(d)})):c.target.removeChild(d);var f=c.itemNodes.indexOf(d);f!==-1&&c.itemNodes.splice(f,1)}},refresh:function(){var a=this._internal;if(a.hasScheduledRefresh=!1,(a.template||a.templateFunction)&&a.items&&a.target){for(var b=0;b<a.itemNodes.length;b++)a.target.removeChild(a.itemNodes[b]);a.itemNodes=[];for(var b=0;b<a.items.size();b++){var c=a.items.get(b);this.addItem(c)}}},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()}}};b.exports=d.defineNode(h)},{"../../guid":249,"../../node":255,"../../nodedefinition":257}],270:[function(a,b,c){"use strict";var d={name:"For Each Actions",displayNodeName:"For Each Item",category:"Data",color:"data",inputs:{removeCompleted:{type:{name:"boolean",allowConnectionsOnly:!0},displayName:"Remove Completed",group:"Events",valueChangedToTrue:function(){this._internal.removeCompletedCallback&&this._internal.removeCompletedCallback()}}},outputs:{added:{type:"signal",displayName:"Added",group:"Events"},tryRemove:{type:"signal",displayName:"Try Remove",group:"Events"},itemId:{type:"string",displayName:"Item Id",group:"General",getter:function(){return this._internal.itemId}}},prototypeExtensions:{setItemId:function(a){this._internal.itemId=a,this.flagOutputDirty("itemId")},signalAdded:function(){this.sendSignalOnOutput("added")},tryRemove:function(a){this.getOutput("tryRemove").hasConnections()?(this._internal.removeCompletedCallback=a,this.sendSignalOnOutput("tryRemove")):a()}}};b.exports={node:d}},{}],271:[function(a,b,c){function d(a,b){this.id=a,this.data=b}var e=a("lodash"),f={};d.get=function(a){return void 0===a&&(a=d.guid()),f[a]||(f[a]=new d(a,{})),f[a]},d.create=function(a){var b=a?a:{},c=d.get(b.id);for(var e in b)"id"!==e&&c.set(e,b[e]);return c},d.exists=function(a){return void 0!==f[a]},d.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);c!==-1&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=e.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.setAll=function(a){for(var b in a)if("id"!==b&&this.data[b]!==a[b]){var c=this.data[b];this.data[b]=a[b],this.notify("change",{name:b,value:a[b],old:c})}},d.prototype.set=function(a,b,c){if(c&&c.resolve&&a.indexOf(".")!==-1){for(var e=a.split("."),f=this,g=0;g<e.length-1;g++){var h=f.get(e[g]);if(!(h instanceof d))return;f=h}return void f.set(e[e.length-1],b)}var i=this.data[a];this.data[a]=b,(!c||!c.silent)&&this.notify("change",{name:a,value:b,old:i})},d.prototype.getId=function(){return this.id},d.prototype.get=function(a,b){if(b&&b.resolve&&a.indexOf(".")!==-1){for(var c=a.split("."),e=this,f=0;f<c.length-1;f++){var g=e.get(c[f]);if(!(g instanceof d))return;e=g}return e.get(c[c.length-1])}return this.data[a]},b.exports=d},{lodash:145}],272:[function(a,b,c){"use strict";function d(a){return this._internal.model?this._internal.model.get(a,{resolve:!0}):void 0}function e(a,b){this._internal.inputValues[a]=b}function f(a,b,c){var d=[];b=b?b.split(","):void 0;for(var e in b){var f=b[e];d.push({type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:f})}var g=JSON.stringify(d);j[a]!==g&&(j[a]=g,c.sendDynamicPorts(a,d))}var g=a("./model"),h=a("../../edgetriggeredinput"),i=a("../../node"),j={},k={name:"Model",category:"Data",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"idType = explicit",ports:[{name:"modelId",plug:"input",type:"string",displayName:"Id",group:"General"}]},{name:"conditionalports/basic",condition:"idType = unique OR idType NOT SET",ports:[{name:"newId",plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"New Id",group:"General"}]}],initialize:function(){var a=this._internal;a.inputValues={};var b=this;this._internal.onModelChangedCallback=function(a){b.hasOutput(a.name)&&b.flagOutputDirty(a.name)}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.model?this._internal.model.getId():void 0}},stored:{type:"signal",displayName:"Stored",group:"Events"}},inputs:{idType:{type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Generated",value:"unique"},{label:"For each assigned",value:"instance"}],allowEditOnly:!0},default:"unique",displayName:"Id Mode",group:"General",set:function(a){this._internal.idType=a}},properties:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Properties",group:"Properties",set:function(a){}},store:{displayName:"Store",group:"Actions",valueChangedToTrue:function(){var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(a.model){for(var b in a.inputValues)a.model.set(b,a.inputValues[b],{resolve:!0});this.sendSignalOnOutput("stored")}})}},clear:{displayName:"Clear",group:"Actions",valueChangedToTrue:function(){var a=this._internal;if(a.model)for(var b in a.inputValues)a.model.set(b,void 0,{resolve:!0})}}},prototypeExtensions:{hasInstanceIDType:function(){return"instance"===this._internal.idType},newModelID:function(){this.setModelID(g.guid())},setModelID:function(a){var b=g.get(a);this.setModel(b)},setModel:function(a){this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.model=a,this.flagOutputDirty("id"),a.on("change",this._internal.onModelChangedCallback);for(var b in a.data)this.hasOutput(b)&&this.flagOutputDirty(b)},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback)},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||("modelId"===a?this.registerInput(a,{set:function(a){b.setModelID(a)}}):"newId"===a?this.registerInput(a,{set:h.createSetter({valueChangedToTrue:function(){b.newModelID()}})}):this.registerInput(a,{set:e.bind(this,a)}))}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Model",function(b){b.parameters.properties&&f(b.id,b.parameters.properties,a.editorConnection),b.on("parameterUpdated",function(c){"properties"===c.name&&f(b.id,b.parameters.properties,a.editorConnection)})})}}},{"../../edgetriggeredinput":244,"../../node":255,"./model":271}],273:[function(a,b,c){"use strict";function d(a){return this._internal.responseOutputs[a]}function e(a,b){this._internal.requestInputs[a]=b}function f(a,b){function c(a){for(var b=0;b<d.length;b++)if(d[b].name===a)return!0;return!1}if(a.parameters){var d=[];if(a.parameters.resource){var e=a.parameters.resource.match(/\{[A-Za-z0-9_]*\}/g);for(var f in e){var h=e[f],i=h.replace("{","").replace("}","");d.push({name:i,type:"string",plug:"input",group:"Inputs"})}}if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var j=a.parameters.externalFile,k=void 0!==b;k&&"/"!==j[0]&&(j="/"+j),g.createFromURL(j,null,function(e){e.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var l=g.createFromCode(a.parameters.code,null);l.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)}}}var g=(a("../../nodedefinition"),a("../../node"),a("../../guid"),a("../../javascriptnodeparser")),h=a("xml2js"),i="define({\n\t// The input ports of the REST node, name of input and type\n\tinputs:{\n\t    //ExampleInput:'number',\n\t},\n\t\n\t// The output ports of the REST node, name of output and type\n\toutputs:{\n\t    //ExampleOutput:'string',\n\t},\n\t\n\t//Add custom code to setup the request object before the request\n\t//is made.\n\t//\n\t//*request.resource     contains the resource path of the request.\n\t//*request.method       contains the method, GET, POST, PUT or DELETE.\n\t//*request.headers      is a map where you can add additional headers.\n\t//*request.parameters   is a map the parameters that will be appended\n\t//                      to the url.\n\t//*request.content      contains the content of the request as a javascript\n\t//                      object.\n\t//\n\t// The inputs and outputs maps can also be accessed via *this.inputs and\n\t// *this.outputs.\n\trequest:function(inputs,request) {\n\t},\n\t\n\t// Add custom code to convert the response content to outputs\n\t//\n\t//*response.status    The status code of the response\n\t//*response.content   The content of the response as a javascript\n\t//                    object.\n\t//*response.request   The request object that resulted in the response.\n\t//\n\t// The inputs and outputs maps can also be accessed via *this.inputs and\n\t// *this.outputs.\n\tresponse:function(outputs,response) {\n\t}\n})\n",j="//Add prototype backend code to response to the request\n//\n//*context.request                      contains the request object as passed from the\n//                                      request script.\n//*context.sendResponse(status,content) should be called to send a response back\n//                                      to the request script with status code\n//                                      and a javascript object with the content\n//                                      of the response.\ncontext.sendResponse(200,{result:'success'});\n",k={name:"REST",category:"Data",color:"data",initialize:function(){this._internal.requestInputs={},this._internal.responseOutputs={},this._internal.backendProperties={},this._internal.hasPendingFetch=!1,this._internal.useExternalFile=!1},dynamicports:[{name:"conditionalports/basic",condition:"backendType = external OR backendType NOT SET",ports:[{name:"backendEndpoint",plug:"input",type:{name:"string",allowEditOnly:!0},displayName:"Endpoint",group:"Backend"}]},{name:"conditionalports/basic",condition:"backendType = prototype",ports:[{name:"backendScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script",default:j,group:"Backend"}]},{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Script",group:"Request",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},default:i}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Request",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{resource:{type:"string",displayName:"Resource",group:"Request",default:"/",set:function(a){this._internal.resource=a}},method:{type:{name:"enum",enums:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}]},displayName:"Method",group:"Request",default:"GET",set:function(a){this._internal.method=a}},useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},default:"no",displayName:"Use External File",group:"Request",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){a&&this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var b=g.createFromCode(a,this.nodeScope.noodlJavascriptAPI);this._onCodeParsed(b)}})}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;g.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a),b._internal.hasPendingFetch===!0&&(b._internal.hasPendingFetch=!1,b.doFetch())})}}},fetch:{type:"boolean",displayName:"Fetch",group:"Actions",valueChangedToTrue:function(){this.scheduleFetch()}},cancel:{type:"boolean",displayName:"Cancel",group:"Actions",valueChangedToTrue:function(){this.cancelFetch()}},backendType:{type:{name:"enum",enums:[{label:"External",value:"external"},{label:"Prototype",value:"prototype"}],allowEditOnly:!0},displayName:"Backend type",group:"Backend",default:"external",set:function(a){this._internal.backendType=a}}},outputs:{fetching:{type:"boolean",displayName:"Fetching",group:"Status",getter:function(){return!!this._internal.fetching}},started:{type:"signal",displayName:"Started",group:"Signals"},completed:{type:"signal",displayName:"Completed",group:"Signals"},statusOK:{type:"signal",displayName:"Status OK",group:"Signals"},statusFail:{type:"signal",displayName:"Status Fail",group:"Signals"}},prototypeExtensions:{_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.requestFunction=a.definedObject.request,this._internal.responseFunction=a.definedObject.response}},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||(0===a.indexOf("backend")?this.registerInput(a,{set:function(c){b._internal.backendProperties[a]=c}}):this.registerInput(a,{set:e.bind(this,a)}))},scheduleFetch:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this)))},doResponse:function(a,b,c){if(this._internal.responseFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.responseFunction.apply(d,[this._internal.responseOutputs,{status:a,content:b,request:c}])}for(var e in this._internal.responseOutputs)this.hasOutput(e)&&this.flagOutputDirty(e);200===a?this.sendSignalOnOutput("statusOK"):this.sendSignalOnOutput("statusFail"),this._internal.fetching=!1,this.flagOutputDirty("fetching"),this.sendSignalOnOutput("completed")},doExternalFetch:function(a){var b=this,c=new window.XMLHttpRequest,d=this._internal.backendProperties.backendEndpoint+a.resource;if(Object.keys(a.parameters).length>0){d+="?";for(var e in a.parameters)d+=e+"="+a.parameters[e]+"&"}c.open(a.method,window.encodeURI(d),!0);for(var f in a.headers)c.setRequestHeader(f,a.headers[f]);c.onreadystatechange=function(){var c=(this.response,!1);if(4===this.readyState||this.readyState===XMLHttpRequest.DONE){var d=this.status,e=this.getResponseHeader("content-type"),f=this.response;e&&(e=e.toLowerCase(),e.indexOf("/json")!==-1?(b.doResponse(d,JSON.parse(f),a),c=!0):e.indexOf("/xml")!==-1&&(h.parseString(f,function(c,e){b.doResponse(d,c?f:e,a)}),c=!0)),c===!1&&b.doResponse(d,f,a)}},c.onerror=function(){console.log("REST: Failed to request",d)},a.content?(c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify(a.content))):c.send()},doPrototypeFetch:function(a){var b=this,c=this._internal.backendProperties.backendScript,d=new Function("context",c),e={request:a,sendResponse:function(c,d){b.doResponse(c,d,a)}};d(e)},doFetch:function(){if(this._internal.hasScheduledFetch=!1,this._internal.useExternalFile===!0&&this._internal.isWaitingForExternalFileToLoad===!0)return void(this._internal.hasPendingFetch=!0);this.sendSignalOnOutput("started"),this._internal.fetching=!0,this.flagOutputDirty("fetching");var a=this._internal.resource;for(var b in this._internal.requestInputs)a=a.replace("{"+b+"}",this._internal.requestInputs[b]);var c={resource:a,headers:{},method:void 0!==this._internal.method?this._internal.method:"GET",parameters:{}};if(this._internal.requestFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.requestFunction.apply(d,[this._internal.requestInputs,c])}void 0===this._internal.backendType||"external"===this._internal.backendType?this.doExternalFetch(c):this.doPrototypeFetch(c)}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.REST",function(b){f(b,a.editorConnection),b.on("parameterUpdated",function(c){f(b,a.editorConnection)})})}}},{"../../guid":249,"../../javascriptnodeparser":251,"../../node":255,"../../nodedefinition":257,xml2js:219}],274:[function(a,b,c){"use strict";function d(a,b){b=b||",";for(var c=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),d=[[]],e=null;e=c.exec(a);){var f=e[1];f.length&&f!==b&&d.push([]);var g;g=e[2]?e[2].replace(new RegExp('""',"g"),'"'):e[3],d[d.length-1].push(g)}return d}var e=a("../../nodedefinition"),f=a("./collection"),g={name:"Static Data",category:"Data",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"type = csv OR type NOT SET",ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General"}]},{name:"conditionalports/basic",condition:"type = json",ports:[{name:"json",plug:"input",type:{name:"string",codeeditor:"json"},displayName:"JSON",group:"General"}]}],inputs:{type:{type:{name:"enum",enums:[{label:"CSV",value:"csv"},{label:"JSON",value:"json"}]},displayName:"Type",group:"General",default:"csv",set:function(a){this._internal.type=a}},csv:{set:function(a){this._internal.csv=a,this.scheduleParseData()}},json:{set:function(a){this._internal.json=a,this.scheduleParseData()}}},outputs:{items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}}},prototypeExtensions:{scheduleParseData:function(){var a=this._internal;a.hasScheduledParseData||(a.hasScheduledParseData=!0,this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this)))},parseData:function(){var a=this._internal;if(a.hasScheduledParseData=!1,a.collection||(a.collection=f.get()),void 0===a.type||"csv"===a.type){for(var b=d(a.csv),c=[],e=b[0],g=1;g<b.length;g++){for(var h=b[g],i={},j=0;j<e.length;j++)i[e[j]]=h[j];c.push(i)}a.collection.set(c),this.flagOutputDirty("items")}else if("json"===a.type){var c=JSON.parse(a.json);a.collection.set(c),this.flagOutputDirty("items")}}}};b.exports=e.defineNode(g)},{"../../nodedefinition":257,"./collection":267}],275:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this._internal.snapPositions.length-1;return this._internal.snapPositions.some(function(c,d){return c>a&&(b=d-1,!0)}),b}function f(a){this._internal.currentSnappedIndex!==a&&(this._internal.currentSnappedIndex=a,this.flagOutputDirty("currentIndex"))}function g(a,b,c){var e=b+(c>0?1:-1);return e=d(0,a.length-1,e)}function h(a,b,c,e){var f=.5,g=.02,h=50,i=a.length-1,j=Math.abs(c-a[b]),k=Math.abs(e);if(j<h&&k<f)return b;for(var l=0;l<a.length;++l){if(j=Math.abs(c-a[l]),j<h&&k<g){i=l,e>0&&i--;break}if(a[l]>c){i=l-1;break}}return e>0&&i++,d(0,a.length-1,i)}function i(a,b,c){var d;if("none"!==this._internal.snapBehavior){d="everyPosition"===this._internal.snapBehavior?g(this._internal.snapPositions,a,c):h(this._internal.snapPositions,this._internal.currentSnappedIndex,b,c);var e=this._internal.snapAnimation;e.startPosition=b,e.endPosition=this._internal.snapPositions[d],e.start(),f.call(this,d)}}function j(a){var b=a;this._internal.clampEnabled===!0&&(b=d(this._internal.clampMin,this._internal.clampMax,a)),0===this._internal.dragGestureRecognizer.axis?this._internal.target.setPositionX(b):this._internal.target.setPositionY(b)}function k(){var a=this._internal.target._internal.uiControl;return 0===this._internal.dragGestureRecognizer.axis?a.positionX:a.positionY}function l(a,b){if(a._internal.dragEnabled!==!1){var c=a._internal.dragGestureRecognizer.onTouch(b);return a._internal.track?c:void 0}}var m=(a("../node"),a("../nodedefinition")),n=a("../easecurves"),o={name:"Drag",category:"Interaction",initialize:function(){var a=this,b=this._internal;b.snapPositions=[0],b.target=void 0,b.track=!0,b.startSnapIndex=0,b.currentSnappedIndex=0,b.snapBehavior="none",b.dragEnabled=!0,b.dragRatio=1,b.snapDuration=300,b.clampMin=0,b.clampMax=0,b.clampEnabled=!1,b.snapAnimation=this.context.timerScheduler.createTimer({duration:b.snapDuration,ease:n.easeOut,startPosition:0,endPosition:0,onRunning:function(b){j.call(a,this.ease(this.startPosition,this.endPosition,b))}}),b.controlStart=0,b.indexOnDragStart=0,b.snapIndex=0,b.dragGestureRecognizer={},b.dragGestureRecognizer=this.context.uiEngine.createDragGestureRecognizer({axis:0,threshold:5,onDragStart:function(){b.snapAnimation.stop(),a.sendSignalOnOutput("dragStart"),b.controlStart=k.call(a),b.indexOnDragStart=e.call(a,b.controlStart)},onDrag:function(){var c=b.controlStart+this.dragDistance*b.dragRatio;if("none"!==b.snapBehavior){var e=b.snapPositions[0],f=b.snapPositions[b.snapPositions.length-1];c=d(e,f,c)}j.call(a,c)},onDragEnd:function(){a.sendSignalOnOutput("dragEnd"),i.call(a,b.indexOnDragStart,k.call(a),this.velocity)}})},inputs:{target:{type:"reference",displayName:"Target",group:"Target Node",set:function(a){if(this._internal.target&&(this._internal.target.removeTouchHandlersWithId(this),this._internal.target=void 0),a){var b=a.getVisualRoot();if(!b._internal.uiControl)throw new Error("target must be a visual node, not a "+b.name);this._internal.target=b,this._internal.target.addTouchHandler(l.bind(null,this),this);var c=this;this.context.scheduleAfterUpdate(function(){"none"!==c._internal.snapBehavior&&j.call(c,c._internal.snapPositions[c._internal.startSnapIndex])})}}},axis:{type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},default:"0",displayName:"Drag Direction",group:"Drag Behavior",set:function(a){this._internal.dragGestureRecognizer.axis=Number(a)}},snapBehavior:{type:{name:"enum",enums:[{value:"none",label:"None"},{value:"everyPosition",label:"Every Position"},{value:"closestPosition",label:"Closest Position"}]},default:"none",group:"Drag Behavior",displayName:"Snap Behavior",set:function(a){this._internal.snapBehavior=a}},track:{type:"boolean",displayName:"Track Touch",group:"Drag Behavior",default:!0,set:function(a){this._internal.track=a}},dragThreshold:{type:{name:"number",allowEditOnly:!0},displayName:"Drag Threshold",group:"Drag Behavior",default:5,set:function(a){this._internal.dragGestureRecognizer.threshold=a}},dragEnabled:{type:{name:"boolean"},displayName:"Drag Enabled",group:"Drag Behavior",default:!0,set:function(a){this._internal.dragEnabled=!!a}},dragRatio:{type:"number",displayName:"Drag Ratio",default:1,group:"Drag Behavior",set:function(a){this._internal.dragRatio=Number(a)}},"snapToIndex.index":{type:"number",displayName:"Index",group:"Snap To Index",default:0,set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.snapIndex=Math.floor(a)}},"snapToIndex.duration":{type:"number",displayName:"Duration",editorName:"Duration|Snap To Index",group:"Snap To Index",default:300,set:function(a){this._internal.snapDuration=a}},"snapToIndex.do":{group:"Snap To Index",displayName:"Do",editorName:"Do|Snap To Index",valueChangedToTrue:function(){var a=this._internal.snapAnimation,b=this;this.scheduleAfterInputsHaveUpdated(function(){a.startPosition=k.call(b),a.endPosition=b._internal.snapPositions[b._internal.snapIndex],a.duration=b._internal.snapDuration,a.start(),f.call(b,b._internal.snapIndex)})}},"clampDragPosition.min":{type:{name:"number"},displayName:"Start",group:"Constrain",default:0,set:function(a){this._internal.clampMin=a}},"clampDragPosition.max":{type:{name:"number"},displayName:"End",group:"Constrain",default:0,set:function(a){this._internal.clampMax=a}},"clampDragPosition.enabled":{type:{name:"boolean"},displayName:"Constrain",group:"Constrain",default:!1,set:function(a){this._internal.clampEnabled=a}}},numberedInputs:{position:{name:"numbered/simple-number",displayPrefix:"Position",group:"Snap Positions",createSetter:function(a){return function(b){this._internal.snapPositions[a]=b}},selectors:{startAt:{displayName:"Start At",group:"Snap Positions",set:function(a){var b=this._internal;b.startSnapIndex=a,f.call(this,a),b.target&&a<b.snapPositions.length&&j.call(this,b.snapPositions[b.startSnapIndex])}}}}},outputs:{dragStart:{group:"Signals",type:"signal",displayName:"Drag Started"},dragEnd:{group:"Signals",type:"signal",displayName:"Drag Ended"},currentIndex:{group:"Current State",type:"number",displayName:"Current Index",getter:function(){return this._internal.currentSnappedIndex}}}};b.exports=m.defineNode(o)},{"../easecurves":243,"../node":255,"../nodedefinition":257}],276:[function(a,b,c){"use strict";var d={name:"Event Receiver",category:"Events",usePortAsLabel:"channelName",color:"component",initialize:function(){var a=this._internal;a.outputValues={},a.outputNames=[],a.eventReceived=!1,a._isEnabled=!0,a.channelName=""},dynamicports:[{name:"portchannel/event-sender-channel",channelPort:{name:"channelName",displayName:"Channel",plug:"input"},port:{type:"*",plug:"output",allowConnectionOnly:!0}}],inputs:{enabled:{displayName:"Enabled",type:"boolean",default:!0,set:function(a){this._internal._isEnabled=!!a}},channelName:{set:function(a){this._internal.channelName=a,this.registerListenersForChannel(a)}}},outputs:{eventReceived:{displayName:"Event Received",type:"signal"}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;this._internal.outputNames.push(a),this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},handleEvent:function(a){if(this._internal._isEnabled!==!1){this.sendSignalOnOutput("eventReceived");for(var b in a)this.hasOutput(b)&&(this._internal.outputValues[b]=a[b],this.flagOutputDirty(b))}},onEventReceived:function(a){this.handleEvent(a)},registerListenersForChannel:function(a){var b=this.context.eventSenderEmitter,c=this.onEventReceived.bind(this);b.on(a,c),this.context.eventEmitter.once("applicationDataReloaded",function(){b.removeListener(a,c)})},getChannelName:function(){return this._internal.channelName}}};b.exports={node:d}},{}],277:[function(a,b,c){"use strict";var d={name:"Event Sender",category:"Events",usePortAsLabel:"channelName",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"input",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.inputValues={},this._internal.channelName="",this._internal.propagation="global"},inputs:{sendEvent:{displayName:"Send Event",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){"global"===a._internal.propagation?a.context.sendGlobalEventFromEventSender(a._internal.channelName,a._internal.inputValues):a.nodeScope.sendEventFromThisScope(a._internal.channelName,a._internal.inputValues,a._internal.propagation)})}},channelName:{type:{name:"string",allowEditOnly:!0},default:"",group:"Settings",displayName:"Channel Name",set:function(a){this._internal.channelName=a,this._internal.inputValues._channelName=a}},propagation:{type:{name:"enum",enums:[{value:"global",label:"Global"},{value:"parent",label:"Parent"},{value:"children",label:"Children"}]},default:"global",group:"Settings",displayName:"Propagation",set:function(a){this._internal.propagation=a}}},prototypeExtensions:{registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}}}}};b.exports={node:d}},{}],278:[function(a,b,c){"use strict";
function d(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}var e=a("../nodedefinition"),f=a("../node"),g=a("lodash"),h={name:"Expression",category:"Math",usePortAsLabel:"expression",initialize:function(){var a=this._internal;a.scope={},a.hasScheduledEvaluation=!1,a.code=void 0,a.cachedValue=0,a.currentExpression="",a.compiledFunction=void 0,a.inputNames=[],a.inputValues=[]},dynamicports:[{name:"regexp/expression-mathjs",port:"expression"}],inputs:{expression:{type:{name:"string",allowEditOnly:!0},displayName:"Expression",set:function(a){this._internal.currentExpression=i+"return ("+a+");",this._internal.compiledFunction=void 0,this._scheduleEvaluateExpression()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.currentExpression?this._internal.cachedValue:0}}},prototypeExtensions:{onInputPortAdded:{value:function(a){var b=this._internal,c=a.name,d={set:function(a){b.scope[c]=a,this._scheduleEvaluateExpression()}};this.registerInput(c,d),this._internal.scope[c]=0,this._cachedInputValues[c]=0,this._internal.inputNames=Object.keys(this._internal.scope),this._internal.compiledFunction=void 0,this._scheduleEvaluateExpression(),this.flagDirty()}},onInputPortRemoved:{value:function(a){this.deregisterInput(a.name),delete this._internal.scope[name],this._internal.inputNames=Object.keys(this._internal.scope),this._internal.compiledFunction=void 0,this._scheduleEvaluateExpression()}},setNodeModel:function(a){f.prototype.setNodeModel.call(this,a),g.forIn(a.getInputPorts(),this.onInputPortAdded.bind(this)),a.on("inputPortAdded",this.onInputPortAdded,this),a.on("inputPortRemoved",this.onInputPortRemoved,this)},_scheduleEvaluateExpression:{value:function(){var a=this._internal;a.hasScheduledEvaluation===!1&&(a.hasScheduledEvaluation=!0,this.flagDirty(),this.scheduleAfterInputsHaveUpdated(function(){var b=a.cachedValue;a.cachedValue=this._calculateExpression(),b!==a.cachedValue&&this.flagOutputDirty("result"),a.hasScheduledEvaluation=!1}))}},_calculateExpression:{value:function(){var a=this._internal;a.compiledFunction||(a.compiledFunction=this._compileFunction());for(var b=0;b<a.inputNames.length;++b){var c=a.scope[a.inputNames[b]];a.inputValues[b]=c}try{return a.compiledFunction.apply(null,a.inputValues)}catch(d){console.error("Error in expression:",d.message)}return 0}},_compileFunction:{value:function(){var a=this._internal.currentExpression,b=Object.keys(this._internal.scope),c=a+b.join(" ");if(j.hasOwnProperty(c)===!1){b.push(a);try{j[c]=d(Function,b)}catch(e){console.error("Failed to compile JS function",e.message)}}return j[c]}}}},i=["var min = Math.min,    max = Math.max,    cos = Math.cos,    sin = Math.sin,    tan = Math.tan,    sqrt = Math.sqrt,    pi = Math.PI,    round = Math.round,    floor = Math.floor,    ceil = Math.ceil,    abs = Math.abs,    random = Math.random;"].join(""),j={};b.exports=e.defineNode(h)},{"../node":255,"../nodedefinition":257,lodash:145}],279:[function(a,b,c){"use strict";var d={name:"Globals",category:"Utilities",color:"component",panels:[{name:"PortEditor",context:["select","connectTo","connectFrom"],title:"Globals",plug:"input/output",type:{name:"*"}}],prototypeExtensions:{_newOutputValueReceived:{value:function(a){this._cachedInputValues[a]=this.context.globalValues[a],this.flagOutputDirty(a)}},registerInputIfNeeded:{value:function(a){var b=this;this.hasInput(a)||this.registerInput(a,{set:b.context.setGlobalValue.bind(b.context,a)})}},registerOutputIfNeeded:{value:function(a){if(!this.hasOutput(a)){var b=this._newOutputValueReceived.bind(this,a),c=this.context.globalsEventEmitter;c.on(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b)}),this.registerOutput(a,{getter:function(){return this.context.globalValues[a]}})}}}}};b.exports={node:d}},{}],280:[function(a,b,c){"use strict";function d(a){a.alpha!==this._internal.alpha&&(this._internal.alpha=a.alpha,this.flagOutputDirty("rotationZ")),a.beta!==this._internal.beta&&(this._internal.beta=a.beta,this.flagOutputDirty("rotationX")),a.gamma!==this._internal.gamma&&(this._internal.gamma=a.gamma,this.flagOutputDirty("rotationY"))}var e=a("../nodedefinition"),f={name:"Gyroscope",displayNodeName:"Device Orientation",category:"Sensors",initialize:function(){this._internal.alpha=0,this._internal.beta=0,this._internal.gamma=0;var a=d.bind(this);window.addEventListener("deviceorientation",a),this.context.eventEmitter.once("applicationDataReloaded",function(){window.removeEventListener("deviceorientation",a)})},outputs:{rotationX:{type:"number",displayName:"Rotation X",getter:function(){return-this._internal.beta}},rotationY:{type:"number",displayName:"Rotation Y",getter:function(){return this._internal.gamma}},rotationZ:{type:"number",displayName:"Rotation Z",getter:function(){return-this._internal.alpha}}}};b.exports=e.defineNode(f)},{"../nodedefinition":257}],281:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e={name:"Inverter",category:"Math",initialize:function(){this._internal.currentValue=!1},inputs:{value:{type:{name:"boolean"},displayName:"Value",set:function(a){this._internal.currentValue=a,this.flagOutputDirty("result")}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return!this._internal.currentValue}}}};b.exports=d.defineNode(e)},{"../nodedefinition":257}],282:[function(a,b,c){"use strict";function d(){return this._internal.isFirstFrame?void(this._internal.isFirstFrame=!1):(this._evaluateFunction(),this.context.nodeIsDirty(this),void this.flagDirty())}function e(a,b){this._internal.needsToEval=!0,this._internal.inputValues[a]=b,this.flagDirty()}function f(a){return this._internal.needsToEval&&this._evaluateFunction(),this._internal.outputValues[a]}var g=a("../nodedefinition"),h=a("../node"),i={};b.exports=g.defineNode({name:"Javascript",category:"Javascript",displayNodeName:"Javascript (Deprecated)",deprecated:!0,panels:[{name:"PortEditor",context:["select"],title:"Inputs",plug:"input",type:{name:"*"}},{name:"PortEditor",context:["select"],title:"Outputs",plug:"output",type:{name:"*"}}],initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.needsToEval=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(a){if(!a)throw new Error("Output port name must be specified");b.flagOutputDirty(a)}},a.isFirstFrame=!0,a.onFrameStart=d.bind(this)},inputs:{code:{type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},displayName:"code",group:"Code",set:function(a){i[a]||(i[a]=new Function("inputs","outputs",a)),this._internal.userFunction=i[a],this._internal.needsToEval=!0}},runEveryFrame:{type:"boolean",displayName:"Run Every Frame",group:"Settings",set:function(a){a=!!a;var b=this.context.eventEmitter;a===!0?b.on("frameStart",this._internal.onFrameStart):b.removeListener("frameStart",this._internal.onFrameStart)}}},prototypeExtensions:{update:{value:function(){this._dirty===!1||this._isUpdating||(h.prototype.update.call(this),this._internal.needsToEval&&(this._evaluateFunction(),this.flagDirty()))}},registerInputIfNeeded:{value:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:f.bind(this,a)})}},_evaluateFunction:{value:function(){var a=this._internal;a.userFunction.call(a.userFunctionScope,a.inputValues,a.outputValues),a.needsToEval=!1}},flagDirty:{value:function(){for(var a in this._internal.outputValues)this.flagOutputDirty(a);h.prototype.flagDirty.call(this)}}}})},{"../node":255,"../nodedefinition":257}],283:[function(a,b,c){"use strict";function d(){for(var a in this._internal.dirtyOutputs)this.flagOutputDirty(a);this._internal.dirtyOutputs={}}function e(){this._internal.setupScheduled||(this._internal.setupScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callSetupFunction(),this._internal.setupScheduled=!1,d.call(this)}))}function f(){this._internal.runScheduled||(this._internal.runScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._callRunFunction(),this._internal.runScheduled=!1,d.call(this)}))}function g(){this._internal.runNextFrame=!1,f.call(this)}function h(a,b){this._internal.inputValues[a]=b,this._internal.hasParsedCode===!0&&f.call(this)}function i(a){return this._internal.outputValues[a]}function j(a,b){if(a.parameters)if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var c=a.parameters.externalFile,d=void 0!==b;d&&"/"!==c[0]&&(c="/"+c),l.createFromURL(c,null,function(c){var d=c.getPorts();b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var e=l.createFromCode(a.parameters.code,null),f=e.getPorts();b.sendDynamicPorts(a.id,f)}}var k=a("../node"),l=a("../javascriptnodeparser"),m=["define({","    inputs: {",'        inputValue: "number"',"    },","    outputs: {",'        outputValue: "number"',"    },","    setup: function(inputs, outputs) {","","    },","    run: function(inputs, outputs) {","","    }","});"].join("\n"),n={name:"Javascript2",displayNodeName:"Javascript",category:"Javascript",color:"javascript",initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.outputProperties={},a.dirtyOutputs={},a.runScheduled=!1,a.setupScheduled=!1,a.runNextFrameScheduled=!1,a.isWaitingForExternalFileToLoad=!1,a.useExternalFile=!1,a.runFunction=void 0,a.setupFunction=void 0,a.hasParsedCode=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(c){if(!c)throw new Error("Output port name must be specified");b.flagOutputDirty(c),a.dirtyOutputs.hasOwnProperty(c)&&delete a.dirtyOutputs[c]},runNextFrame:function(){a.runNextFrameScheduled||(a.runNextFrameScheduled=!0,b.context.scheduleNextFrame(function(){a.runNextFrameScheduled=!1,f.call(b)}))},sendSignalOnOutput:function(c){a.outputValues[c]=!0,b.flagOutputDirty(c),a.outputValues[c]=!1,b.flagOutputDirty(c)}},a.onFrameStart=g.bind(this)},dynamicports:[{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Code",group:"Code",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},default:m}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Code",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},default:"no",displayName:"Use External File",group:"Code",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){if(a){var b=this;this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var c=l.createFromCode(a,b.nodeScope.noodlJavascriptAPI);b._onCodeParsed(c)}})}}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;l.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a)})}}}},prototypeExtensions:{update:function(){this._internal.isWaitingForExternalFileToLoad===!0?this._dirty=!1:k.prototype.update.call(this)},_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.setupFunction=a.setup,this._internal.runFunction=a.run,this._internal.setupFunction&&e.call(this),this._internal.runFunction&&f.call(this),this._internal.hasParsedCode=!0}},registerInputIfNeeded:function(a){this.hasInput(a)||(this._internal.inputValues[a]=void 0,this.registerInput(a,{set:h.bind(this,a)}))},registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;Object.defineProperty(this._internal.outputProperties,a,{set:function(c){b._internal.outputValues[a]=c,b._internal.dirtyOutputs[a]=!0,b.context.scheduleFrame()},get:function(){return b._internal.outputValues[a]}}),this.registerOutput(a,{getter:i.bind(this,a)})}},_callRunFunction:function(){var a=this._internal;if(a.runFunction)try{a.runFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node run code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-run-waring",{message:"<strong>run</strong>: "+b.message})}},_callSetupFunction:function(){var a=this._internal;if(a.setupFunction)try{a.setupFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node setup code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-setup-waring",{message:"<strong>setup</strong>: "+b.message})}}}};b.exports={node:n,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.Javascript2",function(b){j(b,a.editorConnection),b.on("parameterUpdated",function(c){j(b,a.editorConnection)})})}}},{"../javascriptnodeparser":251,"../node":255}],284:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../easecurves");b.exports=d.defineNode({name:"Number Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.inputs=[],a.blendValue=0,a.result=0,a.clamp=!1},prototypeExtensions:{updateResult:function(){var a=this._internal.inputs;if(0===a.length)return 0;var b=Math.floor(this._internal.blendValue),c=this._internal.blendValue-b;b>=a.length-1?this._internal.clamp?(b=a.length-1,c=0):(c+=b-(a.length-1),b=a.length-1):b<=0&&(this._internal.clamp?(b=0,c=0):(c+=b,b=0)),0===c||1===a.length?this._internal.result=a[b]:b===a.length-1&&c>0?this._internal.result=e.linear(a[b-1],a[b],c+1):this._internal.result=e.linear(a[b],a[b+1],c),this.flagOutputDirty("result")}},numberedInputs:{input:{name:"numbered/simple-number",displayPrefix:"Number",createSetter:function(a){var b=this._internal.inputs;return b[a]=0,function(c){b[a]!==c&&(b[a]=c,this.updateResult())}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value",default:0,set:function(a){this._internal.blendValue=a,this.updateResult()}},clamp:{type:"boolean",displayName:"Clamp",default:!1,set:function(a){this._internal.clamp=!!a,this.updateResult()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.result}}}})},{"../easecurves":243,"../nodedefinition":257}],285:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Number Remapper",category:"Math",initialize:function(){var a=this._internal;a._currentInputValue=0,a._remappedValue=0,a._minInputValue=0,a._maxInputValue=0,a._minOutputValue=0,a._maxOutputValue=1,a._clampOutput=!0},inputs:{inputValue:{group:"Value to Remap",type:{name:"number",allowConnectionOnly:!0},default:0,displayName:"Input Value",set:function(a){this._internal._currentInputValue=a,this._calculateNewOutputValue()}},minInputValue:{group:"Input Parameters",type:{name:"number"},default:0,displayName:"Input Minimum",set:function(a){this._internal._minInputValue=a,this._calculateNewOutputValue()}},maxInputValue:{group:"Input Parameters",type:{name:"number"},default:0,displayName:"Input Maximum",set:function(a){this._internal._maxInputValue=a,this._calculateNewOutputValue()}},minOutputValue:{group:"Output Parameters",type:{name:"number"},default:0,displayName:"Output Minimum",set:function(a){this._internal._minOutputValue=a,this._calculateNewOutputValue()}},maxOutputValue:{group:"Output Parameters",type:{name:"number"},default:1,displayName:"Output Maximum",set:function(a){this._internal._maxOutputValue=a,this._calculateNewOutputValue()}},clamp:{group:"Output Parameters",type:{name:"boolean",allowEditOnly:!0},default:!0,displayName:"Clamp Output",set:function(a){this._internal._clampOutput=!!a,this._calculateNewOutputValue()}}},outputs:{remappedValue:{type:"number",displayName:"Remapped Value",group:"Outputs",getter:function(){return this._internal._remappedValue}}},prototypeExtensions:{_calculateNewOutputValue:{value:function(){var a,b=this._internal;a=b._maxInputValue===b._minInputValue?0:(b._currentInputValue-b._minInputValue)/(b._maxInputValue-b._minInputValue),b._clampOutput&&(a=Math.max(0,Math.min(1,a))),b._remappedValue=b._minOutputValue+a*(b._maxOutputValue-b._minOutputValue),this.flagOutputDirty("remappedValue")}}}})},{"../nodedefinition":257}],286:[function(a,b,c){"use strict";function d(a){return!!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Or",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return this._internal.inputs.some(d)}}}})},{"../nodedefinition":257}],287:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithType("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithType("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition"),f=a("lodash"),g=a("../node");b.exports=e.defineNode({name:"Page Navigation",category:"Navigation",initialize:function(){this._internal.inputValues={},this._internal.portUpdateScheduled=!1},inputs:{navigate:{displayName:"Navigate To Page",group:"Navigation",valueChangedToTrue:function(){var a=this._internal;if(a.destinationComponentName){var b=d(this.nodeScope);b.navigateTo(a.destinationComponentName,a.inputValues)}}},destination:{displayName:"Destination",group:"Navigation",type:"component",set:function(a){var b=this._internal;if(b.destinationComponentModel&&(b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentModel=void 0),this.context.hasComponentModelWithName(a)!==!1){b.destinationComponentModel&&b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentName=a;var c=this.context.getComponentModel(a);b.destinationComponentModel=c,this.updateDestinationPagePorts(c),c.on("inputPortAdded",this.scheduleUpdateDestinationPagePorts.bind(this,c),this),c.on("inputPortRemoved",this.scheduleUpdateDestinationPagePorts.bind(this,c),this)}}}},prototypeExtensions:{_onNodeDeleted:function(){g.prototype._onNodeDeleted.call(this);var a=this._internal;a.destinationComponentModel&&a.destinationComponentModel.removeListenersWithRef(this)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this._internal.inputValues[a]=b}})},scheduleUpdateDestinationPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateDestinationPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateDestinationPagePorts:function(a){var b=f.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Destination Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}})},{"../node":255,"../nodedefinition":257,lodash:145}],288:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithType("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithType("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Page Navigation Back",category:"Navigation",inputs:{back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){var a=d(this.nodeScope);a.back()}}}})},{"../nodedefinition":257}],289:[function(a,b,c){"use strict";function d(a,b){this._internal.topicComponents[a]=b,this.scheduleSubscribe()}function e(a){return this._internal.outputValues[a]}function f(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});var g=b.match(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g);for(var f in g)e.push({name:g[f].replace(/\+/g,""),group:"Topic components",plug:"output",type:"*"});c.sendDynamicPorts(a,e)}var g=(a("../nodedefinition"),a("../services/services")),h={name:"Receive Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"outputs",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){var a=this._internal;a.payload={},a.messageReceived=!1,a.isEnabled=!0,a.topic="",a.topicComponents={},a.outputValues={}},inputs:{enabled:{displayName:"Enabled",type:"boolean",default:!0,set:function(a){this._internal.isEnabled=!!a}},topic:{displayName:"Topic",type:"string",default:"",set:function(a){this._internal.topic=a,this.scheduleSubscribe()}}},outputs:{messageReceived:{displayName:"Received",type:"signal"}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:e.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponents;for(var c in b)a=a.replace("{"+c+"}",b[c]);return a.replace(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g,"+")},handleMessage:function(a){if(this._internal.isEnabled!==!1){for(var b=a.payload,c=this._internal.topic.split("/"),d=a.topic.split("/"),e=0;e<d.length;e++){var f=c[e];if("+"===f[0]&&"+"===f[f.length-1]){var g=f.substring(1,f.length-1);this._internal.outputValues[g]=d[e],this.flagOutputDirty(g)}}for(var h in b)this._internal.outputValues[h]=b[h],this.hasOutput(h)&&this.flagOutputDirty(h);this.sendSignalOnOutput("messageReceived"),this.context.scheduleFrame()}},onMessageReceived:function(a){this.handleMessage(a)},scheduleSubscribe:function(){var a=this;this._internal.subscribeScheduled||(this._internal.subscribeScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){a._internal.subscribeScheduled=!1,a.subscribe()}))},subscribe:function(){this.subscription&&(g.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0);var a=this.computeTopic();if(a){var b=this.onMessageReceived.bind(this);this.subscription={topic:a,subscriber:b},g.pubsub.subscribe(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){g.pubsub.unsubscribe(a,b)})}}}};b.exports={node:h,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Receive Message",function(b){b.parameters.topic&&f(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&f(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../nodedefinition":257,"../services/services":332}],290:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Reload",category:"Utilities",inputs:{reload:{displayName:"Reload",valueChangedToTrue:function(){this.context.reloadApplication()}}}})},{"../nodedefinition":257}],291:[function(a,b,c){"use strict";var d={name:"Screen Resolution",category:"Utilities",initialize:function(){var a=this;this.context.uiEngine.on("viewportSizeChanged",this._viewportSizeChanged.bind(this),this),this.context.eventEmitter.once("applicationDataReloaded",function(){a.context.uiEngine.removeListenersWithRef(a)}),this._viewportSizeChanged(this.context.uiEngine.getViewportSize())},outputs:{width:{type:"number",displayName:"Width",getter:function(){return this._internal.width}},height:{type:"number",displayName:"Height",getter:function(){return this._internal.height}},aspectRatio:{type:"number",displayName:"Aspect Ratio",getter:function(){return this._internal.width/this._internal.height}}},prototypeExtensions:{_viewportSizeChanged:function(a){this._internal.width=a.width,this._internal.height=a.height,this.flagAllOutputsDirty()}}};b.exports={node:d}},{}],292:[function(a,b,c){"use strict";function d(a,b){this._internal.inputValues[a]=b,this._internal.publishOnInputsChanged&&this.schedulePublish()}function e(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});c.sendDynamicPorts(a,e)}var f=a("../services/services"),g={name:"Send Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"input",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.payload={},this._internal.topic="",this._internal.inputValues={},this._internal.topicComponentsMap={},this._internal.hasScheduledPublish=!1,this._internal.publishOnInputsChanged=!1,this._internal.rateLimitEnabled=!1,this._internal.maxMessagesPerSecond=10,this._internal.lastPublishTime=0},dynamicports:[{name:"conditionalports/basic",condition:"rateLimit = true",ports:[{name:"maxMessagesPerSecond",type:"number",default:10,displayName:"Messages / Sec",group:"Rate Limit",plug:"input"}]}],inputs:{send:{displayName:"Send",valueChangedToTrue:function(){this.schedulePublish()}},topic:{type:{name:"string"},default:"",displayName:"Topic",group:"General",set:function(a){this._internal.topic=a;var b=a.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g);for(var c in b)this._internal.topicComponentsMap[b[c].replace(/(\{|\})/g,"")]=!0}},publishOnInputsChanged:{type:"boolean",default:!1,displayName:"Send On Change",group:"General",set:function(a){this._internal.publishOnInputsChanged=!!a}},rateLimit:{type:"boolean",default:!1,displayName:"Rate Limit",group:"Rate Limit",set:function(a){this._internal.rateLimitEnabled=!!a}},maxMessagesPerSecond:{set:function(a){this._internal.maxMessagesPerSecond=Number(a)}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponentsMap,c=this._internal.inputValues;for(var d in b)a=a.replace("{"+d+"}",c[d]);return a},schedulePublish:function(){if(!this._internal.hasScheduledPublish){if(this._internal.rateLimitEnabled){clearTimeout(this._internal.rateLimitTimeoutId);var a=window.performance.now(),b=1e3/this._internal.maxMessagesPerSecond,c=a-this._internal.lastPublishTime;if(c<b)return void(this._internal.rateLimitTimeoutId=setTimeout(this.schedulePublish.bind(this),b-c))}this._internal.hasScheduledPublish=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.hasScheduledPublish=!1;var a=this.computeTopic(),b={},c=this._internal.inputValues,d=this._internal.topicComponentsMap;for(var e in c)d[e]||(b[e]=c[e]);f.pubsub.publish(a,b),this._internal.lastPublishTime=window.performance.now()})}}}};b.exports={node:g,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Send Message",function(b){b.parameters.topic&&e(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&e(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../services/services":332}],293:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../edgetriggeredinput");b.exports=d.defineNode({name:"Signal To Index",category:"Logic",initialize:function(){this._internal.currentIndex=0},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Signal",createSetter:function(a){return e.createSetter({valueChangedToTrue:this.onValueChangedToTrue.bind(this,a)})},selectors:{startIndex:{displayName:"Start Index",set:function(a){this._internal.currentIndex=a,this.flagOutputDirty("index")}}}}},outputs:{index:{displayName:"Index",type:"number",getter:function(){return this._internal.currentIndex}},signalTriggered:{displayName:"Signal Triggered",type:"signal"}},prototypeExtensions:{onValueChangedToTrue:function(a){this.sendSignalOnOutput("signalTriggered"),this._internal.currentIndex!==a&&(this._internal.currentIndex=a,this.flagOutputDirty("index"))}}})},{"../edgetriggeredinput":244,"../nodedefinition":257}],294:[function(a,b,c){"use strict";function d(a,b,c,d){var e=[];c=c?c.split(","):void 0;for(var f in c){var i=c[f];e.push({type:{name:"number",allowConnectionsOnly:!0},plug:"output",group:"Values",name:i})}b=b?b.split(","):void 0;for(var f in b){for(var j in c)e.push({plug:"input",type:"number",group:b[f]+" Values",name:"value-"+b[f]+"-"+c[j],displayName:c[j],editorName:b[f]+"|"+c[j]});e.push({plug:"input",type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"}]},default:"easeOut",displayName:"Easing Curve",group:b[f]+" Transition",name:"transition-"+b[f]}),e.push({plug:"input",type:"number",default:g,displayName:"Duration",group:b[f]+" Transition",name:"duration-"+b[f]}),e.push({plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"To "+b[f],name:"to-"+b[f],group:"Go to state"}),e.push({plug:"output",type:"boolean",displayName:"At "+b[f],name:"at-"+b[f],group:"Current state"}),e.push({plug:"output",type:"boolean",displayName:"Has Reached "+b[f],name:"reached-"+b[f],group:"Current state"})}b&&e.push({plug:"input",type:{name:"enum",enums:b},group:"States",displayName:"Start at",name:"startState",default:b[0]});var k=JSON.stringify(e);h[a]!==k&&(h[a]=k,d.sendDynamicPorts(a,e))}var e=a("../edgetriggeredinput"),f=a("../easecurves"),g=300,h={},i={name:"States",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentValues={},b.stateParameters={},b.startValues={},b.valuesAreInitialised=!1,b.animation=this.context.timerScheduler.createTimer({duration:g,ease:f.easeOut,onStart:function(){},onRunning:function(c){var d=this.ease(0,1,c),e=b.values,f=b.currentValues,g=b.stateParameters,h="value-"+b.state+"-",i=b.startValues;for(var j in e){var k=e[j];f[k]=i[k]*(1-d)+(g[h+k]||0)*d,a.flagOutputDirty(k)}},onFinish:function(){var c="reached-"+b.state;a.hasOutput(c)&&a.sendSignalOnOutput(c)}})},inputs:{states:{type:{name:"stringlist",allowEditOnly:!0},displayName:"States",group:"States",set:function(a){this._internal.states=a.split(",");var b=this;this.scheduleAfterInputsHaveUpdated(function(){b._internal.scheduledToGoToState||b.goToState(b._internal.states[0])})}},values:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Values",group:"Values",set:function(a){var b=this._internal;b.values=a.split(",");for(var c in b.values)this.registerOutputIfNeeded(b.values[c])}},toggle:{group:"Go to state",displayName:"Toggle",valueChangedToTrue:function(){var a=this._internal,b=this;if(a.states){var c=a.states.indexOf(a.state),d=(c+1)%a.states.length;this._internal.scheduledToGoToState=a.states[d],this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a.states[d])})}}},currentState:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Current State",group:"Go to state",set:function(a){var b=this,c=this._internal;c.states&&c.states.indexOf(a)!==-1&&(c.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)}))}}},outputs:{currentState:{type:"string",displayName:"Current State",group:"Current State",getter:function(){return this._internal.state}},stateChanged:{type:"signal",displayName:"State Changed",group:"Current State"}},prototypeExtensions:{registerOutputIfNeeded:function(a){var b=this._internal;this.hasOutput(a)||this.registerOutput(a,{getter:function(){return b.currentValues[a]}})},registerInputIfNeeded:function(a){var b=this,c=this._internal;if(!this.hasInput(a))if(0===a.indexOf("to-")){var d=a.substring(3);this.registerInput(a,{set:e.createSetter({valueChangedToTrue:function(){this._internal.scheduledToGoToState=d,this.scheduleAfterInputsHaveUpdated(function(){
b.goToState(d)})}})})}else if("startState"===a)this.registerInput(a,{set:function(a){this._internal.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)})}});else if(0===a.indexOf("value-")){var f=a.split("-"),d=f[1],g=f[2];this.registerInput(a,{set:function(e){c.stateParameters[a]=e,c.state===d&&(c.currentValues[g]=e,b.flagOutputDirty(g))}})}else if(0===a.indexOf("duration-")){var d=a.substring(9);this.registerInput(a,{set:function(b){c.stateParameters[a]=b}})}else if(0===a.indexOf("transition-")){var d=a.substring(11);this.registerInput(a,{set:function(b){c.stateParameters[a]=b}})}},jumpToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a)){b.animation.stop();var c="value-"+a+"-";for(var d in b.values){var e=b.values[d];b.currentValues[e]=b.stateParameters[c+e]||0,this.flagOutputDirty(e)}b.valuesAreInitialised=!0,b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}},goToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a))if(this._internal.scheduledToGoToState=void 0,b.valuesAreInitialised){for(var c in b.values){var d=b.values[c];b.startValues[d]=b.currentValues[d]}b.animation.ease=f[b.stateParameters["transition-"+a]||"easeOut"];var e="duration-"+a;b.animation.duration=b.stateParameters.hasOwnProperty(e)?b.stateParameters[e]:g,b.animation.start(),b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}else this.jumpToState(a)},updateAtStatePorts:function(){var a=this._internal,b=a.states;for(var c in b){var d=b[c],e="at-"+d;a.currentValues[e]=a.state===d,this.hasOutput(e)&&this.flagOutputDirty(e)}}}};b.exports={node:i,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.States",function(b){b.parameters.states&&d(b.id,b.parameters.states,b.parameters.values,a.editorConnection),b.on("parameterUpdated",function(c){"states"!==c.name&&"values"!==c.name||d(b.id,b.parameters.states,b.parameters.values,a.editorConnection)})})}}},{"../easecurves":243,"../edgetriggeredinput":244}],295:[function(a,b,c){"use strict";function d(a,b){this._internal.inputValues[a]=b,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}function e(a,b,c){var d=b.match(/\{[A-Za-z0-9_]*\}/g),e=[];for(var f in d){var g=d[f],h=g.replace("{","").replace("}","");e.push({name:h,type:"*",plug:"input"})}c.sendDynamicPorts(a,e)}var f={name:"String Format",category:"String Manipulation",initialize:function(){var a=this._internal;a.format="",a.cachedResult="",a.resultDirty=!1,a.inputValues={}},inputs:{format:{type:{name:"string",multiline:!0},displayName:"Format",set:function(a){this._internal.format=a,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}}},outputs:{formatted:{type:"string",displayName:"Formatted",getter:function(){var a=this._internal;if(a.resultDirty){var b=a.format,c=a.format.match(/\{[A-Za-z0-9_]*\}/g),d=[];c&&(d=c.map(function(a){return a.replace("{","").replace("}","")})),d.forEach(function(c){var d=a.inputValues[c];b=b.replace("{"+c+"}",void 0!==d?d:"")}),a.cachedResult=b,a.resultDirty=!1}return a.cachedResult}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})}}};b.exports={node:f,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.String Format",function(b){b.parameters.format&&e(b.id,b.parameters.format,a.editorConnection),b.on("parameterUpdated",function(c){"format"===c.name&&e(b.id,b.parameters.format,a.editorConnection)})})}}},{}],296:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Mapper",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.mappings=[]},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",index:11,createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this.scheduleMapping()}}},output:{name:"numbered/simple-string",displayPrefix:"Mapping",index:12,group:"Mappings",createSetter:function(a){return function(b){b=b.toString(),this._internal.mappings[a]=b,this.scheduleMapping()}}}},inputs:{inputString:{type:{name:"string"},index:1,displayName:"Input String",set:function(a){this._internal.currentInputString=a,this.scheduleMapping()}},defaultMapping:{type:"string",displayName:"Default",index:10,group:"Mappings",set:function(a){this._internal.defaultMapping=a,this.scheduleMapping()}}},outputs:{mappedString:{type:"string",displayName:"Mapped String",group:"Value",getter:function(){return this._internal.mappedString}}},prototypeExtensions:{doMapping:function(){this._internal.hasScheduledFetch=!1;var a=this._internal.inputs.indexOf(this._internal.currentInputString);a!==-1?this._internal.mappedString=this._internal.mappings[a]:this._internal.mappedString=this._internal.defaultMapping,this.flagOutputDirty("mappedString")},scheduleMapping:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this)))}}})},{"../nodedefinition":257}],297:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Selector",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.currentSelectedIndex=0,this._internal.indexChanged=!1},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this._internal.currentSelectedIndex===a&&this.flagOutputDirty("currentValue")}}}},inputs:{index:{type:{name:"number"},displayName:"Index",default:0,set:function(a){a=0|a,this._internal.currentSelectedIndex=a,this.flagOutputDirty("currentValue"),this.sendSignalOnOutput("indexChanged")}}},outputs:{currentValue:{type:"string",displayName:"Current Value",group:"Value",getter:function(){return this._internal.inputs[this._internal.currentSelectedIndex]}},indexChanged:{type:"signal",displayName:"Index Changed",group:"Signals"}}})},{"../nodedefinition":257}],298:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Substring",category:"String Manipulation",initialize:function(){var a=this._internal;a.startIndex=0,a.endIndex=-1,a.cachedResult="",a.inputString="",a.resultDirty=!1},inputs:{start:{type:"number",displayName:"Start",default:0,set:function(a){this._internal.startIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},end:{type:"number",displayName:"End",default:0,set:function(a){this._internal.endIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},string:{type:{name:"string"},displayName:"String",default:"",set:function(a){a=a.toString(),this._internal.inputString=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}}},outputs:{result:{type:"string",displayName:"Result",getter:function(){var a=this._internal;return a.resultDirty&&(a.endIndex===-1?a.cachedResult=a.inputString.substr(a.startIndex):a.cachedResult=a.inputString.substr(a.startIndex,a.endIndex-a.startIndex),a.resultDirty=!1),a.cachedResult}}}})},{"../nodedefinition":257}],299:[function(a,b,c){"use strict";var d={name:"Switch",category:"Logic",initialize:function(){this._internal.state=!1,this._internal.initialized=!1},inputs:{on:{displayName:"On",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!0&&(this._internal.state=!0,this.flagOutputDirty("state"),this.emitSignals())}},off:{displayName:"Off",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!1&&(this._internal.state=!1,this.flagOutputDirty("state"),this.emitSignals())}},flip:{displayName:"Flip",group:"Change State",valueChangedToTrue:function(){this._internal.state=!this._internal.state,this.flagOutputDirty("state"),this.emitSignals()}},onFromStart:{type:"boolean",displayName:"Start State",group:"Start State",default:!1,set:function(a){a&&!this._internal.initialized&&(this._internal.state=!0,this.flagOutputDirty("state"),this._internal.initialized=!0,this.emitSignals())}}},outputs:{state:{type:"boolean",displayName:"Current State",getter:function(){return this._internal.state}},switchedToOn:{displayName:"Switched To On",type:"signal",group:"Signals"},switchedToOff:{displayName:"Switched To Off",type:"signal",group:"Signals"}},prototypeExtensions:{emitSignals:function(){this._internal.state===!0?this.sendSignalOnOutput("switchedToOn"):this.sendSignalOnOutput("switchedToOff")}}};b.exports={node:d}},{}],300:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Timer",category:"Utilities",initialize:function(){var a=this;this._internal._animation=this.context.timerScheduler.createTimer({duration:0,onStart:function(){a.sendSignalOnOutput("timerStarted")},onFinish:function(){a.sendSignalOnOutput("timerFinished")}})},inputs:{start:{displayName:"Start",valueChangedToTrue:function(){this._internal._animation._isRunning===!1&&this._internal._animation.start()}},restart:{displayName:"Restart",valueChangedToTrue:function(){this._internal._animation.start()}},duration:{type:"number",displayName:"Duration",default:0,set:function(a){this._internal._animation.duration=a}},startDelay:{type:"number",displayName:"Start Delay",default:0,set:function(a){this._internal._animation.delay=a}},stop:{displayName:"Stop",valueChangedToTrue:function(){this._internal._animation.stop()}}},outputs:{timerStarted:{type:"signal",displayName:"Started"},timerFinished:{type:"signal",displayName:"Finished"}}})},{"../nodedefinition":257}],301:[function(a,b,c){"use strict";var d=a("../node"),e={name:"Touch Position",category:"Interaction",initialize:function(){this._internal.x=0,this._internal.y=0,this.context.uiEngine.on("touchEvent",this.onTouchEvent.bind(this),this)},outputs:{x:{type:"number",displayName:"Position X",getter:function(){return this._internal.x}},y:{type:"number",displayName:"Position Y",getter:function(){return this._internal.y}}},prototypeExtensions:{_onNodeDeleted:function(){d.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this)},onTouchEvent:function(a){this._internal.x!==a.x&&(this._internal.x=a.x,this.flagOutputDirty("x")),this._internal.y!==a.y&&(this._internal.y=a.y,this.flagOutputDirty("y"))}}};b.exports={node:e}},{"../node":255}],302:[function(a,b,c){"use strict";function d(a){var b=this._internal._animation;b.stop(),b.startValue=a,this.scheduleAfterInputsHaveUpdated(function(){b.endValue!==a&&b.start()}),this._internal.currentNumber=a,this.flagOutputDirty("currentValue")}var e=a("../nodedefinition"),f=a("../easecurves"),g=300,h={name:"Transition",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentNumber=0,b.numberInitialized=!1,b.animationStarted=!1,b.setCurrentNumberEnabled=!1,b.overrideValue=0,b._animation=this.context.timerScheduler.createTimer({duration:g,startValue:0,endValue:0,ease:f.easeOut,onStart:function(){b.animationStarted=!0},onRunning:function(c){b.currentNumber=this.ease(this.startValue,this.endValue,c),a.flagOutputDirty("currentValue")},onFinish:function(){a.sendSignalOnOutput("atTargetValue")}})},inputs:{targetValue:{type:{name:"number"},displayName:"Value",group:"Target Value",default:void 0,set:function(a){if(a===!0?a=1:a===!1&&(a=0),a=Number(a),!isNaN(a)){var b=this._internal;return b.numberInitialized===!1?(b.currentNumber=a,b.numberInitialized=!0,b._animation.endValue=a,void this.flagOutputDirty("currentValue")):void(a!==b._animation.endValue&&(b._animation.startValue=b.currentNumber,b._animation.endValue=a,b._animation.start()))}}},"overrideCurrentValue.value":{type:{name:"number"},group:"Override Value",displayName:"Value",editorName:"Value|Override Value",set:function(a){this._internal.overrideValue=a}},"overrideCurrentValue.do":{group:"Override Value",displayName:"Do",editorName:"Do|Override Value",valueChangedToTrue:function(){d.call(this,this._internal.overrideValue)}},duration:{type:"number",group:"Parameters",displayName:"Duration",default:g,set:function(a){this._internal._animation.duration=a}},delay:{type:"number",group:"Parameters",displayName:"Delay",default:0,set:function(a){this._internal._animation.delay=a}},easingCurve:{type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"}]},default:"easeOut",displayName:"Easing Curve",group:"Parameters",set:function(a){this._internal._animation.ease=f[a]}}},outputs:{currentValue:{type:"number",displayName:"Current Value",group:"Current State",getter:function(){return this._internal.currentNumber}},atTargetValue:{type:"signal",displayName:"At Target Value",group:"Signals"}}};b.exports=e.defineNode(h)},{"../easecurves":243,"../nodedefinition":257}],303:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Value Changed",category:"Logic",initialize:function(){this._internal.lastValue=void 0},inputs:{value:{type:"*",displayName:"Input",set:function(a){this._internal.lastValue!==a&&(this.sendSignalOnOutput("valueChanged"),this._internal.lastValue=a)}}},outputs:{valueChanged:{type:"signal",displayName:"Value Changed"}}})},{"../nodedefinition":257}],304:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Boolean",startValue:!1,type:{name:"boolean"},cast:function(a){return Boolean(a)}});b.exports={node:e}},{"./variablebase":308}],305:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition");b.exports=e.defineNode(d.createDefinition({name:"Color",startValue:"#f1f2f4",type:{name:"color"},cast:function(a){return a}}))},{"../../nodedefinition":257,"./variablebase":308}],306:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Number",startValue:0,type:{name:"number"},cast:function(a){return Number(a)}});b.exports={node:e}},{"./variablebase":308}],307:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"String",startValue:"",type:{name:"string"},cast:function(a){return a.toString()}});e.extend(f,{outputs:{length:{type:"number",displayName:"Length",getter:function(){return this._internal.currentValue.length}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":257,"./variablebase":308}],308:[function(a,b,c){"use strict";function d(a){return{name:a.name,category:"Variables",initialize:function(){this._internal.currentValue=a.startValue,this._internal.latestValue=0},inputs:{value:{type:a.type,displayName:"Value",default:a.startValue,set:function(a){this.isInputConnected("saveValue")===!1?this.setValueTo(a):this._internal.latestValue=a}},saveValue:{displayName:"Save Value",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){this.setValueTo(this._internal.latestValue)})}}},outputs:{savedValue:{type:a.type.name,displayName:"Saved Value",getter:function(){return this._internal.currentValue}}},prototypeExtensions:{setValueTo:function(b){b=a.cast(b),this._internal.currentValue=b,this.flagAllOutputsDirty()}}}}b.exports={createDefinition:d}},{}],309:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Velocity",category:"Math",initialize:function(){var a=this._internal;a.oldValue=0,a.sampledAtTime=0,a.velocity=0},inputs:{value:{type:"number",displayName:"Value",set:function(a){var b=this._internal;if(0===b.sampledAtTime)return b.oldValue=a,void(b.sampledAtTime=this.context.currentFrameTime);if(this.context.currentFrameTime!==b.sampledAtTime){var c=this.context.currentFrameTime-b.sampledAtTime;b.velocity=(a-b.oldValue)/c,b.sampledAtTime=this.context.currentFrameTime,b.oldValue=a,this.flagOutputDirty("velocity")}}}},outputs:{velocity:{type:"number",displayName:"Velocity",getter:function(){return this._internal.velocity}}}})},{"../nodedefinition":257}],310:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f0f0f0",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"px",defaultWidth:200,defaultHeight:200,defaultColor:f,createControl:function(a){var b=a.createCircleControl();return b.setWidth(200),b.setColor(f),b}});delete g.inputs.height,g.inputs.width.displayName="Size",g.inputs.width.type.units=["px"],e.extend(g,{name:"Circle",inputs:{solid:{index:3004,type:"boolean",displayName:"Solid",group:"Appearance",default:!0,set:function(a){this._internal.uiControl.setSolid(!!a)}},lineWidth:{index:3005,type:"number",displayName:"Line Width",group:"Appearance",default:1,set:function(a){this._internal.uiControl.setLineWidth(a)}},blur:{index:3006,displayName:"Blur Length",group:"Appearance",type:"number",default:0,set:function(a){this._internal.uiControl.setBlur(a)}},arcAngle:{index:3007,displayName:"Arc Angle",group:"Appearance",type:"number",default:360,set:function(a){this._internal.uiControl.setArcAngle(a*Math.PI/180)}},image:{index:3500,displayName:"Image Path",group:"Image Properties",type:{name:"image"},set:function(a){"string"==typeof a&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),this._internal.uiControl.setImagePath(a)}}}}),b.exports={node:g}},{"../../nodedefinition":257,"./renderable":318}],311:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Flow Layout",hasOrientation:!0,createControl:function(a){return a.createFlowLayoutControl()}});e.extend(f,{inputs:{verticalItemSpacing:{index:2501,group:"Layout",displayName:"V. Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setVerticalItemSpacing(Number(a))}},horizontalItemSpacing:{index:2502,group:"Layout",displayName:"H. Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setHorizontalItemSpacing(Number(a))}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":257,"./layoutbase":314}],312:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=d.createDefinition({name:"Group",createControl:function(a){return a.createDockLayoutControl()},version:2});b.exports={node:e}},{"./layoutbase":314}],313:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=d.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultColor:"#ffffff",createControl:function(a){return a.createImageControl()}});e.extend(f,{name:"Image",version:2,usePortAsLabel:"image",portLabelTruncationMode:"filename",inputs:{image:{index:2500,type:{name:"image"},displayName:"Image Path",group:"Image Properties",set:function(a){return a?("string"==typeof a&&0!==a.lastIndexOf("data:",0)&&0!==a.lastIndexOf("http:",0)&&0!==a.lastIndexOf("https:",0)&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),void this._internal.uiControl.setImagePath(a)):void this._internal.uiControl.setImagePath(null)}},cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance",default:0,set:function(a){}},fillMode:{index:2501,type:{name:"enum",enums:[{value:"original",label:"Original"},{value:"aspectFill",label:"Aspect Fill"},{value:"aspectFit",label:"Aspect Fit"},{value:"fill",label:"Fill"}],allowEditOnly:!0},displayName:"Fill Mode",group:"Image Properties",default:"original",set:function(a){this._internal.uiControl.setFillMode(a)}},clipImage:{index:2502,type:"boolean",displayName:"Clip Image",default:!0,group:"Image Properties",set:function(a){this._internal.uiControl.setClip(!!a)}}}});var g=[{inputName:"cropStartX",index:0,default:0,displayName:"Crop Start X"},{inputName:"cropEndX",index:2,default:1,displayName:"Crop End X"},{inputName:"cropStartY",index:1,default:0,displayName:"Crop Start Y"},{inputName:"cropEndY",index:3,default:1,displayName:"Crop End Y"}],h={};g.forEach(function(a){var b=a.index;h[a.inputName]={index:2503+b,type:"number",group:"Image Properties",default:a.default,displayName:a.displayName,set:function(a){this._internal.innerControl._srcRect[b]=a,this._internal.innerControl.contentDirty=!0}}}),e.extend(f,h),b.exports=e.defineNode(f)},{"../../nodedefinition":257,"./renderable":318}],314:[function(a,b,c){"use strict";function d(a){var b=e.createDefinition({createControl:a.createControl,sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});return f.extend(b,{name:a.name,version:a.version,initialize:function(){var a=this._internal;a.children=[]},allowChildren:!0,inputs:{clip:{group:"Appearance",displayName:"Clip",type:"boolean",index:3100,default:!1,set:function(a){this._internal.uiControl.setClip(a)}},padding:{group:"Padding",displayName:"Padding",type:"number",index:2800,default:0,set:function(a){var b=this._internal.uiControl;b.setPaddingTop(a),b.setPaddingLeft(a),b.setPaddingBottom(a),b.setPaddingRight(a)}},paddingLeft:{group:"Padding",displayName:"Pad Left",type:"number",index:2801,set:function(a){this._internal.uiControl.setPaddingLeft(a)}},paddingRight:{group:"Padding",displayName:"Pad Right",type:"number",index:2802,set:function(a){this._internal.uiControl.setPaddingRight(a)}},paddingTop:{group:"Padding",displayName:"Pad Top",type:"number",index:2803,set:function(a){this._internal.uiControl.setPaddingTop(a)}},paddingBottom:{group:"Padding",displayName:"Pad Bottom",type:"number",index:2804,set:function(a){this._internal.uiControl.setPaddingBottom(a)}}},outputs:{childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}},prototypeExtensions:{addChild:{value:function(a,b){if(!a.getVisualRoot)throw new Error("child must have a visual root");var c=this._internal.uiControl,d=this._internal.children;void 0===b&&(b=d.length),b=Math.max(0,b),c.addChild(a.getVisualRoot()._internal.uiControl,b),b===d.length?d.push(a):d.splice(b,0,a),this.flagOutputDirty("childCount");for(var e=b;e<d.length;e++)d[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=this,a.getVisualRoot()._internal.visualParent=this}},getChildren:{value:function(){return g.clone(this._internal.children)}},removeChild:{value:function(a){if(!a.getVisualRoot)throw new Error("child must be a visual node");var b=this._internal.children,c=b.indexOf(a);if(c===-1)throw new Error("child is not a child of this node");if(a.getVisualRoot()){var d=a.getVisualRoot()._internal.uiControl;d.parent&&d.parent.removeChild(d)}b.splice(c,1),this.flagOutputDirty("childCount");for(var e=c;e<b.length;e++)b[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=void 0,a.getVisualRoot()&&(a.getVisualRoot()._internal.visualParent=void 0)}},getChildRoot:{value:function(){return this}}}}),a.hasOrientation&&f.extend(b,{initialize:function(){this._internal.uiControl.setOrientation("vertical")},inputs:{orientation:{index:2500,group:"Layout",displayName:"Orientation",type:{name:"enum",enums:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]},default:"vertical",set:function(a){this._internal.uiControl.setOrientation(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition"),g=a("lodash");b.exports={createDefinition:d}},{"../../nodedefinition":257,"./visualbase":323,lodash:145}],315:[function(a,b,c){"use strict";function d(a,b){var c=a.getLayoutRect().width;void 0===c&&(c=0);var d=.3*-c;b<=0?a.setPositionX(g.easeInOut(d,0,1+b)):a.setPositionX(g.easeInOut(0,c,b))}var e=a("./layoutbase"),f=a("../../nodedefinition"),g=a("../../easecurves"),h=e.createDefinition({name:"Page",createControl:function(a){return a.createDockLayoutControl()}});f.extend(h,{initialize:function(){this._internal.title="",this._internal.transition="default",this._internal.transitionPosition=0,this._internal.transitionDuration=350,this._internal.customTransitionDuration=350},dynamicports:[{name:"conditionalports/basic",condition:"transition = custom",ports:[{name:"customTransitionDuration",plug:"input",type:"number",displayName:"Transition Duration",group:"Page",default:350}]}],inputs:{title:{type:"string",displayName:"Title",group:"Page",set:function(a){this._internal.title=a}},transition:{displayName:"Transition",group:"Page",default:"default",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"default",label:"Default"},{value:"custom",label:"Custom"}]},set:function(a){var b=this._internal;b.transition=a}},customTransitionDuration:{set:function(a){this._internal.customTransitionDuration=a}}},outputs:{transitionPosition:{index:0,type:"number",displayName:"Transition Position",group:"Page",getter:function(){return this._internal.transitionPosition}},pageShowing:{type:"signal",displayName:"Page Showing",group:"Page Signals"},pageHiding:{type:"signal",displayName:"Page Hiding",group:"Page Signals"},pageShown:{type:"signal",displayName:"Page Shown",group:"Page Signals"},pageHidden:{type:"signal",displayName:"Page Hidden",group:"Page Signals"}},prototypeExtensions:{setPagesNode:function(a){this._internal.pagesNode=a},setTransitionPosition:function(a){var b=this._internal;"default"===b.transition&&d(this,a),b.transitionPosition=a,this.flagOutputDirty("transitionPosition")},getAnimationDuration:function(){switch(this._internal.transition){case"none":return 0;case"default":case"ios":return 350;case"custom":return this._internal.customTransitionDuration}return 0},getAnimationPosition:function(){return this._internal.transitionPosition},sendPageShowingSignal:function(){this.sendSignalOnOutput("pageShowing")},sendPageHidingSignal:function(){this.sendSignalOnOutput("pageHiding")},sendPageShownSignal:function(){this.sendSignalOnOutput("pageShown")},sendPageHiddenSignal:function(){this.sendSignalOnOutput("pageHidden")},getTitle:function(){return this._internal.title}}}),b.exports=f.defineNode(h)},{"../../easecurves":243,"../../nodedefinition":257,"./layoutbase":314}],316:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=a("../../guid"),g=a("../../easecurves"),h=a("lodash"),i=a("../../node"),j=d.createDefinition({name:"Pages",createControl:function(a){return a.createDockLayoutControl()}});e.extend(j,{initialize:function(){this._internal.pageStack=[],this._internal.isNavigating=!1,this._internal.portUpdateScheduled=!1},inputs:{startPage:{type:"component",displayName:"Start Page",group:"Navigation",set:function(a){if(this._cleanup(),a){var b=this._createPage(a);this.startPageComponent=b;var c=this._internal,d=this.context.getComponentModel(a);c.startPageComponentModel=d,this.updateStartPagePorts(d),d.on("inputPortAdded",this.scheduleUpdateStartPagePorts.bind(this,d),this),d.on("inputPortRemoved",this.scheduleUpdateStartPagePorts.bind(this,d),this),c.pageStack.push(b),this.addPageAtIndex(b,0),b.getVisualRoot().sendPageShowingSignal()}}},back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){this.back()}}},outputs:{currentPageTitle:{type:"string",displayName:"Current Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return a[a.length-1].getVisualRoot().getTitle()}},prevPageTitle:{type:"string",displayName:"Previous Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return 1===a.length?"":a[a.length-2].getVisualRoot().getTitle()}},hasPreviousPage:{type:"boolean",displayName:"Has Previous Page",group:"Pages",getter:function(){return this._internal.pageStack.length>1}}},prototypeExtensions:{_cleanup:function(){var a=this._internal;a.startPageComponentModel&&(a.startPageComponentModel.removeListenersWithRef(this),a.startPageComponentModel=void 0);var b=this;this.getChildren().forEach(function(a){b.removeChild(a),b.nodeScope.deleteNode(a)}),a.pageStack.forEach(function(a){a._onNodeDeleted()}),this.startPageComponent=void 0,a.pageStack=[]},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._cleanup()},addPageAtIndex:function(a,b){this.addChild(a,b),this.flagOutputDirty("currentPageTitle"),this.flagOutputDirty("prevPageTitle")},navigateTo:function(a,b){if(!this._internal.isNavigating){var c=this._internal,d=c.pageStack,e=d[d.length-1],f=this._createPage(a,b),g=f.getVisualRoot();d.push(f),this.addPageAtIndex(f),this.context.layout(),g.setTransitionPosition(1),f.update();var h=this;this.context.scheduleNextFrame(function(){h._animationPageAnimationPositionTo(f,0),h._animationPageAnimationPositionTo(e,-1)}),d.length>1&&this.flagOutputDirty("hasPreviousPage")}},back:function(){var a=this._internal.pageStack;if(1!==a.length&&!this._internal.isNavigating){var b=a.pop();1===a.length&&this.flagOutputDirty("hasPreviousPage");var c=a[a.length-1];c.getVisualRoot()._internal.visualParent||this.addPageAtIndex(c,this._internal.children.indexOf(b)-1),this._animationPageAnimationPositionTo(c,0),this._animationPageAnimationPositionTo(b,1)}},_animationPageAnimationPositionTo:function(a,b){var c=a.getVisualRoot(),d=c.getAnimationPosition();if(d!==b){0===b?c.sendPageShowingSignal():c.sendPageHidingSignal(),this._internal.isNavigating=!0;var e=this,f=this.context.timerScheduler.createTimer({duration:c.getAnimationDuration(),onRunning:function(a){c.setTransitionPosition(g.linear(d,b,a))},onFinish:function(){b===-1||1===b?(c.sendPageHiddenSignal(),e.removeChild(a),1===b&&e.context.scheduleNextFrame(function(){e.nodeScope.deleteNode(a)})):0===b&&c.sendPageShownSignal(),e._internal.isNavigating=!1}});f.start()}},_createPage:function(a,b){var c=this.nodeScope.createNode(a,f());c.getVisualRoot().setPagesNode(this);for(var d in b)c.queueInput(d,b[d]);return c},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.startPageComponent?this.startPageComponent.setInputValue(a,b):this.scheduleAfterInputsHaveUpdated(function(){this.startPageComponent.hasInput(a)&&this.startPageComponent.setInputValue(a,b)})}})},scheduleUpdateStartPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateStartPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateStartPagePorts:function(a){var b=h.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Start Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}}),b.exports=e.defineNode(j)},{"../../easecurves":243,"../../guid":249,"../../node":255,"../../nodedefinition":257,"./layoutbase":314,lodash:145}],317:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f1f2f4",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,defaultColor:f,createControl:function(a){var b=a.createRectangleControl();return b.setColor(f),b}});e.extend(g,{name:"Rectangle",inputs:{cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance",default:0,set:function(a){this._internal.uiControl.setCornerRadius(a)}},blur:{index:3005,type:"number",displayName:"Blur Length",group:"Appearance",default:0,set:function(a){this._internal.uiControl.setBlur(a)}}}}),b.exports=e.defineNode(g)},{"../../nodedefinition":257,"./renderable":318}],318:[function(a,b,c){"use strict";function d(a){if(!a.defaultColor)throw new Error("No default color specified");var b=e.createDefinition(a),c=[{value:"alpha",label:"Alpha"},{value:"solid",label:"Solid"},{value:"additive",label:"Additive"},{value:"multiply",label:"Multiply"}];return f.extend(b,{inputs:{blendMode:{index:3003,type:{name:"enum",enums:c},default:"alpha",displayName:"Blend Mode",group:"Appearance",set:function(a){this._internal.uiControl.setBlendMode(a);
}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance",default:a.defaultColor,set:function(a){this._internal.uiControl.setColor(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition");b.exports={createDefinition:d}},{"../../nodedefinition":257,"./visualbase":323}],319:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this.noodlNode,c=b._internal;if(c.scrollEnabled===!1||c.uiControl.touchPropagation===!1)return c.isTracking&&(c.isTracking=!1,b.sendSignalOnOutput("dragEnded")),void(c.hasReceivedEnter=!1);var d,e=c.uiControl.scroller,f=c.uiControl.scrollOffset;if(a.isEnter&&(c.hasReceivedEnter=!0),a.isExit)c.isTracking===!0?(b.sendSignalOnOutput("dragEnded"),c.isTracking=!1,b.context.scheduleAfterUpdate(function(){e.onTouch(f,a)})):e.onTouch(f,a),c.hasReceivedEnter=!1;else{if(c.hasReceivedEnter===!1){c.hasReceivedEnter=!0;var g={};for(var h in a)g[h]=a[h];g.type="isEnter",g.isEnter=!0,g.isDown=g.isUp=g.isMove=!1,c.uiControl.onTouch(g)}d=e.onTouch(f,a),"StartTracking"===d&&c.isTracking===!1&&(c.isTracking=!0,b.sendSignalOnOutput("dragStarted"))}return d}function f(a){var b=this._internal.children;if(b.length<=1)return 0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=0,e=this._internal.uiControl.getItemSpacing(),f=0,g=b.length;f<g;++f){var h=b[f].getVisualRoot().getLayoutRect(),i=h[c];if(Math.floor(d+i)>a)return f;d+=i+e}return console.error("Invalid position",a),b.length-1}function g(a){var b=this._internal.children;if(a<0||a>=b.length)return console.error("ScrollView: Invalid item index",index),0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.uiControl.getItemSpacing(),e=0,f=0;f<a;f++)e+=b[f].getVisualRoot().getLayoutRect()[c]+d;return e}function h(a){return a=d(0,this._internal.children.length-1,a),g.call(this,a)}function i(a){var b=this._internal;a!==b.currentIndex&&(b.currentIndex=a,this.flagOutputDirty("index"),this.sendSignalOnOutput("indexChanged"))}function j(a,b){var c=this;this.context.timerScheduler.createTimer({duration:b,startPosition:l.call(this),endPosition:-a,onRunning:function(a){c._internal.uiControl.setScrollOffset(q.easeOut(this.startPosition,this.endPosition,a))}}).start()}function k(a,b){return b}function l(){return this._internal.uiControl.scrollOffset}function m(a,b){var c=f.call(this,-l.call(this)),e=0;return e=a<0?c+1:c,e=d(0,this._internal.children.length-1,e),-h.call(this,e)}function n(a,b){var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.children,e=this._internal.uiControl.getItemSpacing();if(1===d.length)return a<0?-d[0].getVisualRoot().getLayoutRect()[c]:0;for(var f=0,g=0,h=Number.MAX_VALUE,i=0,j=0;j<d.length-1;++j){var k=d[j].getVisualRoot().getLayoutRect()[c],m=f+k+e,n=Math.abs(f+b),o=Math.abs(m+b);if(n<h&&(h=n,i=f),o<h&&(h=o,i=m),o>n){var p=l.call(this);return a<0&&-f>p?-m:a>0&&-f<p?-g:-f}g=f,f+=k+e}return-f}var o=a("./layoutbase"),p=a("../../nodedefinition"),q=a("../../easecurves"),r=500,s=o.createDefinition({name:"Scroll View",createControl:function(a){return a.createScrollViewControl()},hasItemSpacing:!0});p.extend(s,{initialize:function(){var a=this._internal;a.scrollEnabled=!0,a.isTracking=!1,a.currentIndex=0,a.hasReceivedEnter=!1,a.scrollToPositionValue=0,a.scrollDuration=r,a.scrollToPositionDuration=r,a.scrollToIndexDuration=r,a.scrollToIndexValue=0,a.uiControl.scrollEndedPositionCallback=function(a,b){return b};var b=this;this._internal.uiControl.on("scrollOffsetChanged",function(a){b.flagOutputDirty("scrollPosition");var c=f.call(b,-a),d=b._internal.children[c].getVisualRoot().getLayoutRect(),e="horizontal"===b._internal.uiControl.orientation?"width":"height",g=-a+.5*d[e];i.call(b,f.call(b,g))}),this.addTouchHandler(e,b)},inputs:{itemSpacing:{index:2400,group:"Layout",displayName:"Item Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}},clip:{index:3100,type:"boolean",group:"Appearance",displayName:"Clip",default:!1,set:function(a){this._internal.uiControl.setClip(!!a)}},scrollDuration:{index:2500,type:"number",displayName:"Scroll Duration",group:"Scroll Behavior",default:r,set:function(a){this._internal.scrollDuration=a,this._internal.scroller&&(this._internal.scroller.scrollEndedAnimationDuration=a)}},snap:{index:2501,type:{name:"enum",enums:[{value:"disabled",label:"Disabled"},{value:"item",label:"Item"},{value:"everyItem",label:"Every Item"}]},displayName:"Snap",group:"Scroll Behavior",default:"disabled",set:function(a){"disabled"===a?this._internal.uiControl.scrollEndedPositionCallback=k.bind(this):"everyItem"===a?this._internal.uiControl.scrollEndedPositionCallback=m.bind(this):"item"===a?this._internal.uiControl.scrollEndedPositionCallback=n.bind(this):console.error("Unknown snap value: "+a)}},scrollAxis:{index:2502,type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},displayName:"Scroll Direction",group:"Scroll Behavior",default:"1",set:function(a){this._internal.uiControl.setOrientation(Number(a)?"vertical":"horizontal")}},scrollStartPosition:{index:2503,type:"number",displayName:"Start Position",group:"Scroll Behavior",default:0,set:function(a){this._internal.uiControl.setScrollOffset(Number(a))}},scrollEnabled:{index:2504,type:"boolean",displayName:"Scroll Enabled",group:"Scroll Behavior",default:!0,set:function(a){this._internal.scrollEnabled=!!a}},overscrollEnabled:{index:2505,type:"boolean",displayName:"Overscroll Enabled",group:"Scroll Behavior",default:!0,set:function(a){var b=!!a;this._internal.uiControl.setOverscrollEnabled(b)}},"scrollToPosition.value":{index:6e3,type:"number",displayName:"Position",editorName:"Position|Scroll To Position",group:"Scroll To Position",default:0,set:function(a){this._internal.scrollToPositionValue=a}},"scrollToPosition.do":{index:6001,group:"Scroll To Position",editorName:"Do|Scroll To Position",displayName:"Do",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){j.call(this,this._internal.scrollToPositionValue,this._internal.scrollToPositionDuration)})}},"scrollToPosition.duration":{index:6002,group:"Scroll To Position",displayName:"Duration",editorName:"Duration|Scroll To Position",type:"number",default:r,set:function(a){this._internal.scrollToPositionDuration=a}},"scrollToIndex.value":{index:6003,group:"Scroll To Index",editorName:"Index|Scroll To Index",displayName:"Index",type:"number",default:0,set:function(a){this._internal.scrollToIndexValue=Math.floor(a)}},"scrollToIndex.do":{index:6004,group:"Scroll To Index",editorName:"Do|Scroll To Index",displayName:"Do",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){if(a._internal.children.length>0){var b=h.call(this,this._internal.scrollToIndexValue);j.call(this,b,this._internal.scrollToIndexDuration)}})}},"scrollToIndex.duration":{index:6005,type:"number",group:"Scroll To Index",displayName:"Duration",editorName:"Duration|Scroll To Index",default:r,set:function(a){this._internal.scrollToIndexDuration=a}}},outputs:{dragStarted:{type:"signal",displayName:"Drag Started",group:"Signals"},dragEnded:{type:"signal",displayName:"Drag Ended",group:"Signals"},indexChanged:{displayName:"Index Changed",group:"Signals",type:"signal"},scrollPosition:{displayName:"Scroll Position",type:"number",getter:function(){return this._internal.uiControl.scrollOffset}},index:{displayName:"Scroll Index",type:"number",getter:function(){return this._internal.currentIndex}},childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}}}),b.exports=p.defineNode(s)},{"../../easecurves":243,"../../nodedefinition":257,"./layoutbase":314}],320:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Stack Layout",hasOrientation:!0,hasItemSpacing:!0,createControl:function(a){return a.createStackLayoutControl()}});e.extend(f,{inputs:{itemSpacing:{index:2501,group:"Layout",displayName:"Item Spacing",type:"number",default:0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":257,"./layoutbase":314}],321:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=a("../../fontloader"),g="Text",h=d.createDefinition({createControl:function(a){var b=a.createTextControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(g),b},defaultColor:"#ffffff",sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});e.extend(h,{name:"Text",version:2,usePortAsLabel:"text",inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},default:g,set:function(a){this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family",default:"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;f.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size",default:40,set:function(a){this._internal.uiControl.setFontSize(a)}},lineHeight:{index:2503,type:"number",displayName:"Line Height",group:"Text",default:0,set:function(a){this._internal.uiControl.setLineHeight(a)}},alignment:{index:2504,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}],allowEditOnly:!0},displayName:"Horizontal",group:"Text Alignment",default:"left",set:function(a){this._internal.uiControl.setHorizontalAlignment(a)}},verticalAlignment:{index:2505,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}],allowEditOnly:!0},displayName:"Vertical",group:"Text Alignment",default:"top",set:function(a){this._internal.uiControl.setVerticalAlignment(a)}},clipText:{index:2999,type:"boolean",displayName:"Clip Text",default:!0,group:"Appearance",set:function(a){this._internal.uiControl.setClip(!!a)}}}}),b.exports={node:h,setup:function(a,b){b.on("nodeAdded.Text",function(a){a.parameters.fontFamily&&f.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a){"fontFamily"===a.name&&f.instance.loadFont(a.value)})})}}},{"../../fontloader":248,"../../nodedefinition":257,"./renderable":318}],322:[function(a,b,c){"use strict";function d(a){var b=this.noodlNode;if(a.isUp)return b._internal.uiControl.focus(),"StopPropagation"}var e=a("./renderable"),f=a("../../nodedefinition"),g=a("../../fontloader"),h="Text",i=e.createDefinition({controlAttribute:"innerTextControl",createControl:function(a){var b=a.createTextInputControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(h),b},defaultColor:"#ffffff",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});f.extend(i,{name:"Text Input",initialize:function(){this.addTouchHandler(d);var a=this;this._internal.uiControl.on("textChanged",function(){a.flagOutputDirty("text")},this),this._internal.uiControl.on("focused",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this),this._internal.uiControl.on("blurred",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this)},inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},default:h,set:function(a){this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family",default:"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;g.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size",default:40,set:function(a){this._internal.uiControl.setFontSize(a)}},clear:{index:2600,group:"Actions",displayName:"Clear",valueChangedToTrue:function(){this._internal.uiControl.setText("")}},type:{index:3001,group:"Appearance",displayName:"Type",default:"text",type:{name:"enum",enums:[{value:"text",label:"Text"},{value:"textarea",label:"Text Area"},{value:"password",label:"Password"},{value:"email",label:"Email"},{value:"tel",label:"Tel"},{value:"number",label:"Number"}]},set:function(a){this._internal.uiControl.setInputType(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance",default:"#ffffff",set:function(a){this._internal.uiControl.setColor(a)}}},outputs:{text:{index:2500,group:"Text",displayName:"Text",type:"string",getter:function(){return this._internal.uiControl.getText()}},focused:{index:2501,group:"State",displayName:"Focused",type:"boolean",getter:function(){return this._internal.uiControl.isFocused()}},blurred:{index:2502,group:"State",displayName:"Blurred",type:"boolean",getter:function(){return!this._internal.uiControl.isFocused()}}},prototypeExtensions:{setText:function(a){this._internal.uiControl.setText(a)}}}),b.exports={node:i,setup:function(a,b){b.on("nodeAdded.Text Input",function(a){a.parameters.fontFamily&&g.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a,b){"fontFamily"===a&&g.instance.loadFont(b)})})}}},{"../../fontloader":248,"../../nodedefinition":257,"./renderable":318}],323:[function(a,b,c){"use strict";function d(a){if(a=a||{},!a.createControl)throw new Error("createControl can't be undefined");a.sizeEnums=a.sizeEnums||[],a.defaultSizeEnum=a.defaultSizeEnum||"",a.defaultSizeUnit=a.defaultSizeUnit||"px",a.defaultPivotUnit=a.defaultPivotUnit||"%",a.defaultWidth=a.hasOwnProperty("defaultWidth")?a.defaultWidth:0,a.defaultHeight=a.hasOwnProperty("defaultHeight")?a.defaultHeight:0,a.widthCondition=a.widthCondition||"sizeMode = explicit OR sizeMode = childHeight OR sizeMode NOT SET",a.heightCondition=a.heightCondition||"sizeMode = explicit OR sizeMode = childWidth OR sizeMode NOT SET";var b={category:"Visual",initialize:function(){var b=this._internal,c=a.createControl.call(this,this.context.uiEngine);c.onTouch=g,c.onHover=h,c.noodlNode=this,b.uiControl=c,b.touchHandlers=[],b.hoverHandlers=[],b.visualParent=void 0,c.setSizeMode(a.defaultSizeEnum),c.setWidth(a.defaultWidth),c.setHeight(a.defaultHeight),c.setWidthUnit(a.defaultSizeUnit),c.setHeightUnit(a.defaultSizeUnit),c.setPivotXUnit(a.defaultPivotUnit),c.setPivotYUnit(a.defaultPivotUnit),this._internal.tapHandler=this.context.uiEngine.createTapHandler(e),this.addTouchHandler(j,this),this.addHoverHandler(k,this);var d=this;c.on("screenXChanged",function(){d.flagOutputDirty("screenX")}),c.on("screenYChanged",function(){d.flagOutputDirty("screenY")}),c.on("layoutWidthChanged",function(){d.flagOutputDirty("width")}),c.on("layoutHeightChanged",function(){d.flagOutputDirty("height")})},inputs:{x:{type:{name:"number"},group:"Placement",index:2002,displayName:"Position X",default:0,set:function(a){this.setPositionX(a)}},y:{type:{name:"number"},index:2003,group:"Placement",displayName:"Position Y",default:0,set:function(a){this.setPositionY(a)}},z:{type:{name:"number"},index:2004,group:"Placement",displayName:"Position Z",default:0,set:function(a){this._internal.uiControl.setPositionZ(a)}},alignX:{index:2e3,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Placement",displayName:"Align X",default:"left",set:function(a){this._internal.uiControl.setAlignX(a)}},alignY:{index:2001,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Placement",displayName:"Align Y",default:"top",set:function(a){this._internal.uiControl.setAlignY(a)}},width:{index:1001,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Width",group:"Dimensions",default:a.defaultWidth,set:function(a,b){void 0!==a&&this._internal.uiControl.setWidth(a),b&&this._internal.uiControl.setWidthUnit(b)}},height:{index:1002,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Height",group:"Dimensions",default:a.defaultHeight,set:function(a,b){void 0!==a&&this._internal.uiControl.setHeight(a),b&&this._internal.uiControl.setHeightUnit(b)}},opacity:{index:3e3,group:"Appearance",displayName:"Opacity",type:"number",default:1,set:function(a){this._internal.uiControl.setOpacity(a)}},visible:{type:{name:"boolean"},index:3001,displayName:"Visible",group:"Appearance",default:!0,set:function(a){this._internal.uiControl.setVisible(!!a)}},scaleX:{index:5e3,type:"number",group:"Transform",displayName:"Scale X",default:1,set:function(a){this._internal.uiControl.setScaleX(a)}},scaleY:{index:5001,type:"number",group:"Transform",displayName:"Scale Y",default:1,set:function(a){this._internal.uiControl.setScaleY(a)}},rotationX:{index:5002,type:"number",group:"Transform",displayName:"Rotation X",default:0,set:function(a){this._internal.uiControl.setRotationX(Math.PI/180*a)}},rotationY:{index:5003,type:"number",group:"Transform",displayName:"Rotation Y",default:0,set:function(a){this._internal.uiControl.setRotationY(Math.PI/180*a)}},rotationZ:{index:5004,type:"number",group:"Transform",displayName:"Rotation Z",default:0,set:function(a){this._internal.uiControl.setRotationZ(Math.PI/180*a)}},pivotX:{index:5005,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},default:50,group:"Transform",displayName:"Pivot X",set:function(a,b){b&&this._internal.uiControl.setPivotXUnit(b),this._internal.uiControl.setPivotX(a)}},pivotY:{index:5006,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},default:50,group:"Transform",displayName:"Pivot Y",set:function(a,b){b&&this._internal.uiControl.setPivotYUnit(b),this._internal.uiControl.setPivotY(a)}},pivotZ:{index:5007,type:"number",group:"Transform",displayName:"Pivot Z",default:0,set:function(a){this._internal.uiControl.setPivotZ(a)}},touchPropagation:{index:4e3,type:{name:"boolean"},displayName:"Ignore Touch",default:!1,set:function(a){this._internal.uiControl.setTouchPropagation(!a)}},blockTouch:{index:4001,type:{name:"boolean"},displayName:"Block Touch",default:!1,set:function(a){this._internal.uiControl.setBlockTouch(!!a)}},depth:{index:4002,type:{name:"number"},displayName:"Depth",default:0,set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.uiControl.setDepth(a)}}},outputs:{this:{type:"reference",displayName:"This",getter:function(){return this}},childIndex:{type:"number",displayName:"Child Index",getter:function(){var a=this._internal.uiControl.parent;return a?a.children.indexOf(this._internal.uiControl):-1}},width:{displayName:"Width",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.width}},height:{displayName:"Height",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.height}},x:{displayName:"Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionX}},y:{displayName:"Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionY}},screenX:{displayName:"Screen Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenX()}},screenY:{displayName:"Screen Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenY()}}},prototypeExtensions:{addTouchHandler:function(a,b){this._internal.touchHandlers.push({callback:a,id:b})},removeTouchHandlersWithId:function(a){n.remove(this._internal.touchHandlers,function(b){return b.id===a})},addHoverHandler:function(a,b){this._internal.hoverHandlers.push({callback:a,id:b})},removeHoverHandler:function(a){n.remove(this._internal.hoverHandlers,function(b){return b.id===a})},getVisualRoot:function(){return this},_onNodeDeleted:function(){m.prototype._onNodeDeleted.call(this),this._internal.uiControl.dispose()},setPositionX:function(a){this._internal.uiControl.setPositionX(a),this.flagOutputDirty("x")},setPositionY:function(a){this._internal.uiControl.setPositionY(a),this.flagOutputDirty("y")},getLayoutRect:function(){return this._internal.uiControl.layoutRect},setHighlightEnabled:function(a){this._internal.uiControl.setHighlightEnabled(a)}}};return a.sizeEnums.length>0&&f(b,a),i(b),b}function e(a){var b=a.noodlNode;b.sendSignalOnOutput("touch.tap")}function f(a,b){var c={index:1001,name:"width",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Width",group:"Dimensions",default:b.defaultWidth},d={index:1002,name:"height",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Height",group:"Dimensions",default:b.defaultHeight},e={name:"conditionalports/basic",condition:b.widthCondition,ports:[c]},f={name:"conditionalports/basic",condition:b.heightCondition,ports:[d]},g=[e,f];l(a,{dynamicports:g,inputs:{sizeMode:{index:1e3,type:{name:"enum",enums:b.sizeEnums,allowEditOnly:!0},group:"Dimensions",displayName:"Size Mode",default:b.defaultSizeEnum,set:function(a){this._internal.uiControl.setSizeMode(a)}}}})}function g(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.touchHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&("StartTracking"===e?b=e:"StopPropagation"===e&&"StartTracking"!==b&&(b=e))}),c.context.scheduleFrame(),b}function h(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.hoverHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&"StopPropagation"===e&&(b=e)}),c.context.scheduleFrame(),b}function i(a){l(a,{initialize:function(){this._internal.hasSignaledMove=!1,this.context.nodeIsDirty(this)},outputs:{"touch.tap":{group:"Touch",displayName:"Tap",type:"signal"},"touch.press":{type:"signal",group:"Touch",displayName:"Press"},"touch.release":{type:"signal",group:"Touch",displayName:"Release"},"touch.enter":{type:"signal",group:"Touch",displayName:"Enter"},"touch.exit":{type:"signal",group:"Touch",displayName:"Exit"},"touch.move":{type:"signal",group:"Touch",displayName:"Move"},"hover.enter":{type:"signal",group:"Hover",displayName:"Hover Enter"},"hover.move":{type:"signal",group:"Hover",displayName:"Hover Move"},"hover.exit":{type:"signal",group:"Hover",displayName:"Hover Exit"}}})}function j(a){var b=this.noodlNode;if(a.isDown&&(b.sendSignalOnOutput("touch.press"),b._internal.hasSignaledMove=!1),a.isMove?b._internal.hasSignaledMove===!1&&(b._internal.hasSignaledMove=!0,b.sendSignalOnOutput("touch.move")):a.isUp?b.sendSignalOnOutput("touch.release"):a.isEnter?b.sendSignalOnOutput("touch.enter"):a.isExit&&b.sendSignalOnOutput("touch.exit"),b.getOutput("touch.tap").hasConnections())return b._internal.tapHandler.onTouch(this,a)}function k(a){var b=this.noodlNode;a.isHoverEnter&&b.sendSignalOnOutput("hover.enter"),a.isHoverMove?b.sendSignalOnOutput("hover.move"):a.isHoverExit&&b.sendSignalOnOutput("hover.exit")}var l=a("../../nodedefinition").extend,m=a("../../node"),n=a("lodash");b.exports={createDefinition:d}},{"../../node":255,"../../nodedefinition":257,lodash:145}],324:[function(a,b,c){"use strict";function d(a){function b(){console.log("websocket disconnected",a),delete i[a]}if(!i[a]){var c=new WebSocket(a);c.addEventListener("open",function(){console.log("websocket connected",a)}),c.addEventListener("close",b),c.addEventListener("error",b),i[a]=c}return i[a]}function e(a){function b(){e._close(),window.setTimeout(e.connect.bind(e,e.uri),1e3)}function c(){e.eventEmitter.emit("connected"),e.context.eventEmitter.once("applicationDataReloaded",function(){e._close(),e.eventEmitter.removeAllListeners()}),e.socket.addEventListener("message",e._onMessage)}function d(a){var b=JSON.parse(a.data);e.eventEmitter.emit("jsonMessage",b),e.context.update()}this.eventEmitter=new h,this.eventEmitter.setMaxListeners(1e3),this.context=a;var e=this;this._reconnect=b,this._onConnectionOpen=c,this._onMessage=d}function f(a,b){if(a){var c={};for(var d in b)isNaN(Number(b[d]))?c[d]=b[d]:c[d]=Number(b[d]);a.send(JSON.stringify(c))}}var g=a("../nodedefinition"),h=a("events").EventEmitter,i={};e.prototype._close=function(){this.socket&&(this.eventEmitter.emit("disconnected"),this.socket.removeEventListener("close",this.reconnect),this.socket.removeEventListener("error",this.reconnect),this.socket.removeEventListener("open",this._onConnectionOpen),this.socket.removeEventListener("message",this._onMessage),this.socket=void 0)},e.prototype.connect=function(a){this._close(),this.uri=a,this.socket=d(a),this.socket.addEventListener("close",this._reconnect),this.socket.addEventListener("error",this._reconnect),this.socket.readyState===WebSocket.OPEN?this._onConnectionOpen():this.socket.addEventListener("open",this._onConnectionOpen)},e.prototype.addEventListener=function(a,b){this.eventEmitter.on(a,b)},e.prototype.send=function(a){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(a)},b.exports=g.defineNode({name:"Websocket",category:"Communication",initialize:function(){var a=this._internal;a.socket=new e(this.context),a.socket.addEventListener("connected",this.onConnected.bind(this)),a.socket.addEventListener("disconnected",this.onDisconnected.bind(this)),a.socket.addEventListener("jsonMessage",this.onMessageReceived.bind(this)),a.address=void 0,a.connected=!1,a.inputValues={},a.outputValues={},a.outputNames=[]},panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Outputs",plug:"output",type:{name:"*",group:"Output data"}},{name:"PortEditor",context:["select","connectTo"],title:"Data To Send",plug:"input",group:"Data To Send",type:{name:"string"}}],inputs:{address:{group:"Settings",displayName:"Ip Address:Port",type:{name:"string"},set:function(a){if(!(void 0===a||a.length<=0)){this._internal.address=a;var b="ws://"+a+"/";this._internal.socket.connect(b)}}},sendData:{group:"Send Data",displayName:"Send Data",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){a._internal.inputValues._nodeId=a.id,f(a._internal.socket,a._internal.inputValues)})}}},outputs:{newDataReceived:{displayName:"New Data Received",type:"signal"},connected:{displayName:"Connected",type:"boolean",getter:function(){return this._internal.connected}}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){this._internal.outputValues[a]=void 0;var b=this;this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},registerInputIfNeeded:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}},onMessageReceived:function(a){if(!a._nodeIds||a._nodeIds.indexOf(this.id)!==-1){var b=!1;for(var c in a)this.hasOutput(c)&&(this._internal.outputValues[c]=a[c],this.flagOutputDirty(c),b=!0);b&&this.sendSignalOnOutput("newDataReceived")}},onConnected:function(){this._internal.connected!==!0&&(this._internal.connected=!0,this.flagOutputDirty("connected"))},onDisconnected:function(){this._internal.connected!==!1&&(this._internal.connected=!1,this.flagOutputDirty("connected"))}}})},{"../nodedefinition":257,events:21}],325:[function(a,b,c){"use strict";function d(a,b){this.context=a,this.nodes={},this.componentOwner=b,this.noodlJavascriptAPI=f(this),this.componentInstanceChildren={}}function e(a,b){b.forEach(function(b){if(!a[b])throw new Error("Missing "+b)})}var f=a("./noodl-js-api"),g=a("lodash");d.prototype.addConnection=function(a){try{e(a,["sourceId","sourcePort","targetId","targetPort"])}catch(b){throw new Error("Error in connection: "+b.message)}try{var c=this.getNodeWithId(a.sourceId),d=this.getNodeWithId(a.targetId);d.registerInputIfNeeded(a.targetPort),c.registerOutputIfNeeded(a.sourcePort),d.connectInput(a.targetPort,c,a.sourcePort)}catch(b){console.error(b.message)}},d.prototype.setNodeParameters=function(a,b){b.expression&&a.setInputValue("expression",b.expression);var c=Object.keys(b).filter(function(a){return"expression"!==a});c.forEach(function(c){function d(){var d=b[c];"object"==typeof d?a.setInputValue(c,d.value,d.unit):a.setInputValue(c,d)}a.registerInputIfNeeded(c),a.hasInput(c)!==!1&&(window.chrome&&navigator&&"Win32"===navigator.platform&&"text"===c?a._internal.setTextHaxTimeout=window.setTimeout(d,200):d())})},d.prototype.createNodeFromModel=function(a){if("Component Children"!==a.type){var b;try{b=this.createNode(a.type,a.id),b.setNodeModel(a)}catch(c){return void console.error(c.message,c.stack)}this.setNodeParameters(b,a.parameters),a.parent&&this.insertNodeInTree(b,a)}else if(a.parent){var d=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(d)}},d.prototype.insertNodeInTree=function(a,b){var c=this.getNodeWithId(b.parent.id),d=b.parent.children.indexOf(b);if(!c.addChild)throw new Error("Node "+c.id+" of type "+c.constructor.name+" can't have children");a.getVisualRoot&&c.addChild(a,d)},d.prototype.getNodeWithId=function(a){if(this.nodes.hasOwnProperty(a)===!1)throw new Error("Unknown node id "+a);return this.nodes[a]},d.prototype.hasNodeWithId=function(a){return this.nodes.hasOwnProperty(a)},d.prototype.createNode=function(a,b){if(this.nodes.hasOwnProperty(b))throw Error("duplicate id "+b);var c;return this.context.hasComponentModelWithName(a)?(c=this.context.createComponentInstanceNode(a),c.parentNodeScope=this,this.componentInstanceChildren[b]=c):(c=this.context.nodeRegister.createNode(a),c.nodeScope=this),this.nodes[b]=c,c.id=b,c},d.prototype.getNodesWithIdRecursive=function(b){function c(a,b,e){a.nodes.hasOwnProperty(b)&&e.push(a.nodes[b]);var f=Object.keys(a.nodes).filter(function(b){return a.nodes[b]instanceof d});f.forEach(function(d){c(a.nodes[d].nodeScope,b,e)})}var d=a("./nodes/componentinstance"),e=[];return c(this,b,e),e},d.prototype.getNodesWithType=function(a){var b=this,c=Object.keys(this.nodes).filter(function(c){return b.nodes[c].name===a});return c.map(function(a){return b.nodes[a]})},d.prototype.onNodeModelRemoved=function(a){var b=this.getNodeWithId(a.id);if(a.parent){var c=this.getNodeWithId(a.parent.id);c.removeChild(b)}b._onNodeDeleted(),delete this.nodes[b.id],delete this.componentInstanceChildren[b.id]},d.prototype.removeConnection=function(a){var b=this.getNodeWithId(a.targetId);b.removeInputConnection(a.targetPort,a.sourceId,a.sourcePort)},d.prototype.removeNodeFromParent=function(a){if(a.getVisualRoot&&a.getVisualRoot()){var b=a.getVisualRoot()._internal.visualParent;b&&b.removeChild(a)}},d.prototype.setComponentModel=function(a){this.componentModel=a;var b=a.getAllNodes();b.forEach(this.createNodeFromModel.bind(this)),a.getAllConnections().forEach(this.addConnection.bind(this)),a.on("connectionAdded",this.addConnection,this),a.on("connectionRemoved",this.removeConnection,this),a.on("nodeAdded",this.createNodeFromModel,this);var c=this;a.on("nodeParentWillBeRemoved",function(a){if("Component Children"!==a.type){var b=c.getNodeWithId(a.id);c.removeNodeFromParent(b)}else if(a.parent){this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(null)}},this),a.on("nodeParentUpdated",function(a){if("Component Children"===a.type){var b=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(b)}else{var d=c.getNodeWithId(a.id);c.insertNodeInTree(d,a)}},this),a.on("nodeRemoved",function(a){"Component Children"!==a.type&&c.onNodeModelRemoved(a)},this)},d.prototype.reset=function(){if(this.componentModel){this.componentModel.removeListenersWithRef(this);var a=this;Object.keys(this.nodes).forEach(function(b){a.nodes.hasOwnProperty(b)&&a.deleteNode(a.nodes[b])}),this.componentModel=void 0,this.noodlJavascriptAPI.eventEmitter.removeAllListeners()}},d.prototype.deleteNode=function(a){if(this.nodes.hasOwnProperty(a.id)===!1)return void console.error("Node doesn't belong to this scope",this,a);
var b=this;this.removeNodeFromParent(a),a.getChildren&&(a.getChildren().forEach(a.removeChild.bind(a)),a.getChildren().forEach(function(a){b.deleteNode(a)}));var c=this.componentModel.getConnectionsFrom(a.id),d=this.componentModel.getConnectionsTo(a.id);c.concat(d).forEach(function(a){b.nodes.hasOwnProperty(a.targetId)&&b.nodes.hasOwnProperty(a.sourceId)&&b.removeConnection(a)}),a._onNodeDeleted(),delete this.nodes[a.id],delete this.componentInstanceChildren[a.id]},d.prototype.sendEventFromThisScope=function(a,b,c,d){if(d){var e=this.getNodesWithType("Event Receiver").filter(function(b){return b.getChannelName()===a});e.forEach(function(a){a.handleEvent(b)})}"parent"===c&&this.componentOwner.parentNodeScope?this.componentOwner.parentNodeScope.sendEventFromThisScope(a,b,c,!0):"children"===c&&g.forIn(this.componentInstanceChildren,function(d){d.nodeScope.sendEventFromThisScope(a,b,c,!0)})},b.exports=d},{"./nodes/componentinstance":264,"./noodl-js-api":326,lodash:145}],326:[function(a,b,c){"use strict";function d(a){function b(b){return b&&b.length>0&&"/"!==b[0]&&(b="/"+b),a.createNode(b,e())}function c(b){a.deleteNode(b)}function d(a,b){j.scheduleAfterUpdate(function(){j.setGlobalValue(a,b)})}function i(a,b){if(k[a]){var c=k[a].indexOf(b);c!==-1&&k[a].splice(c,1)}}var j=a.context,k={},l={on:function(a,b){var c=j.eventSenderEmitter;c.on(a,b),k[a]=k[a]||[],k[a].push(b),j.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b),i(a,b)})},once:function(a,b){j.eventSenderEmitter.once(a,b)},off:function(a,b){j.eventSenderEmitter.removeListener(a,b),i(a,b)},emit:function(a,b){j.eventSenderEmitter.emit(a,b)},removeAllListeners:function(){Object.keys(k).forEach(function(a){for(var b=k[a],c=b.length-1;c>=0;c--){var d=b[c];j.eventSenderEmitter.removeListener(a,d),i(a,d)}})}};return{createComponent:b,deleteComponent:c,setGlobalValue:d,eventEmitter:l,Collection:f,Model:g,Item:g,AnimationCurve:h}}var e=a("./guid"),f=a("./nodes/data/collection"),g=a("./nodes/data/model"),h=a("./easecurves");b.exports=d},{"./easecurves":243,"./guid":249,"./nodes/data/collection":267,"./nodes/data/model":271}],327:[function(a,b,c){"use strict";function d(a){if(!a.owner)throw new Error("Owner must be set");this.getter=a.getter,this.connections=[],this.owner=a.owner,this.name=a.name,this._id=void 0}Object.defineProperties(d.prototype,{value:{get:function(){return this.getter.call(this.owner)}},id:{get:function(){return this._id||(this._id=this.owner.id+this.name),this._id}},registerConnection:{value:function(a,b){this.connections.push({node:a,inputPortName:b})}},deregisterConnection:{value:function(a,b){for(var c=0;c<this.connections.length;c++){var d=this.connections[c];if(d.node===a&&d.inputPortName===b){this.connections.splice(c,1);break}}}},flagDependeesDirty:{value:function(a){for(var b=0,c=this.connections.length;b<c;b++)this.connections[b].node.flagDirty()}},sendValue:{value:function(a){for(var b=0,c=this.connections.length;b<c;b++){var d=this.connections[b];d.node.queueInput(d.inputPortName,a)}}},hasConnections:{value:function(){return this.connections.length>0}}}),b.exports=d},{}],328:[function(a,b,c){"use strict";function d(a,b,c){if(!c[a]){if(!g[a])throw new Error("Unknown patch key "+a);var d={nodePatches:[],dismissPatches:[]};for(var e in g[a])d[e]=g[a][e];c[a]=d}c[a].nodePatches.push(b)}function e(a,b){var c=[],e=[h,i,j,k,l];e.forEach(function(b){b.condition(a)&&c.push(b.generatePatch(a))}),c.forEach(function(a){d(a.key,a.patch,b)})}function f(a,b){e(a,b),a.children&&a.children.forEach(function(a){f(a,b)})}var g={LayoutNotSupported:{message:"Group with layout is no longer supported. These have been replaced with the new nodes Stack Layout and Flow Layout",notifyUser:!0,askPermission:!1,key:"LayoutNotSupported"},ImageDefaultUnitChanged:{notifyUser:!1,askPermission:!1,key:"ImageDefaultUnitChanged",message:""},TextMaxLineWidthReplaced:{notifyUser:!0,askPermission:!1,key:"TextMaxLineWidthReplaced",message:"Text max line width is no longer supported. Replaced with size mode content height and explicit width set in pixels"},RemoveValue:{notifyUser:!1,askPermission:!1,key:"RemoveValue",message:""}},h={condition:function(a){return void 0===a.version&&"Group"===a.type&&"none"===a.parameters.layout},generatePatch:function(a){return{key:"RemoveValue",version:2,patch:{nodeId:a.id,params:{layout:null}}}}},i={condition:function(a){return void 0===a.version&&"Group"===a.type&&a.parameters.hasOwnProperty("layout")&&"none"!==a.parameters.layout},generatePatch:function(a){var b,c;if("stackHorizontal"===a.parameters.layout)b="Stack Layout",c="horizontal";else if("stackVertical"===a.parameters.layout)b="Stack Layout",c="vertical";else if("flowHorizontal"===a.parameters.layout)b="Flow Layout",c="horizontal";else{if("flowVertical"!==a.parameters.layout)return void console.error("Can't convert layout",a);b="Flow Layout",c="vertical"}return{key:"LayoutNotSupported",patch:{nodeId:a.id,version:2,typename:b,params:{layout:null,orientation:c}}}}},j={condition:function(a){return void 0===a.version&&"Image"===a.type&&(("explicit"===a.parameters.sizeMode||"childHeight"===a.parameters.sizeMode)&&(!a.parameters.hasOwnProperty("width")||"object"!=typeof a.parameters.width))},generatePatch:function(a){var b=0;return a.parameters.width&&(b=a.parameters.width.value?a.parameters.width.value:a.parameters.width),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{width:{value:b,unit:"px"}}}}}},k={condition:function(a){return void 0===a.version&&"Image"===a.type&&(("explicit"===a.parameters.sizeMode||"childWidth"===a.parameters.sizeMode)&&(!a.parameters.hasOwnProperty("height")||"object"!=typeof a.parameters.height))},generatePatch:function(a){var b=0;return a.parameters.height&&(b=a.parameters.height.value?a.parameters.height.value:a.parameters.height),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{height:{value:b,unit:"px"}}}}}},l={condition:function(a){return void 0===a.version&&"Text"===a.type&&a.parameters.hasOwnProperty("maxWidth")},generatePatch:function(a){return{key:"TextMaxLineWidthReplaced",patch:{nodeId:a.id,version:2,params:{maxWidth:null,sizeMode:"childHeight",width:{value:a.parameters.maxWidth,unit:"px"}}}}}};b.exports={collectPatches:function(a){var b={};return a.components.forEach(function(a){a.nodes.forEach(function(a){f(a,b)})}),b}}},{}],329:[function(a,b,c){"use strict";function d(a,b){var c="Device Settings - "+a;b.ports.push({group:c,type:{name:"enum",enums:[{label:"WebGL",value:"webgl"},{label:"Canvas2D",value:"canvas2d"}]},name:a+".renderer",displayName:"Renderer",default:"webgl"}),b.ports.push({group:c,type:{name:"component"},name:a+".rootComponent",displayName:"Root Component"}),b.dynamicports.push({name:"conditionalports/basic",condition:"'"+a+".fillMode' = aspectFit OR '"+a+".fillMode' NOT SET",ports:[{group:c,type:"number",name:a+".canvasWidth",displayName:"Width",default:1080},{group:c,type:"number",name:a+".canvasHeight",displayName:"Height",default:1920}]}),b.ports.push({group:c,type:{name:"enum",enums:[{label:"Fill",value:"fill"},{label:"Aspect Fit",value:"aspectFit"}]},name:a+".fillMode",displayName:"Fill Mode",default:"aspectFit"})}function e(a){a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL",default:"mqtt://user:pass@brokerurl.com:1883"}]}),a.ports.push({group:"MQTT",type:"boolean",name:"mqttUseExternalBroker",displayName:"External Broker",default:!1})}function f(a){var b={dynamicports:[],ports:[{group:"Devices",type:"stringlist",name:"devices",displayName:"Devices",default:h}]},c=[h];return a.devices&&(c=a.devices.split(",")),c.forEach(function(a){d(a,b)}),e(b),b}function g(a){var b=["fillMode","canvasWidth","canvasHeight","renderer"],c=b.filter(function(b){return a.hasOwnProperty(b)});if(0!==c.length){var d={fillMode:null,canvasWidth:null,canvasHeight:null,renderer:null,devices:h};return c.forEach(function(b){d[h+"."+b]=a[b]}),{askPermission:!1,notifyUser:!1,settingsPatch:d}}}var h="Default Device";b.exports={generateProjectSettings:f,collectPatch:g}},{}],330:[function(a,b,c){"use strict";function d(){}var e=a("mqtt"),f=a("./services");d.prototype.connect=function(a){if(this.url!==a.url||this.clientId!==a.clientId){this.url=a.url,this.clientId=a.clientId,this.client&&this.client.end();var b=e.connect(a.url,{clientId:a.clientId});b.on("connect",function(){console.log("Connected to",a.url)}),b.on("message",function(a,b){var c=JSON.parse(b.toString());f.pubsub.routeMessage({topic:a,payload:c})}),this.client=b}},d.prototype.sendServiceRequest=function(a){"subscribe"===a.type?this.client.subscribe(a.topic):"unsubscribe"===a.type?this.client.unsubscribe(a.topic):"publish"===a.type&&this.client.publish(a.topic,JSON.stringify(a.payload))},b.exports=d},{"./services":332,mqtt:164}],331:[function(a,b,c){"use strict";function d(){}var e={};d.prototype.setConnection=function(a){this.connection=a},d.prototype.getMatchingSubscribers=function(a){function b(a,b){var c=a.split("/"),d=b.split("/");if(c.length!==d.length)return!1;for(var e=0;e<c.length;e++)if("+"!==d[e]&&c[e]!==d[e])return!1;return!0}var c=[];for(var d in e)if(b(a,d))for(var f=e[d],g=0;g<f.length;g++)c.push(f[g]);return c},d.prototype.routeMessage=function(a){for(var b=this.getMatchingSubscribers(a.topic),c=0;c<b.length;c++)b[c](a)},d.prototype.getSubscribers=function(a){return e[a]||(e[a]=[]),e[a]},d.prototype.subscribe=function(a,b){var c=this.getSubscribers(a);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"subscribe",topic:a}),c.push(b)},d.prototype.unsubscribe=function(a,b){for(var c=this.getSubscribers(a),d=0;d<c.length;d++)c[d]===b&&c.splice(d,1);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"unsubscribe",topic:a})},d.prototype.publish=function(a,b){this.connection.sendServiceRequest({service:"pubsub",type:"publish",topic:a,payload:b})},b.exports=d},{}],332:[function(a,b,c){function d(){}var e=a("events").EventEmitter;d.events=new e,b.exports=d},{events:21}],333:[function(a,b,c){"use strict";function d(a,b,c){var d=e(JSON.stringify(b)),g=new f(4);g.writeUInt32LE(d.uncompressedSize,0);var h=new XMLHttpRequest;h.open("POST",a,!0),h.send(f.concat([g,d.buffer])),h.addEventListener("readystatechange",function(){h.readyState===XMLHttpRequest.DONE&&c(200===h.status?"success":"error")})}function e(a){var b=new f(a),c=new f(g.encodeBound(b.length)),d=g.encodeBlock(b,c);return c=c.slice(0,d),{buffer:c,uncompressedSize:b.length}}var f=a("buffer").Buffer,g=a("lz4");b.exports=function(a){function b(){e||(e=!0,d(c,f,function(a){"success"===a&&(e=!1)}))}var c,e=!1,f={frames:[],events:[],metadata:{}};a.onmessage=function(a){var d=JSON.parse(a.data);if("sessionStart"===d.cmd)f.id=d.id,c=d.url,setInterval(b,5e3);else if("frame"===d.cmd)f.frames.push(d.frame);else if("events"===d.cmd)f.events.push(d.events);else if("metadata"===d.cmd)for(var e in d.metadata)f.metadata[e]=d.metadata[e]}}},{buffer:6,lz4:155}],334:[function(a,b,c){"use strict";function d(b,c){var d=this;this.touchPoints={},this.startTime=void 0,this.frameNumber=0,this.renderer={render:this._onRenderCommands.bind(this),setViewportSize:function(a,b){d.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"metadata",metadata:{viewportWidth:a,viewportHeight:b}}))},setFillMode:function(a){d.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"metadata",metadata:{fillMode:a}}))},beginFrame:this._onBeginFrame.bind(this),endFrame:this._onEndFrame.bind(this),removeResourcesForRenderCommand:function(){}},this.compressAndUploadWorker=f(a("./session-recorder-webworker.js")),this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"sessionStart",id:b,url:c}))}var e=a("lodash"),f=a("webworkify");d.prototype._onBeginFrame=function(){void 0===this.startTime&&(this.startTime=window.performance.now()),this.renderCommands=[],this.timestamp=window.performance.now()-this.startTime},d.prototype._onEndFrame=function(){this.frameNumber++,this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"frame",frame:{renderCommands:this.renderCommands,touchPoints:this.touchPoints,timestamp:this.timestamp}})),this.compressAndUploadWorker.postMessage(JSON.stringify({cmd:"events",events:this.events})),this.events=[]},d.prototype._onRenderCommands=function(a){var b=e.cloneDeep(a);b.forEach(function(a){a.content.image&&delete a.content.image}),this.renderCommands=b},d.prototype.appendTouchEvent=function(a){"isDown"===a.type||"isMove"===a.type?this.touchPoints[a.id]={x:a.x,y:a.y}:"isUp"===a.type&&delete this.touchPoints[a.id]},d.prototype.appendEvent=function(a){this.events.push({eventName:a,frame:this.frameNumber,timestamp:this.timestamp})},d.prototype.getRenderer=function(){return this.renderer},b.exports=d},{"./session-recorder-webworker.js":333,lodash:145,webworkify:215}],335:[function(a,b,c){"use strict";function d(a,b){this.duration=b.duration||0,this._isRunning=!1,this._hasCalledOnStart=!1,this.scheduler=a,this.repeatCount=1,this.delay=0;for(var c in b)this[c]=b[c]}function e(a){this.requestFrame=a,this.runningTimers=[],this.newTimers=[]}d.prototype.start=function(){return this._isRunning&&this.stop(),this.scheduler.scheduleTimer(this),this},d.prototype.stop=function(){this.scheduler.stopTimer(this),this._hasCalledOnStart=!1,this._isRunning=!1,this._wasStopped=!0},e.prototype.createTimer=function(a){return new d(this,a)},e.prototype.scheduleTimer=function(a){this.newTimers.indexOf(a)===-1&&(0===a.repeatCount&&(a.repeatCount=1e5),this.newTimers.push(a),this.requestFrame())},e.prototype.stopTimer=function(a){var b;a._isRunning?(b=this.runningTimers.indexOf(a),b!==-1&&this.runningTimers.splice(b,1),a.onStop&&!a._wasStopped&&a.onStop()):(b=this.newTimers.indexOf(a),b!==-1&&this.newTimers.splice(b,1))},e.prototype.runTimers=function(a){var b,c,d=[],e=[],f=[],g=this.runningTimers.length;for(b=0;b<g;++b)f[b]=this.runningTimers[b];for(b=0;b<g;++b)if(c=f[b],c&&a>=c._start){c._hasCalledOnStart===!1&&c.onStart&&(c.onStart(),c._hasCalledOnStart=!0);var h;h=c.duration>0?(a-c._start)/(c.duration*c.repeatCount):1;var i=h*c.repeatCount-Math.floor(h*c.repeatCount);h>=1&&(i=1),c.onRunning&&c.onRunning(i),h<1&&c._isRunning?d.push(c):c._wasStopped||e.push(c)}else d.push(c);for(this.runningTimers=d,b=0;b<e.length;++b)e[b]._isRunning=!1,e[b]._hasCalledOnStart=!1,e[b].onFinish&&e[b].onFinish();if(this.newTimers.length>0){for(b=0;b<this.newTimers.length;++b)c=this.newTimers[b],c._start=a+c.delay,c._isRunning=!0,c._wasStopped=!1,this.runningTimers.push(c),0===c.delay&&(c.onStart&&(c.onStart(),c._hasCalledOnStart=!0),c.onRunning&&c.onRunning(0));this.newTimers.length=0}},e.prototype.hasPendingTimers=function(){return this.runningTimers.length>0||this.newTimers.length>0},b.exports=e},{}],336:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.imageCache=b,this.renderCommand={type:"circle",color:"#ffffff",blendMode:"alpha",arcAngle:2*Math.PI,solid:!0,lineWidth:2,blur:0,image:null,imagePath:null}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d="%"===a.widthUnit?b*(a.width/100):a.width;return{width:d,height:d}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setArcAngle=function(a){this.renderCommand.arcAngle=a,this.setContentDirty(!0)},d.prototype.setSolid=function(a){this.renderCommand.solid=a,this.setContentDirty(!0)},d.prototype.setLineWidth=function(a){this.renderCommand.lineWidth=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.setContentDirty(!0),this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},b.exports=d},{"./uicontrol":350}],337:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static)}var e=a("./layoutcontrol"),f=a("../layout/docklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../layout/docklayout":352,"./layoutcontrol":341}],338:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static),this.verticalItemSpacing=0,this.horizontalItemSpacing=0,this.orientation="horizontal"}var e=a("./layoutcontrol"),f=a("../layout/flowlayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setVerticalItemSpacing=function(a){this.verticalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHorizontalItemSpacing=function(a){this.horizontalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/flowlayout":353,"./layoutcontrol":341}],339:[function(a,b,c){"use strict";function d(a,b,c,d){var e=c/a,f=d/b,g=Math.min(e,f);return{width:a*g,height:b*g}}function e(a,b,c,d){var e=c/a,f=d/b,g=Math.max(e,f);return{width:a*g,height:b*g}}function f(a,b){g.call(this,a),this.layout=h,this.setAlignX("center"),this.setAlignY("center"),this.setSizeMode("original"),this.imageCache=b,this.renderCommand={type:"image",color:"#ffffff",blendMode:"alpha",image:null,imagePath:null},this.imageWidth=0,this.imageHeight=0}var g=a("../uicontrol"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var f=a.imageWidth,g=a.imageHeight;if("fill"===a.sizeMode){var h=a.parent.sizeMode;"explicit"!==h&&"childHeight"!==h||(f=b),"explicit"!==h&&"childWidth"!==h||(g=c)}var i=b&&c&&a.imageWidth&&a.imageHeight;return"aspectFit"===a.sizeMode&&i?d(a.imageWidth,a.imageHeight,b,c):"aspectFill"===a.sizeMode&&i?e(a.imageWidth,a.imageHeight,b,c):{width:f,height:g}}};f.prototype=Object.create(g.prototype),f.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},f.prototype.setVideoElement=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a.src,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),a.videoWidth?this._onVideoLoaded(a):a.addEventListener("canplay",this._onVideoLoaded.bind(this,a))},f.prototype._onVideoLoaded=function(a){a.src===this.path&&(this.imageWidth=a.videoWidth,this.imageHeight=a.videoHeight,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this))},f.prototype._onImageLoaded=function(a){a._path===this.path&&(this.imageWidth=a.width,this.imageHeight=a.height,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},f.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},f.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},f.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},b.exports=f},{"../uicontrol":350}],340:[function(a,b,c){"use strict";function d(a,b){f.call(this,a),this.clip=!0,this.innerControl=new e(a,b),this.addChild(this.innerControl)}var e=a("./image/imageinnercontrol"),f=a("./docklayoutcontrol");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.innerControl.setImagePath(a)},d.prototype.setVideoElement=function(a){this.innerControl.setVideoElement(a)},d.prototype.setFillMode=function(a){this.innerControl.setSizeMode(a)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.setImageSourceRect=function(a){this.innerControl.setImageSourceRect(a)},d.prototype.dispose=function(){this.innerControl.dispose(),f.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":337,"./image/imageinnercontrol":339}],341:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=b,this.children=[],this.padding={top:0,bottom:0,left:0,right:0},this.clip=!1,this.childAABB=f.create()}var e=a("./uicontrol"),f=a("../math/aabb");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setPaddingTop=function(a){this.padding.top=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingLeft=function(a){this.padding.left=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingRight=function(a){this.padding.right=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingBottom=function(a){this.padding.bottom=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.addChild=function(a,b){void 0===b&&(b=this.children.length-1),this.children.splice(b,0,a),a.parent=this,this.layouter.setNeedsRelayout(this),this.layouter.setNeedsRelayout(a),a.setContentDirty(!0),a.localTransformDirty=!0},d.prototype.removeChild=function(a){var b=this.children.indexOf(a);b!==-1?this.children.splice(b,1):console.error("Node is not a child"),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.getChildren=function(){return this.children},b.exports=d},{"../math/aabb":358,"./uicontrol":350}],342:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.setWidth(100),this.setHeight(100),this.renderCommand={type:"mesh",color:"#ffffff",blendMode:"alpha",mesh:null,shader:null,image:null,imagePath:null,srcRect:[0,0,1,1]},this.imageCache=b}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setShader=function(a){this.renderCommand.shader=a,this.setContentDirty(!0)},d.prototype.setMesh=function(a){this.renderCommand.mesh=a,this.setContentDirty(!0)},d.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},d.prototype.dispose=function(){this.renderCommand.mesh&&this.renderCommand.mesh.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./uicontrol":350}],343:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=f,this.renderCommand={type:"rectangle",color:"#ffffff",blendMode:"solid",cornerRadius:0,blur:0}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setCornerRadius=function(a){this.renderCommand.cornerRadius=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":350}],344:[function(a,b,c){"use strict";function d(a,b){e.call(this,a,f.static),this.itemSpacing=0,this.orientation="vertical",this.scrollOffset=0,this.scrollDuration=300;var c=this;this.scroller=new g(b,{scrollThreshold:50,axis:1,scrollEndedAnimationDuration:this.scrollDuration,bounceOnPositionEndedOverride:!1,scrollEndedPositionCallback:function(a,b){return c.scrollEndedPositionCallback(a,b)},scrollCallback:function(a){c.setScrollOffset(a)}}),this.contentLengthChanged=function(a){c.scroller.scrollObjectSize=a},this.on("layoutWidthChanged",function(a){"horizontal"===c.orientation&&(c.scroller.scrollViewSize=a)}),this.on("layoutHeightChanged",function(a){"vertical"===c.orientation&&(c.scroller.scrollViewSize=a)})}var e=a("./layoutcontrol"),f=a("../layout/scrollviewlayout"),g=a("../touch/scroller");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.getItemSpacing=function(){return this.itemSpacing},d.prototype.setOrientation=function(a){this.orientation=a,this.scroller.setOrientation(a),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setScrollOffset=function(a){this.scrollOffset=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0),this.emit("scrollOffsetChanged",a)},d.prototype.setOverscrollEnabled=function(a){this.scroller.shouldRubber=a},b.exports=d},{"../layout/scrollviewlayout":356,"../touch/scroller":379,"./layoutcontrol":341}],345:[function(a,b,c){"use strict";function d(a){e.call(this,a,f.static),this.orientation="vertical",this.itemSpacing=0}var e=a("./layoutcontrol"),f=a("../layout/stacklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/stacklayout":357,"./layoutcontrol":341}],346:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=g,this.renderCommand={type:"text",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",text:"",lineHeight:0,blendMode:"alpha"},this.text="",this.textWidth=0,this.textHeight=0,this.horizontalAlignment="left",this.maxWidth=0,this.lineHeight=0}var e=a("../uicontrol"),f=a("./textlayout"),g={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return a.layoutText(),{width:a.textWidth,height:a.textHeight}}};d.prototype=Object.create(e.prototype),d.prototype.layoutText=function(){var a=f.layoutText(this.text,this.renderCommand.fontFamily,this.renderCommand.fontSize,this.horizontalAlignment,this.lineHeight,this.maxWidth);this.textWidth=a.width,this.textHeight=a.height,this.renderCommand.lines=a.lines,this.renderCommand.text=a.lines.map(function(a){return a.text}).join("\n"),this.setContentDirty(!0)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setLineHeight=function(a){this.lineHeight=a,this.renderCommand.lineHeight=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setText=function(a){a=String(a),this.text!==a&&(this.text=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},d.prototype.getText=function(){return this.text},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setHorizontalAlignment=function(a){this.horizontalAlignment=a,this.renderCommand.horizontalAlignment=a,this.layouter.setNeedsRelayout(this)},d.prototype.setMaxWidth=function(a){this.maxWidth!==a&&(this.maxWidth=a,this.layouter.setNeedsRelayout(this))},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../uicontrol":350,"./textlayout":347}],347:[function(a,b,c){"use strict";function d(a,b){var c=a+" - "+b;if(void 0===i[c]){var d=document.createElement("span");d.style.fontFamily=a,d.style.fontSize=b+"px",d.innerHTML="yq|";var e=document.createElement("div");e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var f=document.createElement("div");f.style.display="inline-block",f.appendChild(d),f.appendChild(e),document.body.appendChild(f),e.style.verticalAlign="bottom";var g=e.offsetTop-d.offsetTop;e.style.verticalAlign="baseline";var h=e.offsetTop-d.offsetTop;document.body.removeChild(f);var j={height:g,baseline:h};i[c]=j}return i[c]}function e(a,b,c){k.font=c+'px "'+b+'"';var e=d(b,c);return{width:k.measureText(a).width,height:e.height,baseline:e.baseline}}function f(a,b){var c=a.split(" "),d=[],e="";if(k.measureText(a).width<b)return[a];for(;c.length>0;){for(;k.measureText(c[0]).width>=b;){var f=c[0];c[0]=f.slice(0,-1),c.length>1?c[1]=f.slice(-1)+c[1]:c.push(f.slice(-1))}k.measureText(e+c[0]).width<b?(e.length&&(e+=" "),e+=c.shift()):(d.push(e),e=""),0===c.length&&d.push(e)}return d}function g(a,b,c){return"center"===a?(b-c)/2:"right"===a?b-c:0}function h(a,b,c,e,h,i){k.font=c+'px "'+b+'"';var j=[];0===i?j=a.split("\n"):a.split("\n").forEach(function(a){j=j.concat(f(a,i))});var l=0,m=[];j.forEach(function(a){var b=k.measureText(a).width;l=Math.max(l,b),m.push(b)});var n=d(b,c),o=h?h:n.height,p=n.height+(j.length-1)*o,q=[];return j.forEach(function(a,b){var c=m[b],d=g(e,l,c);q.push({text:a,x:d,y:n.baseline+b*o})}),{width:l,height:p,lines:q}}var i={},j=document.createElement("canvas"),k=j.getContext("2d");b.exports={measureText:e,layoutText:h}},{}],348:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.innerControl=new f(a),this.addChild(this.innerControl)}var e=a("./docklayoutcontrol"),f=a("./text/textinnercontrol");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onLayoutWidthChanged=function(a){e.prototype._onLayoutWidthChanged.call(this,a),"explicit"===this.sizeMode||"childHeight"===this.sizeMode?this.innerControl.setMaxWidth(a):this.innerControl.setMaxWidth(0)},d.prototype.setFontFamily=function(a){this.innerControl.setFontFamily(a)},d.prototype.setFontSize=function(a){this.innerControl.setFontSize(a)},d.prototype.setLineHeight=function(a){this.innerControl.setLineHeight(a)},d.prototype.setText=function(a){this.innerControl.setText(a)},d.prototype.getText=function(){return this.innerControl.getText()},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setHorizontalAlignment=function(a){this.innerControl.setHorizontalAlignment(a),this.innerControl.setAlignX(a)},d.prototype.setVerticalAlignment=function(a){this.innerControl.setAlignY(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.dispose=function(){this.innerControl.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":337,"./text/textinnercontrol":346}],349:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=h,this.contentWidth=0,this.contentHeight=0,this.renderCommand={type:"textInput",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",focused:!1,text:"",blendMode:"alpha"},this.text="",this.type="text",this.clip=!0}var e=a("./uicontrol"),f=a("./text/textlayout"),g=a("../../useragent-utils"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d=0,e=0;return d="childSize"===a.sizeMode||"childWidth"===a.sizeMode?a.contentWidth:"%"===a.widthUnit?b*(a.width/100):a.width,
e="childSize"===a.sizeMode||"childHeight"===a.sizeMode?a.contentHeight:"%"===a.heightUnit?c*(a.height/100):a.height,{width:d,height:e}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.updateTextMetrics=function(){var a=f.measureText(this.renderCommand.text,this.renderCommand.fontFamily,this.renderCommand.fontSize);this.contentWidth=a.width,this.contentHeight=a.height,this.renderCommand.baseline=a.baseline,this.renderCommand.textWidth=a.width,this.renderCommand.textHeight=a.height,this.layouter.setNeedsRelayout(this)},d.prototype.setInputField=function(a){this.textInputField=a;var b=this;a.on("inputChanged",function(a){b.setText(a)},this),a.on("blur",this.blur.bind(this),this)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.getRenderText=function(a){if("password"===this.type){var b=g.isMobile.iOS()?"":"";a=b.repeat(a.length)}return a},d.prototype.setText=function(a){this.renderCommand.text=this.getRenderText(a),this.updateTextMetrics(),this.setContentDirty(!0),this.text=a,this.emit("textChanged",a)},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.getText=function(){return this.text},d.prototype.setHorizontalAlignment=function(a){},d.prototype.setVerticalAlignment=function(a){},d.prototype.focus=function(){this.renderCommand.focused!==!0&&(this.renderCommand.focused=!0,this.textInputField.focus(),this.setContentDirty(!0),this.emit("focused",this))},d.prototype.blur=function(){this.renderCommand.focused!==!1&&(this.renderCommand.focused=!1,this.textInputField.blur(),this.setContentDirty(!0),this.emit("blurred",this))},d.prototype.isFocused=function(){return this.renderCommand.focused},d.prototype.setInputType=function(a){this.type=a,this.textInputField.setType(a),this.renderCommand.text=this.getRenderText(this.text),this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.dispose=function(){e.prototype.dispose.call(this),this.textInputField&&(this.textInputField.removeListenersWithRef(this),this.textInputField.dispose())},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../../useragent-utils":384,"./text/textlayout":347,"./uicontrol":350}],350:[function(a,b,c){"use strict";function d(a){f.call(this),this.id=g(),this.layouter=a,this.sizeMode="explicit",this.pivotUnitType=[],this.pivotFactors=[.5,.5],this.parent=null,this.positionX=0,this.positionY=0,this.positionZ=0,this.alignX="left",this.alignY="top",this.pivotX=50,this.pivotY=50,this.pivotXUnit="%",this.pivotYUnit="%",this.pivotXPx=0,this.pivotYPx=0,this.pivotZPx=0,this.width=0,this.height=0,this.widthUnit="%",this.heightUnit="%",this.depth=void 0,this.opacity=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.blockTouch=!1,this.touchPropagation=!0,this.contentDirty=!0,this.highlightEnabled=!1,this.layoutRect=new e({xChanged:this._onLayoutPositionChanged.bind(this),yChanged:this._onLayoutPositionChanged.bind(this),widthChanged:this._onLayoutWidthChanged.bind(this),heightChanged:this._onLayoutHeightChanged.bind(this)}),this.screenAABB=i.create(),this.transform=h.create(),this.localTransform=h.create(),this.localTransformDirty=!1}var e=a("./../layout/layoutrect"),f=a("../../eventsender"),g=a("../../guid"),h=a("../math/mat4"),i=a("../math/aabb");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype._onLayoutPositionChanged=function(){this.localTransformDirty=!0},d.prototype._onLayoutWidthChanged=function(a){this.emit("layoutWidthChanged",a),"%"===this.pivotXUnit&&this.setPivotX(this.pivotX)},d.prototype._onLayoutHeightChanged=function(a){this.emit("layoutHeightChanged",a),"%"===this.pivotYUnit&&this.setPivotY(this.pivotY)},d.prototype.setPositionX=function(a){this.positionX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionY=function(a){this.positionY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionZ=function(a){this.positionZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setWidth=function(a){this.width=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeight=function(a){this.height=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setWidthUnit=function(a){this.widthUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeightUnit=function(a){this.heightUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setSizeMode=function(a){this.sizeMode=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignX=function(a){this.alignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignY=function(a){this.alignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setBlockTouch=function(a){this.blockTouch=a},d.prototype.setTouchPropagation=function(a){this.touchPropagation=a},d.prototype.setDepth=function(a){this.depth=a,this.setContentDirty(!0)},d.prototype.setOpacity=function(a){0===this.opacity&&a>0&&(this.localTransformDirty=!0),this.opacity=a,this.setContentDirty(!0)},d.prototype.setVisible=function(a){this.visible=a,this.setContentDirty(!0)},d.prototype.setPivotX=function(a){this.pivotX=a;var b=a;if("%"===this.pivotXUnit){var c=void 0===this.layoutRect.width?0:this.layoutRect.width;b=c*a*.01}this.pivotXPx!==b&&(this.pivotXPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotXUnit=function(a){this.pivotXUnit=a,this.setPivotX(this.pivotX),this.setContentDirty(!0)},d.prototype.setPivotY=function(a){this.pivotY=a;var b=a;if("%"===this.pivotYUnit){var c=void 0===this.layoutRect.height?0:this.layoutRect.height;b=c*a*.01}this.pivotYPx!==b&&(this.pivotYPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotYUnit=function(a){this.pivotYUnit=a,this.setPivotY(this.pivotY),this.setContentDirty(!0)},d.prototype.setPivotZ=function(a){this.pivotZPx=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationX=function(a){this.rotationX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationY=function(a){this.rotationY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationZ=function(a){this.rotationZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleX=function(a){this.scaleX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleY=function(a){this.scaleY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setContentDirty=function(a){this.contentDirty!==a&&(this.contentDirty=a,a&&this.parent&&this.parent.setContentDirty(!0))},d.prototype.setHighlightEnabled=function(a){this.highlightEnabled=a,this.setContentDirty(!0)},d.prototype.getScreenX=function(){return this.screenAABB.min[0]},d.prototype.getScreenY=function(){return this.screenAABB.min[1]},d.prototype.dispose=function(){this.emit("disposed",this),this.removeAllListeners()},b.exports=d},{"../../eventsender":247,"../../guid":249,"../math/aabb":358,"../math/mat4":360,"./../layout/layoutrect":355}],351:[function(a,b,c){"use strict";function d(){this.cache={}}d.prototype.getImage=function(a,b){var c=this.cache[a];if(c)return void(c.isLoaded?b(c.image):c.callbacks.push(b));this.cache[a]={image:new Image,callbacks:[],isLoaded:!1},c=this.cache[a],c.callbacks.push(b);var d=c.image;d.crossOrigin="anonymous",d.addEventListener("load",function(){c.callbacks.forEach(function(a){a(d)}),c.isLoaded=!0,delete c.callbacks}),d.src=a,d._path=a},d.prototype.clear=function(){this.cache={}},b.exports=d},{}],352:[function(a,b,c){"use strict";function d(){}d.prototype.layoutChildHorizontally=function(a,b,c,d,e){"left"===b.alignX?(a.x=b.positionX+e.left,a.width=c):"right"===b.alignX?(a.x=d.width-e.right+b.positionX-c,a.width=c):"center"===b.alignX&&(a.x=(d.width-e.right-e.left)/2+e.left+b.positionX-c/2,a.width=c),a.x=Math.round(a.x)},d.prototype.layoutChildVertically=function(a,b,c,d,e){"top"===b.alignY?(a.y=b.positionY+e.top,a.height=c):"bottom"===b.alignY?(a.y=d.height-e.bottom+b.positionY-c,a.height=c):"center"===b.alignY&&(a.y=(d.height-e.bottom-e.top)/2+e.top+b.positionY-c/2,a.height=c),a.y=Math.round(a.y)},d.prototype.setChildLayoutRect=function(a,b){var c=a.layoutRect.width!=b.width||a.layoutRect.height!=b.height;a.layoutRect.x=b.x,a.layoutRect.y=b.y,a.layoutRect.width=Math.max(b.width,0),a.layoutRect.height=Math.max(b.height,0),(c||a.needsRelayout)&&(a.layout.layout&&a.layout.layout(a),a.needsRelayout=!1)},d.prototype.layout=function(a){for(var b={x:0,y:0,width:0,height:0},c=0;c<a.children.length;c++){var d=a.children[c],e=a.layoutRect.width-a.padding.left-a.padding.right,f=a.layoutRect.height-a.padding.top-a.padding.bottom,g=d.layout.layoutSize(d,e,f);this.layoutChildHorizontally(b,d,g.width,a.layoutRect,a.padding),this.layoutChildVertically(b,d,g.height,a.layoutRect,a.padding),this.setChildLayoutRect(d,b)}},d.prototype.layoutSize=function(a,b,c){var d=this.measure(a);return{width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?d.width:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?d.height:this.layoutHeight(a,c)}},d.prototype.measureChildrenWidth=function(a){for(var b=0,c=0;c<a.children.length;c++){var d=a.children[c],e=d.layout.measure(d);b=Math.max(b,Math.max(d.positionX,0)+e.width)}return b},d.prototype.measureChildrenHeight=function(a){for(var b=0,c=0;c<a.children.length;c++){var d=a.children[c],e=d.layout.measure(d);b=Math.max(b,Math.max(d.positionY,0)+e.height)}return b},d.prototype.layoutWidth=function(a,b){return"%"===a.widthUnit?b*(a.width/100):a.width},d.prototype.layoutHeight=function(a,b){return"%"===a.heightUnit?b*(a.height/100):a.height},d.prototype.measure=function(a){if(a.measuredSize)return a.measuredSize;var b={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenWidth(a)+a.padding.left+a.padding.right:this.layoutWidth(a,0),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenHeight(a)+a.padding.top+a.padding.bottom:this.layoutHeight(a,0)};return a.measuredSize=b,b},d.static=new d,b.exports=d},{}],353:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.measureChildrenHeightForHorizontalFlow=function(a){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return this.layoutHeight(a,0,0);for(var b="childSize"===a.sizeMode?Number.MAX_VALUE:this.layoutWidth(a,0,0)-a.padding.left-a.padding.right,c=0,d=0,e=0,f=a.children.length,g=0;g<f;g++){var h=a.children[g],i=h.layout.measure(h);d+i.width>b&&(c+=e+a.verticalItemSpacing,e=d=0),e=Math.max(e,i.height+h.positionY),d+=i.width+a.horizontalItemSpacing}return c+=e},d.prototype.measureChildrenWidthForHorizontalFlow=function(a){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return this.layoutWidth(a,0,0);for(var b=0,c=a.children.length,d=0;d<c;d++){var e=a.children[d],f=e.layout.measure(e);b+=f.width+(d!==c-1?a.horizontalItemSpacing:0)}return b},d.prototype.measureChildrenWidthForVerticalFlow=function(a){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return this.layoutWidth(a,0,0);for(var b="childSize"===a.sizeMode?Number.MAX_VALUE:this.layoutHeight(a,0,0)-a.padding.top-a.padding.left,c=0,d=0,e=0,f=a.children.length,g=0;g<f;g++){var h=a.children[g],i=h.layout.measure(h);c+i.height>b&&(d+=e+a.horizontalItemSpacing,e=c=0),e=Math.max(e,i.width+h.positionX),c+=i.height+a.verticalItemSpacing}return d+=e},d.prototype.measureChildrenHeightForVerticalFlow=function(a){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return this.layoutHeight(a,0,0);for(var b=0,c=a.children.length,d=0;d<c;d++){var e=a.children[d],f=e.layout.measure(e);b+=f.height+(d!==c-1?a.verticalItemSpacing:0)}return b},d.prototype.measureChildrenWidth=function(a){return"horizontal"===a.orientation?this.measureChildrenWidthForHorizontalFlow(a):this.measureChildrenWidthForVerticalFlow(a)},d.prototype.measureChildrenHeight=function(a){return"horizontal"===a.orientation?this.measureChildrenHeightForHorizontalFlow(a):this.measureChildrenHeightForVerticalFlow(a)};var f=[];d.prototype.layout=function(a){function b(b,c,d,e){for(var g=b;g<c;g++){var h=a.children[g],i=f[g],k=h.layout.layoutSize(h,0,e);j.layoutChildVertically(i,h,k.height,{height:e},{top:0,bottom:0,left:0,right:0}),i.y+=d,j.setChildLayoutRect(h,i)}}function c(b,c,d,e){for(var g=b;g<c;g++){var h=a.children[g],i=f[g],k=h.layout.layoutSize(h,e,0);j.layoutChildHorizontally(i,h,k.width,{width:e},{top:0,bottom:0,left:0,right:0}),i.x+=d,j.setChildLayoutRect(h,i)}}var d,e,g,h,i,j=this,k=0,l=0,m=0,n=0,o=0,p=a.children.length;if(f.length<p)for(e=0;e<p;e++)f[e]={x:0,y:0,width:0,height:0};if("horizontal"===a.orientation){var q=a.layoutRect.width-a.padding.left-a.padding.right;for(d=q,e=0;e<p;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,q,0),k+h.width>d&&(b(o,e,l+a.padding.top,m),l+=m+a.verticalItemSpacing,o=e,m=0,k=0),m=Math.round(Math.max(m,h.height)),i.x=k+a.padding.left+g.positionX,i.width=h.width,k+=Math.round(h.width)+a.horizontalItemSpacing;b(o,e,l+a.padding.top,m)}else{var r=a.layoutRect.height-a.padding.top-a.padding.bottom;for(d=r,e=0;e<p;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,0,r),l+h.height>d&&(c(o,e,k+a.padding.left,n),k+=n+a.horizontalItemSpacing,o=e,n=0,l=0),n=Math.round(Math.max(n,h.width)),i.y=l+a.padding.top+g.positionY,i.height=h.height,l+=Math.round(h.height)+a.verticalItemSpacing;c(o,e,k+a.padding.left,n)}},d.static=new d,b.exports=d},{"./docklayout":352}],354:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype.setWindowSize=function(a,b){this.windowSize={width:a,height:b}},d.prototype.layout=function(a){var b={layoutRect:{x:0,y:0,width:this.windowSize.width,height:this.windowSize.height},padding:{top:0,left:0,bottom:0,right:0},children:[a]};e.static.layout(b),a.needsRelayout=!1},d.prototype.setNeedsFullRelayout=function(a){function b(a){if(a.measuredSize=void 0,a.needsRelayout=!0,a.children)for(var c=0;c<a.children.length;c++)b(a.children[c])}b(a)},d.prototype.setNeedsRelayout=function(a){a.needsRelayout||(a.measuredSize=void 0,a.needsRelayout=!0,a.parent&&this.setNeedsRelayout(a.parent))},d.prototype.relayout=function(a){this.setNeedsFullRelayout(a),this.layout(a)},b.exports=d},{"./docklayout":352}],355:[function(a,b,c){var d=function(a){this._x=this._y=this._width=this._height=void 0,this.callbacks=a};Object.defineProperties(d.prototype,{x:{set:function(a){this._x!==a&&(this._x=a,this.callbacks.xChanged(a))},get:function(){return this._x}},y:{set:function(a){this._y!==a&&(this._y=a,this.callbacks.yChanged(a))},get:function(){return this._y}},width:{set:function(a){this._width!==a&&(this._width=a,this.callbacks.widthChanged(a))},get:function(){return this._width}},height:{set:function(a){this._height!==a&&(this._height=a,this.callbacks.heightChanged(a))},get:function(){return this._height}}}),b.exports=d},{}],356:[function(a,b,c){"use strict";function d(){}var e=a("./stacklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=a.children.length,f={x:0,y:0,width:0,height:0},g=a.layoutRect.height-a.padding.top-a.padding.bottom,h=a.layoutRect.width-a.padding.left-a.padding.right;if("horizontal"===a.orientation){var i=a.padding.left;for(d=0;d<e;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),f.x=Math.round(i+a.scrollOffset+b.positionX),f.width=Math.round(c.width),this.layoutChildVertically(f,b,c.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,f),i+=a.itemSpacing+b.layoutRect.width;a.contentLengthChanged&&a.contentLengthChanged(i-(d>0?a.itemSpacing:0)-a.padding.left)}else{var j=a.padding.top;for(d=0;d<e;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),this.layoutChildHorizontally(f,b,c.width,a.layoutRect,a.padding),f.y=Math.round(j+a.scrollOffset+b.positionY),f.height=Math.round(c.height),this.setChildLayoutRect(b,f),j+=a.itemSpacing+b.layoutRect.height;a.contentLengthChanged&&a.contentLengthChanged(j-(d>0?a.itemSpacing:0)-a.padding.top)}},d.static=new d,b.exports=d},{"./stacklayout":357}],357:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=0,f=0,g=0,h={x:0,y:0,width:0,height:0};if("horizontal"===a.orientation){for(c=a.children.length,d=0;d<c;d++)if(b=a.children[d],"%"!==b.widthUnit||"explicit"!==b.sizeMode&&"childHeight"!==b.sizeMode){var i=b.layout.measure(b);e+=i.width}else g+=b.width/100;f=Math.max(0,a.layoutRect.width-a.padding.left-a.padding.right-e)/g;var j=Math.round(a.padding.left);for(d=0;d<c;d++){b=a.children[d];var k=a.layoutRect.height-a.padding.top-a.padding.bottom;i=b.layout.layoutSize(b,f,k),h.x=j+b.positionX,h.width=Math.round(i.width),this.layoutChildVertically(h,b,i.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,h),j+=a.itemSpacing+b.layoutRect.width}}else{for(c=a.children.length,d=0;d<c;d++)b=a.children[d],"%"!==b.heightUnit||"explicit"!==b.sizeMode&&"childWidth"!==b.sizeMode?(i=b.layout.measure(b),e+=i.height):g+=b.height/100;f=Math.max(0,a.layoutRect.height-a.padding.top-a.padding.bottom-e)/g;var l=Math.round(a.padding.top);for(d=0;d<c;d++){b=a.children[d];var m=a.layoutRect.width-a.padding.left-a.padding.right;i=b.layout.layoutSize(b,m,f),this.layoutChildHorizontally(h,b,i.width,a.layoutRect,a.padding),h.y=l+b.positionY,h.height=Math.round(i.height),this.setChildLayoutRect(b,h),l+=a.itemSpacing+b.layoutRect.height}}a.needsRelayout=!1},d.prototype.measureChildrenWidth=function(a){if("horizontal"===a.orientation){for(var b=0,c=a.children.length,d=0;d<c;d++){var f=a.children[d],g=f.layout.measure(f);b+=g.width+(d!==c-1?a.itemSpacing:0)}return b}return e.prototype.measureChildrenWidth.call(this,a)},d.prototype.measureChildrenHeight=function(a){if("vertical"===a.orientation){for(var b=0,c=a.children.length,d=0;d<c;d++){var f=a.children[d],g=f.layout.measure(f);b+=g.height+(d!==c-1?a.itemSpacing:0)}return b}return e.prototype.measureChildrenHeight.call(this,a)},d.static=new d,b.exports=d},{"./docklayout":352}],358:[function(a,b,c){"use strict";var d=a("./mat3"),e=a("./mat4"),f=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],g={};g.create=function(){return{min:[0,0],max:[0,0]}},g.set=function(a,b,c,d,e){a.min[0]=b,a.min[1]=c,a.max[0]=d,a.max[1]=e},g.transform3=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],d.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;c<4;++c){var e=f[c];d.transformPoint(b,e),e[0]<a.min[0]&&(a.min[0]=e[0]),e[1]<a.min[1]&&(a.min[1]=e[1]),e[0]>a.max[0]&&(a.max[0]=e[0]),e[1]>a.max[1]&&(a.max[1]=e[1])}},g.transform4=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],e.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;c<4;++c){var d=f[c];e.transformPoint(b,d),d[0]<a.min[0]&&(a.min[0]=d[0]),d[1]<a.min[1]&&(a.min[1]=d[1]),d[0]>a.max[0]&&(a.max[0]=d[0]),d[1]>a.max[1]&&(a.max[1]=d[1])}},g.copy=function(a,b){a.min[0]=b.min[0],a.min[1]=b.min[1],a.max[0]=b.max[0],a.max[1]=b.max[1]},g.intersects=function(a,b){return!(a.min[0]>=b.max[0]||a.max[0]<=b.min[0]||a.min[1]>=b.max[1]||a.max[1]<=b.min[1])},g.union=function(a,b){b.min[0]<a.min[0]&&(a.min[0]=b.min[0]),b.min[1]<a.min[1]&&(a.min[1]=b.min[1]),b.max[0]>a.max[0]&&(a.max[0]=b.max[0]),b.max[1]>a.max[1]&&(a.max[1]=b.max[1])},g.width=function(a){return a.max[0]-a.min[0]},g.height=function(a){return a.max[1]-a.min[1]},g.isPointInside=function(a,b){return b[0]>=a.min[0]&&b[0]<=a.max[0]&&b[1]>=a.min[1]&&b[1]<=a.max[1]},g.intersection=function(a,b){a.min[0]=Math.max(a.min[0],b.min[0]),a.min[1]=Math.max(a.min[1],b.min[1]),a.max[0]=Math.min(a.max[0],b.max[0]),a.max[1]=Math.min(a.max[1],b.max[1])},b.exports=g},{"./mat3":359,"./mat4":360}],359:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(9);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.copy=function(a,b){for(var c=0;c<9;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},e.translate=function(a,b,c){return a[6]=b*a[0]+c*a[3]+a[6],a[7]=b*a[1]+c*a[4]+a[7],a[8]=b*a[2]+c*a[5]+a[8],a},e.rotate=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=Math.sin(b),m=Math.cos(b);return a[0]=m*c+l*f,a[1]=m*d+l*g,a[2]=m*e+l*h,a[3]=m*f-l*c,a[4]=m*g-l*d,a[5]=m*h-l*e,a[6]=i,a[7]=j,a[8]=k,a},e.scale=function(b,c,d){return b[0]=c*a[0],b[1]=c*a[1],b[2]=c*a[2],b[3]=d*a[3],b[4]=d*a[4],b[5]=d*a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.transformPoint=function(a,b){var c=b[0],d=b[1];b[0]=a[0]*c+a[3]*d+a[6],b[1]=a[1]*c+a[4]*d+a[7]},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=-j*e+g*h,m=i*e-f*h,n=b*k+c*l+d*m;return n?(n=1/n,a[0]=k*n,a[1]=(-j*c+d*i)*n,a[2]=(g*c-d*f)*n,a[3]=l*n,a[4]=(j*b-d*h)*n,a[5]=(-g*b+d*e)*n,a[6]=m*n,a[7]=(-i*b+c*h)*n,a[8]=(f*b-c*e)*n,a):null},c.exports=e},{}],360:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(16);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.copy=function(a,b){for(var c=0;c<16;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},e.translate=function(a,b,c,d){return a[12]=a[0]*b+a[4]*c+a[8]*d+a[12],a[13]=a[1]*b+a[5]*c+a[9]*d+a[13],a[14]=a[2]*b+a[6]*c+a[10]*d+a[14],a[15]=a[3]*b+a[7]*c+a[11]*d+a[15],a},e.rotateX=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];return a[4]=e*d+i*c,a[5]=f*d+j*c,a[6]=g*d+k*c,a[7]=h*d+l*c,a[8]=i*d-e*c,a[9]=j*d-f*c,a[10]=k*d-g*c,a[11]=l*d-h*c,a},e.rotateY=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];return a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d,a},e.rotateZ=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];return a[0]=e*d+i*c,a[1]=f*d+j*c,a[2]=g*d+k*c,a[3]=h*d+l*c,a[4]=i*d-e*c,a[5]=j*d-f*c,a[6]=k*d-g*c,a[7]=l*d-h*c,a},e.scale=function(b,c,d,e){return b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b[4]=a[4]*d,b[5]=a[5]*d,b[6]=a[6]*d,b[7]=a[7]*d,b[8]=a[8]*e,b[9]=a[9]*e,b[10]=a[10]*e,b[11]=a[11]*e,b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},e.transformPoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=a[3]*c+a[7]*d+a[11]*e+a[15];f=f||1,b[0]=(a[0]*c+a[4]*d+a[8]*e+a[12])/f,b[1]=(a[1]*c+a[5]*d+a[9]*e+a[13])/f,b[2]=(a[2]*c+a[6]*d+a[10]*e+a[14])/f},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p,D=r*C-s*B+t*A+u*z-v*y+w*x;return D?(D=1/D,a[0]=(g*C-h*B+i*A)*D,a[1]=(d*B-c*C-e*A)*D,a[2]=(o*w-p*v+q*u)*D,a[3]=(l*v-k*w-m*u)*D,a[4]=(h*z-f*C-i*y)*D,a[5]=(b*C-d*z+e*y)*D,a[6]=(p*t-n*w-q*s)*D,a[7]=(j*w-l*t+m*s)*D,a[8]=(f*B-g*z+i*x)*D,a[9]=(c*z-b*B-e*x)*D,a[10]=(n*v-o*t+q*r)*D,a[11]=(k*t-j*v-m*r)*D,a[12]=(g*y-f*A-h*x)*D,a[13]=(b*A-c*y+d*x)*D,a[14]=(o*s-n*u-p*r)*D,void(a[15]=(j*u-k*s+l*r)*D)):null},e.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},c.exports=e},{}],361:[function(a,b,c){"use strict";function d(a){g.call(this),this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.perspective="1000px",this.rootElement.style.webkitPerspective="1000px",a.appendChild(this.rootElement),document.ontouchstart=function(a){a.preventDefault()},this.clipAABB=f.create(),this.renderers=[],this.renderDepthSet={},this._resizeRootElement();var b=this;h.isMobile.Android()&&window.addEventListener("orientationchange",function(){window.setTimeout(b._resizeRootElement.bind(b),100)})}var e=a("./math/mat4"),f=a("./math/aabb"),g=a("../eventsender"),h=a("../useragent-utils"),i=a("lodash");d.prototype=Object.create(g.prototype),d.prototype.constructor=d,d.prototype._resizeRootElement=function(){h.isMobile.Android()?(this.rootElement.style.width=window.innerWidth+"px",this.rootElement.style.height=window.innerHeight+"px"):(this.rootElement.style.width="100%",this.rootElement.style.height="100%"),this.renderers.forEach(function(a){a.resizeRootElement&&a.resizeRootElement()}),this.emit("requestFrame")},d.prototype.removeAllRenderers=function(){this.renderers.forEach(function(a){a.detach&&a.detach()}),this.renderers=[]},d.prototype.addRenderer=function(a){a.setViewportSize&&a.setViewportSize(this.viewportWidth,this.viewportHeight),a.attach&&a.attach(this.rootElement),this.renderers.push(a)},d.prototype.createTextInputField=function(a){for(var b=0;b<this.renderers.length;b++){var c=this.renderers[b];if(c.createInputField)return c.createInputField(a)}},d.prototype.beginLayout=function(){this.renderDepthSet={}},d.prototype.layout=function(a,b){if(a.visible&&0!==a.opacity){a.contentDirty=!1;var c=a.layoutRect,d=a.localTransform,g=b||a.localTransformDirty;if(a.localTransformDirty&&(e.identity(d),d[0]=a.scaleX,d[5]=a.scaleY,d[12]=c.x+a.pivotXPx,d[13]=c.y+a.pivotYPx,d[14]=a.positionZ+a.pivotZPx,a.rotationX&&e.rotateX(d,a.rotationX),a.rotationY&&e.rotateY(d,a.rotationY),a.rotationZ&&e.rotateZ(d,a.rotationZ),e.translate(d,-a.pivotXPx,-a.pivotYPx,-a.pivotZPx),a.localTransformDirty=!1),g){e.multiply(a.transform,a.parent.transform,d);var h=a.screenAABB.min[0],i=a.screenAABB.min[1];f.set(a.screenAABB,0,0,c.width,c.height),f.transform4(a.screenAABB,a.transform),h!==a.screenAABB.min[0]&&a.emit("screenXChanged",a.screenAABB.min[0]),i!==a.screenAABB.min[1]&&a.emit("screenYChanged",a.screenAABB.min[1])}if(a.renderDepth=void 0!==a.depth?a.depth:a.parent.renderDepth||0,this.renderDepthSet[a.renderDepth]=!0,a.children){f.copy(a.childAABB,a.screenAABB);for(var j=0,k=a.children.length;j<k;j++){var l=a.children[j];this.layout(l,g),a.clip||f.union(a.childAABB,l.childAABB||l.screenAABB)}}}},d.prototype._addRenderCommand=function(a,b,c){if(void 0!==c)a[c].push(b);else for(var d=0;d<this.renderDepths.length;d++)a[this.renderDepths[d]].push(b)},d.prototype._collectRenderCommandsRecursive=function(a,b,c,d){if(a.visible&&0!==a.opacity&&f.intersects(this.clipAABB,a.childAABB||a.screenAABB)!==!1){if(a.clip){this._addRenderCommand(b,{content:{type:"pushClipRect"},id:a.id+"clip",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height});var e=f.create();f.copy(e,this.clipAABB),f.intersection(this.clipAABB,a.screenAABB)}var g=a.renderCommand;if(g&&("image"!==g.type||g.image)&&(g.opacity=a.opacity*d,this._addRenderCommand(b,{content:g,id:a.id,transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth)),g&&g.maskType&&"none"!==g.maskType){var h=i.clone(g);h.maskType="positive"===g.maskType?"negative":"positive",c.push({content:h,id:a.id+"-undoMask",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height})}if(a.children){for(var j=[],k=0,l=a.children.length;k<l;k++)this._collectRenderCommandsRecursive(a.children[k],b,j,a.opacity*d);for(var k=0,l=j.length;k<l;k++)this._addRenderCommand(b,j[k],a.renderDepth)}if(a.highlightEnabled&&this._addRenderCommand(b,{id:a.id+"-hl",content:{type:"rectangle",color:"#8BC6E9",opacity:.6,cornerRadius:0,blur:0},transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth),a.clip){for(var k=0;k<this.renderDepths.length;k++){var m=b[this.renderDepths[k]];"pushClipRect"===m[m.length-1].content.type?m.length=m.length-1:m.push({content:{type:"popClipRect"}})}f.copy(this.clipAABB,e)}}},d.prototype._collectRenderCommands=function(a){var b={};this.renderDepths=Object.keys(this.renderDepthSet);for(var c=0;c<this.renderDepths.length;c++)b[this.renderDepths[c]]=[];return this._collectRenderCommandsRecursive(a,b,[],1),b},d.prototype.render=function(a){var b=this._collectRenderCommands(a),c=Object.keys(b).sort();this.renderers.forEach(function(a){for(var d=0;d<c.length;d++)a.render(b[c[d]])})},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.renderers.forEach(function(c){c.setViewportSize&&c.setViewportSize(a,b)})},d.prototype.beginFrame=function(){f.set(this.clipAABB,0,0,this.viewportWidth,this.viewportHeight),this.renderers.forEach(function(a){a.beginFrame&&a.beginFrame()})},d.prototype.endFrame=function(){this.renderers.forEach(function(a){a.endFrame&&a.endFrame()})},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderers.forEach(function(b){b.setFillMode&&b.setFillMode(a)})},d.prototype.captureScreenShot=function(a,b,c){for(var d,e=0;e<this.renderers.length;e++){var f=this.renderers[e];if(f.rootElement&&"CANVAS"===f.rootElement.tagName){d=f;break}}if(d){var g=this.rootElement.style.width,h=this.rootElement.style.height;this.rootElement.style.width=b+"px",this.rootElement.style.height=c+"px",d.resizeRootElement(),d.beginFrame&&d.beginFrame();for(var i=this._collectRenderCommands(a),j=Object.keys(i).sort(),e=0;e<j.length;e++)d.render(i[j[e]]);d.endFrame&&d.endFrame();var k=d.rootElement.toDataURL();return this.rootElement.style.width=g,this.rootElement.style.height=h,d.resizeRootElement(),this.emit("requestFrame"),k}},d.prototype.onControlDisposed=function(a){this.renderers.forEach(function(b){b.removeResourcesForRenderCommand({id:a.id,content:a.renderCommand})})},d.prototype.clearImageCaches=function(){this.renderers.forEach(function(a){a.clearImageCache&&a.clearImageCache()})},b.exports=d},{"../eventsender":247,"../useragent-utils":384,"./math/aabb":358,"./math/mat4":360,lodash:145}],362:[function(a,b,c){"use strict";function d(a,b){e.call(this);var c=document.createElement("input");c.style.position="absolute",c.style.display="block",c.style.transformOrigin="0% 0%",c.style.padding="0px",c.style.margin="0px",c.style.border="none",c.style.outline="none",c.style.background="none",c.style.textAlign="left",c._noodlStyle={},this.element=c,this.inputListener=this.onInput.bind(this),this.blurListener=this.emit.bind(this,"blur"),c.addEventListener("keyup",this.inputListener),c.addEventListener("blur",this.blurListener),this.renderer=b,this.id=a}var e=a("../../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.onInput=function(){this.emit("inputChanged",this.element.value)},d.prototype.focus=function(){this.element.style.visibility="visible",this.element._noodlStyle.visibility="visible",
this.element.focus()},d.prototype.blur=function(){this.element.style.visibility="hidden",this.element._noodlStyle.visibility="hidden",this.element.blur()},d.prototype.setText=function(a){this.element.value=a},d.prototype.setType=function(a){this.element.type=a},d.prototype.dispose=function(){this.element.removeEventListener("input",this.inputListener),this.element.removeEventListener("blur",this.blurListener),this.renderer.removeInputField(this.id)},b.exports=d},{"../../../eventsender":247}],363:[function(a,b,c){"use strict";function d(a){this.rootElement=document.createElement(a.rootElementTag),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.overflow="hidden",this.rootElement.style.pointerEvents="none",this.fillMode="aspectFit",this.viewportWidth=0,this.viewportHeight=0,this.onResizeCallback=a.onResize,this.onWindowResizeHandler=this._windowResizeListener.bind(this)}d.prototype._windowResizeListener=function(){"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.attach=function(a){a.appendChild(this.rootElement),window.addEventListener("resize",this.onWindowResizeHandler),this.resizeRootElement()},d.prototype.detach=function(){window.removeEventListener("resize",this.onWindowResizeHandler),this.rootElement.parentNode&&this.rootElement.parentNode.removeChild(this.rootElement)},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.rootElement.parentNode&&"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype._calculateAspectFit=function(){var a=this.viewportWidth,b=this.viewportHeight,c=1,d=1,e=a/b,f=this.rootElement.parentElement.getBoundingClientRect(),g=f.width/f.height;return e/g>1?d=g/e:c=e/g,{width:f.width*c,height:f.height*d}},d.prototype.resizeRootElementAspectFit=function(){var a=this._calculateAspectFit();this.rootElement.style.width=a.width+"px",this.rootElement.style.height=a.height+"px";var b=this.rootElement.parentElement.getBoundingClientRect(),c=Math.round(b.width-a.width)/2+"px",d=Math.round(b.height-a.height)/2+"px";this.rootElement.style.transform="translate("+c+","+d+")",this.rootElement.style.webkitTransform=this.rootElement.style.transform},d.prototype.resizeRootElementFill=function(){this.rootElement.style.width="100%",this.rootElement.style.height="100%",this.rootElement.style.transform="",this.rootElement.style.webkitTransform=""},d.prototype.resizeRootElement=function(){"aspectFit"===this.fillMode?this.resizeRootElementAspectFit():this.resizeRootElementFill(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.setFillMode=function(a){this.fillMode=a,this.resizeRootElement()},b.exports=d},{}],364:[function(a,b,c){"use strict";function d(a){e.call(this,{rootElementTag:"canvas",onResize:this._onResize.bind(this)}),this.useScreenResolution=!!a.useScreenResolution}var e=a("./renderer-base");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onResize=function(){this.resizeCanvasBuffer()},d.prototype.resizeCanvasBuffer=function(){var a=this.rootElement.getBoundingClientRect(),b=window.devicePixelRatio||1;if("aspectFit"===this.fillMode){var c=Math.max(a.width*b/this.viewportWidth,a.height*b/this.viewportHeight);this.useScreenResolution===!1&&(c=Math.max(1,Math.round(c))),this.rootElement.width=this.viewportWidth*c,this.rootElement.height=this.viewportHeight*c,this.renderScale=this.rootElement.width/this.viewportWidth}else this.rootElement.width=a.width*b,this.rootElement.height=a.height*b,this.renderScale=b},b.exports=d},{"./renderer-base":363}],365:[function(a,b,c){"use strict";function d(a){j.call(this,a),this.coloredImagesCache=new k,this.rectangleBlurEdgeCache=new k,this.circleBlurCache=new k,this.circleStrokeBlurCache=new k,this.circleStrokeCache=new k,this.ctx=this.rootElement.getContext("2d",{alpha:!!a.alpha})}function e(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a,b,c){var d=Math.max(0,Math.min(1,(c-a)/(b-a)));return d*d*(3-2*d)}function g(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=1,c.height=a;var g=d.createImageData(1,a);e(l,b);for(var h=0;h<a;h++){var i=f(0,1,h/(a-1));g.data[4*h]=l[0],g.data[4*h+1]=l[1],g.data[4*h+2]=l[2],g.data[4*h+3]=255*i}return d.putImageData(g,0,0),c}function h(a,b,c){var d=document.createElement("canvas"),g=d.getContext("2d");d.width=a+b,d.height=a+b;var h=g.createImageData(a+b,a+b);e(l,c);for(var i=0;i<h.height;i++)for(var j=0;j<h.width;j++){var k=Math.sqrt(j*j+i*i)-a,m=f(1,0,k/b),n=h.width-1-j+(h.height-1-i)*h.width;h.data[4*n]=l[0],h.data[4*n+1]=l[1],h.data[4*n+2]=l[2],h.data[4*n+3]=255*m}return g.putImageData(h,0,0),d}function i(a,b,c,d){var g=document.createElement("canvas"),h=g.getContext("2d");g.width=a+b,g.height=a+b;var i=h.createImageData(a+b,a+b);e(l,d);for(var j=0;j<i.height;j++)for(var k=0;k<i.width;k++){var m=Math.sqrt(k*k+j*j),n=0;m>=a-c-b&&m<=a-c?n=f(a-c-b,a-c,m):m>a-c&&m<a?n=1:m>=a&&(n=1-f(a,a+b,m));var o=i.width-1-k+(i.height-1-j)*i.width;i.data[4*o]=l[0],i.data[4*o+1]=l[1],i.data[4*o+2]=l[2],i.data[4*o+3]=255*n}return h.putImageData(i,0,0),g}var j=a("./renderer-canvas-base"),k=a("../resourcecache");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.beginFrame=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.globalAlpha=1,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.toPixel(this.viewportWidth),this.toPixel(this.viewportHeight))},d.prototype.endFrame=function(){},d.prototype.render=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.content.type;"pushClipRect"===d?this.pushClipRect(c):"popClipRect"===d?this.popClipRect():this._renderContent(c)}},d.prototype.drawColoredImage=function(a,b,c){var d=b.src+"."+c;if(this.coloredImagesCache.isInCache(d)===!1){var e=document.createElement("canvas");e.width=b.width,e.height=b.height;var f=e.getContext("2d",{alpha:!0});f.clearRect(0,0,e.width,e.height),f.drawImage(b,0,0,b.width,b.height),f.globalCompositeOperation="source-in",f.fillStyle=c,f.fillRect(0,0,b.width,b.height),this.coloredImagesCache.addResource(d,e)}return this.coloredImagesCache.updateReference(a,d),this.coloredImagesCache.getResource(d)},d.prototype._drawRoundedRect=function(a,b,c){a<2*c&&(c=a/2),b<2*c&&(c=b/2),this.ctx.beginPath(),this.ctx.moveTo(c,0),this.ctx.arcTo(a,0,a,b,c),this.ctx.arcTo(a,b,0,b,c),this.ctx.arcTo(0,b,0,0,c),this.ctx.arcTo(0,0,a,0,c),this.ctx.closePath(),this.ctx.fill()};var l=[0,0,0];d.prototype._drawRectangleBlurred=function(a,b,c,d,f,i){b<2*d&&(d=b/2),c<2*d&&(d=c/2),d>0?(this.ctx.fillRect(d,0,b-2*d,d),this.ctx.fillRect(0,d,b,c-2*d),this.ctx.fillRect(d,c-d,b-2*d,d)):this.ctx.fillRect(0,0,b,c),e(l,i);var j=i+f;this.rectangleBlurEdgeCache.isInCache(j)===!1&&this.rectangleBlurEdgeCache.addResource(j,g(f,i)),this.rectangleBlurEdgeCache.updateReference(a,j);var k=i+d+"."+f;this.circleBlurCache.isInCache(k)===!1&&this.circleBlurCache.addResource(k,h(d,f,i)),this.circleBlurCache.updateReference(a,k);var m=this.rectangleBlurEdgeCache.getResource(j),n=this.circleBlurCache.getResource(k);this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.save(),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-c),this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.restore()},d.prototype._drawCircleBlurred=function(a,b,c,d,e){var f=d+b+"."+c;this.circleBlurCache.isInCache(f)===!1&&this.circleBlurCache.addResource(f,h(b,c,d)),this.circleBlurCache.updateReference(a,f);var g=this.circleBlurCache.getResource(f);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype._drawCircleStrokeBlurred=function(a,b,c,d,e,f){var g=d+b+"."+c+"."+f;this.circleStrokeBlurCache.isInCache(g)===!1&&this.circleStrokeBlurCache.addResource(g,i(b,c,f,d)),this.circleStrokeBlurCache.updateReference(a,g);var h=this.circleStrokeBlurCache.getResource(g);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype.toPixel=function(a){return a*this.renderScale},d.prototype._renderContent=function(a){var b=a.content.type;switch(this._setTransform(a.transform),this.ctx.globalAlpha=a.content.opacity,a.content.blendMode){case"alpha":this.ctx.globalCompositeOperation="source-over";break;case"solid":this.ctx.globalCompositeOperation="source-over";break;case"additive":this.ctx.globalCompositeOperation="lighter";break;case"multiply":this.ctx.globalCompositeOperation="multiply"}if("rectangle"===b){this.ctx.fillStyle=a.content.color;var c=Math.floor(this.toPixel(a.content.blur));c>0?this._drawRectangleBlurred(a.id,this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.blur,a.content.color):a.content.cornerRadius>0?this._drawRoundedRect(this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius)):this.ctx.fillRect(0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("image"===b&&a.content.image){var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("text"===b&&a.content.text){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';for(var e=0;e<a.content.lines.length;e++){var f=a.content.lines[e];this.ctx.fillText(f.text,this.toPixel(f.x),this.toPixel(f.y))}}else if("textInput"===b&&a.content.text&&!a.content.focused){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';var g=.5*(a.height-a.content.textHeight);this.ctx.fillText(a.content.text,0,this.toPixel(g+a.content.baseline))}else if("circle"===b){var h=a.width/2,c=Math.floor(this.toPixel(a.content.blur));if(c>1)a.content.solid?this._drawCircleBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle):this._drawCircleStrokeBlurred(a.id,Math.floor(this.toPixel(h)),c,a.content.color,a.content.arcAngle,Math.floor(this.toPixel(a.content.lineWidth)));else{var i=a.width/2,g=a.height/2;if(this.ctx.beginPath(),a.content.solid||(h-=.5*a.content.lineWidth),this.ctx.arc(this.toPixel(i),this.toPixel(g),this.toPixel(h),-Math.PI/2,-Math.PI/2+a.content.arcAngle,!1),a.content.solid)if(a.content.arcAngle<2*Math.PI&&this.ctx.lineTo(this.toPixel(i),this.toPixel(g)),a.content.image){this.ctx.save(),this.ctx.clip();var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.restore()}else this.ctx.fillStyle=a.content.color,this.ctx.fill();else this.ctx.strokeStyle=a.content.color,this.ctx.lineWidth=Math.max(1,this.toPixel(a.content.lineWidth)),this.ctx.stroke()}}},d.prototype._setTransform=function(a){this.ctx.setTransform(a[0],a[1],a[4],a[5],this.toPixel(a[12]),this.toPixel(a[13]))},d.prototype.pushClipRect=function(a){this._setTransform(a.transform),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.clip()},d.prototype.popClipRect=function(){this.ctx.restore()},d.prototype.removeResourcesForRenderCommand=function(a){"image"===a.content.type||"circle"===a.content.type?this.coloredImagesCache.removeReference(a.id):"rectangle"===a.content.type?(this.rectangleBlurEdgeCache.removeReference(a.id),this.circleBlurCache.removeReference(a.id)):"circle"===a.content.type&&(this.circleBlurCache.removeReference(a.id),this.circleStrokeBlurCache.removeReference(a.id),this.circleStrokeCache.removeReference(a.id))},d.prototype.detach=function(){j.prototype.detach.call(this),this.coloredImagesCache.clear(),this.rectangleBlurEdgeCache.clear(),this.circleBlurCache.clear(),this.circleStrokeBlurCache.clear(),this.circleStrokeCache.clear()},b.exports=d},{"../resourcecache":377,"./renderer-canvas-base":364}],366:[function(a,b,c){"use strict";function d(a){var b=document.createElement(a);return b.style.position="absolute",b.style.display="block",b.style.pointerEvents="none",b.style.transformOrigin="0% 0%",b._noodlStyle={},b}function e(){j.call(this,{rootElementTag:"div",onResize:this._onResize.bind(this)}),this.rootElement.style.transformStyle="preserve-3d",this.rootElement.style.webkitTransformStyle="preserve-3d",this.elements={},this.unusedElements={},this.transformStack=[],this.textFields={},this.renderTextInputOnly=!1}function f(a,b,c){a._noodlStyle[b]!==c&&(a.style[b]=c,a._noodlStyle[b]=c)}function g(a,b,c){if(a.parentNode!==b||a.index!==c){c<b.children.length-1?b.insertBefore(a,b.children[c+1]):b.appendChild(a);for(var d=0;d<b.children.length;d++)b.children[d].index=d}}var h=a("../math/mat4"),i=a("./dom/dominputfield"),j=a("./renderer-base");e.prototype=Object.create(j.prototype),e.prototype.constructor=e,e.prototype.setRenderInputFieldsOnly=function(a){this.renderTextInputOnly=a},e.prototype._onResize=function(){"aspectFit"===this.fillMode?this.renderScale=this.rootElement.getBoundingClientRect().width/this.viewportWidth:this.renderScale=1},e.prototype._removeUnusedElements=function(){for(var a in this.elements)if(!this.elementsThisFrame[a]){var b=this.elements[a],c=b.parentNode;c.removeChild(b),delete this.elements[a],this.unusedElements[a]=b,b.index=void 0;for(var d=0;d<c.children.length;d++)c.children[d].index=d}},e.prototype._getTextInputCommands=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;"textInput"!==e&&"pushClipRect"!==e&&"popClipRect"!==e||("popClipRect"===d.content.type&&"pushClipRect"===b[b.length-1].content.type?b.length=b.length-1:b.push(d))}return b},e.prototype.render=function(a){var b=[0];this.parentElement=this.rootElement,this.elementsThisFrame={},this.renderTextInputOnly&&(a=this._getTextInputCommands(a));for(var c=0;c<a.length;c++){var d=a[c],e=d.content.type;"pushClipRect"===e?(this.pushClipRect(d,b[b.length-1]),b[b.length-1]++,b.push(0)):"popClipRect"===e?(this.popClipRect(),b.pop()):(this._renderContent(d,b[b.length-1]),b[b.length-1]++)}this._removeUnusedElements()};var k=h.create();e.prototype._setTransform=function(a,b){this.transformStack.length&&(h.identity(k),h.multiply(k,this.transformStack[this.transformStack.length-1],k),h.multiply(k,k,b),b=k);var c="matrix3d("+b[0]+","+b[1]+","+b[2]+","+b[3]+","+b[4]+","+b[5]+","+b[6]+","+b[7]+","+b[8]+","+b[9]+","+b[10]+","+b[11]+","+b[12]*this.renderScale+","+b[13]*this.renderScale+","+b[14]*this.renderScale+","+b[15]+")";a._noodlStyle.transform!==c&&(a._noodlStyle.transform=c,a.style.transform=c,a.style.webkitTransform=c)},e.prototype.createInputField=function(a){var b=new i(a,this);return this.textFields[a]=b,b},e.prototype.removeInputField=function(a){delete this.textFields[a]},e.prototype._renderContent=function(a,b){var c=a.id,e=a.content.type;if(!this.elements[c]){var h;this.unusedElements[c]?(h=this.unusedElements[c],delete this.unusedElements[c]):"rectangle"===e?h=d("div"):"image"===e?(h=d("div"),h.style.backgroundSize="100% 100%"):"text"===e?(h=d("div"),h.style.whiteSpace="nowrap"):"circle"===e?(h=d("div"),h.style.borderRadius="50%"):"textInput"===e&&(h=this.textFields[c].element),h.className=e,this.elements[c]=h}this.elementsThisFrame[c]=!0;var i=this.elements[c];g(i,this.parentElement,b),this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),f(i,"opacity",a.content.opacity),"rectangle"===e?(f(i,"backgroundColor",a.content.color),f(i,"borderRadius",.5*a.content.cornerRadius+"px")):"image"===e?(f(i,"backgroundImage","url("+a.content.image.src+")"),"#ffffff"!==a.content.color?(f(i,"backgroundColor",a.content.color),f(i,"backgroundBlendMode","overlay"),f(i,"isolation","isolate")):(f(i,"backgroundColor",void 0),f(i,"backgroundBlendMode","normal"))):"text"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),f(i,"textAlign",a.content.horizontalAlignment),f(i,"lineHeight",a.content.lineHeight?a.content.lineHeight*this.renderScale+"px":"normal"),i.innerText!==a.content.text&&(i.innerText=a.content.text)):"textInput"===e?(f(i,"color",a.content.color),f(i,"fontFamily",a.content.fontFamily),f(i,"fontSize",a.content.fontSize*this.renderScale+"px"),a.content.focused||i.value===a.content.text||(i.value=a.content.text),this.renderTextInputOnly&&!a.content.focused&&f(i,"visibility","hidden")):"circle"===e&&(a.content.solid?f(i,"backgroundColor",a.content.color):f(i,"border",a.content.lineWidth+"px solid "+a.content.color))},e.prototype.pushClipRect=function(a,b){var c=a.id;if(!this.elements[c]){var e=d("div");e._noodlStyle={},e.style.overflow="hidden",this.elements[c]=e}this.elementsThisFrame[c]=!0;var i=this.elements[c];this._setTransform(i,a.transform),f(i,"width",a.width*this.renderScale+"px"),f(i,"height",a.height*this.renderScale+"px"),g(i,this.parentElement,b);var j=h.create();h.copy(j,a.transform),h.invert(j),this.transformStack.push(j),this.parentElement=i},e.prototype.popClipRect=function(){this.parentElement=this.parentElement.parentNode,this.transformStack.pop()},e.prototype.removeResourcesForRenderCommand=function(a){},b.exports=e},{"../math/mat4":360,"./dom/dominputfield":362,"./renderer-base":363}],367:[function(a,b,c){"use strict";function d(a){m.call(this,a);var b=this.rootElement.getContext("webgl",{alpha:!!a.alpha,stencil:!0});this.webGLHelper=new p(b,1080,1920),this.defaultShader=this.createShader({vertexSource:this.webGLHelper._defaultVsSource,fragmentSource:this.webGLHelper._defaultFsSource}),this.defaultTextShader=this._createDefaultTextShader(),this.clipRects=[o.create()],this.defaultMesh=this.webGLHelper.createMesh(),this.numVerticesThisFrame=0,this.textCache=new q(this.webGLHelper),this.circleCache={},this.roundedRectCache={},this.textureCache=new t(this.webGLHelper),this.tempVertices=new Float32Array(u*this.defaultShader.numComponentsPerVertex)}function e(a,b,c,d,e,f,g){a[0]=0,a[1]=0,a[2]=0,b[0]=e,b[1]=0,b[2]=0,c[0]=0,c[1]=f,c[2]=0,d[0]=e,d[1]=f,d[2]=0,n.transformPoint(g,a),n.transformPoint(g,b),n.transformPoint(g,c),n.transformPoint(g,d)}function f(a,b,c,d,e,f,g,h){var i=g.width,j=g.height;a[0]<h.min[0]&&(e[0]=(h.min[0]-a[0])/i,a[0]=h.min[0],c[0]=h.min[0]),a[1]<h.min[1]&&(e[1]=(h.min[1]-a[1])/j,a[1]=h.min[1],b[1]=h.min[1]),b[0]>h.max[0]&&(f[0]=(b[0]-h.max[0])/i,b[0]=h.max[0],d[0]=h.max[0]),c[1]>h.max[1]&&(f[1]=(c[1]-h.max[1])/j,c[1]=h.max[1],d[1]=h.max[1])}function g(a,b,c,d,e,f){var g=Math.min(a[0],b[0],c[0],d[0]),h=Math.min(a[1],b[1],c[1],d[1]),i=Math.max(a[0],b[0],c[0],d[0]),j=Math.max(a[1],b[1],c[1],d[1]),k=g<f.min[0]||h<f.min[1]||i>f.max[0]||j>f.max[1];k&&(e.scissorTest=!0,e.scissorRect[0]=f.min[0],e.scissorRect[1]=f.min[1],e.scissorRect[2]=f.max[0],e.scissorRect[3]=f.max[1])}function h(a){return 1!==a[0]||1!==a[5]||1!==a[10]}function i(a){return 0!==a[1]||0!==a[2]||0!==a[4]||0!==a[6]||0!==a[8]||0!==a[9]}function j(a,b){for(var c=0;c<3;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)/255}}function k(a,b,c,d){var j=b.transform;e(w,x,y,z,b.width,b.height,j),A[0]=0,A[1]=0,B[0]=0,B[1]=0;var k=i(j)||h(j);k||0!==j[14]?g(w,x,y,z,c,d):f(w,x,y,z,A,B,b,d);var l=c.srcRect,m=l[2]-l[0],n=l[3]-l[1],o=c.color;a[0]=w[0],a[1]=w[1],a[2]=w[2],a[3]=l[0]+A[0]*m,a[4]=l[1]+A[1]*n,a[5]=o[0]*b.content.opacity,a[6]=o[1]*b.content.opacity,a[7]=o[2]*b.content.opacity,a[8]=b.content.opacity,a[9]=x[0],a[10]=x[1],a[11]=x[2],a[12]=l[2]-B[0]*m,a[13]=a[4],a[14]=a[5],a[15]=a[6],a[16]=a[7],a[17]=a[8],a[18]=y[0],a[19]=y[1],a[20]=y[2],a[21]=a[3],a[22]=l[3]-B[1]*n,a[23]=a[5],a[24]=a[6],a[25]=a[7],a[26]=a[8],a[27]=z[0],a[28]=z[1],a[29]=z[2],a[30]=a[12],a[31]=a[22],a[32]=a[5],a[33]=a[6],a[34]=a[7],a[35]=a[8]}function l(a,b,c,d,f){d.mesh=a,d.shader=b,b&&b.standardUniforms.u_world!==-1&&(d.worldTransform=c.transform),e(w,x,y,z,c.width,c.height,c.transform),g(w,x,y,z,d,f)}var m=a("./renderer-canvas-base"),n=a("../math/mat4"),o=a("../math/aabb"),p=a("./webgl/webglhelper"),q=a("./webgl/text-cache"),r=a("./webgl/circle"),s=a("./webgl/roundedrect"),t=a("./webgl/texturecache"),u=4;d.prototype=Object.create(m.prototype),d.prototype.constructor=d,d.prototype.createShader=function(a){return this.webGLHelper.createShader(a)},d.prototype._onResize=function(){m.prototype._onResize.call(this),o.set(this.clipRects[0],0,0,this.viewportWidth,this.viewportHeight),this.webGLHelper.setVirtualSize(this.viewportWidth,this.viewportHeight),this.webGLHelper.setRenderBufferSize(this.rootElement.width,this.rootElement.height)},d.prototype.render=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;if("pushClipRect"===e)this.pushClipRect(d);else if("popClipRect"===e)this.popClipRect();else{var f="textInput"===d.content.type&&d.content.focused;f===!1&&this._renderContent(d,b)}}for(c=0;c<b.length;c++)this.webGLHelper.executeRenderCommand(b[c])},d.prototype.pushClipRect=function(a){var b=o.create();o.set(b,0,0,a.width,a.height),o.transform4(b,a.transform),o.intersection(b,this.clipRects[this.clipRects.length-1]),this.clipRects.push(b)},d.prototype.popClipRect=function(){this.clipRects.pop()};var v=[0,0,1,1];d.prototype._renderContent=function(a,b){var c={texture:null,blendMode:p.BlendMode.Alpha,mesh:null,depthTest:!1,vertexIndex:-1,opacity:a.content.opacity,scissorTest:!1,scissorRect:[0,0,0,0],srcRect:a.content.srcRect||v,flipTexCoordY:0,writeToStencil:!1,maskIsPositive:!1,shader:this.defaultShader,worldTransform:null,color:[0,0,0]};switch(a.content.shader&&(c.shader=a.content.shader,a.content.shaderUniforms&&(c.shaderUniforms=a.content.shaderUniforms)),a.content.blendMode){case"alpha":c.blendMode=p.BlendMode.Alpha;break;case"solid":c.blendMode=p.BlendMode.Solid;break;case"additive":c.blendMode=p.BlendMode.Additive;break;case"multiply":c.blendMode=p.BlendMode.Multiply}if("solid"===a.content.blendMode&&a.content.opacity<1&&(c.blendMode=p.BlendMode.Alpha),a.content.maskType&&"none"!==a.content.maskType&&(c.writeToStencil=!0,c.maskIsPositive="positive"===a.content.maskType),j(c.color,a.content.color),a.content.image?(c.texture=this.textureCache.getTexture(a.content.imagePath,a.content.image),c.texture.refCount=1,c.texture.videoDOMNode&&c.texture.updateVideoTexture()):"text"===a.content.type||"textInput"===a.content.type?(c.texture=this.textCache.getTextTexture(a,this.renderScale,a.content.color),c.shader=this.defaultTextShader):c.texture=this.webGLHelper.whiteTexture(),"circle"===a.content.type){var d=this._getCircle(a);this.circleShader||(this.circleShader=r.createShader(this.webGLHelper)),l(d.getMesh(),this.circleShader,a,c,this.clipRects[this.clipRects.length-1])}else if("rectangle"===a.content.type&&s.cornerTooSmall(a.content.cornerRadius,a.content.blur)===!1){var e=this._getRoundedRectangle(a);this.roundedRectangleShader||(this.roundedRectangleShader=s.createShader(this.webGLHelper)),l(e.getMesh(),this.roundedRectangleShader,a,c,this.clipRects[this.clipRects.length-1])}else"mesh"===a.content.type&&a.content.mesh&&a.content.shader&&a.content.mesh.vertices&&a.content.mesh.vertices.length>0?l(a.content.mesh,a.content.shader,a,c,this.clipRects[this.clipRects.length-1]):(k(this.tempVertices,a,c,this.clipRects[this.clipRects.length-1]),c.vertexIndex=this.numVerticesThisFrame,this.numVerticesThisFrame+=this.tempVertices.length,this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex>this.defaultMesh.vertices.length&&(this.defaultMesh.vertices=new Float32Array(this.numVerticesThisFrame*this.defaultShader.numComponentsPerVertex*u*2)),c.mesh=this.defaultMesh,this.defaultMesh.vertices.set(this.tempVertices,c.vertexIndex*this.defaultShader.numComponentsPerVertex),this.defaultMesh.vertexDataDirty=!0);b.push(c)},d.prototype.removeResourcesForRenderCommand=function(a){"rectangle"===a.content.type&&this.roundedRectCache.hasOwnProperty(a.id)?(this.roundedRectCache[a.id].dispose(),delete this.roundedRectCache[a.id]):"circle"===a.content.type&&this.circleCache.hasOwnProperty(a.id)?(this.circleCache[a.id].dispose(),delete this.circleCache[a.id]):"text"!==a.content.type&&"textInput"!==a.content.type||this.textCache.textResourceRemoved(a.id)},d.prototype.beginFrame=function(){this.webGLHelper.beginFrame(),this.webGLHelper.bindRenderTarget(0),this.numVerticesThisFrame=0},d.prototype.endFrame=function(){},d.prototype._getCircle=function(a){this.circleCache[a.id]||(this.circleCache[a.id]=new r(this.webGLHelper));var b=this.circleCache[a.id];return b.setSize(a.width),b.setArcAngle(a.content.arcAngle),b.setSolid(a.content.solid),b.setLineWidth(a.content.lineWidth),b.setBlur(Math.max(1,a.content.blur)),b.updateMesh(),b},d.prototype._getRoundedRectangle=function(a){this.roundedRectCache[a.id]||(this.roundedRectCache[a.id]=new s(this.webGLHelper));var b=this.roundedRectCache[a.id];return b.setWidth(a.width),b.setHeight(a.height),b.setBlur(a.content.blur),b.setCornerRadius(a.content.cornerRadius),b.updateMesh(),b},d.prototype.detach=function(){m.prototype.detach.call(this),this.textCache.clear(),this.textureCache.clear();var a=this.roundedRectCache;Object.keys(a).forEach(function(b){a[b].dispose()});var b=this.circleCache;Object.keys(b).forEach(function(a){b[a].dispose()})},d.prototype.clearImageCache=function(){this.textureCache.clear()};var w=[0,0,0],x=[0,0,0],y=[0,0,0],z=[0,0,0],A=[0,0],B=[0,0];d.prototype._createDefaultTextShader=function(){return this.createShader({vertexSource:["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),fragmentSource:["uniform sampler2D texture;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 texColor = texture2D(texture, uv);","    gl_FragColor = texColor*color.a;","}"].join("\n")})},b.exports=d},{"../math/aabb":358,"../math/mat4":360,"./renderer-canvas-base":364,"./webgl/circle":368,"./webgl/roundedrect":371,"./webgl/text-cache":373,"./webgl/texturecache":375,"./webgl/webglhelper":376}],368:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){b=b||{},this.solid=!b.hasOwnProperty("solid")||b.solid,this.radius=b.size/2||100,this.lineWidth=b.lineWidth||1,this.blurDistance=b.hasOwnProperty("blur")?b.blur:2,this.arcAngle=b.hasOwnProperty("arcAngle")?d(0,2*Math.PI,b.arcAngle):2*Math.PI,this.error=b.error||.075,this.meshDirty=!0,this._calculateVertices(),this.mesh=a.createMesh({vertices:this.vertices,indices:this.indices,primitiveType:g.PrimitiveType.TriangleStrip})}function f(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float aBlur;","attribute float aVertexOpacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = aBlur;","   vertexOpacity = aVertexOpacity;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur*vertexOpacity);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})}var g=a("./mesh");e.prototype._calculateVertices=function(){function a(a,c,d,e){var f=Math.cos(d-.5*Math.PI),g=Math.sin(d-.5*Math.PI);n[i++]=a+b*f,n[i++]=c+b*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e,n[i++]=a+p*f,n[i++]=c+p*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+j*f,n[i++]=c+j*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+k*f,n[i++]=c+k*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e}var b=this.radius+this.blurDistance,c=Math.acos(2*(1-this.error/b)*(1-this.error/b)-1),d=Math.ceil(this.arcAngle/c),e=24,f=this.arcAngle<2*Math.PI;this.arcAngle>0&&d<4&&(d=2);var g=d;f&&(g+=2);var h=g*e;this.vertices&&this.vertices.length===h||(this.vertices=new Float32Array(h));var i=0,j=this.radius-this.lineWidth,k=j-this.blurDistance,l=this.radius,m=this.radius;this.solid&&(j=0,k=0);var n=this.vertices,o=this.blurDistance,p=this.radius;f&&a(l,m-this.blurDistance,0,0);var q;for(q=0;q<d;++q){var r=q/(d-1),s=this.arcAngle*r;a(l,m,s,1)}f&&a(l-Math.sin(this.arcAngle)*o,m+Math.cos(this.arcAngle)*o,this.arcAngle,0);var t=8*(g-1);for(this.indices&&this.indices.length===t||(this.indices=new Uint16Array(t)),i=0,q=0;q<g-1;++q){var u;if(q%2===0)for(u=0;u<4;++u)this.indices[i++]=4*q+u,this.indices[i++]=4*(q+1)+u;else for(u=0;u<4;++u)this.indices[i++]=4*q+3-u,this.indices[i++]=4*(q+1)+3-u}},e.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._calculateVertices(),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0,this.meshDirty=!1)},e.prototype.setSize=function(a){this.radius!==a/2&&(this.radius=a/2,this.meshDirty=!0)},e.prototype.setLineWidth=function(a){this.lineWidth!==a&&(this.lineWidth=a,this.meshDirty=!0)},e.prototype.setSolid=function(a){this.solid!==a&&(this.solid=a,this.meshDirty=!0)},e.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},e.prototype.setArcAngle=function(a){a=d(0,2*Math.PI,a),this.arcAngle!==a&&(this.arcAngle=a,this.meshDirty=!0)},e.prototype.getMesh=function(){return this.mesh},e.prototype.dispose=function(){this.mesh.dispose()},e.createShader=function(a){return f(a)},b.exports=e},{"./mesh":370}],369:[function(a,b,c){"use strict";function d(a,b){this.texture=b.texture;var c,d,e=a.getParameter(a.FRAMEBUFFER_BINDING),f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture.handle,0),d=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,d),b.depthBuffer&&(c=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,c),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c));var g=a.checkFramebufferStatus(a.FRAMEBUFFER);switch(g){case a.FRAMEBUFFER_COMPLETE:break;case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case a.FRAMEBUFFER_UNSUPPORTED:console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:console.log("Incomplete framebuffer: "+g)}a.bindFramebuffer(a.FRAMEBUFFER,e),this.fbo=f,this.gl=a,this.width=b.width,this.height=b.height}b.exports=d},{}],370:[function(a,b,c){"use strict";function d(a,b){b=b||{},void 0===b.vertices&&(b.vertices=new Float32Array(0)),b.vertices instanceof Float32Array==!1&&console.error("Vertices must be of type Float32Array"),b.indices&&b.indices instanceof Uint16Array==!1&&console.error("Indices must be of type Uint16Array"),this.gl=a,this.vertexBuffer=a.createBuffer(),this.vertices=b.vertices,this.indexBuffer=null,this.indices=b.indices,b.primitiveType===d.PrimitiveType.Triangles?this.primitiveType=a.TRIANGLES:b.primitiveType===d.PrimitiveType.Lines?this.primitiveType=a.LINES:b.primitiveType===d.PrimitiveType.LineStrip?this.primitiveType=a.LINE_STRIP:b.primitiveType===d.PrimitiveType.TriangleFan?this.primitiveType=a.TRIANGLE_FAN:this.primitiveType=a.TRIANGLE_STRIP,this.vertexDataDirty=!0}d.prototype.bind=function(a,b){var c=this.gl;this.numComponentsPerVertex=b,c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);var d,e=0;for(d=c.numVertexAttribsEnabled;d<a.length;++d)c.enableVertexAttribArray(d);for(d=a.length;d<c.numVertexAttribsEnabled;++d)c.disableVertexAttribArray(d);for(c.numVertexAttribsEnabled=a.length,d=0;d<a.length;++d){var f=a[d];c.vertexAttribPointer(d,f.numComponents,c.FLOAT,!1,4*b,4*e),e+=f.numComponents}null===this.indexBuffer&&this.indices&&this.indices.length>0&&(this.indexBuffer=c.createBuffer()),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},d.prototype.syncVertexData=function(){var a=this.gl;this.vertexDataDirty&&(this.indices&&this.indices.length>0&&a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.STREAM_DRAW),this.vertexDataDirty=!1)},d.prototype.draw=function(){this.syncVertexData();var a=this.gl,b=0;this.indexBuffer?a.drawElements(this.primitiveType,this.indices.length,a.UNSIGNED_SHORT,0):(b=this.vertices.length/this.numComponentsPerVertex,a.drawArrays(this.primitiveType,0,b))},d.prototype.drawVertexRange=function(a,b){this.syncVertexData();var c=this.gl;this.indexBuffer?c.drawElements(this.primitiveType,b,c.UNSIGNED_SHORT,2*a):c.drawArrays(this.primitiveType,a,b)},d.prototype.dispose=function(){this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer)},d.PrimitiveType={TriangleStrip:0,Triangles:1,Lines:2,LineStrip:3,TriangleFan:4},b.exports=d},{}],371:[function(a,b,c){"use strict";function d(a){this.width=0,this.height=0,this.mesh=a.createMesh({vertices:new Float32Array(0),indices:new Uint16Array(0),primitiveType:e.PrimitiveType.TriangleStrip})}var e=a("./mesh");d.createShader=function(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float a_blur;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = a_blur;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})},d.prototype._generateMesh=function(){function a(a){return(a.numSegments+1)*s}function b(){var b=0;return k.forEach(function(c){b+=a(c)*p}),b}function c(){var a=0;k.forEach(function(b){a+=b.numSegments});var b=4,c=6,d=5,e=c*b+d,f=6;return a*f+e}function d(a,b,c,d,e){for(var f=b.radius+n,g=r/b.numSegments,h=0;h<=b.numSegments;++h){var i=Math.cos(e+h*g),j=Math.sin(e+h*g);a[o++]=c,a[o++]=d,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+b.radius*i,a[o++]=d-b.radius*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=1,a[o++]=c+f*i,a[o++]=d-f*j,a[o++]=a[o-3]/l,a[o++]=a[o-3]/m,a[o++]=0}}function e(a){d(a,k[0],k[0].radius,k[0].radius,Math.PI/2),d(a,k[1],k[1].radius,m-k[1].radius,Math.PI),d(a,k[2],l-k[2].radius,m-k[2].radius,3*Math.PI/2),d(a,k[3],l-k[3].radius,k[3].radius,0)}function f(a,b,c){for(var d=c.startFromVertexIndex,e=c.startFromInnerEdge===!0?0:1,f=0;f<b.numSegments;++f){var g;if(f%2===e){for(g=0;g<s;++g)a[o++]=f*s+g+d,a[o++]=(f+1)*s+g+d;c.startFromInnerEdge=!1}else{for(g=0;g<s;++g)a[o++]=f*s+(s-1)-g+d,a[o++]=(f+1)*s+(s-1)-g+d;c.startFromInnerEdge=!0}}c.startFromVertexIndex=a[o-1]}function g(a,b){var c,d,e=t/p;b.startFromInnerEdge===!0?(c=b.startFromVertexIndex+s,d=b.startFromVertexIndex,a[o++]=d,a[o++]=c%e,a[o++]=d+1,a[o++]=(c+1)%e,a[o++]=d+2,a[o++]=(c+2)%e,b.startFromInnerEdge=!1):b.startFromInnerEdge===!1&&(c=b.startFromVertexIndex+1,d=b.startFromVertexIndex,a[o++]=d,a[o++]=(c+2)%e,a[o++]=d-1,a[o++]=(c+1)%e,a[o++]=d-2,a[o++]=c%e,b.startFromInnerEdge=!0),b.startFromVertexIndex=c}function h(b){var c=[a(k[0]),a(k[1]),a(k[2]),a(k[3])];b[o++]=0,b[o++]=0,b[o++]=c[0]+c[1]+c[2],b[o++]=c[0],b[o++]=c[0]+c[1]}function i(a){var b={startFromInnerEdge:!0,startFromVertexIndex:0};o=0,f(a,k[0],b),g(a,b),f(a,k[1],b),g(a,b),f(a,k[2],b),g(a,b),f(a,k[3],b),g(a,b),h(a)}function j(){k.forEach(function(a){if(0===a.radius)a.numSegments=1;else{var b=1-q/(a.radius+n),c=Math.acos(2*b*b-1);a.numSegments=Math.ceil(r/c)}})}var k=this.corners,l=this.width,m=this.height,n=this.blurDistance,o=0,p=5,q=.2,r=Math.PI/2,s=3;j();var t=b();void 0!==this.vertices&&this.vertices.length===t||(this.vertices=new Float32Array(t)),e(this.vertices);var u=c();void 0!==this.indices&&this.indices.length===u||(this.indices=new Uint16Array(u)),i(this.indices),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0},d.prototype.setCornerRadius=function(a){a=Math.max(0,a),this.corners&&this.corners[0].radius===a&&this.corners[1].radius===a&&this.corners[2].radius===a&&this.corners[3].radius===a||(a=Math.max(1,a),this.corners=[{radius:a},{radius:a},{radius:a},{radius:a}],this.meshDirty=!0)},d.prototype.setIndividualCornerRadii=function(a,b,c,d){this.corners=[{radius:Math.max(0,a)},{radius:Math.max(0,b)},{radius:Math.max(0,c)},{radius:Math.max(0,d)}],this.meshDirty=!0},d.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._generateMesh(),this.meshDirty=!1)},d.cornerTooSmall=function(a,b){var c=.1;return a+b<c},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.setWidth=function(a){this.width!==a&&(this.width=a,this.meshDirty=!0)},d.prototype.setHeight=function(a){this.height!==a&&(this.height=a,this.meshDirty=!0)},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.dispose=function(){this.mesh.dispose()},d.prototype.getMesh=function(){return this.mesh},b.exports=d},{"./mesh":370}],372:[function(a,b,c){"use strict";function d(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS))throw new Error("An error occurred compiling a shader: "+a.getShaderInfoLog(d));return d}function e(a,b){var c=1;switch(b.type){case"float":c=1;break;case"vec2":c=2;break;case"vec3":c=3;break;case"vec4":c=4}return{name:b.name,numComponents:c}}function f(a,b){var c,d=[],e=new RegExp(b+"\\s*([^;]*)","g");do if(c=e.exec(a)){var f=c[1].split(" ");3===f.length&&f.splice(0,1),d.push({type:f[0],name:f[1]})}while(c);return d}function g(a,b,c){var d,e=f(c,"attribute"),g=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),h={};for(d=0;d<g;++d)h[a.getActiveAttrib(b,d).name]=!0;for(d=0;d<e.length;)h[e[d].name]!==!0?e.splice(d,1):d++;return e}function h(a,b){function c(a){a.forEach(function(a){d.some(function(b){return b.name===a.name})===!1&&d.push(a)})}var d=[];return c(f(a,"uniform")),c(f(b,"uniform")),d}function i(a){switch(a){case"float":return 0;case"vec2":return[0,0];case"vec3":return[0,0,0];case"vec4":return[0,0,0,0]}return 0}function j(a,b,c){function d(d,e,f){Object.defineProperty(d,e,{set:function(d){null===c.value&&(c.value=i(b)),c.value[f]=d,a.hasDirtyUniforms=!0},get:function(){return c.value[f]}})}for(var e=Number(b[b.length-1]),f={},g=0;g<e;g++)for(var h=0;h<m[g].length;h++)d(f,m[g][h],g);return Object.defineProperty(f,"array",{get:function(){return c.value},set:function(a){if(a.length!==e)throw new Error("Uniform array: Array must be of size "+e);c.value=a}}),Object.freeze(f)}function k(a,b){if(!b.vertexSource)throw new Error("No vertex shader source");if(!b.fragmentSource)throw new Error("No fragment shader source");if(b.uniforms&&Array.isArray(b.uniforms))throw new Error("WebGLShader: old style uniforms is unsupported");this.program=a.createProgram(),this.attributes=[];var c=d(a,b.vertexSource,a.VERTEX_SHADER),f=b.fragmentSource+"\nvoid _haxAndroidShaderCache() { lowp float hax="+Math.random()+";}",j=d(a,f,a.FRAGMENT_SHADER);if(a.attachShader(this.program,c),a.attachShader(this.program,j),a.linkProgram(this.program),!a.getProgramParameter(this.program,a.LINK_STATUS))throw new Error("Unable to initialize the shader program.");var k=0,m=this,n=g(a,this.program,b.vertexSource);n.forEach(function(b,c){a.bindAttribLocation(m.program,c,b.name);var d=e(a,b);m.attributes.push(d),k+=d.numComponents}),a.linkProgram(this.program),this.numComponentsPerVertex=k,this.standardUniforms={},this._uniforms={};var o=h(b.vertexSource,b.fragmentSource);o.forEach(function(b){var c=a.getUniformLocation(m.program,b.name);l[b.name]?m.standardUniforms[b.name]=c:m._uniforms[b.name]={type:b.type,location:c,value:i(b.type)}}),this.uniforms=this.createUniformSetters(this._uniforms),this.uniformNames=Object.keys(this._uniforms),this.hasDirtyUniforms=!0}var l={texture:!0,u_view:!0,u_projection:!0,u_world:!0,u_opacity:!0,u_color:!0,u_srcRect:!0,u_flipTexCoordY:!0},m=[["x","r","u"],["y","g","v"],["z","b"],["w","a"]];k.prototype.createUniformSetters=function(a){var b={},c=this;return Object.keys(this._uniforms).forEach(function(d){var e=c._uniforms[d];"vec"!==e.type.substring(0,3)?Object.defineProperty(b,d,{set:function(b){a[d].value=b,c.hasDirtyUniforms=!0},get:function(){return a[d].value}}):b[d]=j(c,e.type,a[d])}),b},b.exports=k},{}],373:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache=new e({freelistSize:50}),this.canvas=document.createElement("canvas")}var e=a("../../resourcecache");d.prototype._createNewTextTexture=function(a,b,c){var d=this.canvas;d.width=a.width*b,d.height=a.height*b;var e=d.getContext("2d");if(e.clearRect(0,0,d.width,d.height),e.font=a.content.fontSize*b+'px "'+a.content.fontFamily+'"',e.fillStyle=c,"text"===a.content.type)for(var f=0;f<a.content.lines.length;f++){var g=a.content.lines[f];e.fillText(g.text,g.x*b,g.y*b)}else if("textInput"===a.content.type){var h=.5*(a.height-a.content.textHeight);e.fillText(a.content.text,0,b*(h+a.content.baseline))}return this.webGLHelper.createTexture({canvas:d})},d.prototype.getTextTexture=function(a,b,c,d){var e=b+""+a.content.fontSize+a.content.fontFamily+c;return e+="text"===a.content.type?a.content.lines.map(function(a){return a.x+" "+a.text}).join(""):a.content.text,this.textureCache.isInCache(e)===!1&&this.textureCache.addResource(e,this._createNewTextTexture(a,b,c)),this.textureCache.updateReference(a.id,e),this.textureCache.getResource(e)},d.prototype.textResourceRemoved=function(a){this.textureCache.removeReference(a)},d.prototype.clear=function(){this.textureCache.clear()},b.exports=d},{"../../resourcecache":377}],374:[function(a,b,c){"use strict";function d(a,b){this.handle=0,this.size=[0,0],this.loaded=!1,this.path=null,this.target=null,this.gl=a,this.refCount=0,this.preloadedAndUnused=!1,this.keepForever=!1,this.sizeCallbacks=[],this._pixelDataChangedListeners=[],b.wrapMode=b.wrapMode||d.WrapMode.Clamp,b.filter=b.filter||d.Filter.Linear,b.pixels?this._uploadPixelData(b.pixels,b.width,b.height,b.wrapMode,b.filter):b.path instanceof Array?6==b.path.length?this._uploadCubemap(b.resourceDirectory,b.path,b.wrapMode,b.filter):console.error("Cubemap requries six image paths"):b.path&&b.domElement?this._uploadDomElement(b.domElement,b.path,b.wrapMode,b.filter):b.path?this._uploadImageData(b.resourceDirectory,b.path,b.wrapMode,b.filter):b.canvas?this._uploadCanvas(b.canvas,b.wrapMode,b.filter):b.video?this._uploadVideo(b.video,b.wrapMode,b.filter):this._uploadEmptyTexture(b.width,b.height,b.wrapMode,b.filter)}var e=0;d.prototype._uploadEmptyTexture=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.texImage2D(this.target,0,e.RGBA,a,b,0,e.RGBA,e.UNSIGNED_BYTE,null),this._textureDataLoaded(a,b)},d.prototype._uploadPixelData=function(a,b,c,d,e){if(Array.isArray(a))a=new Uint8Array(a);else if(a instanceof Uint8Array==!1)throw new Error("pixels must be an array or Uint8Array");var f=this.gl;this._createAndBindHandle(f.TEXTURE_2D,d,e),f.bindTexture(this.target,this.handle),f.texImage2D(this.target,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,a),this._textureDataLoaded(b,c)},d.prototype._uploadVideo=function(a,b,c){this.videoDOMNode=a,this._createAndBindHandle(this.gl.TEXTURE_2D,b,c)},d.prototype._uploadImageData=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d);var f="http"===b.substring(0,4).toLowerCase(),g=new Image;f&&(g.crossOrigin="anonymous");var h=this;g.onload=function(){e.bindTexture(h.target,h.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(h.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),h._textureDataLoaded(this.width,this.height)},g.src=a+b,this.path=b},d.prototype._uploadDomElement=function(a,b,c,d){if("video"===a.tagName.toLowerCase())this._uploadVideo(a,c,d);else{var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.bindTexture(this.target,this.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(this.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),this._textureDataLoaded(a.width,a.height)}this.path=b},d.prototype._uploadCubemap=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_CUBE_MAP,c,d);for(var f=[e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z],g=this,h=0;h<6;++h){var i=new Image;i.crossOrigin="anonymous",i.onload=function(a){return function(){e.bindTexture(g.target,g.handle),e.texImage2D(f[a],0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),g._textureDataLoaded(this.width,this.height)}}(h),i.src=a+b[h]}},d.prototype._uploadCanvas=function(a,b,c){var d=this.gl;this._createAndBindHandle(d.TEXTURE_2D,b,c),d.bindTexture(this.target,this.handle),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(this.target,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a);var e=window.devicePixelRatio||1;this._textureDataLoaded(a.width/e,a.height/e)},d.prototype.updateVideoTexture=function(){var a=this.videoDOMNode;if(a.readyState===a.HAVE_ENOUGH_DATA){var b=this.gl;b.bindTexture(this.target,this.handle),b.texImage2D(this.target,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a),this.loaded===!1&&this._textureDataLoaded(a.videoWidth,a.videoHeight),this._notifyPixleDataChangedListeners()}},d.prototype.addPixelDataChangedListener=function(a){this._pixelDataChangedListeners.push(a)},d.prototype.removePixelDataChangedListener=function(a){var b=this._pixelDataChangedListeners.indexOf(a);if(b===-1)throw new Error("Listener is not added");this._pixelDataChangedListeners.splice(b,1)},d.prototype._notifyPixleDataChangedListeners=function(){for(var a=0;a<this._pixelDataChangedListeners.length;++a)this._pixelDataChangedListeners[a].onTexturePixelDataChanged(this)},d.prototype._createAndBindHandle=function(a,b,c){var e=this.gl;this.handle=e.createTexture(),this.target=a,e.bindTexture(a,this.handle);var f;c===d.Filter.Nearest?f=e.NEAREST:c===d.Filter.Linear&&(f=e.LINEAR),e.texParameteri(a,e.TEXTURE_MAG_FILTER,f),e.texParameteri(a,e.TEXTURE_MIN_FILTER,f),b===d.WrapMode.Repeat?(e.texParameteri(a,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(a,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),this.wrapMode=b},d.prototype._textureDataLoaded=function(a,b){this.size=[a,b],this.loaded=!0,this._notifySizeCallbacks(this.size),e+=a*b*4},d.prototype._notifySizeCallbacks=function(a){if(0!==this.sizeCallbacks.length){for(var b=0;b<this.sizeCallbacks.length;++b)this.sizeCallbacks[b].callback(a);this.sizeCallbacks.length=0}},d.prototype.dispose=function(){this.gl.deleteTexture(this.handle)},d.WrapMode={Clamp:0,Repeat:1},d.Filter={Nearest:1,Linear:2},b.exports=d},{}],375:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache={}}d.prototype.getTexture=function(a,b){var c=this.textureCache[a];return c||(c=this.webGLHelper.createTexture({path:a,domElement:b}),this.textureCache[a]=c),c},d.prototype.flushUnused=function(){for(var a in this.textureCache){var b=this.textureCache[a];0===b.refCount&&b.preloadedAndUnused===!1&&b.keepForever===!1&&delete this.textureCache[a]}},d.prototype.evict=function(a){this.textureCache[a]?delete this.textureCache[a]:console.log("WebGLTextureCache.evict: texture doesn't exist: "+a)},d.prototype.clear=function(){this.textureCache={}},b.exports=d},{}],376:[function(a,b,c){"use strict";function d(a,b,c){this.gl=a,this.gl.numVertexAttribsEnabled=0,this.screenCameraProjection=l.create(),this.screenCameraView=l.create(),this.fieldOfView=25,this._whiteTexture=null,this.currentBlendMode=d.BlendMode.Solid,this.currentRenderTarget=0,this.currentShader=0,this.currentUniformValues=null,this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.currentDepthTestState=!1,this.currentScissorTestState=!1,this.currentStencilTestState=!1,this.currentBoundMesh=null,this.maskRenderingEnabled=!1,this.currentViewport={width:0,height:0},a.disable(a.CULL_FACE),a.clearColor(0,0,0,0),a.stencilMask(255),a.clearStencil(128),this.supportsEGLImageExternal=!!a.TEXTURE_EXTERNAL_OES,this.cameraMatricesDirty=!0,this.activeTexture=0,this.setVirtualSize(b,c),this.resourceDirectory="",this._defaultVsSource=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),this._defaultFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._videoFsSource=["#extension GL_OES_EGL_image_external : require","uniform samplerExternalOES texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._imageMaskFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 tex = texture2D(texture, uv);","    if (tex.a < 0.5) {","       discard;","    }","    else {","       gl_FragColor = vec4(vec3(tex.a), 1.);","    }","}"].join("\n")}function e(a,b){var c=new window.XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status)b(c.responseText);else if(404===c.status)throw new Error("Failed to read shader file: "+a)},c.open("GET",a,!0),c.send()}function f(a,b,c){var d=g(c,"vertex"),e=g(c,"fragment"),f=b.file;b.file=void 0,b.vertexSource=d,b.fragmentSource=e;var h=a.createShader(b);void 0!==b.onCreated&&b.onCreated(h,f)}function g(a,b){function c(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=a.length);for(var e=0,f=a.indexOf(b,c);f!=-1&&f<d;)e++,f=a.indexOf(b,f+1);return e}function d(a,b){for(var c="",d=0;d<b;d++)c+=a;return c}var e,f,g="(^|\\n)\\s*\\["+b+"\\]((\\n|.)*?)(\\n\\s*\\[|$)",h=new RegExp(g);if(e=h.exec(a),null!==e){var i=e[2],j=a.indexOf(i),k=c(a,"\n",0,j),l=c(a,"\n",j+i.length);f=d("\n",k),f+=i,f+=d("\n",l)}return f}var h=a("./mesh"),i=a("./shader"),j=a("./texture"),k=a("./fbo"),l=a("../../math/mat4");d.prototype.setVirtualSize=function(a,b){this.virtualWidth=a,this.virtualHeight=b,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.prototype.setRenderBufferSize=function(a,b){this.renderWidth=a,this.renderHeight=b,this.gl.viewport(0,0,a,b),this.currentViewport.width=a,this.currentViewport.height=b},d.prototype.createShader=function(a){return void 0===a.vertexSource&&(a.vertexSource=this._defaultVsSource),void 0===a.fragmentSource&&(a.fragmentSource=this._defaultFsSource),new i(this.gl,a)},d.prototype.createShaderFromFile=function(a){if(void 0===a.file)throw new Error("createShaderFromFile: no file specified");e(a.file,f.bind(null,this,a))},d.prototype.createMesh=function(a){return new h(this.gl,a)},d.prototype.createTexture=function(a){return new j(this.gl,a)},d.prototype.createFBO=function(a){return a.texture=j(this.gl,{width:a.width,height:a.height}),new k(this.gl,a)},d.prototype.calculateCamera=function(a,b,c,d){var e=this.fieldOfView*Math.PI/180,f=.5*d/Math.tan(.5*e);l.perspective(b,e,c/d,.05*f,5*f),l.identity(a),l.translate(a,.5*-c,.5*d,-f),a[5]=-1,this.cameraMatricesDirty=!0},d.prototype.bindScreen=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,this.renderWidth,this.renderHeight),this.currentViewport.width=this.renderWidth,this.currentViewport.height=this.renderHeight},d.prototype.setBlendMode=function(a){if(a!==this.currentBlendMode){var b=this.gl;this.currentBlendMode=a,this.currentBlendMode===d.BlendMode.Alpha?(b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Additive?(b.blendFunc(b.ONE,b.ONE),b.enable(b.BLEND)):this.currentBlendMode===d.BlendMode.Solid?b.disable(b.BLEND):this.currentBlendMode===d.BlendMode.Multiply&&(b.blendFunc(b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND))}},d.prototype.setDepthTest=function(a){if(a!==this.currentDepthTestState){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.currentDepthTestState=a}},d.prototype.setStencilTest=function(a){if(a!==this.currentStencilTestState){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.currentStencilTestState=a}},d.prototype.setScissorTest=function(a,b){var c=this.gl;if(this.currentScissorTestState!==a&&(a?c.enable(c.SCISSOR_TEST):c.disable(c.SCISSOR_TEST),this.currentScissorTestState=a),a){var d=this.currentViewport.width/this.virtualWidth,e=this.currentViewport.height/this.virtualHeight,f=0!==this.currentRenderTarget;f&&(d=1,e=1);var g=Math.ceil(b[0]*d),h=Math.ceil(this.currentViewport.height-b[3]*e),i=Math.ceil((b[2]-b[0])*d),j=Math.ceil((b[3]-b[1])*e);c.scissor(g,h,i,j)}},d.prototype.bindFbo=function(a){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.viewport(0,0,a.width,a.height),this.currentViewport.width=a.width,this.currentViewport.height=a.height},d.prototype.bindRenderTarget=function(a){a!==this.currentRenderTarget&&(this.currentRenderTarget=a,0===this.currentRenderTarget||null===this.currentRenderTarget?(this.bindScreen(),this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.cameraMatricesDirty=!0):(this.bindFbo(this.currentRenderTarget.fbo),this.currentViewMatrix=this.currentRenderTarget.cameraView,this.currentProjectionMatrix=this.currentRenderTarget.cameraProjection,this.cameraMatricesDirty=!0)),this.setScissorTest(!1),this.setMaskRendering(!1),this.gl.stencilMask(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},d.prototype.bindTexture=function(a,b){this.activeTexture!==a&&(this.activeTexture=a,this.gl.activeTexture(this.gl.TEXTURE0+a)),this.gl.bindTexture(b.target,b.handle)},d.prototype.bindShader=function(a,b){var c=this.gl;if(this.currentShader!==a&&(this.currentShader=a,this.currentBoundMesh=null,c.useProgram(this.currentShader.program),void 0!==a.standardUniforms.texture&&c.uniform1i(a.standardUniforms.texture,0),this.cameraMatricesDirty=!0,a.hasDirtyUniforms=!0),b!==this.currentUniformValues&&(this.currentUniformValues=b,a.hasDirtyUniforms=!0),this.currentShader.hasDirtyUniforms){for(var d=1,e=this.currentShader._uniforms,f=0,g=a.uniformNames.length;f<g;f++){var h=a.uniformNames[f],i=e[h],j=i.value;b&&b.hasOwnProperty(h)&&(j=b[h]),"float"===i.type||"f"===i.type?c.uniform1f(i.location,j):"vec2"===i.type?c.uniform2f(i.location,j[0],j[1]):"vec3"===i.type?c.uniform3f(i.location,j[0],j[1],j[2]):"vec4"===i.type?c.uniform4f(i.location,j[0],j[1],j[2],j[3]):"sampler2D"===i.type&&(this.bindTexture(d,j),c.uniform1i(i.location,d),d++)}a.hasDirtyUniforms=!1}this.cameraMatricesDirty&&(void 0!==a.standardUniforms.u_projection&&c.uniformMatrix4fv(a.standardUniforms.u_projection,!1,this.currentProjectionMatrix),void 0!==a.standardUniforms.u_view&&c.uniformMatrix4fv(a.standardUniforms.u_view,!1,this.currentViewMatrix),this.cameraMatricesDirty=!1)},d.prototype.bindMesh=function(a){this.currentBoundMesh!==a&&(a.bind(this.currentShader.attributes,this.currentShader.numComponentsPerVertex),this.currentBoundMesh=a)},d.prototype.beginFrame=function(){var a=this.gl;a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},d.prototype.setMaskRendering=function(a,b){var c=this.gl;this.setStencilTest(!0),a?(this.maskRenderingEnabled===!1&&(c.colorMask(!1,!1,!1,!1),c.depthMask(!1),c.stencilFunc(c.NEVER,1,255),this.maskRenderingEnabled=!0),b?c.stencilOp(c.INCR,c.INCR,c.INCR):c.stencilOp(c.DECR,c.DECR,c.DECR)):this.maskRenderingEnabled===!0&&(c.colorMask(!0,!0,!0,!0),c.depthMask(!0),c.stencilFunc(c.LEQUAL,128,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),this.maskRenderingEnabled=!1)},d.prototype.executeRenderCommand=function(a){var b=this.gl;this.setBlendMode(a.blendMode),this.setDepthTest(a.depthTest),this.setMaskRendering(a.writeToStencil,a.maskIsPositive),this.setScissorTest(a.scissorTest,a.scissorRect),this.bindShader(a.shader,a.shaderUniforms),this.bindTexture(0,a.texture);var c=this.currentShader.standardUniforms.u_world;void 0!==c&&a.worldTransform&&b.uniformMatrix4fv(c,!1,a.worldTransform);var d=this.currentShader.standardUniforms.u_opacity;void 0!==d&&b.uniform1f(d,a.opacity);var e=this.currentShader.standardUniforms.u_color;void 0!==e&&b.uniform3f(e,a.color[0],a.color[1],a.color[2]);var f=this.currentShader.standardUniforms.u_srcRect;void 0!==f&&b.uniform4f(f,a.srcRect[0],a.srcRect[1],a.srcRect[2],a.srcRect[3]);var g=this.currentShader.standardUniforms.u_flipTexCoordY;void 0!==g&&b.uniform1f(g,a.flipTexCoordY),this.bindMesh(a.mesh),a.vertexIndex===-1?a.mesh.draw():a.mesh.drawVertexRange(a.vertexIndex,4)},d.prototype.whiteTexture=function(){return null===this._whiteTexture&&(this._whiteTexture=this.createTexture({pixels:new Uint8Array([255,255,255,255]),width:1,height:1})),this._whiteTexture},d.prototype.setFieldOfView=function(a){this.fieldOfView=a,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},d.BlendMode={Alpha:0,Solid:1,Additive:2,Multiply:3},b.exports=d},{"../../math/mat4":360,"./fbo":369,"./mesh":370,"./shader":372,"./texture":374}],377:[function(a,b,c){"use strict";function d(a){a=a||{},this.cache={},this.activeReferences={},this.freelist={},this.freelistKeys=[],this.freelistMaxLength=a.freelistSize||0,this.disposeCallback=a.disposeCallback}d.prototype.isInCache=function(a){return this.cache.hasOwnProperty(a)||this.freelist.hasOwnProperty(a)},d.prototype.addResource=function(a,b){this.cache[a]={resource:b,refCount:0}},d.prototype._decreaseRefCount=function(a){var b=this.cache[a];if(b.refCount--,0===b.refCount){if(this.freelistMaxLength>0){if(this.freelistKeys.length===this.freelistMaxLength){var c=this.freelistKeys.shift();this._dispose(this.freelist[c]),delete this.freelist[c]}this.freelistKeys.push(a),this.freelist[a]=b.resource}else this._dispose(b.resource);delete this.cache[a]}},d.prototype.removeReference=function(a){if(this.activeReferences.hasOwnProperty(a)!==!1){var b=this.activeReferences[a];this._decreaseRefCount(b),delete this.activeReferences[a]}},d.prototype.updateReference=function(a,b){if(this.activeReferences[a]!==b){var c=this.activeReferences[a];if(this.freelist.hasOwnProperty(b)){this.cache[b]={resource:this.freelist[b],refCount:0},delete this.freelist[b];var d=this.freelistKeys.indexOf(b);this.freelistKeys.splice(d,1)}this.activeReferences[a]=b,this.cache[b].refCount++,c&&this._decreaseRefCount(c)}},d.prototype.getResource=function(a){return this.cache[a].resource},d.prototype.clear=function(){var a;for(a in this.cache)this._dispose(this.cache[a].resource);for(a in this.freelist)this._dispose(this.freelist[a]);this.cache={},this.freelist={},this.freelistKeys=[]},d.prototype._dispose=function(a){this.disposeCallback?this.disposeCallback(a):a.dispose&&a.dispose()},b.exports=d},{}],378:[function(a,b,c){"use strict";function d(){}function e(a){this.axis=a.axis||0,this.track=!a.hasOwnProperty("track")||a.track,this.threshold=a.threshold,this.onDragStart=a.onDragStart||d,this.onDrag=a.onDrag||d,this.onDragEnd=a.onDragEnd||d,this._startPosition=0,this._touchPosition=0,this._hasPressedDown=!1,this._isDragging=!1,this._velocity=0,this._deltaPosition=0}e.prototype=Object.create(e.prototype,{velocity:{get:function(){return this._velocity}},dragDistance:{get:function(){return this._touchPosition-this._startPosition}},dragDelta:{get:function(){return this._deltaPosition}}}),e.prototype.onTouch=function(a){if(a.isDown)this._touchPosition=a.pos[this.axis],this._hasPressedDown=!0,this._velocity=0,this._deltaPosition=0,this._startPosition=this._touchPosition;else if(a.isMove&&this._hasPressedDown){var b=a.pos[this.axis];if(this._isDragging===!1?Math.abs(b-this._touchPosition)>this.threshold&&(this._isDragging=!0,this._startPosition=b,this._touchPosition=b,this.onDragStart()):(a.deltaTime>0&&(this._velocity=(b-this._touchPosition)/a.deltaTime),this._touchPosition=b,this._deltaPosition=a.delta[this.axis],this.onDrag()),this._isDragging&&this.track)return"StartTracking"}else(a.isUp||a.isExit)&&this._isDragging&&(this._isDragging=!1,this._hasPressedDown=!1,this._deltaPosition=0,this.onDragEnd())},b.exports=e},{}],379:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=1-e;return f*f*f*a+3*f*f*e*b+3*f*e*e*c+e*e*e*d}function e(a,b){this.axis=b.axis,this.scrollCallback=b.scrollCallback,this.scrollThreshold=b.scrollThreshold,this.shouldRubber=void 0===b.shouldRubber||b.shouldRubber,this.scrollSpeed=void 0!==b.scrollSpeed?b.scrollSpeed:1,this.scrollEndedAnimationDuration=b.scrollEndedAnimationDuration||300,this.scrollEndedPositionCallback=b.scrollEndedPositionCallback,this.trackId=-1,this.animation=null,this.speed=0,this.timerScheduler=a,this.scrollObjectSize=1,this.scrollViewSize=1,this.rubberLength=4}e.prototype.onTouch=function(a,b){if(this.trackId===-1||b.id===this.trackId){var c=0,e=this.axis,f=!0;if(b.isDown||b.isEnter)this.hasMoved=!1,this.downStartPos=b.pos[e],this.animation&&this.animation.stop(),this.speed=0;else if(b.isMove&&(this.hasMoved||Math.abs(b.pos[e]-this.downStartPos)>this.scrollThreshold)){this.hasMoved=!0;var g=0,h=a+b.delta[e],i=Math.min(0,-this.scrollObjectSize+this.scrollViewSize);if(h>0?g=h:h<i&&(g=i-h),g>0&&this.shouldRubber){var j=Math.max(0,1-g/this.scrollViewSize*this.rubberLength);c=b.delta[e]*j}else h>0?(c=-a,this.shouldRubber===!1&&(f=!1)):h<i?(c=i-a,this.shouldRubber===!1&&(f=!1)):c=b.delta[e];
b.deltaTime>0&&(this.speed=b.delta[this.axis]/b.deltaTime),0!==c&&(a+=c,this.scrollCallback(a,c))}else if((b.isUp||b.isExit)&&this.hasMoved===!0){this.hasMoved=!1;var k=this.scrollEndedAnimationDuration,l=a+this.speed*k/3,m=a+this.speed*k/3,n=Math.min(0,this.scrollViewSize-this.scrollObjectSize);l>0?(l=0,m=0):l<n&&(l=n,m=l),l=this.scrollEndedPositionCallback(this.speed,l),this.shouldRubber===!1&&(m=l);var o=this.scrollCallback,p=this.onScrollEnded;this.animation=this.timerScheduler.createTimer({duration:k,p0:a,p1:m,p2:l,p3:l,onRunning:function(a){o(d(this.p0,this.p1,this.p2,this.p3,a))},onFinish:function(){p&&p()}}).start()}return this.hasMoved&&f?(this.trackId=b.id,"StartTracking"):void(this.trackId=-1)}},e.prototype.setOrientation=function(a){this.axis="horizontal"===a?0:1},b.exports=e},{}],380:[function(a,b,c){"use strict";function d(a,b){this.scrollThreshold=a,this.startPos=[0,0],this.hasReceivedDownEvent=!1,this.callback=b}d.prototype.onTouch=function(a,b){if(b.isDown)this.startPos[0]=b.pos[0],this.startPos[1]=b.pos[1],this.hasReceivedDownEvent=!0;else if(b.isMove)(Math.abs(b.pos[0]-this.startPos[0])>this.scrollThreshold||Math.abs(b.pos[1]-this.startPos[1])>this.scrollThreshold)&&(this.hasReceivedDownEvent=!1);else if(b.isUp&&this.hasReceivedDownEvent===!0)return this.callback(a,b),this.hasReceivedDownEvent=!1,"StopPropagation"},b.exports=d},{}],381:[function(a,b,c){"use strict";function d(){this.trackedControls=[],this.lastTouch=[],this.prevIntersectedControlsDepthLayers={},this.hoverState={prevIntersectedControlsDepthLayers:{},lastHover:{}},this.depthIndices=[],this.numDepthIndices=0,this.focusedControl=null}function e(a,b){return a-b}function f(a){for(var b=0,c=a.length;b<c;++b)null!==a[b].onTouch&&a[b].onTouch(p)}function g(a){for(var b=0,c=a.length;b<c;++b)null!==a[b].onHover&&a[b].onHover(r)}function h(a,b){return n.isPointInside(a.childAABB||a.screenAABB,b)}function i(a,b){return n.isPointInside(a.screenAABB,b)}function j(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onTouch||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onTouch&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)j(e[f],b,c,d)}}function k(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b.pos)){(a.onHover||a.blockTouch)&&i(a,b.pos)&&(a.blockTouch&&(c[d]=[],s=Math.max(s,d)),a.onHover&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)k(e[f],b,c,d)}}function l(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.visible&&a.opacity>0&&h(a,b)){(a.onTouch||a.blockTouch)&&i(a,b)&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a));var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++)l(e[f],b,c,d)}}function m(){return{pos:[0,0],delta:[0,0],deltaTime:0,type:"isMove",isMove:!1,isUp:!1,isDown:!1,isEnter:!1,isExit:!1,id:0}}var n=a("../math/aabb"),o=m();o.type="isEnter",o.isEnter=!0;var p=m();p.type="isExit",p.isExit=!0;var q=m();q.type="isHoverEnter",q.isHoverEnter=!0;var r=m();r.type="isHoverExit",r.isHoverExit=!0,d.prototype.processTouchEvent=function(a,b){var c=b.id,d=this.lastTouch[c];d||(this.lastTouch[c]={pos:[0,0],time:0},d=this.lastTouch[c]),b.isMove&&(b.delta[0]=b.pos[0]-d.pos[0],b.delta[1]=b.pos[1]-d.pos[1],b.deltaTime=b.time-d.time),d.time=b.time,d.pos[0]=b.pos[0],d.pos[1]=b.pos[1];var g={0:[]};this.trackedControls[b.id]?g[0].push(this.trackedControls[b.id]):(s=-1e7,j(a,b,g,void 0===a.depth?0:a.depth)),o.id=b.id,o.pos[0]=b.pos[0],o.pos[1]=b.pos[1],o.delta[0]=b.delta[0],o.delta[1]=b.delta[1],o.deltaTime=b.deltaTime,o.force=b.force,o.domEvent=b.domEvent,p.id=b.id,p.pos[0]=b.pos[0],p.pos[1]=b.pos[1],p.delta[0]=b.delta[0],p.delta[1]=b.delta[1],p.deltaTime=b.deltaTime,p.force=0,p.domEvent=b.domEvent;var h,i,k,l,m,n,q=!0;this.numDepthIndices=0;for(n in g)n>=s&&(this.depthIndices[this.numDepthIndices++]=n);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0&&q;--l)for(k=this.depthIndices[l],m=g[k],h=m.length-1;h>=0;--h){var r=m[h],t=!1;for(i in this.prevIntersectedControlsDepthLayers){var u=this.prevIntersectedControlsDepthLayers[i].indexOf(r);if(u!==-1){t=!0,this.prevIntersectedControlsDepthLayers[i].splice(u,1);break}}t===!1&&(r.onTouch(o),this.focusedControl&&r!==this.focusedControl&&(this.focusedControl.blur(),this.focusedControl=null));var v=r.onTouch(b);if("StartTracking"===v){this.trackedControls[b.id]=r,q=!1;break}if(this.trackedControls[b.id]=null,"StopPropagation"===v){q=!1;break}void 0!==v&&console.log("unknown return value from from onTouch "+v)}if(b.isUp)for(l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=g[k],f(m),this.prevIntersectedControlsDepthLayers={};else{this.numDepthIndices=0;for(n in this.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=n;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),l=this.numDepthIndices-1;l>=0;--l)k=this.depthIndices[l],m=this.prevIntersectedControlsDepthLayers[k],f(m);this.prevIntersectedControlsDepthLayers=g}},d.prototype.processHoverEvent=function(a,b){var c=(b.id,{0:[]});s=-1e7,k(a,b,c,void 0===a.depth?0:a.depth),q.id=b.id,q.pos[0]=b.pos[0],q.pos[1]=b.pos[1],q.delta[0]=b.delta[0],q.delta[1]=b.delta[1],q.deltaTime=b.deltaTime,q.domEvent=b.domEvent,r.id=b.id,r.pos[0]=b.pos[0],r.pos[1]=b.pos[1],r.delta[0]=b.delta[0],r.delta[1]=b.delta[1],r.deltaTime=b.deltaTime,r.domEvent=b.domEvent;var d,f,h,i,j,l,m=!0;this.numDepthIndices=0;for(l in c)l>=s&&(this.depthIndices[this.numDepthIndices++]=l);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0&&m;--i)for(h=this.depthIndices[i],j=c[h],d=j.length-1;d>=0;--d){var n=j[d],o=!1;for(f in this.hoverState.prevIntersectedControlsDepthLayers){var p=this.hoverState.prevIntersectedControlsDepthLayers[f].indexOf(n);if(p!==-1){o=!0,this.hoverState.prevIntersectedControlsDepthLayers[f].splice(p,1);break}}o===!1&&n.onHover(q);var t=n.onHover(b);if("StopPropagation"===t){m=!1;break}void 0!==t&&console.log("unknown return value from from onhoverEvent "+t)}this.numDepthIndices=0;for(l in this.hoverState.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=l;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0;--i)h=this.depthIndices[i],j=this.hoverState.prevIntersectedControlsDepthLayers[h],g(j);this.hoverState.prevIntersectedControlsDepthLayers=c},d.prototype.handleTouchEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=b.force,c.domEvent=b.domEvent,this.processTouchEvent(a,c)},d.prototype.handleHoverEvent=function(a,b){var c=m();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=0,c.domEvent=b.domEvent,this.processHoverEvent(a,c)},d.prototype.setFocus=function(a){return a.blur?void(this.focusedControl=a):void console.error("Can't set focus on a control that can't be blurred")};var s;d.prototype.hitTest=function(a,b){var c={};return l(a,b,c,0),c},b.exports=d},{"../math/aabb":358}],382:[function(a,b,c){"use strict";function d(){e.call(this),this.mouseDown=!1,this.lastTouch=[];var a=this;this.onMouseMove=function(b){b.preventDefault(),a.mouseDown===!0&&a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),0,b.timeStamp,"isMove",b),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchMove=function(b){a.onTouchEvent(b,"isMove")},this.onTouchLeave=function(b){a.onTouchEvent(b,"isUp")},this.onTouchEnd=function(b){a.onTouchEvent(b,"isUp")},this.onMouseUp=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b))},this.onMouseOut=function(b){b.preventDefault(),a.mouseDown&&(a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b)),a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b)},this.onTouchStart=function(b){a.onTouchEvent(b,"isDown")},this.onMouseDown=function(b){0===b.button&&(b.preventDefault(),a.mouseDown=!0,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isDown",b))}}var e=a("../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setDOMElement=function(a){this.domElement=a,a.style.pointerEvents="auto",this.setTouchEnabled(!0)},d.prototype.setTouchEnabled=function(a){var b=this.domElement;b&&(a?(b.addEventListener("mousemove",this.onMouseMove,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchleave",this.onTouchLeave,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("mouseup",this.onMouseUp,!1),b.addEventListener("mouseout",this.onMouseOut,!1),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("mousedown",this.onMouseDown,!1)):(b.removeEventListener("mousemove",this.onMouseMove),b.removeEventListener("touchmove",this.onTouchMove),b.removeEventListener("touchleave",this.onTouchLeave),b.removeEventListener("touchend",this.onTouchEnd),b.removeEventListener("mouseup",this.onMouseUp),b.removeEventListener("mouseout",this.onMouseOut),b.removeEventListener("touchstart",this.onTouchStart),b.removeEventListener("mousedown",this.onMouseDown)))},d.prototype.onTouchEvent=function(a,b){a.preventDefault();for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];this.emitEvent(d.identifier,this.getTouchX(d),this.getTouchY(d),d.force,a.timeStamp,b,a)}},d.prototype.emitEvent=function(a,b,c,d,e,f,g){this.emit("touchEvent",{id:a,x:b,y:c,force:d,timestamp:e,type:f,domEvent:g})},d.prototype.emitHoverEvent=function(a,b,c,d,e,f){this.emit("hoverEvent",{id:a,x:b,y:c,timestamp:d,type:e,domEvent:f})},d.prototype.getTouchX=function(a){var b=this.domElement.getBoundingClientRect(),c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype.getTouchY=function(a){var b=this.domElement.getBoundingClientRect(),c=b.bottom-b.top,d=a.pageY-b.top;return d/c},b.exports=d},{"../../eventsender":247}],383:[function(a,b,c){"use strict";function d(a,b){i.call(this),this.timerScheduler=a,this.eventSender=new i,this.layouter=new f,this.imageCache=new v,this.renderer=new e(b);var c=this;this.renderer.on("requestFrame",function(){c.eventSender.emit("requestFrame")}),this.root=this.createDockLayoutControl(),this.root.setSizeMode("explicit"),this.root.setWidthUnit("px"),this.root.setHeightUnit("px"),this.touchEngine=new g,this.touchListener=new h,this.touchListener.on("touchEvent",this.handleTouchEvent.bind(this),this),this.touchListener.on("hoverEvent",this.handleHoverEvent.bind(this),this),this.fillMode="aspectFit",this.setAspectFitViewport(1080,1920),this.root.setContentDirty=function(a){k.prototype.setContentDirty(a),a&&c.eventSender.emit("requestFrame")},window.addEventListener("resize",function(){c._resizeViewport(),c.eventSender.emit("requestFrame")}),this.rendererSet=!1}var e=a("./renderer"),f=a("./layout/layouter"),g=a("./touch/touchengine"),h=a("./touch/touchlistener"),i=a("../eventsender"),j=a("./controls/circlecontrol"),k=a("./controls/docklayoutcontrol"),l=a("./controls/flowlayoutcontrol"),m=a("./controls/imagecontrol"),n=a("./controls/rectanglecontrol"),o=a("./controls/scrollviewcontrol"),p=a("./controls/stacklayoutcontrol"),q=a("./controls/textcontrol"),r=a("./controls/textinputcontrol"),s=a("./controls/meshcontrol"),t=a("./touch/taphandler"),u=a("./touch/draggesturerecognizer"),v=a("./imagecache");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.prototype._addListenersToControl=function(a){a.on("disposed",this.renderer.onControlDisposed.bind(this.renderer))},d.prototype.createCircleControl=function(){var a=new j(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createDockLayoutControl=function(){var a=new k(this.layouter);return a},d.prototype.createFlowLayoutControl=function(){return new l(this.layouter)},d.prototype.createImageControl=function(){var a=new m(this.layouter,this.imageCache);return this._addListenersToControl(a.innerControl),a},d.prototype.createRectangleControl=function(){var a=new n(this.layouter);return this._addListenersToControl(a),a},d.prototype.createScrollViewControl=function(){return new o(this.layouter,this.timerScheduler)},d.prototype.createStackLayoutControl=function(){return new p(this.layouter)},d.prototype.createTextControl=function(){var a=new q(this.layouter);return this._addListenersToControl(a.innerControl),a},d.prototype.createTextInputControl=function(){var a=new r(this.layouter);this._addListenersToControl(a);var b=this.renderer.createTextInputField(a.id);return b&&a.setInputField(b),a.on("focused",this.touchEngine.setFocus.bind(this.touchEngine)),a},d.prototype.createMeshControl=function(){var a=new s(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createTapHandler=function(a){return new t(50,a)},d.prototype.createDragGestureRecognizer=function(a){return new u(a)},d.prototype.setAspectFitViewport=function(a,b){this.aspectFillViewportSize={width:a,height:b},this._resizeViewport()},d.prototype._resizeViewport=function(){var a,b;if("aspectFit"===this.fillMode)a=this.aspectFillViewportSize.width,b=this.aspectFillViewportSize.height;else{var c=this.renderer.rootElement.getBoundingClientRect();a=c.width,b=c.height}this._setViewportSize(a,b)},d.prototype._setViewportSize=function(a,b){this.renderer.setViewportSize(a,b),this.layouter.setWindowSize(a,b),this.root.setWidth(a),this.root.setHeight(b),this.root.screenAABB.max[0]=a,this.root.screenAABB.max[1]=b,this.root.childAABB.max[0]=a,this.root.childAABB.max[1]=b,this.emit("viewportSizeChanged",{width:a,height:b})},d.prototype.layout=function(){if(this.layouter.layout(this.root),this.root.contentDirty){this.renderer.beginLayout();for(var a=0;a<this.root.children.length;a++)this.renderer.layout(this.root.children[a],!1)}},d.prototype.renderFrame=function(){this.renderer.beginFrame(),this.renderer.render(this.root),this.renderer.endFrame()},d.prototype.handleTouchEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("touchEvent",a),this.touchEngine.handleTouchEvent(this.root,a)},d.prototype.handleHoverEvent=function(a){a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("hoverEvent",a),this.touchEngine.handleHoverEvent(this.root,a)},d.prototype.removeAllRenderers=function(){this.rendererSet=!1,this.renderer.removeAllRenderers()},d.prototype.addRenderer=function(a){this.rendererSet===!1&&a.rootElement&&(this.touchListener.setDOMElement(a.rootElement),this.rendererSet=!0),this.renderer.addRenderer(a)},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderer.setFillMode(a),this._resizeViewport()},d.prototype.hitTest=function(a,b){return this.touchEngine.hitTest(this.root,[a,b])},d.prototype.captureScreenShot=function(a,b){return this.renderer.captureScreenShot(this.root,a,b)},d.prototype.getViewportSize=function(){return{width:this.renderer.viewportWidth,height:this.renderer.viewportHeight}},d.prototype.clearImageCache=function(){this.imageCache.clear(),this.renderer.clearImageCaches()},b.exports=d},{"../eventsender":247,"./controls/circlecontrol":336,"./controls/docklayoutcontrol":337,"./controls/flowlayoutcontrol":338,"./controls/imagecontrol":340,"./controls/meshcontrol":342,"./controls/rectanglecontrol":343,"./controls/scrollviewcontrol":344,"./controls/stacklayoutcontrol":345,"./controls/textcontrol":348,"./controls/textinputcontrol":349,"./imagecache":351,"./layout/layouter":354,"./renderer":361,"./touch/draggesturerecognizer":378,"./touch/taphandler":380,"./touch/touchengine":381,"./touch/touchlistener":382}],384:[function(a,b,c){"use strict";var d={Windows:function(){return/IEMobile/i.test(navigator.userAgent)},Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},any:function(){return d.Android()||d.BlackBerry()||d.iOS()||d.Windows()}};b.exports={isMobile:d}},{}]},{},[242])(242)});